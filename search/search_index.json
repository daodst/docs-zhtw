{"config":{"lang":["en"],"separator":"[\\s\\-]+","pipeline":["stopWordFilter"]},"docs":[{"location":"","title":"DAODST\u6587\u6a94\u9996\u9875","text":""},{"location":"api/","title":"Home","text":""},{"location":"api/#cli","title":"cli","text":""},{"location":"api/#eth-json-grpc","title":"eth json grpc","text":""},{"location":"api/#cosmos-grpc","title":"cosmos grpc","text":""},{"location":"chat/","title":"\u804a\u5929","text":"<p>\u804a\u5929\u6a21\u584a\u8ca0\u8cac\u7528\u6236\u93c8\u4e0a\u804a\u5929\u76f8\u95dc\u7684\u8cc7\u6599\u7ba1\u7406\uff0c\u5305\u62ec\u7528\u6236\u7684\u93c8\u4e0a\u8cc7\u8a0a\u5b58\u5132\u7b49</p> <pre><code>chat/\n\u251c\u2500\u2500 client\n\u2502   \u2514\u2500\u2500 rest\n\u2502        \u251c\u2500\u2500 error.go          # \u4ecb\u9762\u932f\u8aa4\u96c6\n\u2502        \u251c\u2500\u2500 grpc.go           # grpc\u67e5\u8be2\u65b9\u6cd5\n\u2502        \u251c\u2500\u2500 handle_account.go # grpc\u67fb\u8a62\u65b9\u6cd5\n\u2502        \u251c\u2500\u2500 handle_chat.go    # chat\u6a21\u584a\u6d88\u606f\u524d\u7f6e\u8655\u7406\n\u2502        \u251c\u2500\u2500 query.go          # \u4ecb\u9762\u67fb\u8a62\u51fd\u6578\n\u2502        \u251c\u2500\u2500 rest.go           # \u6d88\u606f\u8207\u67fb\u8a62\u8def\u7531\u7684\u6ce8\u518c\n\u2502        \u2514\u2500\u2500 tx.go             # tx\u76f8\u95dc\u65b9\u6cd5\uff0c\u5305\u62ec\u5ee3\u64ad\u7b49\n\u251c\u2500\u2500 keeper\n\u2502   \u251c\u2500\u2500 genesis.go        # \u6a21\u584a\u7684\u72c0\u614b\u5316\u548c\u532f\u51fa\n\u2502   \u251c\u2500\u2500 keeper.go         # \u5b58\u5132\u7ba1\u7406\u5668\uff0c\u8655\u7406\u6a21\u584a\u7684\u696d\u52d9\u908f\u8f2f\uff0c\u4e26\u6709\u8a31\u53ef\u6b0a\u8a2a\u554f\u72c0\u614b\u6a39\u7684\u7279\u5b9a\u5b50\u6a39\n\u2502   \u251c\u2500\u2500 msg_server.go     # \u63d0\u4f9b\u4e0a\u93c8\u6d88\u606f\u7684\u670d\u52d9\u8655\u7406\u908f\u8f2f\n\u2502   \u251c\u2500\u2500 params.go         # \u6a21\u584a\u53c3\u6578\u7684\u8a2d\u5b9a\u548c\u7372\u53d6\n\u2502   \u251c\u2500\u2500 query.go          # \u72c0\u614b\u67fb\u8a62\u51fd\u6578\n\u251c\u2500\u2500 types\n\u2502\u00a0\u00a0 \u251c\u2500\u2500 codec.go          # \u7de8\u78bc\u6ce8\u518c\u985e\u578b\n\u2502\u00a0\u00a0 \u251c\u2500\u2500 errors.go         # \u6a21\u584a\u7279\u5b9a\u7684\u932f\u8aa4\n\u2502\u00a0\u00a0 \u251c\u2500\u2500 events.go         # \u5411Tendermint PubSub/Websocket\u66b4\u9732\u7684\u4e8b\u4ef6\n\u2502\u00a0\u00a0 \u251c\u2500\u2500 genesis.go        # \u6a21\u584a\u7684\u5275\u4e16\u72c0\u614b\n\u2502\u00a0\u00a0 \u251c\u2500\u2500 interface.go      # \u6a21\u584a\u7684\u4ecb\u9762\u96c6\u5408\n\u2502\u00a0\u00a0 \u251c\u2500\u2500 keys.go           # \u6a21\u584a\u5b58\u5132key\u4ee5\u53ca\u4e00\u4e9b\u5176\u4ed6\u7684\u5e38\u6578\n\u2502\u00a0\u00a0 \u251c\u2500\u2500 msg.go            # \u804a\u5929\u6a21\u584a\u4ea4\u6613\u6d88\u606f\n\u2502\u00a0\u00a0 \u251c\u2500\u2500 params.go         # \u6a21\u584a\u53ef\u4ee5\u901a\u904e\u6cbb\u7406\u6a21\u584a\u4fee\u6539\u7684\u81ea\u5b9a\u7fa9\u53c3\u6578\n\u2502\u00a0\u00a0 \u2514\u2500\u2500 types.go          # \u6a21\u584a\u7684\u985e\u578b\u96c6\u5408\n\u251c\u2500\u2500 genesis.go            # ABCI\u7684\u5275\u4e16\u72c0\u614b\u521d\u59cb\u5316\u548c\u532f\u51fa\u529f\u80fd\n\u251c\u2500\u2500 handler.go            # \u6d88\u606f\u8def\u7531\n\u2514\u2500\u2500 module.go             # \u6a21\u584a\u7ba1\u7406\u5668\u7684\u6a21\u584a\u8a2d\u5b9a\n</code></pre>"},{"location":"chat/#_1","title":"\u76ee\u9304","text":""},{"location":"chat/#_2","title":"\u804a\u5929","text":"<p>DaoDst\u4f5c\u70ba\u4e00\u500b\u5e36\u6709\u53bb\u4e2d\u5fc3\u5316\u804a\u5929\u7684\u5340\u584a\u93c8\uff0c\u5176\u4e2d\u804a\u5929\u7684\u6578\u64da\u7684\u93c8\u4e0a\u7ba1\u7406\uff0c\u4e3b\u8981\u5c31\u662f\u901a\u904e'x/chat'\u6a21\u584a\u9032\u884c\uff0c</p> <p>\u7576\u7528\u6236\u8a3b\u518a\u804a\u5929\u6642\uff0c\u6703\u767c\u8d77\u5ee3\u64ad\uff0c\u5c07\u7528\u6236\u7684\u5730\u5740\uff0c\u9598\u9053\uff0cdid\uff0c\u804a\u5929\u7b49\u8cc7\u8a0a\u8a18\u9304\u5230\u93c8\u4e0a\u3002</p> <p>\u7576\u5176\u4ed6\u529f\u80fd\u6216\u6a21\u584a\u9700\u8981\u8abf\u7528\u9019\u4e9b\u6578\u64da\u6642\uff0c\u4e5f\u9700\u8981\u901a\u904echat\u6a21\u584a\u7372\u53d6</p>"},{"location":"chat/#_3","title":"\u72c0\u614b","text":"<p>Chat\u6a21\u584a\u5b58\u5132\u4e86\u95dc\u65bc\u804a\u5929\u7528\u6236\u7684\u57fa\u790e\u93c8\u4e0a\u6578\u64da</p> <pre><code>// \u7528\u6237\u4fe1\u606f\ntype UserInfo struct {\n    //\u9322\u5305\u5730\u5740\n    FromAddress string `json:\"from_address\" yaml:\"from_address\"`\n    //\u6ce8\u518c\u9598\u9053\n    RegisterNodeAddress string `json:\"register_node_address\" yaml:\"register_node_address\"`\n    //\u7576\u524d\u9598\u9053\n    NodeAddress string `json:\"node_address\" yaml:\"node_address\"`\n    //\u901a\u8a0a\u9304\n    AddressBook string `json:\"address_book\" yaml:\"address_book\"`\n    //\u901a\u8a0a\u9304\u9ed1\u540d\u55ae\uff08\u7528\u6236\u516c\u958b\u91d1\u9470\u52a0\u5bc6\uff09\n    ChatBlacklist string `json:\"chat_blacklist\" yaml:\"chat_blacklist\"`\n    //\u804a\u5929\u9650\u5236\u6a21\u5f0f\uff08fee | any | list\uff09\n    ChatRestrictedMode string `json:\"chat_restricted_mode\" yaml:\"chat_restricted_mode\"`\n    //\u901a\u8a0a\u9304\u767d\u540d\u55ae\uff08\u7528\u6236\u516c\u958b\u91d1\u9470\u52a0\u5bc6\uff09\n    ChatWhitelist string `json:\"chat_whitelist\" yaml:\"chat_whitelist\"`\n    //\u804a\u5929\u6536\u8cbb\u8cbb\u7528\n    ChatFee types.Coin `json:\"chat_fee\" yaml:\"chat_fee\"`\n    //\u6301\u6709did\n    Mobile []string `json:\"mobile\" yaml:\"mobile\"`\n    //\u6700\u5f8c\u66f4\u65b0\u6642\u9593\n    UpdateTime int64 `json:\"update_time\" yaml:\"update_time\"`\n    //\u901a\u8a0a\u9304\u9ed1\u540d\u55ae\uff08\u9598\u9053\u516c\u958b\u91d1\u9470\u52a0\u5bc6\uff09\n    ChatBlackEncList string `json:\"chat_black_enc_list\" yaml:\"chat_black_enc_list\"`\n    //\u901a\u8a0a\u9304\u767d\u540d\u55ae\uff08\u9598\u9053\u516c\u958b\u91d1\u9470\u52a0\u5bc6\uff09\n    ChatWhiteEncList string `json:\"chat_white_enc_list\" yaml:\"chat_white_enc_list\" `\n    //\u5099\u8a3b\n    Remarks string `json:\"remarks\" yaml:\"remarks\"`\n}\n</code></pre> <p>\u7528\u6236\u5728\u6ce8\u518c\u7684\u6642\u5019\u6703\u5c07\u5176\u521d\u59cb\u5316\uff0c</p> <p>\u5176\u4e2dChatRestrictedMode\uff0cChatFee\u5169\u500b\u95dc\u65bc\u804a\u5929\u6536\u8cbb\u7684\u53c3\u6578\u6703\u6709\u9810\u8a2d\u503c</p> <p>Chat\u6a21\u584a\u7684\u5927\u591a\u6578\u696d\u52d9\u908f\u8f2f\u90fd\u662f\u57fa\u65bc\u6b64\u7d50\u69cb\u9ad4\u7684</p>"},{"location":"chat/#did","title":"DID","text":"<p>\u7528\u6236\u8a3b\u518a\u6642\u9700\u8981\u9078\u64c7\u6240\u5c6c\u7684\u9598\u9053\uff0c\u4e26\u9078\u64c7\u5c6c\u65bc\u9598\u9053\u7684\u4e00\u500b\u865f\u78bc\u6bb5 \u5728\u6b64\u865f\u78bc\u6bb5\u4e0b\uff0c\u7528\u6236\u5c07\u5f97\u5230\u4e00\u500b\u5c08\u5c6c\u7684\u865f\u78bc\uff08DID\uff09\uff0c\u6b64\u865f\u78bc\u6b78\u5c6c\u8207\u9322\u5305\u5730\u5740\uff08\u5373\u4f7f\u9598\u9053\u4e0d\u518d\u5b58\u5728\uff09 \u8655\u7406\u524d\u7f6e\u865f\u78bc\u6bb5\u5916\uff0c\u5f8c\u7e8c\u7684\u865f\u78bc\u662f\u905e\u589e\u7684</p> <p>\u6bd4\u5982\u67d0\u9598\u9053\u4e0b8888888\u865f\u78bc\u6bb5\uff0c\u6b64\u865f\u78bc\u6bb5\u4e0b\u865f\u78bc\u5df2\u7d93\u5230\u90541234 \u90a3\u9ebc\u4e0b\u4e00\u500b\u9078\u64c7\u6b64\u865f\u78bc\u6bb5\u7684\u4eba\uff0c\u7372\u5f97\u7684\u865f\u78bc\u5c07\u6703\u662f88888881235</p> <p>\u9664\u4e86\u6ce8\u518c\u5916\uff0c\u9084\u53ef\u4ee5\u4e3b\u52d5\u92b7\u6bc0\u4f86\u7372\u5f97DID</p> <p>did \u53ef\u4ee5\u901a\u4e3b\u52a8\u8f6c\u8ba9</p>"},{"location":"chat/#_4","title":"\u92b7\u6bc0\u8207\u8cea\u62bc","text":"<p>\u6ce8\u518c\u804a\u5929\u65f6\uff0c\u9700\u8981\u9500\u6bc1\u4e00\u5b9a\u6570\u91cf\u7684DST,\u540c\u65f6\uff0c\u6ce8\u518c\u5408\u7ea6\u5c06\u4f1a\u81ea\u52a8\u628a\u9500\u6bc1\u5f97\u5230\u7684\u54c8\u5e0c\u5e01\u8d28\u62bc\u5230 Pledge \u6a21\u5757\uff0c\u7531\u6b64\u83b7\u5f97\u8d28\u62bc\u5956\u52b1</p>"},{"location":"chat/#_5","title":"\u804a\u5929\u6536\u8cbb\u6a21\u5f0f","text":"<p>\u7528\u6236\u8a3b\u518a\u6642\uff0c\u9ed8\u8a8d\u7684\u804a\u5929\u6536\u8cbb\u6a21\u5f0f\u70ba\u201d\u6536\u8cbb\u201c\uff0c\u7528\u6236\u53ef\u4ee5\u81ea\u884c\u767c\u6d88\u606f\u4e0a\u93c8\u66f4\u6539</p> <p>\u6709\u5982\u4e0b\u4e09\u7a2e\u6a21\u5f0f</p> <ul> <li>\u6536\u8cbb\u6a21\u5f0f</li> </ul> <p>\u958b\u555f\u6536\u8cbb\u6a21\u5f0f\u5f8c\uff0c\u4e3b\u52d5\u767c\u8d77\u804a\u5929\u6216\u8005\u62c9\u5165\u623f\u9593\u9700\u8981\u652f\u4ed8\u4e00\u5b9a\u8cbb\u7528</p> <ul> <li>\u516c\u958b\u6a21\u5f0f</li> </ul> <p>\u958b\u555f\u516c\u958b\u6a21\u5f0f\u5f8c\uff0c\u4efb\u4f55\u4eba\u90fd\u53ef\u4ee5\u4e3b\u52d5\u5411\u4f60\u767c\u8d77\u804a\u5929</p> <ul> <li>\u767d\u540d\u55ae\u6a21\u5f0f</li> </ul> <p>\u958b\u555f\u767d\u540d\u55ae\u6a21\u5f0f\u5f8c\uff0c\u53ea\u6709\u5728\u767d\u540d\u55ae\u5167\u7684\u5730\u5740\u53ef\u4ee5\u5411\u4f60\u767c\u8d77\u804a\u5929\uff08\u767d\u540d\u55ae\u7684\u8a2d\u5b9a\u540c\u5c6c\u65bcchat\u6a21\u584a\uff09</p>"},{"location":"chat/#_6","title":"\u529f\u80fd","text":"<p>\u804a\u5929\u6a21\u584a' Keeper '\u6388\u4e88\u5c0d\u804a\u5929\u6a21\u584a\u72c0\u614b\u7684\u5b58\u53d6\u6b0a\u9650 \u4e26\u5be6\u73fe' statedb\u3002 \u4ecb\u9762\uff0c\u4ee5\u652f\u6301' StateDB '\u5be6\u73fe\u3002 Keeper\u5305\u542b\u4e00\u500b\u5141\u8a31\u8cc7\u6599\u5eab\u7684\u5b58\u5132\u9375 \u5beb\u5165\u53ea\u80fd\u7531Chat\u6a21\u584a\u8a2a\u554f\u7684\u591a\u5eab\u7684\u5177\u9ad4\u5b50\u6a39\u3002 \u800c\u4e0d\u662f\u4f7f\u7528\u6a39\u548c\u8cc7\u6599\u5eab\u9032\u884c\u67fb\u8a62\u548c\u6301\u4e45\u5316\uff08' StateDB '\u5be6\u73fe\uff09\uff0c DaoDst\u4f7f\u7528Cosmos\u7684\u201cKVStore\u201d\uff08\u9375\u503c\u5b58\u5132\uff09\u548cCosmos SDK\u7684\u201cKeeper\u201d\u4f86\u4fc3\u9032\u72c0\u614b\u8f49\u63db\u3002</p> <p>\u70ba\u4e86\u652f\u6301\u4ecb\u9762\u529f\u80fd\uff0c\u5b83\u5c0e\u5165\u4e864\u500b\u6a21\u584aKeepers:</p> <ul> <li><code>auth</code>: \u5e33\u865f\u7684\u589e\u5220\u6539\u67e5</li> <li><code>bank</code>: \u4f9b\u61c9\u91cf\u548c\u9918\u984d\u7684\u589e\u5220\u6539\u67e5</li> <li><code>comm</code>: \u9598\u9053\u76f8\u95dc\u8cc7\u6599\u7684\u7ba1\u7406</li> <li><code>pledge</code>: \u8cea\u62bc\u3001\u92b7\u6bc0\u8207\u734e\u52f5</li> </ul> <pre><code>type Keeper struct {\n    storeKey   sdk.StoreKey\n    cdc        codec.BinaryCodec\n    paramstore paramtypes.Subspace\n\n    accountKeeper types.AccountKeeper\n    bankKeeper    types.BankKeeper\n    commKeeper    commkeeper.Keeper\n    pledgeKeeper  pledgekeeper.Keeper\n}\n\n</code></pre>"},{"location":"chat/#_7","title":"\u6d88\u606f","text":""},{"location":"chat/#msgsendgift","title":"MsgSendGift","text":"<pre><code>\u901a\u904e\u6b64\u6d88\u606f\u5c07\u5730\u5740\u6ce8\u518c\u5230chat\u6a21\u584a\uff0c\u4e26\u521d\u59cb\u5316\u5c0d\u61c9\u8cc7\u8a0a\n</code></pre> <pre><code>      type MsgRegister struct {\n          FromAddress    string     `protobuf:\"bytes,1,opt,name=from_address,json=fromAddress,proto3\" json:\"from_address,omitempty\" yaml:\"from_address\"`\n          NodeAddress    string     `protobuf:\"bytes,2,opt,name=node_address,json=nodeAddress,proto3\" json:\"node_address,omitempty\" yaml:\"node_address\"`\n          MortgageAmount types.Coin `protobuf:\"bytes,3,opt,name=mortgage_amount,json=mortgageAmount,proto3\" json:\"mortgage_amount\" yaml:\"mortgage_amount\"`\n          MobilePrefix   string     `protobuf:\"bytes,4,opt,name=mobile_prefix,json=mobilePrefix,proto3\" json:\"mobile_prefix,omitempty\" yaml:\"mobile_prefix\"`\n      }\n</code></pre>"},{"location":"chat/#msgsetchatinfo","title":"MsgSetChatInfo","text":"<pre><code>\u901a\u904e\u6b64\u6d88\u606f\u4fee\u6539\u5730\u5740\u5c0d\u61c9\u7684chat\u6a21\u584a\u5b58\u5132\u7684\u6578\u64da\uff0c\u8a72\u6d88\u606f\u63a5\u53d7\u5168\u91cf\u7684\u7528\u6236\u6578\u64da\uff0c\u4e26\u8986\u84cb\u539f\u4f86\u7684\u6578\u64da\n</code></pre> <pre><code>    type MsgSetChatInfo struct {\n        FromAddress        string     `protobuf:\"bytes,1,opt,name=from_address,json=fromAddress,proto3\" json:\"from_address,omitempty\" yaml:\"from_address\"`\n        NodeAddress        string     `protobuf:\"bytes,2,opt,name=node_address,json=nodeAddress,proto3\" json:\"node_address,omitempty\" yaml:\"node_address\"`\n        AddressBook        string     `protobuf:\"bytes,3,opt,name=address_book,json=addressBook,proto3\" json:\"address_book,omitempty\" yaml:\"address_book\"`\n        ChatBlacklist      string     `protobuf:\"bytes,4,opt,name=chat_blacklist,json=chatBlacklist,proto3\" json:\"chat_blacklist,omitempty\" yaml:\"chat_blacklist\"`\n        ChatRestrictedMode string     `protobuf:\"bytes,5,opt,name=chat_restricted_mode,json=chatRestrictedMode,proto3\" json:\"chat_restricted_mode,omitempty\" yaml:\"chat_limit\"`\n        ChatFee            types.Coin `protobuf:\"bytes,6,opt,name=chat_fee,json=chatFee,proto3\" json:\"chat_fee\" yaml:\"chat_fee\"`\n        ChatWhitelist      string     `protobuf:\"bytes,7,opt,name=chat_whitelist,json=chatWhitelist,proto3\" json:\"chat_whitelist,omitempty\" yaml:\"chat_whitelist\"`\n        UpdateTime         int64      `protobuf:\"varint,8,opt,name=update_time,json=updateTime,proto3\" json:\"update_time,omitempty\" yaml:\"update_time\"`\n        ChatBlacklistEnc   string     `protobuf:\"bytes,9,opt,name=chat_blacklist_enc,json=chatBlacklistEnc,proto3\" json:\"chat_blacklist_enc,omitempty\" yaml:\"chat_blacklist_enc\"`\n        ChatWhitelistEnc   string     `protobuf:\"bytes,10,opt,name=chat_whitelist_enc,json=chatWhitelistEnc,proto3\" json:\"chat_whitelist_enc,omitempty\" yaml:\"chat_whitelist_enc\"`\n    }\n</code></pre>"},{"location":"chat/#msgburngetmobile","title":"MsgBurnGetMobile","text":"<pre><code>\u901a\u904e\u6b64\u6d88\u606f\u901a\u904e\u92b7\u6bc0\u7684\u7ba1\u9053\u7372\u5f97did\uff0c\u7372\u5f97\u7684did\u7684\u9996\u78bc\u70ba\u9078\u64c7\u7684did\u865f\u6bb5\uff0c\u5c3e\u78bc\u5247\u5728\u6b64\u865f\u6bb5\u4e0b\u905e\u589e\n\n\u5982\u679c\u865f\u6bb5\u8207\u9598\u9053\u4e0d\u5339\u914d\u6216\u865f\u6bb5\u4e0b\u865f\u78bc\u5df2\u6eff\uff0c\u5247\u7372\u53d6\u5931\u6557\n</code></pre> <pre><code>    type MsgBurnGetMobile struct {\n        FromAddress  string `protobuf:\"bytes,1,opt,name=from_address,json=fromAddress,proto3\" json:\"from_address,omitempty\" yaml:\"from_address\"`\n        MobilePrefix string `protobuf:\"bytes,2,opt,name=mobile_prefix,json=mobilePrefix,proto3\" json:\"mobile_prefix,omitempty\" yaml:\"mobile_prefix\"`\n    }\n</code></pre>"},{"location":"chat/#msgmobiletransfer","title":"MsgMobileTransfer","text":"<pre><code>\u6301\u6709\u7684did\u53ef\u4ee5\u8f49\u8b93\n\n\u5982\u679c\u5c0d\u65b9\u6301\u6709\u7684did\u5df2\u7d93\u5230\u9054\u6700\u5927\u6301\u6709\u91cf\uff0c\u5247\u8f49\u8b93\u5931\u6557\n</code></pre> <pre><code>    type MsgMobileTransfer struct {\n        FromAddress string `protobuf:\"bytes,1,opt,name=from_address,json=fromAddress,proto3\" json:\"from_address,omitempty\" yaml:\"from_address\"`\n        ToAddress   string `protobuf:\"bytes,2,opt,name=to_address,json=toAddress,proto3\" json:\"to_address,omitempty\" yaml:\"to_address\"`\n        Mobile      string `protobuf:\"bytes,3,opt,name=mobile,proto3\" json:\"mobile,omitempty\" yaml:\"mobile\"`\n    }\n</code></pre>"},{"location":"chat/#msgchatsendgift","title":"MsgChatSendGift","text":"<pre><code>\u804a\u5929\u652f\u4ed8\uff0c\u5982\u679c\u5c0d\u65b9\u8a2d\u5b9a\u4e86\u804a\u5929\u6536\u8cbb\uff0c\u9700\u8981\u767c\u8d77\u6b64\u6d88\u606f\u7d66\u5c0d\u65b9\u652f\u4ed8\u4e00\u5b9atoken\n</code></pre> <pre><code>    type MsgChatSendGift struct {\n        FromAddress string     `protobuf:\"bytes,1,opt,name=from_address,json=fromAddress,proto3\" json:\"from_address,omitempty\" yaml:\"from_address\"`\n        ToAddress   string     `protobuf:\"bytes,2,opt,name=to_address,json=toAddress,proto3\" json:\"to_address,omitempty\" yaml:\"to_address\"`\n        GiftValue   types.Coin `protobuf:\"bytes,3,opt,name=gift_value,json=giftValue,proto3\" json:\"gift_value\" yaml:\"gift_value\"`\n    }\n</code></pre>"},{"location":"chat/#_8","title":"\u53c3\u6578","text":"<p>chat\u6a21\u584a\u5305\u542b\u5982\u4e0b\u6a21\u584a\u53c3\u6578</p>"},{"location":"chat/#_9","title":"\u53c3\u6578","text":"Key \u7c7b\u578b \u9884\u8bbe\u503c <code>MaxPhoneNumber</code> uint64 <code>10</code> <code>DestroyPhoneNumberCoin</code> github.com/cosmos/cosmos-sdk/types.Coin <code>100000000000000000000dst</code> <code>ChatFee</code> github.com/cosmos/cosmos-sdk/types.Coin <code>1000000000000000000dst</code> <code>MinRegisterBurnAmount</code> github.com/cosmos/cosmos-sdk/types.Coin <code>100000000000000000000dst</code>"},{"location":"contract/","title":"\u5408\u7d04","text":"<p>\u6b64\u6a21\u5757\u8d1f\u8d23\u548cevm\u6709\u5173\u7684\u4ea4\u6613\u548c\u67e5\u8be2</p> <pre><code>chat/\n\u251c\u2500\u2500 client\n\u2502   \u2514\u2500\u2500 rest\n\u2502        \u251c\u2500\u2500 error.go          # \u4ecb\u9762\u932f\u8aa4\u96c6\n\u2502        \u251c\u2500\u2500 grpc.go           # grpc\u67fb\u8a62\u65b9\u6cd5\n\u2502        \u251c\u2500\u2500 handle_comm.go    # comm\u6a21\u584a\u6d88\u606f\u524d\u7f6e\u8655\u7406\n\u2502        \u251c\u2500\u2500 query.go          # \u4ecb\u9762\u67fb\u8a62\u51fd\u6578\n\u2502        \u251c\u2500\u2500 rest.go           # \u6d88\u606f\u8207\u67fb\u8a62\u8def\u7531\u7684\u6ce8\u518c\n\u2502        \u2514\u2500\u2500 tx.go             # tx\u76f8\u95dc\u65b9\u6cd5\uff0c\u5305\u62ec\u5ee3\u64ad\u7b49\n\u251c\u2500\u2500 keeper\n\u2502   \u251c\u2500\u2500 genesis.go        # \u6a21\u584a\u7684\u72c0\u614b\u5316\u548c\u532f\u51fa\n\u2502   \u251c\u2500\u2500 keeper.go         # \u5b58\u5132\u7ba1\u7406\u5668\uff0c\u8655\u7406\u6a21\u584a\u7684\u696d\u52d9\u908f\u8f2f\uff0c\u4e26\u6709\u8a31\u53ef\u6b0a\u8a2a\u554f\u72c0\u614b\u6a39\u7684\u7279\u5b9a\u5b50\u6a39\n\u2502   \u251c\u2500\u2500 msg_server.go     # \u63d0\u4f9b\u4e0a\u93c8\u6d88\u606f\u7684\u670d\u52d9\u8655\u7406\u908f\u8f2f\n\u2502   \u251c\u2500\u2500 params.go         # \u6a21\u584a\u53c3\u6578\u7684\u8a2d\u5b9a\u548c\u7372\u53d6\n\u2502   \u251c\u2500\u2500 query.go          # \u72c0\u614b\u67fb\u8a62\u51fd\u6578\n\u2502   \u251c\u2500\u2500 medal.go          # hash\u5e01\u8d28\u62bc\u8ba1\u7b97\u76f8\u5173\u903b\u8f91\u7b97\u6cd5\n\u2502   \u2514\u2500\u2500 mingkeeper.go     # \u94f8\u9020\u589e\u53d1\u76f8\u5173\u903b\u8f91\u7b97\u6cd5\n\u251c\u2500\u2500 types\n\u2502\u00a0\u00a0 \u251c\u2500\u2500 codec.go          # \u7de8\u78bc\u6ce8\u518c\u985e\u578b\n\u2502\u00a0\u00a0 \u251c\u2500\u2500 errors.go         # \u6a21\u584a\u7279\u5b9a\u7684\u932f\u8aa4\n\u2502\u00a0\u00a0 \u251c\u2500\u2500 events.go         # \u5411Tendermint PubSub/Websocket\u66b4\u9732\u7684\u4e8b\u4ef6\n\u2502\u00a0\u00a0 \u251c\u2500\u2500 genesis.go        # \u6a21\u584a\u7684\u5275\u4e16\u72c0\u614b\n\u2502\u00a0\u00a0 \u251c\u2500\u2500 interface.go      # \u6a21\u584a\u7684\u4ecb\u9762\u96c6\u5408\n\u2502\u00a0\u00a0 \u251c\u2500\u2500 keys.go           # \u6a21\u584a\u5b58\u5132key\u4ee5\u53ca\u4e00\u4e9b\u5176\u4ed6\u7684\u5e38\u6578\n\u2502\u00a0\u00a0 \u251c\u2500\u2500 msg.go            # \u804a\u5929\u6a21\u584a\u4ea4\u6613\u6d88\u606f\n\u2502\u00a0\u00a0 \u251c\u2500\u2500 params.go         # \u6a21\u584a\u53ef\u4ee5\u901a\u904e\u6cbb\u7406\u6a21\u584a\u4fee\u6539\u7684\u81ea\u5b9a\u7fa9\u53c3\u6578\n\u2502\u00a0\u00a0 \u251c\u2500\u2500 interface.go      # \u5f15\u5165\u7684\u5916\u90e8\u6a21\u5757\u5b9e\u73b0\u7684\u65b9\u6cd5\n\u2502\u00a0\u00a0 \u2514\u2500\u2500 types.go          # \u6a21\u584a\u7684\u985e\u578b\u96c6\u5408\n\u251c\u2500\u2500 genesis.go            # ABCI\u7684\u5275\u4e16\u72c0\u614b\u521d\u59cb\u5316\u548c\u532f\u51fa\u529f\u80fd\n\u251c\u2500\u2500 handler.go            # \u6d88\u606f\u8def\u7531\n\u2514\u2500\u2500 module.go             # \u6a21\u584a\u7ba1\u7406\u5668\u7684\u6a21\u584a\u8a2d\u5b9a\n</code></pre>"},{"location":"contract/#_1","title":"\u6982\u8ff0","text":""},{"location":"contract/#_2","title":"\u5408\u7d04","text":"<pre><code>Contract\u8ca0\u8cac\u548cevm\u5408\u7d04\u7684\u6709\u95dc\u5167\u5bb9\n</code></pre>"},{"location":"contract/#_3","title":"\u4e00\u9375\u767c\u5e63","text":"<pre><code>\u7528\u6236\u53ef\u4ee5\u901a\u904e\u6d88\u606f\u76f4\u63a5\u5728evm\u4e0a\u767c\u4f48\u81ea\u5df1\u7684\u4ee3\u5e63\uff0c\u53ea\u9700\u8981\u4e0a\u50b3\u4ee3\u5e63\u7684\u4e00\u4e9b\u57fa\u672c\u8cc7\u8a0a\u5373\u53ef\uff0c\u4e0d\u9700\u8981\u90e8\u7f72\u4ee3\u5e63\u5408\u7d04\n\u4e00\u5207\u90fd\u5728\u5408\u7d04\u5167\u90e8\u81ea\u52d5\u5b8c\u6210\n</code></pre>"},{"location":"contract/#_4","title":"\u8de8\u93c8\u8f49\u5e33","text":"<pre><code>\u53ef\u4ee5\u901a\u904e\u6b64\u6a21\u584a\u5be6\u73feDaoDst\u5230\u5916\u93c8\u7684\u4ee3\u5e63\u6620\u5c04\u8f49\u5e33\uff08\u5982ETH\uff09\uff0c\u8de8\u93c8\u652f\u6301\u96d9\u5411\n\n\u7576DaoDst\u5411\u5916\u90e8\u93c8\u8de8\u93c8\u8f49\u5e33\u6642\uff0c\u6703\u5c07Daodst\u5167\u90e8\u7684\u9918\u984d\u51cd\u7d50\uff0c\u540c\u6642\uff0c\u5916\u90e8\u93c8\u5408\u7d04\u589e\u767c\u5c0d\u61c9\u4ee3\u5e63\n\u5c0d\u61c9\u7684\uff0c\u9032\u884c\u76f8\u53cd\u64cd\u4f5c\u6642\uff0c\u5916\u90e8\u93c8\u92b7\u6bc0\uff0cDaodst\u89e3\u51cd\n</code></pre>"},{"location":"contract/#_5","title":"\u529f\u80fd","text":"<p>\u5408\u7ea6\u6a21\u584a' Keeper '\u6388\u4e88\u5c0d\u804a\u5929\u6a21\u584a\u72c0\u614b\u7684\u5b58\u53d6\u6b0a\u9650 \u4e26\u5be6\u73fe' statedb\u3002 \u4ecb\u9762\uff0c\u4ee5\u652f\u6301' StateDB '\u5be6\u73fe\u3002 Keeper\u5305\u542b\u4e00\u500b\u5141\u8a31\u8cc7\u6599\u5eab\u7684\u5b58\u5132\u9375 \u5beb\u5165\u53ea\u80fd\u7531Chat\u6a21\u584a\u8a2a\u554f\u7684\u591a\u5eab\u7684\u5177\u9ad4\u5b50\u6a39\u3002 \u800c\u4e0d\u662f\u4f7f\u7528\u6a39\u548c\u8cc7\u6599\u5eab\u9032\u884c\u67fb\u8a62\u548c\u6301\u4e45\u5316\uff08' StateDB '\u5be6\u73fe\uff09\uff0c DaoDst\u4f7f\u7528Cosmos\u7684\u201cKVStore\u201d\uff08\u9375\u503c\u5b58\u5132\uff09\u548cCosmos SDK\u7684\u201cKeeper\u201d\u4f86\u4fc3\u9032\u72c0\u614b\u8f49\u63db\u3002</p> <p>\u70ba\u4e86\u652f\u6301\u4ecb\u9762\u529f\u80fd\uff0c\u5b83\u5c0e\u5165\u4e867\u500b\u6a21\u584aKeepers:</p> <ul> <li><code>auth</code>: \u5e33\u865f\u7684\u589e\u5220\u6539\u67e5</li> <li><code>bank</code>: \u4f9b\u61c9\u91cf\u548c\u9918\u984d\u7684\u589e\u5220\u6539\u67e5</li> <li><code>staking</code>: \u9598\u9053\u76f8\u95dc\u8cc7\u6599\u7684\u7ba1\u7406</li> <li><code>pledge</code>: \u804a\u5929\u76f8\u5173\u6570\u636e\u7684\u7ba1\u7406</li> <li><code>evm</code>: evm\u76f8\u5173\u6570\u636e\u7684\u7ba1\u7406</li> <li><code>chat</code>: \u804a\u5929\u76f8\u95dc\u8cc7\u6599\u7684\u7ba1\u7406</li> <li><code>gateway</code>: \u9598\u9053\u8cc7\u6599\u7ba1\u7406</li> </ul> <pre><code>    type Keeper struct {\n        storeKey   sdk.StoreKey\n        cdc        codec.BinaryCodec\n        paramstore paramtypes.Subspace\n\n        stakingKeeper *stakingKeeper.Keeper\n        accountKeeper types.AccountKeeper\n        BankKeeper    types.BankKeeper\n        pledgeKeeper  types.PledgeKeeper\n        evmKeeper     types.EVMKeeper\n        chatKeeper    types.ChatKeeper\n        gatewayKeeper types.GatewayKeeper\n        erc20Keeper   erc20keeper.Keeper\n    }\n</code></pre>"},{"location":"contract/#_6","title":"\u6d88\u606f","text":""},{"location":"contract/#msgapptokenissue","title":"MsgAppTokenIssue","text":"<pre><code>\u901a\u904e\u6b64\u6d88\u606f\uff0c\u767c\u8d77\u4e00\u9375\u767c\u5e63\n</code></pre> <pre><code>    type MsgAppTokenIssue struct {\n        FromAddress   string `protobuf:\"bytes,1,opt,name=from_address,json=fromAddress,proto3\" json:\"from_address,omitempty\" yaml:\"from_address\"`\n        Name          string `protobuf:\"bytes,2,opt,name=name,proto3\" json:\"name,omitempty\" yaml:\"name\"`\n        Symbol        string `protobuf:\"bytes,3,opt,name=symbol,proto3\" json:\"symbol,omitempty\" yaml:\"symbol\"`\n        PreMintAmount string `protobuf:\"bytes,4,opt,name=pre_mint_amount,json=preMintAmount,proto3\" json:\"pre_mint_amount,omitempty\" yaml:\"pre_mint_amount\"`\n        Decimals      string `protobuf:\"bytes,5,opt,name=decimals,proto3\" json:\"decimals,omitempty\" yaml:\"decimals\"`\n        LogoUrl       string `protobuf:\"bytes,6,opt,name=logo_url,json=logoUrl,proto3\" json:\"logo_url,omitempty\" yaml:\"logo_url\"`\n    }\n</code></pre>"},{"location":"contract/#msgcrosschainout","title":"MsgCrossChainOut","text":"<pre><code>\u901a\u904e\u6b64\u6d88\u606f\uff0c\u5f9eDaoDst\u5411\u5916\u767c\u8d77\u8de8\u93c8\u8f49\u5e33\n</code></pre> <pre><code>    type MsgCrossChainOut struct {\n        SendAddress string `protobuf:\"bytes,1,opt,name=send_address,json=sendAddress,proto3\" json:\"send_address,omitempty\" yaml:\"send_address\"`\n        ToAddress   string `protobuf:\"bytes,2,opt,name=to_address,json=toAddress,proto3\" json:\"to_address,omitempty\" yaml:\"to_address\"`\n        Coins       string `protobuf:\"bytes,3,opt,name=coins,proto3\" json:\"coins,omitempty\" yaml:\"coins\"`\n        ChainType   string `protobuf:\"bytes,4,opt,name=chain_type,json=chainType,proto3\" json:\"chain_type,omitempty\" yaml:\"chain_type\"`\n        Remark      string `protobuf:\"bytes,5,opt,name=remark,proto3\" json:\"remark,omitempty\" yaml:\"remark\"`\n    }\n</code></pre>"},{"location":"contract/#msgcrosschainin","title":"MsgCrossChainIn","text":"<pre><code>\u901a\u904e\u6b64\u6d88\u606f\uff0c\u5f9e\u5916\u90e8\u93c8\u767c\u8d77\u5411DaoDst\u7684\u8de8\u93c8\u8f49\u5e33\n</code></pre> <pre><code>    type MsgCrossChainIn struct {\n        SendAddress string `protobuf:\"bytes,1,opt,name=send_address,json=sendAddress,proto3\" json:\"send_address,omitempty\" yaml:\"send_address\"`\n        Coins       string `protobuf:\"bytes,2,opt,name=coins,proto3\" json:\"coins,omitempty\" yaml:\"coins\"`\n        ChainType   string `protobuf:\"bytes,3,opt,name=chain_type,json=chainType,proto3\" json:\"chain_type,omitempty\" yaml:\"chain_type\"`\n        Remark      string `protobuf:\"bytes,4,opt,name=remark,proto3\" json:\"remark,omitempty\" yaml:\"remark\"`\n        TxHash      string `protobuf:\"bytes,5,opt,name=tx_hash,json=txHash,proto3\" json:\"tx_hash,omitempty\" yaml:\"tx_hash\"`\n    }\n</code></pre>"},{"location":"evm/","title":"\u4ee5\u592a\u574a\u865b\u64ec\u6a5f","text":"<p>\u672c\u6587\u6a94\u5c07\u4ee5\u592a\u574a\u865b\u64ec\u6a5f (EVM) \u7684\u898f\u7bc4\u5b9a\u7fa9\u70ba Cosmos SDK \u6a21\u584a\u3002</p> <p>\u81ea2015\u5e74\u5f15\u5165\u4ee5\u592a\u574a\u4ee5\u4f86\uff0c\u901a\u904e[\u667a\u80fd\u5408\u7d04]\u63a7\u5236\u6578\u5b57\u8cc7\u7522\u7684\u80fd\u529b\u5438\u5f15\u4e86\u5927\u91cf\u958b\u767c\u4eba\u54e1\u5728\u4ee5\u592a\u574a\u865b\u64ec\u6a5f (EVM) \u4e0a\u69cb\u5efa\u53bb\u4e2d\u5fc3\u5316\u61c9\u7528\u7a0b\u5e8f\u3002 \u8a72\u793e\u5340\u4e0d\u65b7\u5275\u5efa\u5ee3\u6cdb\u7684\u5de5\u5177\u4e26\u5f15\u5165\u6a19\u6e96\uff0c\u9019\u9032\u4e00\u6b65\u63d0\u9ad8\u4e86 EVM \u517c\u5bb9\u6280\u8853\u7684\u63a1\u7528\u7387\u3002</p> <p>\u7136\u800c\uff0c\u57fa\u65bc EVM \u7684\u93c8\uff08\u4f8b\u5982\u4ee5\u592a\u574a\uff09\u7684\u589e\u9577\u63ed\u793a\u4e86\u4e00\u4e9b\u53ef\u64f4\u5c55\u6027\u6311\u6230\uff0c\u9019\u4e9b\u6311\u6230\u901a\u5e38\u88ab\u7a31\u70ba\u53bb\u4e2d\u5fc3\u5316\u3001\u5b89\u5168\u6027\u548c\u53ef\u64f4\u5c55\u6027\u7684\u4e09\u96e3\u56f0\u5883\u3002 \u958b\u767c\u4eba\u54e1\u5c0d\u9ad8\u6602\u7684 gas \u8cbb\u7528\u3001\u7de9\u6162\u7684\u4ea4\u6613\u901f\u5ea6\u548c\u541e\u5410\u91cf\u4ee5\u53ca\u93c8\u7279\u5b9a\u7684\u6cbb\u7406\u611f\u5230\u6cae\u55aa\uff0c\u9019\u4e9b\u6cbb\u7406\u7531\u65bc\u5176\u5ee3\u6cdb\u90e8\u7f72\u7684\u61c9\u7528\u7a0b\u5e8f\u800c\u53ea\u80fd\u7d93\u6b77\u7de9\u6162\u7684\u8b8a\u5316\u3002 \u9700\u8981\u4e00\u7a2e\u89e3\u6c7a\u65b9\u6848\u4f86\u6d88\u9664\u5728\u719f\u6089\u7684 EVM \u74b0\u5883\u4e2d\u69cb\u5efa\u61c9\u7528\u7a0b\u5e8f\u7684\u958b\u767c\u4eba\u54e1\u7684\u9019\u4e9b\u9867\u616e\u3002</p> <p><code>x/evm</code> \u6a21\u584a\u5728\u53ef\u64f4\u5c55\u3001\u9ad8\u541e\u5410\u91cf\u7684\u6b0a\u76ca\u8b49\u660e\u5340\u584a\u93c8\u4e0a\u63d0\u4f9b\u9019\u7a2e EVM \u719f\u6089\u5ea6\u3002 \u5b83\u69cb\u5efa\u70ba Cosmos SDK \u6a21\u584a\uff0c\u5141\u8a31\u90e8\u7f72\u667a\u80fd\u5408\u7d04\u3001\u8207 EVM \u72c0\u614b\u6a5f\u4ea4\u4e92\uff08\u72c0\u614b\u8f49\u63db\uff09 \uff0c\u4ee5\u53ca EVM \u5de5\u5177\u7684\u4f7f\u7528\u3002 \u5b83\u53ef\u7528\u65bc Cosmos \u7279\u5b9a\u61c9\u7528\u7a0b\u5e8f\u5340\u584a\u93c8\uff0c\u901a\u904e Tendermint Core \u7684\u9ad8\u4ea4\u6613\u541e\u5410\u91cf\u3001\u5feb\u901f\u7684\u4ea4\u6613\u7d42\u7d50\u6027\u548c IBC \u7684\u6c34\u5e73\u53ef\u64f4\u5c55\u6027\u4f86\u7de9\u89e3\u4e0a\u8ff0\u554f\u984c\u3002</p>"},{"location":"evm/#_1","title":"\u5167\u5bb9","text":"<ol> <li>\u6982\u5ff5</li> <li>\u72c0\u614b</li> <li>\u72c0\u614b\u8f49\u63db</li> <li>\u4ea4\u6613</li> <li>ABCI</li> <li>\u9264\u5b50</li> <li>\u4e8b\u4ef6</li> <li>\u53c3\u6578</li> <li>\u5ba2\u6236\u7aef</li> </ol>"},{"location":"evm/#_2","title":"\u6a21\u584a\u67b6\u69cb","text":"<p>\u6ce8\u610f:: \u5982\u679c\u60a8\u4e0d\u719f\u6089 SDK \u6a21\u584a\u7684\u6574\u9ad4\u6a21\u584a\u7d50\u69cb\uff0c\u8acb\u5148\u95b1\u8b80\u6b64 \u6587\u6a94 \u4f5c\u70ba\u5148\u6c7a\u689d\u4ef6\u3002</p> <pre><code>evm/\n\u251c\u2500\u2500 client\n\u2502   \u2514\u2500\u2500 cli\n\u2502       \u251c\u2500\u2500 query.go      # \u6a21\u584a\u7684 CLI \u67e5\u8a62\u547d\u4ee4\n\u2502    \u00a0\u00a0 \u2514\u2500\u2500 tx.go         # \u6a21\u584a\u7684 CLI \u4ea4\u6613\u547d\u4ee4\n\u251c\u2500\u2500 keeper\n\u2502   \u251c\u2500\u2500 abci.go           # ABCI \u958b\u59cb\u51fa\u584a \u548c \u7d50\u675f\u51fa\u584a \u908f\u8f2f\n\u2502   \u251c\u2500\u2500 keeper.go         # \u8655\u7406\u6a21\u584a\u7684\u696d\u52d9\u908f\u8f2f\u3002\n\u2502   \u251c\u2500\u2500 params.go         # \u53c3\u6578\u7372\u53d6\u5668\u548c\u8a2d\u7f6e\u5668\n\u2502   \u251c\u2500\u2500 querier.go        # \u72c0\u614b\u67e5\u8a62\u51fd\u6578\n\u2502   \u2514\u2500\u2500 statedb.go        # \u4f86\u81ea types/statedb \u4e26\u50b3\u5165 sdk.Context \u7684\u51fd\u6578\n\u251c\u2500\u2500 types\n\u2502\u00a0\u00a0 \u251c\u2500\u2500 chain_config.go\n\u2502\u00a0\u00a0 \u251c\u2500\u2500 codec.go          # \u7de8\u78bc\u985e\u578b\u8a3b\u518a\n\u2502\u00a0\u00a0 \u251c\u2500\u2500 errors.go         # \u7279\u5b9a\u65bc\u6a21\u584a\u7684\u932f\u8aa4\n\u2502\u00a0\u00a0 \u251c\u2500\u2500 events.go         # \u66b4\u9732\u7d66 Tendermint PubSub/Websocket \u7684\u4e8b\u4ef6\n\u2502\u00a0\u00a0 \u251c\u2500\u2500 genesis.go        # \u6a21\u584a\u7684\u5275\u4e16\u72c0\u614b\n\u2502\u00a0\u00a0 \u251c\u2500\u2500 journal.go        # \u4ee5\u592a\u574a\u72c0\u614b\u8f49\u63db\u4ea4\u6613\n\u2502\u00a0\u00a0 \u251c\u2500\u2500 keys.go           # \u5b58\u5132\u5bc6\u9470\u548c\u5be6\u7528\u51fd\u6578\n\u2502\u00a0\u00a0 \u251c\u2500\u2500 logs.go           # \u93c8\u5347\u7d1a\u5f8c\u6301\u4e45\u5316 Ethereum tx \u767b\u9304\u72c0\u614b\u7684\u985e\u578b\n\u2502\u00a0\u00a0 \u251c\u2500\u2500 msg.go            #EVM \u6a21\u584a\u4ea4\u6613\u6d88\u606f\n\u2502\u00a0\u00a0 \u251c\u2500\u2500 params.go         # \u53ef\u4ee5\u4f7f\u7528\u6cbb\u7406\u53c3\u6578\u66f4\u6539\u5efa\u8b70\u81ea\u5b9a\u7fa9\u7684\u6a21\u584a\u53c3\u6578\n\u2502\u00a0\u00a0 \u251c\u2500\u2500 state_object.go   # EVM \u72c0\u614b\u5c0d\u8c61\n\u2502\u00a0\u00a0 \u251c\u2500\u2500 statedb.go        # StateDb\u63a5\u53e3\u7684\u5be6\u73fe\n\u2502\u00a0\u00a0 \u251c\u2500\u2500 storage.go        # \u4f7f\u7528\u6578\u7d44\u5be6\u73fe\u4ee5\u592a\u574a\u72c0\u614b\u5b58\u5132\u6620\u5c04\u4ee5\u9632\u6b62\u975e\u78ba\u5b9a\u6027\n\u2502\u00a0\u00a0 \u2514\u2500\u2500 tx_data.go        # \u4ee5\u592a\u574a\u4ea4\u6613\u6578\u64da\u985e\u578b\n\u251c\u2500\u2500 genesis.go            # ABCI InitGenesis \u548c ExportGenesis \u529f\u80fd\n\u251c\u2500\u2500 handler.go            # \u6d88\u606f\u8def\u7531\n\u2514\u2500\u2500 module.go             # \u6a21\u584a\u7ba1\u7406\u5668\u7684\u6a21\u584a\u8a2d\u7f6e\n</code></pre>"},{"location":"evm/#_3","title":"\u6982\u5ff5","text":""},{"location":"evm/#evm","title":"EVM","text":"<p>\u4ee5\u592a\u574a\u865b\u64ec\u6a5f (EVM) \u662f\u4e00\u7a2e\u8a08\u7b97\u5f15\u64ce\uff0c\u53ef\u4ee5\u5c07\u5176\u8996\u70ba\u7531\u6578\u5343\u53f0\u904b\u884c\u4ee5\u592a\u574a\u5ba2\u6236\u7aef\u7684\u9023\u63a5\u8a08\u7b97\u6a5f\uff08\u7bc0\u9ede\uff09\u7dad\u8b77\u7684\u55ae\u4e00\u5be6\u9ad4\u3002 \u4f5c\u70ba\u865b\u64ec\u6a5f (VM)\uff0cEVM \u8ca0\u8cac\u78ba\u5b9a\u6027\u5730\u8a08\u7b97\u72c0\u614b\u8b8a\u5316\uff0c\u800c\u4e0d\u7ba1\u5176\u74b0\u5883\uff08\u786c\u4ef6\u548c\u64cd\u4f5c\u7cfb\u7d71\uff09\u5982\u4f55\u3002 \u9019\u610f\u5473\u8457\u5728\u7d66\u5b9a\u76f8\u540c\u7684\u8d77\u59cb\u72c0\u614b\u548c\u4ea4\u6613 (tx) \u7684\u60c5\u6cc1\u4e0b\uff0c\u6bcf\u500b\u7bc0\u9ede\u90fd\u5fc5\u9808\u7372\u5f97\u5b8c\u5168\u76f8\u540c\u7684\u7d50\u679c\u3002</p> <p>EVM \u88ab\u8a8d\u70ba\u662f\u8655\u7406 \u667a\u80fd\u5408\u7d04 \u90e8\u7f72\u548c\u57f7\u884c\u7684\u4ee5\u592a\u574a\u5354\u8b70\u7684\u4e00\u90e8\u5206\u3002</p> <p>\u8981\u660e\u78ba\u5340\u5206\uff1a</p> <ul> <li>\u4ee5\u592a\u574a\u5354\u8b70\u63cf\u8ff0\u4e86\u4e00\u500b\u5340\u584a\u93c8\uff0c\u6240\u6709\u4ee5\u592a\u574a\u8cec\u6236\u548c\u667a\u80fd\u5408\u7d04\u90fd\u5b58\u5728\u65bc\u5176\u4e2d\u3002   \u5b83\u5728\u93c8\u4e2d\u7684\u4efb\u4f55\u7d66\u5b9a\u584a\u4e2d\u53ea\u6709\u4e00\u500b\u898f\u7bc4\u72c0\u614b\uff08\u4e00\u7a2e\u6578\u64da\u7d50\u69cb\uff0c\u7528\u65bc\u4fdd\u5b58\u6240\u6709\u5e33\u6236\uff09\u3002</li> <li>\u7136\u800c\uff0cEVM \u662f \u72c0\u614b\u6a5f\uff0c\u5b83\u5b9a\u7fa9\u4e86\u5f9e\u4e00\u500b\u584a\u5230\u53e6\u4e00\u500b\u584a\u8a08\u7b97\u65b0\u6709\u6548\u72c0\u614b\u7684\u898f\u5247\u3002   \u5b83\u662f\u4e00\u500b\u9694\u96e2\u7684\u904b\u884c\u6642\uff0c\u9019\u610f\u5473\u8457\u5728 EVM \u5167\u904b\u884c\u7684\u4ee3\u78bc\u7121\u6cd5\u8a2a\u554f\u7db2\u7d61\u3001\u6587\u4ef6\u7cfb\u7d71\u6216\u5176\u4ed6\u9032\u7a0b\uff08\u4e0d\u662f\u5916\u90e8 API\uff09\u3002</li> </ul> <p><code>x/evm</code> \u6a21\u584a\u5c07 EVM \u5be6\u73fe\u70ba Cosmos SDK \u6a21\u584a\u3002 \u5b83\u5141\u8a31\u7528\u6236\u901a\u904e\u63d0\u4ea4\u4ee5\u592a\u574a\u4ea4\u6613\u4e26\u5728\u7d66\u5b9a\u72c0\u614b\u4e0a\u57f7\u884c\u5305\u542b\u7684\u6d88\u606f\u4f86\u8207 EVM \u4ea4\u4e92\uff0c\u4ee5\u5f15\u767c\u72c0\u614b\u8f49\u63db\u3002</p>"},{"location":"evm/#_4","title":"\u72c0\u614b","text":"<p>\u4ee5\u592a\u574a\u72c0\u614b\u662f\u4e00\u7a2e\u6578\u64da\u7d50\u69cb\uff0c\u5be6\u73fe\u70ba Merkle Patricia Tree\uff0c\u5c07\u6240\u6709\u8cec\u6236\u4fdd\u5b58\u5728\u93c8\u4e0a\u3002 EVM \u5c0d\u8a72\u6578\u64da\u7d50\u69cb\u9032\u884c\u66f4\u6539\uff0c\u5f9e\u800c\u7522\u751f\u5177\u6709\u4e0d\u540c\u72c0\u614b\u6839\u7684\u65b0\u72c0\u614b\u3002 \u56e0\u6b64\uff0c\u4ee5\u592a\u574a\u53ef\u4ee5\u88ab\u8996\u70ba\u4e00\u689d\u72c0\u614b\u93c8\uff0c\u5b83\u901a\u904e\u4f7f\u7528 EVM \u5728\u5340\u584a\u4e2d\u57f7\u884c\u4ea4\u6613\u4f86\u5f9e\u4e00\u7a2e\u72c0\u614b\u8f49\u63db\u5230\u53e6\u4e00\u7a2e\u72c0\u614b\u3002 \u4e00\u500b\u65b0\u7684 txs \u584a\u53ef\u4ee5\u901a\u904e\u5b83\u7684\u584a\u982d\uff08\u7236\u54c8\u5e0c\u3001\u584a\u865f\u3001\u6642\u9593\u6233\u3001\u96a8\u6a5f\u6578\u3001\u6536\u64da\u2026\u2026\uff09\u4f86\u63cf\u8ff0\u3002</p>"},{"location":"evm/#_5","title":"\u8cec\u865f","text":"<p>\u6709\u5169\u7a2e\u985e\u578b\u7684\u5e33\u6236\u53ef\u4ee5\u5b58\u5132\u5728\u7d66\u5b9a\u5730\u5740\u7684\u72c0\u614b\u4e2d\uff1a</p> <ul> <li>\u5916\u90e8\u64c1\u6709\u8cec\u6236 (EOA)\uff1a\u5177\u6709\u96a8\u6a5f\u6578\uff08tx \u8a08\u6578\u5668\uff09\u548c\u4f59\u984d</li> <li>\u667a\u80fd\u5408\u7d04\uff1a\u5177\u6709\u96a8\u6a5f\u6578\u3001\u9918\u984d\u3001\uff08\u4e0d\u53ef\u8b8a\uff09\u4ee3\u78bc\u54c8\u5e0c\u3001\u5b58\u5132\u6839\uff08\u53e6\u4e00\u500b Merkle Patricia Trie\uff09</li> </ul> <p>\u667a\u80fd\u5408\u7d04\u5c31\u50cf\u5340\u584a\u93c8\u4e0a\u7684\u5e38\u898f\u8cec\u6236\u4e00\u6a23\uff0c\u5b83\u9084\u4ee5\u4ee5\u592a\u574a\u7279\u5b9a\u7684\u4e8c\u9032\u5236\u683c\u5f0f\u5b58\u5132\u53ef\u57f7\u884c\u4ee3\u78bc\uff0c\u7a31\u70ba EVM \u5b57\u7bc0\u78bc\u3002 \u5b83\u5011\u901a\u5e38\u662f\u7528\u4ee5\u592a\u574a\u9ad8\u7d1a\u8a9e\u8a00\u7de8\u5beb\u7684\uff0c\u4f8b\u5982 Solidity\uff0c\u5b83\u88ab\u7de8\u8b6f\u6210 EVM \u5b57\u7bc0\u78bc\u4e26\u901a\u904e\u4f7f\u7528\u4ee5\u592a\u574a\u5ba2\u6236\u7aef\u63d0\u4ea4\u4ea4\u6613\u90e8\u7f72\u5728\u5340\u584a\u93c8\u4e0a\u3002</p>"},{"location":"evm/#_6","title":"\u7d50\u69cb","text":"<p>EVM \u4f5c\u70ba\u57fa\u65bc\u5806\u68e7\u7684\u6a5f\u5668\u904b\u884c\u3002 \u5b83\u7684\u4e3b\u8981\u67b6\u69cb\u7d44\u4ef6\u5305\u62ec\uff1a</p> <ul> <li>Virtual ROM\uff1a\u5408\u7d04\u4ee3\u78bc\u5728\u8655\u7406txs\u6642\u88ab\u62c9\u5165\u9019\u500b\u53ea\u8b80\u5167\u5b58</li> <li>\u6a5f\u5668\u72c0\u614b\uff08\u6613\u5931\u6027\uff09\uff1a\u96a8\u8457 EVM \u904b\u884c\u800c\u8b8a\u5316\uff0c\u4e26\u5728\u8655\u7406\u6bcf\u500b tx \u5f8c\u88ab\u6e05\u9664<ul> <li>\u7a0b\u5e8f\u8a08\u6578\u5668\uff08PC\uff09</li> <li>Gas\u200b\u200b\uff1a\u8ddf\u8e2a\u4f7f\u7528\u4e86\u591a\u5c11 gas   *\u5806\u68e7\u548c\u5167\u5b58\uff1a\u8a08\u7b97\u72c0\u614b\u8b8a\u5316</li> </ul> </li> <li>\u8a2a\u554f\u5e33\u6236\u5b58\u5132\uff08\u6301\u4e45\uff09</li> </ul>"},{"location":"evm/#_7","title":"\u667a\u80fd\u5408\u7d04\u7684\u72c0\u614b\u8f49\u63db","text":"<p>\u901a\u5e38\uff0c\u667a\u80fd\u5408\u7d04\u6703\u516c\u958b\u4e00\u500b\u516c\u5171 ABI\uff0c\u9019\u662f\u4e00\u500b\u7528\u6236\u53ef\u4ee5\u8207\u5408\u7d04\u4ea4\u4e92\u7684\u53d7\u652f\u6301\u65b9\u5f0f\u7684\u5217\u8868\u3002 \u8981\u8207\u5408\u7d04\u4ea4\u4e92\u4e26\u8abf\u7528\u72c0\u614b\u8f49\u63db\uff0c\u7528\u6236\u5c07\u63d0\u4ea4\u4e00\u500b\u651c\u5e36\u4efb\u610f\u6578\u91cf\u6c23\u9ad4\u7684\u4ea4\u6613\u548c\u6839\u64da ABI \u683c\u5f0f\u5316\u7684\u6578\u64da\u6709\u6548\u8ca0\u8f09\uff0c\u6307\u5b9a\u4ea4\u4e92\u985e\u578b\u548c\u4efb\u4f55\u5176\u4ed6\u53c3\u6578\u3002 \u7576\u6536\u5230 tx \u6642\uff0cEVM \u4f7f\u7528 tx \u8ca0\u8f09\u57f7\u884c\u667a\u80fd\u5408\u7d04\u7684 EVM \u5b57\u7bc0\u78bc\u3002</p>"},{"location":"evm/#evm_1","title":"\u57f7\u884c EVM \u5b57\u7bc0\u78bc","text":"<p>\u5408\u7d04\u7684 EVM \u5b57\u7bc0\u78bc\u7531\u57fa\u672c\u64cd\u4f5c\uff08\u52a0\u6cd5\u3001\u4e58\u6cd5\u3001\u5b58\u5132\u7b49\uff09\u7d44\u6210\uff0c\u7a31\u70ba\u64cd\u4f5c\u78bc\u3002 \u6bcf\u500b Opcode \u57f7\u884c\u90fd\u9700\u8981\u7528 tx \u652f\u4ed8\u7684 gas\u3002 \u56e0\u6b64\uff0cEVM \u88ab\u8a8d\u70ba\u662f\u6e96\u5716\u9748\u5b8c\u5099\u7684\uff0c\u56e0\u70ba\u5b83\u5141\u8a31\u4efb\u610f\u8a08\u7b97\uff0c\u4f46\u5408\u7d04\u57f7\u884c\u671f\u9593\u7684\u8a08\u7b97\u91cf\u50c5\u9650\u65bc tx \u4e2d\u63d0\u4f9b\u7684\u6c23\u9ad4\u91cf\u3002</p> <p>\u6bcf\u500b\u64cd\u4f5c\u78bc\u7684 gas \u6210\u672c \u53cd\u6620\u4e86\u5728\u5be6\u969b\u8a08\u7b97\u6a5f\u786c\u4ef6\u4e0a\u904b\u884c\u9019\u4e9b\u64cd\u4f5c\u7684\u6210\u672c\uff08\u4f8b\u5982\uff0c<code>ADD = 3gas</code> \u548c <code>SSTORE = 100gas</code>\uff09\u3002 \u8981\u8a08\u7b97\u4ea4\u6613\u7684 gas \u6d88\u8017\u91cf\uff0c\u8acb\u5c07 gas \u6210\u672c\u4e58\u4ee5 gas price\uff0c\u9019\u53ef\u80fd\u6703\u6839\u64da\u7576\u6642\u7db2\u7d61\u7684\u9700\u6c42\u800c\u8b8a\u5316\u3002 \u5982\u679c\u7db2\u7d61\u8ca0\u8f09\u5f88\u91cd\uff0c\u60a8\u53ef\u80fd\u9700\u8981\u652f\u4ed8\u66f4\u9ad8\u7684 gas \u50f9\u683c\u624d\u80fd\u57f7\u884c\u60a8\u7684\u4ea4\u6613\u3002 \u5982\u679c\u9054\u5230\u6c23\u9ad4\u9650\u5236\uff08\u6c23\u9ad4\u7570\u5e38\uff09\uff0c\u5247\u4e0d\u6703\u5c0d\u4ee5\u592a\u574a\u72c0\u614b\u9032\u884c\u4efb\u4f55\u66f4\u6539\uff0c\u9664\u975e\u767c\u9001\u8005\u7684\u96a8\u6a5f\u6578\u589e\u52a0\u4e26\u4e14\u4ed6\u5011\u7684\u9918\u984d\u4e0b\u964d\u4ee5\u652f\u4ed8\u6d6a\u8cbb EVM \u6642\u9593\u7684\u8cbb\u7528\u3002</p> <p>\u667a\u80fd\u5408\u7d04\u4e5f\u53ef\u4ee5\u8abf\u7528\u5176\u4ed6\u667a\u80fd\u5408\u7d04\u3002 \u6bcf\u6b21\u8abf\u7528\u65b0\u5408\u7d04\u90fd\u6703\u5275\u5efa\u4e00\u500b\u65b0\u7684 EVM \u5be6\u4f8b\uff08\u5305\u62ec\u65b0\u7684\u5806\u68e7\u548c\u5167\u5b58\uff09\u3002 \u6bcf\u6b21\u8abf\u7528\u90fd\u6703\u5c07\u6c99\u7bb1\u72c0\u614b\u50b3\u905e\u7d66\u4e0b\u4e00\u500b EVM\u3002 \u5982\u679c\u6c23\u9ad4\u7528\u5b8c\uff0c\u6240\u6709\u72c0\u614b\u8b8a\u5316\u90fd\u5c07\u88ab\u4e1f\u68c4\u3002 \u5426\u5247\uff0c\u5b83\u5011\u5c07\u88ab\u4fdd\u7559\u3002</p> <p>\u5982\u9700\u9032\u4e00\u6b65\u95b1\u8b80\uff0c\u8acb\u53c3\u95b1\uff1a</p> <ul> <li>EVM</li> <li>EVM Architecture</li> <li>What is Ethereum</li> <li>Opcodes</li> </ul>"},{"location":"evm/#daodst-geth","title":"Daodst \u4f5c\u70ba Geth \u5be6\u73fe","text":"<p>Daodst \u5305\u542b Golang \u4e2d\u7684\u4ee5\u592a\u574a\u5354\u8b70 (Geth) \u4f5c\u70ba Cosmos SDK \u6a21\u584a\u7684\u5be6\u73fe\u3002 Geth \u5305\u542b\u4e00\u500b EVM \u7684\u5be6\u73fe\u4f86\u8a08\u7b97\u72c0\u614b\u8f49\u63db\u3002 \u67e5\u770b go-ethereum \u6e90\u4ee3\u78bc \u4e86\u89e3 EVM \u64cd\u4f5c\u78bc\u662f\u5982\u4f55\u5be6\u73fe\u7684\u3002 \u6b63\u5982 Geth \u53ef\u4ee5\u4f5c\u70ba\u4ee5\u592a\u574a\u7bc0\u9ede\u904b\u884c\u4e00\u6a23\uff0cDaodst \u4e5f\u53ef\u4ee5\u4f5c\u70ba\u7bc0\u9ede\u904b\u884c\u4ee5\u8a08\u7b97 EVM \u7684\u72c0\u614b\u8f49\u63db\u3002</p>"},{"location":"evm/#json-rpc","title":"JSON-RPC","text":"<p>JSON-RPC \u662f\u4e00\u7a2e\u7121\u72c0\u614b\u3001\u8f15\u91cf\u7d1a\u7684\u9060\u7a0b\u904e\u7a0b\u8abf\u7528 (RPC) \u5354\u8b70\u3002 \u8a72\u898f\u7bc4\u4e3b\u8981\u5b9a\u7fa9\u4e86\u5e7e\u7a2e\u6578\u64da\u7d50\u69cb\u53ca\u5176\u8655\u7406\u898f\u5247\u3002 \u5b83\u8207\u50b3\u8f38\u7121\u95dc\uff0c\u56e0\u70ba\u9019\u4e9b\u6982\u5ff5\u53ef\u4ee5\u5728\u540c\u4e00\u9032\u7a0b\u4e2d\u3001\u901a\u904e\u5957\u63a5\u5b57\u3001\u901a\u904e HTTP \u6216\u5728\u8a31\u591a\u4e0d\u540c\u7684\u6d88\u606f\u50b3\u905e\u74b0\u5883\u4e2d\u4f7f\u7528\u3002 \u5b83\u4f7f\u7528 JSON (RFC 4627) \u4f5c\u70ba\u6578\u64da\u683c\u5f0f\u3002</p> <p> JSON-RPC \u7bc4\u4f8b: <code>eth_call</code> </p> <p>JSON-RPC \u65b9\u6cd5\u5141\u8a31\u60a8\u6839\u64da\u5408\u7d04\u57f7\u884c\u6d88\u606f\u3002 \u901a\u5e38\uff0c\u60a8\u9700\u8981\u5c07\u4ea4\u6613\u767c\u9001\u5230 Geth \u7bc0\u9ede\u4ee5\u5c07\u5176\u5305\u542b\u5728\u5167\u5b58\u6c60\u4e2d\uff0c\u7136\u5f8c\u7bc0\u9ede\u4e4b\u9593\u76f8\u4e92\u50b3\u64ad\uff0c\u6700\u7d42\u4ea4\u6613\u88ab\u5305\u542b\u5728\u4e00\u500b\u584a\u4e2d\u4e26\u88ab\u57f7\u884c\u3002 \u7136\u800c\uff0c<code>eth_call</code> \u5141\u8a31\u60a8\u5c07\u6578\u64da\u767c\u9001\u5230\u5408\u7d04\uff0c\u4e26\u5728\u4e0d\u63d0\u4ea4\u4ea4\u6613\u7684\u60c5\u6cc1\u4e0b\u67e5\u770b\u6703\u767c\u751f\u4ec0\u9ebc\u3002</p> <p>\u5728Geth\u5be6\u73fe\u4e2d\uff0c\u8abf\u7528\u7aef\u9ede\u5927\u81f4\u7d93\u904e\u4ee5\u4e0b\u6b65\u9a5f\uff1a</p> <ol> <li><code>eth_call</code> \u8acb\u6c42\u8f49\u63db\u70ba\u4f7f\u7528 <code>eth</code> \u547d\u540d\u7a7a\u9593\u8abf\u7528 <code>func (s *PublicBlockchainAPI) Call()</code> \u51fd\u6578</li> <li><code>Call()</code> \u88ab\u8ce6\u4e88\u4ea4\u6613\u53c3\u6578\u3001\u8981\u8abf\u7528\u7684\u584a\u548c\u53ef\u9078\u53c3\u6578\uff0c\u7528\u65bc\u4fee\u6539\u8981\u8abf\u7528\u7684\u72c0\u614b\u3002    \u7136\u5f8c\u5b83\u8abf\u7528 <code>DoCall()</code>\u3002</li> <li><code>DoCall()</code>    \u5c07\u53c3\u6578\u8f49\u63db\u70ba<code>ethtypes.message</code>\uff0c\u5be6\u4f8b\u5316 EVM \u4e26\u4f7f\u7528<code>core.ApplyMessage</code>\u61c9\u7528\u6d88\u606f</li> <li><code>ApplyMessage()</code>    \u8abf\u7528\u72c0\u614b\u8f49\u63db<code>TransitionDb()</code></li> <li><code>TransitionDb()</code> <code>Create()</code> \u662f\u4e00\u500b\u65b0\u5408\u7d04\u6216\u8005 <code>Call()</code> \u662f\u4e00\u500b\u5408\u7d04</li> <li><code>evm.Call()</code>    \u904b\u884c\u89e3\u91cb\u5668 evm.interpreter.Run() \u4f86\u57f7\u884c\u6d88\u606f\u3002    \u5982\u679c\u57f7\u884c\u5931\u6557\uff0c\u72c0\u614b\u5c07\u6062\u5fa9\u70ba\u57f7\u884c\u524d\u62cd\u651d\u7684\u5feb\u7167\u4e26\u6d88\u8017 gas\u3002</li> <li><code>Run()</code>    \u57f7\u884c\u5faa\u74b0\u4ee5\u57f7\u884c\u64cd\u4f5c\u78bc\u3002</li> </ol>"},{"location":"evm/#db","title":"\u72c0\u614bDB","text":"<p>\u4f86\u81ea go-ethereum \u7684 <code>StateDB</code> \u63a5\u53e3\u8868\u793a\u7528\u65bc\u5b8c\u6574\u72c0\u614b\u67e5\u8a62\u7684 EVM \u6578\u64da\u5eab\u3002 EVM \u72c0\u614b\u8f49\u63db\u7531\u8a72\u63a5\u53e3\u555f\u7528\uff0c\u5728 <code>x/evm</code> \u6a21\u584a\u4e2d\u7531 <code>Keeper</code> \u5be6\u73fe\u3002 \u8a72\u63a5\u53e3\u7684\u5be6\u73fe\u4f7f Daodst EVM \u517c\u5bb9\u3002</p>"},{"location":"evm/#_8","title":"\u5171\u8b58\u5f15\u64ce","text":"<p>\u4f7f\u7528 <code>x/evm</code> \u6a21\u584a\u7684\u61c9\u7528\u7a0b\u5e8f\u901a\u904e\u61c9\u7528\u7a0b\u5e8f\u5340\u584a\u93c8\u63a5\u53e3 (ABCI) \u8207 Tendermint \u6838\u5fc3\u5171\u8b58\u5f15\u64ce\u4ea4\u4e92\u3002 \u8a72\u61c9\u7528\u7a0b\u5e8f\u548c Tendermint Core \u5171\u540c\u69cb\u6210\u4e86\u904b\u884c\u5b8c\u6574\u5340\u584a\u93c8\u4e26\u5c07\u696d\u52d9\u908f\u8f2f\u8207\u53bb\u4e2d\u5fc3\u5316\u6578\u64da\u5b58\u5132\u76f8\u7d50\u5408\u7684\u7a0b\u5e8f\u3002</p> <p>\u63d0\u4ea4\u7d66 <code>x/evm</code> \u6a21\u584a\u7684\u4ee5\u592a\u574a\u4e8b\u52d9\u5728\u57f7\u884c\u548c\u66f4\u6539\u61c9\u7528\u7a0b\u5e8f\u72c0\u614b\u4e4b\u524d\u53c3\u8207\u6b64\u5171\u8b58\u904e\u7a0b\u3002 \u6211\u5011\u9f13\u52f5\u4e86\u89e3 Tendermint \u5171\u8b58\u5f15\u64ce \u7684\u57fa\u790e\u77e5\u8b58\uff0c\u4ee5\u4fbf\u8a73\u7d30\u4e86\u89e3\u72c0\u614b\u8f49\u63db.</p>"},{"location":"evm/#_9","title":"\u4ea4\u6613\u8a18\u9304","text":"<p>\u5728\u6bcf\u500b<code>x/evm</code>\u4ea4\u6613\u4e2d\uff0c\u7d50\u679c\u5305\u542b\u4f86\u81ea\u72c0\u614b\u6a5f\u57f7\u884c\u7684\u4ee5\u592a\u574a<code>\u65e5\u8a8c</code>\uff0cJSON-RPC Web3 \u670d\u52d9\u5668\u4f7f\u7528\u9019\u4e9b\u65e5\u8a8c\u9032\u884c\u904e\u6ffe\u5668\u67e5\u8a62\u548c\u8655\u7406 EVM \u639b\u9264\u3002</p> <p>tx \u65e5\u8a8c\u5728 tx \u57f7\u884c\u671f\u9593\u5b58\u5132\u5728\u81e8\u6642\u5b58\u5132\u4e2d\uff0c\u7136\u5f8c\u5728\u4e8b\u52d9\u8655\u7406\u5f8c\u901a\u904e cosmos events \u767c\u51fa\u3002 \u53ef\u4ee5\u901a\u904e gRPC \u548c JSON-RPC \u67e5\u8a62\u5b83\u5011\u3002</p>"},{"location":"evm/#block-bloom","title":"Block Bloom","text":"<p>\u5e03\u9686\u662f\u53ef\u7528\u65bc\u904e\u6ffe\u5668\u67e5\u8a62\u7684\u6bcf\u500b\u584a\u7684\u5e03\u9686\u904e\u6ffe\u5668\u503c\uff08\u4ee5\u5b57\u7bc0\u70ba\u55ae\u4f4d\uff09\u3002 \u584a bloom \u503c\u5b58\u5132\u5728\u77ac\u614b\u5b58\u5132\u4e2d\uff0c\u7136\u5f8c\u5728 EndBlock \u8655\u7406\u671f\u9593\u901a\u904e cosmos \u4e8b\u4ef6\u767c\u51fa\u3002 \u53ef\u4ee5\u901a\u904e gRPC \u548c JSON-RPC \u67e5\u8a62\u5b83\u5011\u3002</p> <p>:::\u63d0\u793a</p> <p>\ud83d\udc49 \u6ce8\u610f: \u7531\u65bc\u5b83\u5011\u4e0d\u5b58\u5132\u5728\u72c0\u614b\u4e2d\uff0c\u4e8b\u52d9\u65e5\u8a8c\u548c\u584a\u7dbb\u653e\u5728\u5347\u7d1a\u5f8c\u4e0d\u6703\u6301\u4e45\u5316\u3002 \u7528\u6236\u5fc5\u9808\u5728\u5347\u7d1a\u5f8c\u4f7f\u7528\u5b58\u6a94\u7bc0\u9ede\u624d\u80fd\u7372\u5f97\u907a\u7559\u93c8\u4e8b\u4ef6\u3002 :::</p>"},{"location":"evm/#_10","title":"\u72c0\u614b","text":"<p>\u672c\u7bc0\u6982\u8ff0\u5b58\u5132\u5728 <code>x/evm</code> \u6a21\u584a\u72c0\u614b\u4e2d\u7684\u5c0d\u8c61\uff0c\u6e90\u81ea go-ethereum <code>StateDB</code> \u63a5\u53e3\u7684\u529f\u80fd\uff0c\u53ca\u5176\u901a\u904e Keeper \u7684\u5be6\u73fe\u4ee5\u53ca\u5275\u4e16\u6642\u7684\u72c0\u614b\u5be6\u73fe\u3002</p>"},{"location":"evm/#_11","title":"\u72c0\u614b\u5c0d\u8c61","text":"<p><code>x/evm</code> \u6a21\u584a\u4fdd\u6301\u4ee5\u4e0b\u72c0\u614b\u7684\u5c0d\u8c61\uff1a</p>"},{"location":"evm/#_12","title":"\u72c0\u614b","text":"\u8aaa\u660e Key Value Store Code \u667a\u80fd\u5408\u7d04\u5b57\u7bc0\u78bc <code>[]byte{1} + []byte(address)</code> <code>[]byte{code}</code> KV Storage \u667a\u80fd\u5408\u7d04\u5b58\u5132 <code>[]byte{2} + [32]byte{key}</code> <code>[32]byte(value)</code> KV Block Bloom Block bloom filter\uff0c\u7528\u65bc\u7d2f\u52a0\u7576\u524d\u584a\u7684bloom filter\uff0c\u767c\u9001\u5230end blocker\u7684\u4e8b\u4ef6. <code>[]byte{1} + []byte(tx.Hash)</code> <code>protobuf([]Log)</code> Transient Tx Index \u7576\u524d\u5340\u584a\u4e2d\u7576\u524d\u4ea4\u6613\u7684\u7d22\u5f15\u3002 <code>[]byte{2}</code> <code>BigEndian(uint64)</code> Transient Log Size \u5230\u76ee\u524d\u70ba\u6b62\u5728\u7576\u524d\u584a\u4e2d\u767c\u51fa\u7684\u65e5\u8a8c\u6578\u3002\u7528\u65bc\u6c7a\u5b9a\u5f8c\u7e8c\u65e5\u8a8c\u7684\u65e5\u8a8c\u7d22\u5f15. <code>[]byte{3}</code> <code>BigEndian(uint64)</code> Transient Gas Used \u7576\u524dcosmos-sdk tx\u7684ethereum\u6d88\u606f\u4f7f\u7528\u7684gas\u91cf\uff0c\u7576cosmos-sdk tx\u5305\u542b\u591a\u689dethereum\u6d88\u606f\u6642\u9700\u8981\u3002 <code>[]byte{4}</code> <code>BigEndian(uint64)</code> Transient"},{"location":"evm/#db_1","title":"\u72c0\u614bDB","text":"<p><code>StateDB</code> \u63a5\u53e3\u7531 <code>x/evm/statedb</code> \u6a21\u584a\u4e2d\u7684 <code>StateDB</code> \u5be6\u73fe\uff0c\u4ee3\u8868\u4e00\u500b EVM \u6578\u64da\u5eab\uff0c\u7528\u65bc\u5408\u7d04\u548c\u8cec\u6236\u7684\u5b8c\u6574\u72c0\u614b\u67e5\u8a62\u3002 \u5728\u4ee5\u592a\u574a\u5354\u8b70\u4e2d\uff0c<code>StateDB</code> \u7528\u65bc\u5b58\u5132 IAVL \u6a39\u4e2d\u7684\u4efb\u4f55\u5167\u5bb9\uff0c\u4e26\u8ca0\u8cac\u7de9\u5b58\u548c\u5b58\u5132\u5d4c\u5957\u72c0\u614b\u3002</p> <pre><code>// github.com/ethereum/go-ethereum/core/vm/interface.go\ntype StateDB interface {\n CreateAccount(common.Address)\n\n SubBalance(common.Address, *big.Int)\n AddBalance(common.Address, *big.Int)\n GetBalance(common.Address) *big.Int\n\n GetNonce(common.Address) uint64\n SetNonce(common.Address, uint64)\n\n GetCodeHash(common.Address) common.Hash\n GetCode(common.Address) []byte\n SetCode(common.Address, []byte)\n GetCodeSize(common.Address) int\n\n AddRefund(uint64)\n SubRefund(uint64)\n GetRefund() uint64\n\n GetCommittedState(common.Address, common.Hash) common.Hash\n GetState(common.Address, common.Hash) common.Hash\n SetState(common.Address, common.Hash, common.Hash)\n\n Suicide(common.Address) bool\n HasSuicided(common.Address) bool\n\n // Exist reports whether the given account exists in state.\n // Notably this should also return true for suicided accounts.\n Exist(common.Address) bool\n // Empty returns whether the given account is empty. Empty\n // is defined according to EIP161 (balance = nonce = code = 0).\n Empty(common.Address) bool\n\n PrepareAccessList(sender common.Address, dest *common.Address, precompiles []common.Address, txAccesses types.AccessList)\n AddressInAccessList(addr common.Address) bool\n SlotInAccessList(addr common.Address, slot common.Hash) (addressOk bool, slotOk bool)\n // AddAddressToAccessList adds the given address to the access list. This operation is safe to perform\n // even if the feature/fork is not active yet\n AddAddressToAccessList(addr common.Address)\n // AddSlotToAccessList adds the given (address,slot) to the access list. This operation is safe to perform\n // even if the feature/fork is not active yet\n AddSlotToAccessList(addr common.Address, slot common.Hash)\n\n RevertToSnapshot(int)\n Snapshot() int\n\n AddLog(*types.Log)\n AddPreimage(common.Hash, []byte)\n\n ForEachStorage(common.Address, func(common.Hash, common.Hash) bool) error\n}\n</code></pre> <p>The <code>StateDB</code> in the <code>x/evm</code> provides the following functionalities:</p>"},{"location":"evm/#crud","title":"\u4ee5\u592a\u574a\u8cec\u6236\u7684 CRUD","text":"<p>\u60a8\u53ef\u4ee5\u5f9e\u63d0\u4f9b\u7684\u5730\u5740\u5275\u5efa <code>EthAccount</code> \u5be6\u4f8b\uff0c\u4e26\u4f7f\u7528 <code>createAccount()</code> \u5c07\u503c\u8a2d\u7f6e\u70ba\u5b58\u5132\u5728 <code>AccountKeeper</code> \u4e0a\u3002 \u5982\u679c\u5177\u6709\u7d66\u5b9a\u5730\u5740\u7684\u5e33\u6236\u5df2\u7d93\u5b58\u5728\uff0c\u6b64\u51fd\u6578\u9084\u6703\u91cd\u7f6e\u8207\u8a72\u5730\u5740\u95dc\u806f\u7684\u4efb\u4f55\u9810\u5148\u5b58\u5728\u7684\u4ee3\u78bc\u548c\u5b58\u5132\u3002</p> <p>\u4e00\u500b\u8cec\u6236\u7684\u8ca8\u5e63\u9918\u984d\u53ef\u4ee5\u901a\u904e <code>BankKeeper</code> \u9032\u884c\u7ba1\u7406\uff0c\u53ef\u4ee5\u4f7f\u7528 <code>GetBalance()</code> \u8b80\u53d6\u4e26\u4f7f\u7528 <code>AddBalance()</code> \u548c <code>SubBalance()</code> \u9032\u884c\u66f4\u65b0\u3002</p> <ul> <li><code>GetBalance()</code> \u8fd4\u56de\u6240\u63d0\u4f9b\u5730\u5740\u7684 EVM \u8ca8\u5e63\u9918\u984d\u3002   \u8ca8\u5e63\u540d\u7a31\u662f\u5f9e\u6a21\u584a\u53c3\u6578\u4e2d\u7372\u53d6\u7684\u3002</li> <li><code>AddBalance()</code> \u901a\u904e\u9444\u9020\u65b0\u8ca8\u5e63\u4e26\u5c07\u5176\u8f49\u79fb\u5230\u5730\u5740\u4f86\u5c07\u7d66\u5b9a\u91d1\u984d\u6dfb\u52a0\u5230\u5730\u5740\u8ca8\u5e63\u9918\u984d\u4e2d\u3002   \u8ca8\u5e63\u540d\u7a31\u662f\u5f9e\u6a21\u584a\u53c3\u6578\u4e2d\u7372\u53d6\u7684\u3002</li> <li><code>SubBalance()</code> \u901a\u904e\u5c07\u8ca8\u5e63\u8f49\u79fb\u5230\u8a17\u7ba1\u8cec\u6236\u7136\u5f8c\u92b7\u6bc0\u5b83\u5011\u4f86\u5f9e\u5730\u5740\u9918\u984d\u4e2d\u6e1b\u53bb\u7d66\u5b9a\u7684\u91d1\u984d\u3002   \u8ca8\u5e63\u540d\u7a31\u662f\u5f9e\u6a21\u584a\u53c3\u6578\u4e2d\u7372\u53d6\u7684\u3002   \u5982\u679c\u91d1\u984d\u70ba\u8ca0\u6216\u7528\u6236\u6c92\u6709\u8db3\u5920\u7684\u8cc7\u91d1\u9032\u884c\u8f49\u8cec\uff0c\u6b64\u51fd\u6578\u5c07\u57f7\u884c\u7a7a\u64cd\u4f5c\u3002</li> </ul> <p>\u96a8\u6a5f\u6578\uff08\u6216\u4ea4\u6613\u5e8f\u5217\uff09\u53ef\u4ee5\u901a\u904e\u8eab\u4efd\u9a57\u8b49\u6a21\u584a<code>AccountKeeper</code>\u5f9e\u8cec\u6236 <code>Sequence</code> \u4e2d\u7372\u53d6\u3002</p> <ul> <li><code>GetNonce()</code> \u6aa2\u7d22\u5177\u6709\u7d66\u5b9a\u5730\u5740\u7684\u5e33\u6236\u4e26\u8fd4\u56de tx \u5e8f\u5217\uff08\u5373\u96a8\u6a5f\u6578\uff09\u3002   \u5982\u679c\u627e\u4e0d\u5230\u8a72\u5e33\u6236\uff0c\u8a72\u51fd\u6578\u5c07\u57f7\u884c\u7a7a\u64cd\u4f5c\u3002</li> <li><code>SetNonce()</code> \u5c07\u7d66\u5b9a\u7684\u96a8\u6a5f\u6578\u8a2d\u7f6e\u70ba\u5730\u5740\u5e33\u6236\u7684\u5e8f\u5217\u3002   \u5982\u679c\u8a72\u5e33\u6236\u4e0d\u5b58\u5728\uff0c\u5c07\u5f9e\u8a72\u5730\u5740\u5275\u5efa\u4e00\u500b\u65b0\u5e33\u6236\u3002</li> </ul> <p>\u5305\u542b\u4efb\u610f\u5408\u7d04\u908f\u8f2f\u7684\u667a\u80fd\u5408\u7d04\u5b57\u7bc0\u78bc\u5b58\u5132\u5728 <code>EVMKeeper</code> \u4e0a\uff0c\u53ef\u4ee5\u4f7f\u7528 <code>GetCodeHash()</code> , <code>GetCode()</code> \u548c <code>GetCodeSize()</code> \u67e5\u8a62\uff0c\u4e26\u4f7f\u7528 <code>SetCode()</code> \u66f4\u65b0\u3002</p> <ul> <li><code>GetCodeHash()</code> \u5f9e\u5b58\u5132\u4e2d\u7372\u53d6\u5e33\u6236\u4e26\u8fd4\u56de\u5176\u4ee3\u78bc\u54c8\u5e0c\u3002   \u5982\u679c\u8cec\u6236\u4e0d\u5b58\u5728\u6216\u4e0d\u662f EthAccount \u985e\u578b\uff0c\u5247\u8fd4\u56de\u7a7a\u4ee3\u78bc\u54c8\u5e0c\u503c\u3002</li> <li><code>GetCode()</code> \u8fd4\u56de\u8207\u7d66\u5b9a\u5730\u5740\u95dc\u806f\u7684\u4ee3\u78bc\u5b57\u7bc0\u6578\u7d44\u3002   \u5982\u679c\u4f86\u81ea\u5e33\u6236\u7684\u4ee3\u78bc\u54c8\u5e0c\u70ba\u7a7a\uff0c\u5247\u6b64\u51fd\u6578\u8fd4\u56de nil\u3002</li> <li><code>SetCode()</code> \u5c07\u4ee3\u78bc\u5b57\u7bc0\u6578\u7d44\u5b58\u5132\u5230\u61c9\u7528\u7a0b\u5e8f KVStore\uff0c\u4e26\u5c07\u4ee3\u78bc\u54c8\u5e0c\u8a2d\u7f6e\u5230\u7d66\u5b9a\u7684\u5e33\u6236\u3002   \u5982\u679c\u4ee3\u78bc\u70ba\u7a7a\uff0c\u5247\u5c07\u5f9e\u5b58\u5132\u4e2d\u522a\u9664\u8a72\u4ee3\u78bc\u3002</li> <li><code>GetCodeSize()</code> \u8fd4\u56de\u8207\u6b64\u5c0d\u8c61\u95dc\u806f\u7684\u5408\u7d04\u4ee3\u78bc\u7684\u5927\u5c0f\uff0c\u5982\u679c\u6c92\u6709\u5247\u8fd4\u56de\u96f6\u3002</li> </ul> <p>\u9700\u8981\u8ddf\u8e2a\u9000\u9084\u7684\u6c23\u9ad4\u4e26\u5c07\u5176\u5b58\u5132\u5728\u55ae\u7368\u7684\u8b8a\u91cf\u4e2d\uff0c\u4ee5\u4fbf\u5728 EVM \u57f7\u884c\u5b8c\u6210\u5f8c\u5c07\u5176\u5f9e\u6c23\u9ad4\u4f7f\u7528\u503c\u4e2d\u6e1b\u53bb/\u6dfb\u52a0\u5230\u6c23\u9ad4\u4f7f\u7528\u503c\u4e2d\u3002\u9000\u6b3e\u503c\u5728\u6bcf\u7b46\u4ea4\u6613\u548c\u6bcf\u500b\u5340\u584a\u7d50\u675f\u6642\u88ab\u6e05\u9664\u3002</p> <ul> <li><code>AddRefund()</code> \u5c07\u7d66\u5b9a\u7684\u6c23\u9ad4\u91cf\u6dfb\u52a0\u5230\u5167\u5b58\u4e2d\u7684\u9000\u6b3e\u503c\u3002</li> <li><code>SubRefund()</code> \u5f9e\u5167\u5b58\u4e2d\u7684\u9000\u6b3e\u503c\u4e2d\u6e1b\u53bb\u7d66\u5b9a\u7684\u6c23\u9ad4\u91cf\u3002   \u5982\u679c gas \u91cf\u5927\u65bc\u7576\u524d\u9000\u6b3e\uff0c\u6b64\u51fd\u6578\u5c07 panic\u3002</li> <li><code>GetRefund()</code> \u8fd4\u56de tx \u57f7\u884c\u5b8c\u6210\u5f8c\u53ef\u7528\u65bc\u8fd4\u56de\u7684\u6c23\u9ad4\u91cf\u3002   \u8a72\u503c\u5728\u6bcf\u6b21\u4ea4\u6613\u6642\u91cd\u7f6e\u70ba 0\u3002</li> </ul> <p>\u72c0\u614b\u5b58\u5132\u5728<code>EVMKeeper</code>\u4e0a\u3002 \u53ef\u4ee5\u4f7f\u7528 <code>GetCommittedState()</code>\u3001<code>GetState()</code> \u67e5\u8a62\u4e26\u4f7f\u7528 <code>SetState()</code> \u66f4\u65b0\u3002</p> <ul> <li><code>GetCommittedState()</code> \u8fd4\u56de\u5b58\u5132\u4e2d\u70ba\u7d66\u5b9a\u9375\u54c8\u5e0c\u8a2d\u7f6e\u7684\u503c\u3002   \u5982\u679c\u5bc6\u9470\u672a\u8a3b\u518a\uff0c\u5247\u6b64\u51fd\u6578\u8fd4\u56de\u7a7a\u6563\u5217\u3002</li> <li><code>GetState()</code> \u8fd4\u56de\u7d66\u5b9a\u9375\u54c8\u5e0c\u7684\u5167\u5b58\u4e2d\u81df\u72c0\u614b\uff0c   \u5982\u679c\u4e0d\u5b58\u5728\uff0c\u5247\u5f9e KVStore \u52a0\u8f09\u63d0\u4ea4\u7684\u503c\u3002</li> <li><code>SetState()</code> \u5c07\u7d66\u5b9a\u7684\u54c8\u5e0c\u503c\uff08\u9375\u3001\u503c\uff09\u8a2d\u7f6e\u70ba\u72c0\u614b\u3002   \u5982\u679c\u503c\u6563\u5217\u70ba\u7a7a\uff0c\u5247\u6b64\u51fd\u6578\u5f9e\u72c0\u614b\u4e2d\u522a\u9664\u9375\uff0c   \u65b0\u503c\u5148\u4fdd\u6301\u81df\u72c0\u614b\uff0c\u6700\u5f8c\u63d0\u4ea4\u7d66KVStore\u3002</li> </ul> <p>\u5e33\u6236\u4e5f\u53ef\u4ee5\u8a2d\u7f6e\u70ba\u81ea\u6bba\u72c0\u614b\u3002 \u7576\u5408\u7d04\u81ea\u6bba\u6642\uff0c\u8cec\u6236\u88ab\u6a19\u8a18\u70ba\u81ea\u6bba\uff0c\u7576\u63d0\u4ea4\u4ee3\u78bc\u6642\uff0c\u5b58\u5132\u548c\u8cec\u6236\u88ab\u522a\u9664\uff08\u5f9e\u4e0b\u4e00\u500b\u584a\u958b\u59cb\uff09\u3002</p> <ul> <li><code>Suicide()</code> \u5c07\u7d66\u5b9a\u5e33\u6236\u6a19\u8a18\u70ba\u5df2\u81ea\u6bba\u4e26\u6e05\u9664 EVM \u4ee3\u5e63\u7684\u5e33\u6236\u9918\u984d\u3002</li> <li><code>HasSuicided()</code> \u67e5\u8a62\u5167\u5b58\u4e2d\u7684\u6a19\u8a8c\u4ee5\u6aa2\u67e5\u5e33\u6236\u662f\u5426\u5df2\u5728\u7576\u524d\u4ea4\u6613\u4e2d\u88ab\u6a19\u8a18\u70ba\u81ea\u6bba\u3002   \u88ab\u81ea\u6bba\u7684\u8cec\u6236\u5c07\u5728\u67e5\u8a62\u671f\u9593\u8fd4\u56de\u70ba\u975e\u96f6\uff0c\u4e26\u5728\u63d0\u4ea4\u584a\u5f8c\u201c\u6e05\u9664\u201d\u3002</li> </ul> <p>\u8981\u6aa2\u67e5\u5e33\u6236\u662f\u5426\u5b58\u5728\uff0c\u8acb\u4f7f\u7528 <code>Exist()</code> \u548c <code>Empty()</code>\u3002</p> <ul> <li>\u5982\u679c\u7d66\u5b9a\u5e33\u6236\u5b58\u5728\u65bc\u5b58\u5132\u4e2d\u6216\u5df2\u88ab\u6a19\u8a18\u70ba\u5df2\u81ea\u6bba\uff0c\u5247 <code>Exist()</code> \u8fd4\u56de true\u3002</li> <li>\u5982\u679c\u5730\u5740\u6eff\u8db3\u4ee5\u4e0b\u689d\u4ef6\uff0c<code>Empty()</code> \u8fd4\u56de true\uff1a<ul> <li>nonce\u70ba 0</li> <li>evm \u8ca8\u5e63 \u7684\u9918\u984d\u70ba 0</li> <li>\u5e33\u6236code hash\u70ba\u7a7a</li> </ul> </li> </ul>"},{"location":"evm/#eip2930-functionality","title":"EIP2930 functionality","text":"<p>\u652f\u6301\u5305\u542b\u8a2a\u554f\u5217\u8868\u3001\u4ea4\u6613\u8a08\u5283\u8a2a\u554f\u7684\u5730\u5740\u548c\u5b58\u5132\u5bc6\u9470\u5217\u8868\u7684\u4ea4\u6613\u985e\u578b\u3002 \u8a2a\u554f\u5217\u8868\u72c0\u614b\u4fdd\u5b58\u5728\u5167\u5b58\u4e2d\uff0c\u4e26\u5728\u4e8b\u52d9\u63d0\u4ea4\u5f8c\u4e1f\u68c4\u3002</p> <ul> <li><code>PrepareAccessList()</code> \u8655\u7406\u57f7\u884c\u95dc\u65bc EIP-2929 \u548c EIP-2930 \u7684\u72c0\u614b\u8f49\u63db\u7684\u6e96\u5099\u6b65\u9a5f\u3002   \u50c5\u7576 Yolov3/Berlin/2929+2930 \u9069\u7528\u65bc\u7576\u524d\u7de8\u865f\u6642\u624d\u61c9\u8abf\u7528\u6b64\u65b9\u6cd5\u3002<ul> <li>\u5c07\u767c\u4ef6\u4eba\u6dfb\u52a0\u5230\u8a2a\u554f\u5217\u8868 (EIP-2929)</li> <li>\u5c07\u76ee\u7684\u5730\u6dfb\u52a0\u5230\u8a2a\u554f\u5217\u8868 (EIP-2929)</li> <li>\u5c07\u9810\u7de8\u8b6f\u6dfb\u52a0\u5230\u8a2a\u554f\u5217\u8868 (EIP-2929)</li> <li>\u6dfb\u52a0\u53ef\u9078\u7684 tx \u8a2a\u554f\u5217\u8868\u7684\u5167\u5bb9 (EIP-2930)</li> </ul> </li> <li>\u5982\u679c\u5730\u5740\u5df2\u8a3b\u518a\uff0c<code>AddressInAccessList()</code> \u8fd4\u56de true\u3002</li> <li><code>SlotInAccessList()</code> \u6aa2\u67e5\u5730\u5740\u548c\u63d2\u69fd\u662f\u5426\u5df2\u8a3b\u518a\u3002</li> <li><code>AddAddressToAccessList()</code> \u5c07\u7d66\u5b9a\u5730\u5740\u6dfb\u52a0\u5230\u8a2a\u554f\u5217\u8868\u3002   \u5982\u679c\u8a72\u5730\u5740\u5df2\u7d93\u5728\u8a2a\u554f\u5217\u8868\u4e2d\uff0c\u5247\u6b64\u51fd\u6578\u57f7\u884c\u7a7a\u64cd\u4f5c\u3002</li> <li><code>AddSlotToAccessList()</code> \u5c07\u7d66\u5b9a\u7684\uff08\u5730\u5740\u3001\u69fd\uff09\u6dfb\u52a0\u5230\u8a2a\u554f\u5217\u8868\u4e2d\u3002   \u5982\u679c\u5730\u5740\u548c\u63d2\u69fd\u5df2\u7d93\u5728\u8a2a\u554f\u5217\u8868\u4e2d\uff0c\u5247\u6b64\u51fd\u6578\u57f7\u884c\u7a7a\u64cd\u4f5c\u3002</li> </ul>"},{"location":"evm/#_13","title":"\u5feb\u7167\u72c0\u614b\u548c\u6062\u5fa9\u529f\u80fd","text":"<p>EVM \u4f7f\u7528\u72c0\u614b\u6062\u5fa9\u7570\u5e38\u4f86\u8655\u7406\u932f\u8aa4\u3002 \u9019\u6a23\u7684\u7570\u5e38\u5c07\u64a4\u6d88\u5c0d\u7576\u524d\u8abf\u7528\uff08\u53ca\u5176\u6240\u6709\u5b50\u8abf\u7528\uff09\u4e2d\u7684\u72c0\u614b\u6240\u505a\u7684\u6240\u6709\u66f4\u6539\uff0c\u4e26\u4e14\u8abf\u7528\u8005\u53ef\u4ee5\u8655\u7406\u932f\u8aa4\u4e26\u4e14\u4e0d\u6703\u50b3\u64ad\u3002 \u60a8\u53ef\u4ee5\u4f7f\u7528 <code>Snapshot()</code> \u901a\u904e\u4fee\u8a02\u8b58\u5225\u7576\u524d\u72c0\u614b\uff0c\u4e26\u4f7f\u7528 <code>RevertToSnapshot()</code> \u5c07\u72c0\u614b\u6062\u5fa9\u5230\u7d66\u5b9a\u4fee\u8a02\u4ee5\u652f\u6301\u6b64\u529f\u80fd\u3002 - <code>Snapshot()</code> \u5275\u5efa\u4e00\u500b\u65b0\u5feb\u7167\u4e26\u8fd4\u56de\u6a19\u8b58\u7b26\u3002 - <code>RevertToSnapshot(rev)</code> \u64a4\u6d88\u6240\u6709\u4fee\u6539\uff0c\u76f4\u81f3\u6a19\u8b58\u70ba <code>rev</code> \u7684\u5feb\u7167\u3002</p> <p>Daodst \u6539\u7de8\u4e86 go-ethereum journal implementation \u4f86\u652f\u6301\u9019\u4e00\u9ede\uff0c\u5b83\u4f7f\u7528\u65e5\u8a8c\u5217\u8868\u70ba\u4e86\u8a18\u9304\u5230\u76ee\u524d\u70ba\u6b62\u5b8c\u6210\u7684\u6240\u6709\u72c0\u614b\u4fee\u6539\u64cd\u4f5c\uff0c\u5feb\u7167\u7531\u65e5\u8a8c\u5217\u8868\u4e2d\u7684\u552f\u4e00 ID \u548c\u7d22\u5f15\u7d44\u6210\uff0c\u8981\u6062\u5fa9\u70ba\u5feb\u7167\uff0c\u5b83\u53ea\u662f\u4ee5\u76f8\u53cd\u7684\u9806\u5e8f\u5728\u5feb\u7167\u7d22\u5f15\u4e4b\u5f8c\u64a4\u6d88\u65e5\u8a8c\u65e5\u8a8c\u3002</p>"},{"location":"evm/#_14","title":"\u4ee5\u592a\u574a\u4ea4\u6613\u65e5\u8a8c","text":"<p>\u4f7f\u7528 <code>AddLog()</code>\uff0c\u60a8\u53ef\u4ee5\u5c07\u7d66\u5b9a\u7684\u4ee5\u592a\u574a <code>Log</code> \u9644\u52a0\u5230\u8207\u4fdd\u5b58\u5728\u7576\u524d\u72c0\u614b\u7684\u4ea4\u6613\u54c8\u5e0c\u95dc\u806f\u7684\u65e5\u8a8c\u5217\u8868\u4e2d\u3002 \u8a72\u51fd\u6578\u9084\u5728\u8a2d\u7f6e\u8981\u5b58\u5132\u7684\u65e5\u8a8c\u4e4b\u524d\u586b\u5beb tx hash\u3001block hash\u3001tx index \u548c log index \u5b57\u6bb5\u3002</p>"},{"location":"evm/#keeper","title":"Keeper","text":"<p>EVM \u6a21\u584a<code>Keeper</code>\u6388\u4e88\u5c0d EVM \u6a21\u584a\u72c0\u614b\u7684\u8a2a\u554f\u6b0a\u9650\uff0c\u4e26\u5be6\u73fe <code>statedb.Keeper</code> \u63a5\u53e3\u4ee5\u652f\u6301 <code>StateDB</code> \u5be6\u73fe\u3002 Keeper \u5305\u542b\u4e00\u500b\u5b58\u5132\u5bc6\u9470\uff0c\u5141\u8a31 DB \u5beb\u5165\u53ea\u80fd\u7531 EVM \u6a21\u584a\u8a2a\u554f\u7684\u591a\u5b58\u5132\u7684\u5177\u9ad4\u5b50\u6a39\u3002 Daodst \u6c92\u6709\u4f7f\u7528 trie \u548c\u6578\u64da\u5eab\u9032\u884c\u67e5\u8a62\u548c\u6301\u4e45\u5316\uff08 <code>StateDB</code> \u5be6\u73fe\uff09\uff0c\u800c\u662f\u4f7f\u7528 Cosmos \u7684 <code>KVStore</code>\uff08\u9375\u503c\u5b58\u5132\uff09\u548c Cosmos SDK \u7684<code>Keeper</code>\u4f86\u4fc3\u9032\u72c0\u614b\u8f49\u63db\u3002</p> <p>\u70ba\u4e86\u652f\u6301\u63a5\u53e3\u529f\u80fd\uff0c\u5b83\u5c0e\u5165\u4e86 4 \u500b\u6a21\u584a Keepers\uff1a</p> <ul> <li><code>auth</code>\uff1aCRUD \u5e33\u6236</li> <li><code>bank</code>\uff1a\u6703\u8a08\uff08\u4f9b\u61c9\uff09\u548c\u4f59\u984d\u7684 CRUD</li> <li><code>staking</code>\uff1a\u67e5\u8a62\u6b77\u53f2\u6a19\u982d</li> <li><code>fee market</code>\uff1a\u8655\u7406<code>DynamicFeeTx</code>\u7684EIP1559\u57fa\u672c\u8cbb\u7528    \u5728<code>ChainConfig</code>\u53c3\u6578\u4e0a\u6fc0\u6d3b<code>London</code>\u786c\u5206\u53c9\u4e4b\u5f8c</li> </ul> <pre><code>type Keeper struct {\n // Protobuf codec\n cdc codec.BinaryCodec\n // Store key required for the EVM Prefix KVStore. It is required by:\n // - storing account's Storage State\n // - storing account's Code\n // - storing Bloom filters by block height. Needed for the Web3 API.\n // For the full list, check the module specification\n storeKey sdk.StoreKey\n\n // key to access the transient store, which is reset on every block during Commit\n transientKey sdk.StoreKey\n\n // module specific parameter space that can be configured through governance\n paramSpace paramtypes.Subspace\n // access to account state\n accountKeeper types.AccountKeeper\n // update balance and accounting operations with coins\n bankKeeper types.BankKeeper\n // access historical headers for EVM state transition execution\n stakingKeeper types.StakingKeeper\n // fetch EIP1559 base fee and parameters\n feeMarketKeeper types.FeeMarketKeeper\n\n // chain ID number obtained from the context's chain id\n eip155ChainID *big.Int\n\n // Tracer used to collect execution traces from the EVM transaction execution\n tracer string\n // trace EVM state transition execution. This value is obtained from the `--trace` flag.\n // For more info check https://geth.ethereum.org/docs/dapp/tracing\n debug bool\n\n // EVM Hooks for tx post-processing\n hooks types.EvmHooks\n}\n</code></pre>"},{"location":"evm/#_15","title":"\u5275\u4e16\u72c0\u614b","text":"<p><code>x/evm</code> \u6a21\u584a <code>GenesisState</code> \u5b9a\u7fa9\u4e86\u5f9e\u5148\u524d\u5c0e\u51fa\u7684\u9ad8\u5ea6\u521d\u59cb\u5316\u93c8\u6240\u9700\u7684\u72c0\u614b\u3002 \u5b83\u5305\u542b <code>GenesisAccounts</code> \u548c\u6a21\u584a\u53c3\u6578</p> <pre><code>type GenesisState struct {\n  // accounts is an array containing the ethereum genesis accounts.\n  Accounts []GenesisAccount `protobuf:\"bytes,1,rep,name=accounts,proto3\" json:\"accounts\"`\n  // params defines all the parameters of the module.\n  Params Params `protobuf:\"bytes,2,opt,name=params,proto3\" json:\"params\"`\n}\n</code></pre>"},{"location":"evm/#_16","title":"\u5275\u4e16\u8cec\u865f","text":"<p><code>GenesisAccount</code> \u985e\u578b\u5c0d\u61c9\u65bc\u4ee5\u592a\u574a<code>GenesisAccount</code> \u985e\u578b\u7684\u6539\u7de8\u3002 \u5b83\u5b9a\u7fa9\u4e86\u4e00\u500b\u5728\u5275\u4e16\u72c0\u614b\u4e0b\u88ab\u521d\u59cb\u5316\u7684\u8cec\u6236\u3002</p> <p>\u5b83\u7684\u4e3b\u8981\u5340\u5225\u5728\u65bc Daodst \u4e0a\u7684\u90a3\u500b\u4f7f\u7528\u81ea\u5b9a\u7fa9\u7684<code>Storage</code>\u985e\u578b\uff0c\u8a72\u985e\u578b\u4f7f\u7528\u5207\u7247\u800c\u4e0d\u662f evm<code>State</code>\u7684\u6620\u5c04\uff08\u7531\u65bc\u975e\u78ba\u5b9a\u6027\uff09\uff0c\u4e26\u4e14\u5b83\u4e0d\u5305\u542b\u79c1\u9470\u5b57\u6bb5\u3002</p> <p>\u540c\u6a23\u91cd\u8981\u7684\u662f\u8981\u6ce8\u610f\uff0c\u7531\u65bc Cosmos SDK \u4e0a\u7684<code>auth</code>\u6a21\u584a\u7ba1\u7406\u5e33\u6236\u72c0\u614b\uff0c<code>Address</code>\u5b57\u6bb5\u5fc5\u9808\u5c0d\u61c9\u65bc\u5b58\u5132\u5728<code>auth</code>\u6a21\u584a<code>Keeper</code>\u4e2d\u7684\u73fe\u6709<code>EthAccount</code>\uff08\u5373<code>AccountKeeper</code>\uff09\u3002</p> <p>\u5730\u5740\u4f7f\u7528 EIP55 \u5341\u516d\u9032\u5236 [\u683c\u5f0f] \u5728 <code>genesis.json</code> \u4e0a\u3002</p> <pre><code>type GenesisAccount struct {\n  // address defines an ethereum hex formated address of an account\n  Address string `protobuf:\"bytes,1,opt,name=address,proto3\" json:\"address,omitempty\"`\n  // code defines the hex bytes of the account code.\n  Code string `protobuf:\"bytes,2,opt,name=code,proto3\" json:\"code,omitempty\"`\n  // storage defines the set of state key values for the account.\n  Storage Storage `protobuf:\"bytes,3,rep,name=storage,proto3,castrepeated=Storage\" json:\"storage\"`\n}\n</code></pre>"},{"location":"evm/#_17","title":"\u72c0\u614b\u8f49\u63db","text":"<p><code>x/evm</code> \u6a21\u584a\u5141\u8a31\u7528\u6236\u63d0\u4ea4\u4ee5\u592a\u574a\u4ea4\u6613 (<code>Tx</code>) \u4e26\u57f7\u884c\u5b83\u5011\u5305\u542b\u7684\u6d88\u606f\u4ee5\u5728\u7d66\u5b9a\u72c0\u614b\u4e0a\u5f15\u767c\u72c0\u614b\u8f49\u63db\u3002</p> <p>\u7528\u6236\u5728\u5ba2\u6236\u7aef\u63d0\u4ea4\u4ea4\u6613\u4ee5\u5c07\u5176\u5ee3\u64ad\u5230\u7db2\u7d61\u3002 \u7576\u4ea4\u6613\u5728\u5171\u8b58\u904e\u7a0b\u4e2d\u88ab\u5305\u542b\u5728\u4e00\u500b\u584a\u4e2d\u6642\uff0c\u5b83\u5c07\u5728\u670d\u52d9\u5668\u7aef\u57f7\u884c\u3002 \u6211\u5011\u5f37\u70c8\u5efa\u8b70\u60a8\u4e86\u89e3 Tendermint \u5171\u8b58\u5f15\u64ce \u7684\u57fa\u790e\u77e5\u8b58\uff0c\u4ee5\u8a73\u7d30\u4e86\u89e3\u72c0\u614b\u8f49\u63db.</p>"},{"location":"evm/#_18","title":"\u5ba2\u6236\u7aef","text":"<p>:::\u63d0\u793a \ud83d\udc49 \u9019\u662f\u57fa\u65bc <code>eth_sendTransaction</code> JSON-RPC :::</p> <ol> <li> <p>\u7528\u6236\u4f7f\u7528\u4ee5\u592a\u574a\u517c\u5bb9\u7684\u5ba2\u6236\u7aef\u6216\u9322\u5305\uff08\u4f8b\u5982 Metamask\u3001WalletConnect\u3001Ledger \u7b49\uff09\u901a\u904e\u53ef\u7528\u7684 JSON-RPC \u7aef\u9ede\u4e4b\u4e00\u63d0\u4ea4\u4ea4\u6613\uff1a</p> <ul> <li>eth\uff08\u516c\u5171\uff09\u547d\u540d\u7a7a\u9593\uff1a <code>eth_sendTransaction</code> \u548c <code>eth_sendRawTransaction</code></li> <li>\u500b\u4eba\uff08\u79c1\u6709\uff09\u547d\u540d\u7a7a\u9593\uff1a <code>personal_sendTransaction</code></li> </ul> </li> <li> <p>\u5728\u4f7f\u7528 SetTxDefaults \u586b\u5145 RPC \u4e8b\u52d9\u5f8c\u5275\u5efa\u4e00\u500b MsgEthereumTx \u5be6\u4f8b\uff0c\u4ee5\u4f7f\u7528\u9ed8\u8a8d\u503c\u586b\u5145\u7f3a\u5931\u7684 tx \u53c3\u6578</p> </li> <li>\u4f7f\u7528 ValidateBasic() \u9a57\u8b49 <code>Tx</code> \u5b57\u6bb5\uff08\u7121\u72c0\u614b\uff09</li> <li><code>Tx</code> \u4f7f\u7528\u8207\u767c\u4ef6\u4eba\u5730\u5740\u95dc\u806f\u7684\u5bc6\u9470\u548c\u4f86\u81ea <code>ChainConfig</code> \u7684\u6700\u65b0\u4ee5\u592a\u574a\u786c\u5206\u53c9\uff08<code>London</code>\u3001<code>Berlin</code> \u7b49\uff09\u7c3d\u540d</li> <li><code>Tx</code> \u662f\u4f7f\u7528 Cosmos Config \u69cb\u5efa\u5668\u5f9e msg \u5b57\u6bb5\u69cb\u5efa\u7684</li> <li><code>Tx</code> \u5728\u540c\u6b65\u6a21\u5f0f\u4e2d\u5ee3\u64ad    \u78ba\u4fdd\u7b49\u5f85 <code>CheckTx</code> \u57f7\u884c\u97ff\u61c9\u3002    \u5728\u6dfb\u52a0\u5230\u5171\u8b58\u5f15\u64ce\u7684\u5167\u5b58\u6c60\u4e4b\u524d\uff0c\u61c9\u7528\u7a0b\u5e8f\u4f7f\u7528<code>CheckTx()</code>\u9a57\u8b49\u4ea4\u6613\u3002</li> <li>JSON-RPC \u7528\u6236\u6536\u5230\u5e36\u6709\u4ea4\u6613\u5b57\u6bb5\u7684 <code>RLP</code> \u54c8\u5e0c\u7684\u97ff\u61c9\u3002    \u6b64\u54c8\u5e0c\u4e0d\u540c\u65bc SDK \u4ea4\u6613\u4f7f\u7528\u7684\u9ed8\u8a8d\u54c8\u5e0c\uff0c\u5f8c\u8005\u8a08\u7b97\u4ea4\u6613\u5b57\u7bc0\u7684<code>sha256</code>\u54c8\u5e0c\u3002</li> </ol>"},{"location":"evm/#_19","title":"\u670d\u52d9\u7aef","text":"<p>\u4e00\u65e6\u5728\u5171\u8b58\u671f\u9593\u63d0\u4ea4\u4e86\u4e00\u500b\u584a\uff08\u5305\u542b\u201cTx\u201d\uff09\uff0c\u5b83\u5c31\u6703\u5728\u670d\u52d9\u5668\u7aef\u7684\u4e00\u7cfb\u5217 ABCI \u6d88\u606f\u4e2d\u61c9\u7528\u65bc\u61c9\u7528\u7a0b\u5e8f\u3002</p> <p>\u6bcf\u500b <code>Tx</code> \u90fd\u7531\u61c9\u7528\u7a0b\u5e8f\u901a\u904e\u8abf\u7528 <code>RunTx</code> \u4f86\u8655\u7406\u3002 \u5728\u5c0d <code>Tx</code> \u4e2d\u7684\u6bcf\u500b <code>sdk.Msg</code> \u9032\u884c\u7121\u72c0\u614b\u9a57\u8b49\u5f8c\uff0c<code>AnteHandler</code> \u78ba\u8a8d <code>Tx</code> \u662f\u4ee5\u592a\u574a\u4ea4\u6613\u9084\u662f SDK \u4ea4\u6613\u3002 \u4f5c\u70ba\u4ee5\u592a\u574a\u4ea4\u6613\uff0c\u5b83\u5305\u542b\u6d88\u606f\uff0c\u7136\u5f8c\u7531 <code>x/evm</code> \u6a21\u584a\u8655\u7406\u4ee5\u66f4\u65b0\u61c9\u7528\u7a0b\u5e8f\u7684\u72c0\u614b\u3002</p>"},{"location":"evm/#_20","title":"\u524d\u7f6e\u8655\u7406\u7a0b\u5e8f","text":"<p><code>anteHandler</code> \u70ba\u6bcf\u7b46\u4ea4\u6613\u904b\u884c\u3002 \u5b83\u6aa2\u67e5 <code>Tx</code> \u662f\u5426\u662f\u4ee5\u592a\u574a\u4ea4\u6613\u4e26\u5c07\u5176\u8def\u7531\u5230\u5167\u90e8 ante \u8655\u7406\u7a0b\u5e8f\u3002 \u5728\u9019\u88e1\uff0c<code>Tx</code> \u4f7f\u7528 EthereumTx \u64f4\u5c55\u9078\u9805\u9032\u884c\u8655\u7406\uff0c\u4ee5\u4e0d\u540c\u65bc\u6b63\u5e38\u7684 Cosmos SDK \u4ea4\u6613\u4f86\u8655\u7406\u5b83\u5011\u3002 <code>antehandler</code> \u904b\u884c\u4e00\u7cfb\u5217\u9078\u9805\u53ca\u5176\u91dd\u5c0d\u6bcf\u500b <code>Tx</code> \u7684 <code>AnteHandle</code> \u51fd\u6578\uff1a</p> <ul> <li><code>EthSetUpContextDecorator()</code> \u6539\u7de8\u81ea cosmos-sdk \u7684 SetUpContextDecorator\uff0c\u5b83\u901a\u904e\u5c07\u71c3\u6c23\u8868\u8a2d\u7f6e\u70ba\u7121\u9650\u4f86\u5ffd\u7565\u71c3\u6c23\u6d88\u8017</li> <li><code>EthValidateBasicDecorator(evmKeeper)</code> \u9a57\u8b49\u4ee5\u592a\u574a\u985e\u578b Cosmos <code>Tx</code> \u6d88\u606f\u7684\u5b57\u6bb5</li> <li><code>EthSigVerificationDecorator(evmKeeper)</code> \u9a57\u8b49\u8a3b\u518a\u7684\u93c8 ID \u662f\u5426\u8207\u6d88\u606f\u4e0a\u7684\u76f8\u540c\uff0c\u4e26\u4e14\u7c3d\u540d\u8005\u5730\u5740\u662f\u5426\u8207\u6d88\u606f\u4e0a\u5b9a\u7fa9\u7684\u76f8\u5339\u914d\u3002   RecheckTx \u4e0d\u6703\u8df3\u904e\u5b83\uff0c\u56e0\u70ba\u5b83\u8a2d\u7f6e\u4e86<code>From</code>\u5730\u5740\uff0c\u9019\u5c0d\u65bc\u5176\u4ed6 ante \u8655\u7406\u7a0b\u5e8f\u7684\u5de5\u4f5c\u81f3\u95dc\u91cd\u8981\u3002   RecheckTx \u5931\u6557\u5c07\u963b\u6b62 tx \u88ab\u5305\u542b\u5230\u584a\u4e2d\uff0c\u7279\u5225\u662f\u7576 CheckTx \u6210\u529f\u6642\uff0c\u5728\u9019\u7a2e\u60c5\u6cc1\u4e0b\u7528\u6236\u5c07\u4e0d\u6703\u770b\u5230\u932f\u8aa4\u6d88\u606f\u3002   -<code>EthAccountVerificationDecorator(ak, bankKeeper, evmKeeper)</code>   \u5c07\u9a57\u8b49\u767c\u9001\u65b9\u9918\u984d\u662f\u5426\u5927\u65bc\u7e3d\u4ea4\u6613\u6210\u672c\u3002   \u5982\u679c\u8a72\u5e33\u6236\u4e0d\u5b58\u5728\uff0c\u5373\u7121\u6cd5\u5728\u5b58\u5132\u4e2d\u627e\u5230\uff0c\u5247\u8a72\u5e33\u6236\u5c07\u88ab\u8a2d\u7f6e\u5230\u5b58\u5132\u4e2d\u3002   \u5982\u679c\u51fa\u73fe\u4ee5\u4e0b\u60c5\u6cc1\uff0c\u6b64 AnteHandler \u88dd\u98fe\u5668\u5c07\u5931\u6557\uff1a<ul> <li>\u4efb\u4f55\u6d88\u606f\u90fd\u4e0d\u662f MsgEthereumTx</li> <li>\u767c\u4ef6\u4eba\u5730\u5740\u70ba\u7a7a</li> <li>\u8cec\u6236\u9918\u984d\u4f4e\u65bc\u4ea4\u6613\u6210\u672c</li> </ul> </li> <li><code>EthNonceVerificationDecorator(ak)</code> \u9a57\u8b49\u4ea4\u6613\u96a8\u6a5f\u6578\u662f\u5426\u6709\u6548\u4e26\u7b49\u540c\u65bc\u767c\u9001\u65b9\u8cec\u6236\u7684\u7576\u524d\u96a8\u6a5f\u6578\u3002</li> <li><code>EthGasConsumeDecorator(evmKeeper)</code> \u9a57\u8b49\u4ee5\u592a\u574a tx \u6d88\u606f\u662f\u5426\u8db3\u4ee5\u652f\u4ed8\u56fa\u6709\u6c23\u9ad4\uff08\u50c5\u5728 CheckTx \u671f\u9593\uff09\u4e26\u4e14\u767c\u9001\u65b9\u6709\u8db3\u5920\u7684\u9918\u984d\u4f86\u652f\u4ed8\u6c23\u9ad4\u6210\u672c\u3002   \u4ea4\u6613\u7684\u56fa\u6709\u6c23\u9ad4\u662f\u4ea4\u6613\u5728\u57f7\u884c\u4e4b\u524d\u4f7f\u7528\u7684\u6c23\u9ad4\u91cf\u3002   \u6c23\u9ad4\u662f\u4e00\u500b\u5e38\u6578\u503c\u52a0\u4e0a\u4ea4\u6613\u63d0\u4f9b\u7684\u984d\u5916\u6578\u64da\u5b57\u7bc0\u6240\u7522\u751f\u7684\u4efb\u4f55\u6210\u672c\u3002   \u5982\u679c\u51fa\u73fe\u4ee5\u4e0b\u60c5\u6cc1\uff0c\u6b64 AnteHandler \u88dd\u98fe\u5668\u5c07\u5931\u6557\uff1a<ul> <li>\u4ea4\u6613\u5305\u542b\u591a\u500b\u6d88\u606f</li> <li>\u6d88\u606f\u4e0d\u662f MsgEthereumTx</li> <li>\u627e\u4e0d\u5230\u767c\u4ef6\u4eba\u5e33\u6236</li> <li>\u4ea4\u6613\u7684 gas limit \u4f4e\u65bc\u56fa\u6709 gas</li> <li>\u7528\u6236\u6c92\u6709\u8db3\u5920\u7684\u9918\u984d\u4f86\u6263\u9664\u4ea4\u6613\u8cbb\u7528\uff08gas_limit * gas_price\uff09</li> <li>\u4ea4\u6613\u6216\u5340\u584a\u7164\u6c23\u8868\u7528\u5b8c\u7164\u6c23</li> </ul> </li> <li><code>CanTransferDecorator(evmKeeper, feeMarketKeeper)</code> \u5f9e\u6d88\u606f\u4e2d\u5275\u5efa\u4e00\u500b EVM \u4e26\u8abf\u7528 BlockContext CanTransfer \u51fd\u6578\u4f86\u67e5\u770b\u8a72\u5730\u5740\u662f\u5426\u53ef\u4ee5\u57f7\u884c\u4ea4\u6613\u3002</li> <li><code>EthIncrementSenderSequenceDecorator(ak)</code> \u8655\u7406\u905e\u589e\u7c3d\u540d\u8005\uff08\u5373\u767c\u9001\u8005\uff09\u7684\u5e8f\u5217\u3002   \u5982\u679c\u4ea4\u6613\u662f\u5408\u7d04\u5275\u5efa\uff0c\u5247\u96a8\u6a5f\u6578\u5c07\u5728\u4ea4\u6613\u57f7\u884c\u671f\u9593\u905e\u589e\uff0c\u800c\u4e0d\u662f\u5728\u6b64 AnteHandler \u88dd\u98fe\u5668\u5167\u3002</li> </ul> <p>\u9078\u9805 <code>authante.NewMempoolFeeDecorator()</code>\u3001<code>authante.NewTxTimeoutHeightDecorator()</code> \u548c <code>authante.NewValidateMemoDecorator(ak)</code> \u8207 Cosmos <code>Tx</code> \u76f8\u540c\u3002 \u55ae\u64ca\u6b64\u8655\u4e86\u89e3\u6709\u95dc <code>anteHandler</code> \u7684\u66f4\u591a\u4fe1\u606f\u3002</p>"},{"location":"evm/#evm_2","title":"EVM \u6a21\u584a","text":"<p>\u901a\u904e <code>antehandler</code> \u9a57\u8b49\u5f8c\uff0c<code>Tx</code> \u4e2d\u7684\u6bcf\u500b <code>sdk.Msg</code>\uff08\u5728\u672c\u4f8b\u4e2d\u70ba <code>MsgEthereumTx</code>\uff09 \u50b3\u905e\u7d66 <code>x/evm</code> \u6a21\u584a\u4e2d\u7684 Msg Handler\uff0c\u4e26\u901a\u904e\u4ee5\u4e0b\u6b65\u9a5f\u904b\u884c\uff1a</p> <ol> <li>\u5c07 <code>Msg</code> \u8f49\u63db\u70ba\u4ee5\u592a\u574a\u7684 <code>Tx</code> \u985e\u578b</li> <li>\u5c07 <code>Tx</code> \u8207 <code>EVMConfig</code> \u4e00\u8d77\u61c9\u7528\u4e26\u5617\u8a66\u57f7\u884c\u72c0\u614b\u8f49\u63db\uff0c\u53ea\u6709\u5728\u4ea4\u6613\u672a\u5931\u6557\u7684\u60c5\u6cc1\u4e0b\u624d\u6703\u6301\u4e45\u5316\uff08\u63d0\u4ea4\uff09\u5230\u5e95\u5c64 KVStore\uff1a    1.\u78ba\u8a8d\u5275\u5efa\u4e86<code>EVMConfig</code><ol> <li>\u4f7f\u7528\u4f86\u81ea\u201cEVMConfig\u201d\u7684\u93c8\u914d\u7f6e\u503c\u5275\u5efa\u4ee5\u592a\u574a\u7c3d\u540d\u8005</li> <li>\u5c07\u4ee5\u592a\u574a\u4ea4\u6613\u54c8\u5e0c\u8a2d\u7f6e\u70ba\uff08\u81e8\u6642\uff09\u81e8\u6642\u5b58\u5132\uff0c\u4ee5\u4fbf\u5b83\u4e5f\u53ef\u7528\u65bc StateDB \u51fd\u6578    4.\u751f\u6210\u65b0\u7684EVM\u5be6\u4f8b</li> <li>\u78ba\u8a8d\u7528\u65bc\u5408\u7d04\u5275\u5efa (<code>EnableCreate</code>) \u548c\u5408\u7d04\u57f7\u884c (<code>EnableCall</code>) \u7684 EVM \u53c3\u6578\u5df2\u555f\u7528    6.\u61c9\u7528\u6d88\u606f\u3002\u5982\u679c<code>To</code>\u5730\u5740\u70ba<code>nil</code>\uff0c\u5247\u4f7f\u7528\u4ee3\u78bc\u4f5c\u70ba\u90e8\u7f72\u4ee3\u78bc\u5275\u5efa\u65b0\u5408\u7d04\u3002 Else \u4ee5\u7d66\u5b9a\u8f38\u5165\u4f5c\u70ba\u53c3\u6578\u5728\u7d66\u5b9a\u5730\u5740\u8abf\u7528\u5408\u7d04    7.\u8a08\u7b97evm\u64cd\u4f5c\u4f7f\u7528\u7684gas</li> </ol> </li> <li>\u5982\u679c<code>Tx</code>\u7533\u8acb\u6210\u529f<ol> <li>\u57f7\u884c EVM <code>Tx</code> \u5f8c\u8655\u7406\u639b\u9264\u3002\u5982\u679c\u9264\u5b50\u8fd4\u56de\u932f\u8aa4\uff0c\u5247\u9084\u539f\u6574\u500b\u201cTx\u201d    2.\u6309\u7167\u4ee5\u592a\u574agas\u8a18\u8cec\u898f\u5247\u8fd4\u9084gas</li> <li>\u4f7f\u7528\u5f9e tx \u751f\u6210\u7684\u65e5\u8a8c\u66f4\u65b0\u584a\u5e03\u9686\u904e\u6ffe\u5668\u503c</li> <li>\u70ba\u4ea4\u6613\u5b57\u6bb5\u548c tx \u65e5\u8a8c\u767c\u51fa SDK \u4e8b\u4ef6</li> </ol> </li> </ol>"},{"location":"evm/#_21","title":"\u4ea4\u6613","text":"<p>\u672c\u90e8\u5206\u5b9a\u7fa9\u4e86\u5c0e\u81f4\u4e0a\u4e00\u7bc0\u4e2d\u5b9a\u7fa9\u7684\u72c0\u614b\u8f49\u63db\u7684 <code>sdk.Msg</code> \u5177\u9ad4\u985e\u578b\u3002</p>"},{"location":"evm/#msgethereumtx","title":"<code>MsgEthereumTx</code>","text":"<p>EVM \u72c0\u614b\u8f49\u63db\u53ef\u4ee5\u901a\u904e\u4f7f\u7528\u201cMsgEthereumTx\u201d\u4f86\u5be6\u73fe\u3002 \u6b64\u6d88\u606f\u5c07\u4ee5\u592a\u574a\u4ea4\u6613\u6578\u64da (<code>TxData</code>) \u5c01\u88dd\u70ba <code>sdk.Msg</code>\u3002 \u5b83\u5305\u542b\u5fc5\u8981\u7684\u4ea4\u6613\u6578\u64da\u5b57\u6bb5\u3002 \u8acb\u6ce8\u610f\uff0c<code>MsgEthereumTx</code> \u5be6\u73fe\u4e86 <code>sdk.Msg</code> \u548c  <code>sdk.Tx</code> \u63a5\u53e3\u3002 \u901a\u5e38\uff0cSDK \u6d88\u606f\u53ea\u5be6\u73fe\u524d\u8005\uff0c\u800c\u5f8c\u8005\u662f\u4e00\u7d44\u6d88\u606f\u6346\u7d81\u5728\u4e00\u8d77\u3002</p> <p>\u672c\u90e8\u5206\u5b9a\u7fa9\u4e86\u5c0e\u81f4\u4e0a\u4e00\u7bc0\u4e2d\u5b9a\u7fa9\u7684\u72c0\u614b\u8f49\u63db\u7684 <code>sdk.Msg</code> \u5177\u9ad4\u985e\u578b\u3002</p>"},{"location":"evm/#msgethereumtx_1","title":"<code>MsgEthereumTx</code>","text":"<p>EVM \u72c0\u614b\u8f49\u63db\u53ef\u4ee5\u901a\u904e\u4f7f\u7528 <code>MsgEthereumTx</code>\u4f86\u5be6\u73fe\u3002 \u6b64\u6d88\u606f\u5c07\u4ee5\u592a\u574a\u4ea4\u6613\u6578\u64da (<code>TxData</code>) \u5c01\u88dd\u70ba <code>sdk.Msg</code>\u3002 \u5b83\u5305\u542b\u5fc5\u8981\u7684\u4ea4\u6613\u6578\u64da\u5b57\u6bb5\u3002 \u8acb\u6ce8\u610f\uff0c<code>MsgEthereumTx</code> \u5be6\u73fe\u4e86 <code>sdk.Msg</code> \u548c  <code>sdk.Tx</code> \u63a5\u53e3\u3002</p> <p>\u901a\u5e38\uff0cSDK \u6d88\u606f\u53ea\u5be6\u73fe\u524d\u8005\uff0c\u800c\u5f8c\u8005\u662f\u4e00\u7d44\u6d88\u606f\u6346\u7d81\u5728\u4e00\u8d77\u3002</p> <pre><code>type MsgEthereumTx struct {\n // inner transaction data\n Data *types.Any `protobuf:\"bytes,1,opt,name=data,proto3\" json:\"data,omitempty\"`\n // DEPRECATED: encoded storage size of the transaction\n Size_ float64 `protobuf:\"fixed64,2,opt,name=size,proto3\" json:\"-\"`\n // transaction hash in hex format\n Hash string `protobuf:\"bytes,3,opt,name=hash,proto3\" json:\"hash,omitempty\" rlp:\"-\"`\n // ethereum signer address in hex format. This address value is checked\n // against the address derived from the signature (V, R, S) using the\n // secp256k1 elliptic curve\n From string `protobuf:\"bytes,4,opt,name=from,proto3\" json:\"from,omitempty\"`\n}\n</code></pre> <p>\u5982\u679c\u51fa\u73fe\u4ee5\u4e0b\u60c5\u6cc1\uff0c\u5247\u6b64\u6d88\u606f\u5b57\u6bb5\u9a57\u8b49\u9810\u8a08\u6703\u5931\u6557\uff1a</p> <ul> <li><code>From</code> \u5b57\u6bb5\u5df2\u5b9a\u7fa9\u4e14\u5730\u5740\u7121\u6548</li> <li><code>TxData</code> \u7121\u72c0\u614b\u9a57\u8b49\u5931\u6557</li> </ul> <p>\u5982\u679c\u51fa\u73fe\u4ee5\u4e0b\u60c5\u6cc1\uff0c\u4ea4\u6613\u57f7\u884c\u9810\u8a08\u6703\u5931\u6557\uff1a</p> <ul> <li>\u4efb\u4f55\u81ea\u5b9a\u7fa9\u7684<code>AnteHandler</code>\u4ee5\u592a\u574a\u88dd\u98fe\u5668\u6aa2\u67e5\u90fd\u5931\u6557\u4e86\uff1a<ul> <li>\u4ea4\u6613\u7684\u6700\u4f4egas\u91cf\u8981\u6c42</li> <li>Tx \u767c\u4ef6\u4eba\u5e33\u6236\u4e0d\u5b58\u5728\u6216\u6c92\u6709\u8db3\u5920\u7684\u8cbb\u7528\u9918\u984d</li> <li>\u8cec\u6236\u5e8f\u5217\u8207\u4ea4\u6613<code>Data.AccountNonce</code>\u4e0d\u5339\u914d</li> <li>\u6d88\u606f\u7c3d\u540d\u9a57\u8b49\u5931\u6557</li> </ul> </li> <li>EVM \u5408\u7d04\u5275\u5efa\uff08\u5373 <code>evm.Create</code>\uff09\u5931\u6557\uff0c\u6216 <code>evm.Call</code> \u5931\u6557</li> </ul>"},{"location":"evm/#_22","title":"\u8f49\u63db","text":"<p><code>MsgEthreumTx</code> \u53ef\u4ee5\u8f49\u63db\u70ba go-ethereum <code>Transaction</code> \u548c <code>Message</code> \u985e\u578b \u70ba\u4e86\u5275\u5efa\u548c\u8abf\u7528 evm \u5408\u7d04\u3002</p> <pre><code>// AsTransaction creates an Ethereum Transaction type from the msg fields\nfunc (msg MsgEthereumTx) AsTransaction() *ethtypes.Transaction {\n txData, err := UnpackTxData(msg.Data)\n if err != nil {\n  return nil\n }\n\n return ethtypes.NewTx(txData.AsEthereumData())\n}\n\n// AsMessage returns the transaction as a core.Message.\nfunc (tx *Transaction) AsMessage(s Signer, baseFee *big.Int) (Message, error) {\n msg := Message{\n  nonce:      tx.Nonce(),\n  gasLimit:   tx.Gas(),\n  gasPrice:   new(big.Int).Set(tx.GasPrice()),\n  gasFeeCap:  new(big.Int).Set(tx.GasFeeCap()),\n  gasTipCap:  new(big.Int).Set(tx.GasTipCap()),\n  to:         tx.To(),\n  amount:     tx.Value(),\n  data:       tx.Data(),\n  accessList: tx.AccessList(),\n  isFake:     false,\n }\n // If baseFee provided, set gasPrice to effectiveGasPrice.\n if baseFee != nil {\n  msg.gasPrice = math.BigMin(msg.gasPrice.Add(msg.gasTipCap, baseFee), msg.gasFeeCap)\n }\n var err error\n msg.from, err = Sender(s, tx)\n return msg, err\n}\n</code></pre>"},{"location":"evm/#_23","title":"\u7c3d\u540d","text":"<p>\u70ba\u4e86\u4f7f\u7c3d\u540d\u9a57\u8b49\u6709\u6548\uff0c<code>TxData</code> \u5fc5\u9808\u5305\u542b\u4f86\u81ea <code>Signer</code> \u7684 <code>v | r | s</code> \u503c\u3002 Sign \u8a08\u7b97 secp256k1 ECDSA \u7c3d\u540d\u4e26\u7c3d\u7f72\u4ea4\u6613\u3002 \u6839\u64da EIP155 \u6a19\u6e96\uff0c\u5b83\u9700\u8981\u4e00\u500b\u5bc6\u9470\u74b0\u7c3d\u540d\u8005\u548c chainID \u4f86\u7c3d\u7f72\u4ee5\u592a\u574a\u4ea4\u6613\u3002 \u6b64\u65b9\u6cd5\u5728\u586b\u5145\u4ea4\u6613\u7c3d\u540d\u7684 V\u3001R\u3001S \u5b57\u6bb5\u6642\u6539\u8b8a\u4ea4\u6613\u3002 \u5982\u679c\u672a\u70ba\u6d88\u606f\u5b9a\u7fa9\u767c\u4ef6\u4eba\u5730\u5740\u6216\u767c\u4ef6\u4eba\u672a\u5728\u5bc6\u9470\u74b0\u4e0a\u8a3b\u518a\uff0c\u5247\u8a72\u51fd\u6578\u5c07\u5931\u6557\u3002</p> <pre><code>// Sign calculates a secp256k1 ECDSA signature and signs the transaction. It\n// takes a keyring signer and the chainID to sign an Ethereum transaction according to\n// EIP155 standard.\n// This method mutates the transaction as it populates the V, R, S\n// fields of the Transaction's Signature.\n// The function will fail if the sender address is not defined for the msg or if\n// the sender is not registered on the keyring\nfunc (msg *MsgEthereumTx) Sign(ethSigner ethtypes.Signer, keyringSigner keyring.Signer) error {\n from := msg.GetFrom()\n if from.Empty() {\n  return fmt.Errorf(\"sender address not defined for message\")\n }\n\n tx := msg.AsTransaction()\n txHash := ethSigner.Hash(tx)\n\n sig, _, err := keyringSigner.SignByAddress(from, txHash.Bytes())\n if err != nil {\n  return err\n }\n\n tx, err = tx.WithSignature(ethSigner, sig)\n if err != nil {\n  return err\n }\n\n msg.FromEthereumTx(tx)\n return nil\n}\n</code></pre>"},{"location":"evm/#txdata","title":"TxData","text":"<p><code>MsgEthereumTx</code> \u652f\u6301\u4f86\u81ea go-ethereum \u7684 3 \u7a2e\u6709\u6548\u7684\u4ee5\u592a\u574a\u4ea4\u6613\u6578\u64da\u985e\u578b\uff1a <code>LegacyTx</code>\u3001<code>AccessListTx</code> \u548c <code>DynamicFeeTx</code>\u3002 \u9019\u4e9b\u985e\u578b\u88ab\u5b9a\u7fa9\u70ba protobuf \u6d88\u606f\uff0c\u4e26\u6253\u5305\u5230 <code>MsgEthereumTx</code> \u5b57\u6bb5\u4e2d\u7684 <code>proto.Any</code> \u63a5\u53e3\u985e\u578b\u4e2d\u3002</p> <ul> <li><code>LegacyTx</code>: EIP-155 \u4ea4\u6613\u985e\u578b</li> <li><code>DynamicFeeTx</code>\uff1aEIP-1559 \u4ea4\u6613\u985e\u578b\u3002</li> <li><code>AccessListTx</code>\uff1aEIP-2930 \u4ea4\u6613\u985e\u578b\u3002</li> </ul>"},{"location":"evm/#legacytx","title":"<code>LegacyTx</code>","text":"<p>\u5e38\u89c4\u4ee5\u592a\u574a\u4ea4\u6613\u7684\u4ea4\u6613\u6570\u636e\u3002</p> <pre><code>type LegacyTx struct {\n // nonce corresponds to the account nonce (transaction sequence).\n Nonce uint64 `protobuf:\"varint,1,opt,name=nonce,proto3\" json:\"nonce,omitempty\"`\n // gas price defines the value for each gas unit\n GasPrice *github_com_cosmos_cosmos_sdk_types.Int `protobuf:\"bytes,2,opt,name=gas_price,json=gasPrice,proto3,customtype=github.com/cosmos/cosmos-sdk/types.Int\" json:\"gas_price,omitempty\"`\n // gas defines the gas limit defined for the transaction.\n GasLimit uint64 `protobuf:\"varint,3,opt,name=gas,proto3\" json:\"gas,omitempty\"`\n // hex formatted address of the recipient\n To string `protobuf:\"bytes,4,opt,name=to,proto3\" json:\"to,omitempty\"`\n // value defines the unsigned integer value of the transaction amount.\n Amount *github_com_cosmos_cosmos_sdk_types.Int `protobuf:\"bytes,5,opt,name=value,proto3,customtype=github.com/cosmos/cosmos-sdk/types.Int\" json:\"value,omitempty\"`\n // input defines the data payload bytes of the transaction.\n Data []byte `protobuf:\"bytes,6,opt,name=data,proto3\" json:\"data,omitempty\"`\n // v defines the signature value\n V []byte `protobuf:\"bytes,7,opt,name=v,proto3\" json:\"v,omitempty\"`\n // r defines the signature value\n R []byte `protobuf:\"bytes,8,opt,name=r,proto3\" json:\"r,omitempty\"`\n // s define the signature value\n S []byte `protobuf:\"bytes,9,opt,name=s,proto3\" json:\"s,omitempty\"`\n}\n</code></pre> <p>\u5982\u679c\u51fa\u73fe\u4ee5\u4e0b\u60c5\u6cc1\uff0c\u5247\u6b64\u6d88\u606f\u5b57\u6bb5\u9a57\u8b49\u9810\u8a08\u6703\u5931\u6557\uff1a</p> <ul> <li><code>GasPrice</code> \u7121\u6548\uff08<code>nil</code>\uff0c\u8ca0\u6578\u6216\u8d85\u51fa int256 \u7bc4\u570d\uff09</li> <li><code>Fee</code> (gasprice * gaslimit) \u7121\u6548</li> <li><code>Amount</code> \u7121\u6548\uff08\u8ca0\u6578\u6216\u8d85\u51fa int256 \u7bc4\u570d\uff09</li> <li><code>To</code> \u5730\u5740\u7121\u6548\uff08\u7121\u6548\u7684\u4ee5\u592a\u574a\u5341\u516d\u9032\u5236\u5730\u5740\uff09</li> </ul>"},{"location":"evm/#dynamicfeetx","title":"<code>DynamicFeeTx</code>","text":"<p>EIP-1559\u52d5\u614b\u624b\u7e8c\u8cbb\u4ea4\u6613\u7684\u4ea4\u6613\u6578\u64da\u3002</p> <pre><code>type DynamicFeeTx struct {\n // destination EVM chain ID\n ChainID *github_com_cosmos_cosmos_sdk_types.Int `protobuf:\"bytes,1,opt,name=chain_id,json=chainId,proto3,customtype=github.com/cosmos/cosmos-sdk/types.Int\" json:\"chainID\"`\n // nonce corresponds to the account nonce (transaction sequence).\n Nonce uint64 `protobuf:\"varint,2,opt,name=nonce,proto3\" json:\"nonce,omitempty\"`\n // gas tip cap defines the max value for the gas tip\n GasTipCap *github_com_cosmos_cosmos_sdk_types.Int `protobuf:\"bytes,3,opt,name=gas_tip_cap,json=gasTipCap,proto3,customtype=github.com/cosmos/cosmos-sdk/types.Int\" json:\"gas_tip_cap,omitempty\"`\n // gas fee cap defines the max value for the gas fee\n GasFeeCap *github_com_cosmos_cosmos_sdk_types.Int `protobuf:\"bytes,4,opt,name=gas_fee_cap,json=gasFeeCap,proto3,customtype=github.com/cosmos/cosmos-sdk/types.Int\" json:\"gas_fee_cap,omitempty\"`\n // gas defines the gas limit defined for the transaction.\n GasLimit uint64 `protobuf:\"varint,5,opt,name=gas,proto3\" json:\"gas,omitempty\"`\n // hex formatted address of the recipient\n To string `protobuf:\"bytes,6,opt,name=to,proto3\" json:\"to,omitempty\"`\n // value defines the the transaction amount.\n Amount *github_com_cosmos_cosmos_sdk_types.Int `protobuf:\"bytes,7,opt,name=value,proto3,customtype=github.com/cosmos/cosmos-sdk/types.Int\" json:\"value,omitempty\"`\n // input defines the data payload bytes of the transaction.\n Data     []byte     `protobuf:\"bytes,8,opt,name=data,proto3\" json:\"data,omitempty\"`\n Accesses AccessList `protobuf:\"bytes,9,rep,name=accesses,proto3,castrepeated=AccessList\" json:\"accessList\"`\n // v defines the signature value\n V []byte `protobuf:\"bytes,10,opt,name=v,proto3\" json:\"v,omitempty\"`\n // r defines the signature value\n R []byte `protobuf:\"bytes,11,opt,name=r,proto3\" json:\"r,omitempty\"`\n // s define the signature value\n S []byte `protobuf:\"bytes,12,opt,name=s,proto3\" json:\"s,omitempty\"`\n}\n</code></pre> <p>\u5982\u679c\u51fa\u73fe\u4ee5\u4e0b\u60c5\u6cc1\uff0c\u5247\u6b64\u6d88\u606f\u5b57\u6bb5\u9a57\u8b49\u9810\u8a08\u6703\u5931\u6557\uff1a</p> <ul> <li><code>GasTipCap</code> \u7121\u6548\uff08<code>nil</code>\u3001\u8ca0\u503c\u6216\u6ea2\u51fa int256\uff09</li> <li><code>GasFeeCap</code> \u7121\u6548\uff08<code>nil</code>\u3001\u8ca0\u503c\u6216\u6ea2\u51fa int256\uff09</li> <li><code>GasFeeCap</code> \u5c0f\u65bc <code>GasTipCap</code></li> <li><code>Fee</code> (gas price * gas limit) \u7121\u6548\uff08\u6ea2\u51fa int256\uff09</li> <li><code>Amount</code> \u7121\u6548\uff08\u8ca0\u6578\u6216\u6ea2\u51fa int256\uff09</li> <li><code>To</code> \u5730\u5740\u7121\u6548\uff08\u7121\u6548\u7684\u4ee5\u592a\u574a\u5341\u516d\u9032\u5236\u5730\u5740\uff09</li> <li><code>ChainID</code> \u70ba <code>nil</code></li> </ul>"},{"location":"evm/#accesslisttx","title":"<code>AccessListTx</code>","text":"<p>EIP-2930\u8a2a\u554f\u5217\u8868\u4ea4\u6613\u7684\u4ea4\u6613\u6578\u64da\u3002</p> <pre><code>type AccessListTx struct {\n // destination EVM chain ID\n ChainID *github_com_cosmos_cosmos_sdk_types.Int `protobuf:\"bytes,1,opt,name=chain_id,json=chainId,proto3,customtype=github.com/cosmos/cosmos-sdk/types.Int\" json:\"chainID\"`\n // nonce corresponds to the account nonce (transaction sequence).\n Nonce uint64 `protobuf:\"varint,2,opt,name=nonce,proto3\" json:\"nonce,omitempty\"`\n // gas price defines the value for each gas unit\n GasPrice *github_com_cosmos_cosmos_sdk_types.Int `protobuf:\"bytes,3,opt,name=gas_price,json=gasPrice,proto3,customtype=github.com/cosmos/cosmos-sdk/types.Int\" json:\"gas_price,omitempty\"`\n // gas defines the gas limit defined for the transaction.\n GasLimit uint64 `protobuf:\"varint,4,opt,name=gas,proto3\" json:\"gas,omitempty\"`\n // hex formatted address of the recipient\n To string `protobuf:\"bytes,5,opt,name=to,proto3\" json:\"to,omitempty\"`\n // value defines the unsigned integer value of the transaction amount.\n Amount *github_com_cosmos_cosmos_sdk_types.Int `protobuf:\"bytes,6,opt,name=value,proto3,customtype=github.com/cosmos/cosmos-sdk/types.Int\" json:\"value,omitempty\"`\n // input defines the data payload bytes of the transaction.\n Data     []byte     `protobuf:\"bytes,7,opt,name=data,proto3\" json:\"data,omitempty\"`\n Accesses AccessList `protobuf:\"bytes,8,rep,name=accesses,proto3,castrepeated=AccessList\" json:\"accessList\"`\n // v defines the signature value\n V []byte `protobuf:\"bytes,9,opt,name=v,proto3\" json:\"v,omitempty\"`\n // r defines the signature value\n R []byte `protobuf:\"bytes,10,opt,name=r,proto3\" json:\"r,omitempty\"`\n // s define the signature value\n S []byte `protobuf:\"bytes,11,opt,name=s,proto3\" json:\"s,omitempty\"`\n}\n</code></pre> <p>\u5982\u679c\u51fa\u73fe\u4ee5\u4e0b\u60c5\u6cc1\uff0c\u5247\u6b64\u6d88\u606f\u5b57\u6bb5\u9a57\u8b49\u9810\u8a08\u6703\u5931\u6557\uff1a</p> <ul> <li><code>GasPrice</code> \u7121\u6548\uff08<code>nil</code>\u3001\u8ca0\u6578\u6216\u6ea2\u51fa int256\uff09</li> <li><code>Fee</code> (gas price * gas limit) \u7121\u6548\uff08\u6ea2\u51fa int256\uff09</li> <li><code>Amount</code> \u7121\u6548\uff08\u8ca0\u6578\u6216\u6ea2\u51fa int256\uff09</li> <li><code>To</code> \u5730\u5740\u7121\u6548\uff08\u7121\u6548\u7684\u4ee5\u592a\u574a\u5341\u516d\u9032\u5236\u5730\u5740\uff09</li> <li><code>ChainID</code> \u70ba <code>nil</code></li> </ul>"},{"location":"evm/#abci","title":"ABCI","text":"<p>\u61c9\u7528\u7a0b\u5e8f\u5340\u584a\u93c8\u63a5\u53e3 (ABCI) \u5141\u8a31\u61c9\u7528\u7a0b\u5e8f\u8207 Tendermint \u5171\u8b58\u5f15\u64ce\u9032\u884c\u4ea4\u4e92\u3002 \u8a72\u61c9\u7528\u7a0b\u5e8f\u8207 Tendermint \u4fdd\u6301\u591a\u500b ABCI \u9023\u63a5\u3002 \u8207 <code>x/evm</code> \u6700\u76f8\u95dc\u7684\u662f \u63d0\u4ea4\u6642\u7684\u5171\u8b58\u9023\u63a5\u3002 \u6b64\u9023\u63a5\u8ca0\u8cac\u584a\u57f7\u884c\u4e26\u8abf\u7528\u51fd\u6578<code>InitChain</code>\uff08\u5305\u542b<code>InitGenesis</code>\uff09\uff0c<code>BeginBlock</code>\uff0c<code>DeliverTx</code>\uff0c<code>EndBlock</code>\uff0c<code>Commit</code>\u3002 <code>InitChain</code> \u50c5\u5728\u7b2c\u4e00\u6b21\u555f\u52d5\u65b0\u5340\u584a\u93c8\u6642\u8abf\u7528\uff0c\u4e26\u4e14\u70ba\u584a\u4e2d\u7684\u6bcf\u500b\u4ea4\u6613\u8abf\u7528 <code>DeliverTx</code>\u3002</p>"},{"location":"evm/#_24","title":"\u521d\u59cb\u5316\u5275\u4e16","text":"<p><code>InitGenesis</code> \u901a\u904e\u5c07 <code>GenesisState</code> \u5b57\u6bb5\u8a2d\u7f6e\u70ba\u5b58\u5132\u4f86\u521d\u59cb\u5316 EVM \u6a21\u584a\u5275\u4e16\u72c0\u614b\u3002 \u7279\u5225\u662f\uff0c\u5b83\u8a2d\u7f6e\u53c3\u6578\u548c\u5275\u4e16\u5e33\u6236\uff08\u72c0\u614b\u548c\u4ee3\u78bc\uff09\u3002</p>"},{"location":"evm/#_25","title":"\u5c0e\u51fa\u5275\u4e16","text":"<p><code>ExportGenesis</code> ABCI \u51fd\u6578\u5c0e\u51fa EVM \u6a21\u584a\u7684\u5275\u4e16\u72c0\u614b\u3002 \u7279\u5225\u662f\uff0c\u5b83\u6aa2\u7d22\u6240\u6709\u5e33\u6236\u53ca\u5176\u5b57\u7bc0\u78bc\u3001\u9918\u984d\u548c\u5b58\u5132\u3001\u4ea4\u6613\u65e5\u8a8c\u3001 \u4ee5\u53ca EVM \u53c3\u6578\u548c\u93c8\u914d\u7f6e\u3002</p>"},{"location":"evm/#beginblock","title":"BeginBlock","text":"<p>EVM \u6a21\u584a<code>BeginBlock</code>\u908f\u8f2f\u5728\u8655\u7406\u4ea4\u6613\u7684\u72c0\u614b\u8f49\u63db\u4e4b\u524d\u57f7\u884c\u3002 \u8a72\u529f\u80fd\u7684\u4e3b\u8981\u76ee\u6a19\u662f\uff1a</p> <ul> <li>\u8a2d\u7f6e\u7576\u524d\u5340\u584a\u7684\u4e0a\u4e0b\u6587\uff0c\u4ee5\u4fbf\u5340\u584a\u982d\u3001\u5b58\u5132\u3001\u7164\u6c23\u8868\u7b49\u3002   \u4e00\u65e6\u5728 EVM \u72c0\u614b\u8f49\u63db\u671f\u9593\u8abf\u7528\u4e86 StateDB \u51fd\u6578\u4e4b\u4e00\uff0cKeeper \u5c31\u53ef\u4ee5\u4f7f\u7528\u9019\u4e9b\u51fd\u6578\u3002</li> <li>\u8a2d\u7f6e EIP155 <code>ChainID</code> \u7de8\u865f\uff08\u5f9e\u5b8c\u6574\u7684\u93c8 ID \u7372\u5f97\uff09\uff0c\u4ee5\u9632\u4e4b\u524d\u5728 <code>InitChain</code> \u671f\u9593\u672a\u8a2d\u7f6e\u5b83</li> </ul>"},{"location":"evm/#_26","title":"\u7d50\u675f\u51fa\u584a","text":"<p>EVM \u6a21\u584a\u7684<code>EndBlock</code>\u908f\u8f2f\u767c\u751f\u5728\u57f7\u884c\u5b8c\u4ea4\u6613\u7684\u6240\u6709\u72c0\u614b\u8f49\u63db\u4e4b\u5f8c\u3002 \u8a72\u529f\u80fd\u7684\u4e3b\u8981\u76ee\u6a19\u662f\uff1a</p> <ul> <li>\u767c\u51fa\u584a\u7dbb\u653e\u4e8b\u4ef6<ul> <li>\u9019\u662f\u7531\u65bc web3 \u517c\u5bb9\u6027\uff0c\u56e0\u70ba\u4ee5\u592a\u574a\u6a19\u982d\u5305\u542b\u6b64\u985e\u578b\u4f5c\u70ba\u5b57\u6bb5\u3002   JSON-RPC \u670d\u52d9\u4f7f\u7528\u6b64\u4e8b\u4ef6\u67e5\u8a62\u5f9e Tendermint \u6a19\u982d\u69cb\u9020\u4ee5\u592a\u574a\u6a19\u982d\u3002</li> <li>\u584a\u5e03\u9686\u904e\u6ffe\u5668\u503c\u5f9e\u77ac\u614b\u5b58\u5132\u4e2d\u7372\u53d6\uff0c\u7136\u5f8c\u767c\u51fa</li> </ul> </li> </ul>"},{"location":"evm/#_27","title":"\u9264\u5b50","text":"<p><code>x/evm</code> \u6a21\u584a\u5be6\u73fe\u4e86\u4e00\u500b <code>EvmHooks</code> \u63a5\u53e3\uff0c\u53ef\u4ee5\u5728\u5916\u90e8\u64f4\u5c55\u548c\u5b9a\u5236 <code>Tx</code> \u8655\u7406\u908f\u8f2f\u3002</p> <p>\u9019\u652f\u6301 EVM \u5408\u7d04\u8abf\u7528\u539f\u751f cosmos \u6a21\u584a</p> <ol> <li>\u5b9a\u7fa9\u65e5\u8a8c\u7c3d\u540d\u4e26\u5f9e\u667a\u80fd\u5408\u7d04\u767c\u51fa\u7279\u5b9a\u65e5\u8a8c\uff0c</li> <li>\u5728\u672c\u6a5f tx \u8655\u7406\u4ee3\u78bc\u4e2d\u8b58\u5225\u9019\u4e9b\u65e5\u8a8c\uff0c\u4ee5\u53ca</li> <li>\u5c07\u5b83\u5011\u8f49\u63db\u70ba\u672c\u5730\u6a21\u584a\u8abf\u7528\u3002</li> </ol> <p>\u70ba\u6b64\uff0c\u63a5\u53e3\u5305\u542b\u4e00\u500b PostTxProcessing \u639b\u9264\uff0c\u7528\u65bc\u5728 EvmKeeper \u4e2d\u8a3b\u518a\u81ea\u5b9a\u7fa9\u7684 Tx \u639b\u9264\u3002 \u9019\u4e9b<code>Tx</code>\u639b\u9264\u5728 EVM \u72c0\u614b\u8f49\u63db\u5b8c\u6210\u4e26\u4e14\u4e0d\u6703\u5931\u6557\u5f8c\u9032\u884c\u8655\u7406\u3002 \u8acb\u6ce8\u610f\uff0cEVM \u6a21\u584a\u4e2d\u6c92\u6709\u5be6\u73fe\u9ed8\u8a8d\u639b\u9264\u3002</p> <pre><code>type EvmHooks interface {\n // Must be called after tx is processed successfully, if return an error, the whole transaction is reverted.\n PostTxProcessing(ctx sdk.Context, msg core.Message, receipt *ethtypes.Receipt) error\n}\n</code></pre>"},{"location":"evm/#posttxprocessing","title":"<code>PostTxProcessing</code>","text":"<p><code>PostTxProcessing</code> \u50c5\u5728 EVM \u4e8b\u52d9\u200b\u200b\u6210\u529f\u5b8c\u6210\u5f8c\u8abf\u7528\uff0c\u4e26\u5c07\u8abf\u7528\u59d4\u8a17\u7d66\u5e95\u5c64\u639b\u9264\u3002 \u5982\u679c\u6c92\u6709\u9264\u5b50\u88ab\u8a3b\u518a\uff0c\u9019\u500b\u51fd\u6578\u8fd4\u56de\u4e00\u500b<code>nil</code> \u932f\u8aa4\u3002 .</p> <pre><code>func (k *Keeper) PostTxProcessing(ctx sdk.Context, msg core.Message, receipt *ethtypes.Receipt) error {\n if k.hooks == nil {\n  return nil\n }\n return k.hooks.PostTxProcessing(k.Ctx(), msg, receipt)\n}\n</code></pre> <p>\u5b83\u8207 EVM \u4e8b\u52d9\u200b\u200b\u5728\u76f8\u540c\u7684\u7de9\u5b58\u4e0a\u4e0b\u6587\u4e2d\u57f7\u884c\uff0c\u5982\u679c\u5b83\u8fd4\u56de\u932f\u8aa4\uff0c\u6574\u500b EVM \u4e8b\u52d9\u200b\u200b\u5c07\u88ab\u9084\u539f\uff0c\u5982\u679c hook \u5be6\u73fe\u8005\u4e0d\u60f3\u9084\u539f tx\uff0c\u4ed6\u5011\u7e3d\u662f\u53ef\u4ee5\u8fd4\u56de <code>nil</code>\u3002</p> <p>\u9264\u5b50\u8fd4\u56de\u7684\u932f\u8aa4\u88ab\u8f49\u63db\u70ba VM \u932f\u8aa4<code>\u7121\u6cd5\u8655\u7406\u672c\u6a5f\u65e5\u8a8c</code>\uff0c\u8a73\u7d30\u7684\u932f\u8aa4\u6d88\u606f\u5b58\u5132\u5728\u8fd4\u56de\u503c\u4e2d\u3002 \u6d88\u606f\u7570\u6b65\u767c\u9001\u5230\u672c\u6a5f\u6a21\u584a\uff0c\u8abf\u7528\u8005\u7121\u6cd5\u6355\u7372\u548c\u6062\u5fa9\u932f\u8aa4\u3002</p> <p> \u7528\u4f8b\uff1a\u5728 Daodst \u4e0a\u8abf\u7528\u539f\u751f ERC20 \u6a21\u584a </p> <p>\u4ee5\u4e0b\u662f\u53d6\u81ea Daodst erc20 \u6a21\u584a \u7684\u793a\u4f8b\uff0c\u5c55\u793a\u4e86<code>EVMHooks</code>\u5982\u4f55\u652f\u6301\u8abf\u7528\u539f\u751f\u6a21\u584a\u4ee5\u5c07 ERC-20 \u4ee3\u5e63\u8f49\u63db\u70ba Cosmos \u539f\u751f\u4ee3\u5e63\u7684\u5408\u7d04\u3002 \u6309\u7167\u4e0a\u9762\u7684\u6b65\u9a5f\u3002</p> <p>\u60a8\u53ef\u4ee5\u50cf\u9019\u6a23\u5728\u667a\u80fd\u5408\u7d04\u4e2d\u5b9a\u7fa9\u4e26\u767c\u51fa\u4e00\u500b\u201cTransfer\u201d\u65e5\u8a8c\u7c3d\u540d\uff1a</p> <pre><code>event Transfer(address indexed from, address indexed to, uint256 value);\n\nfunction _transfer(address sender, address recipient, uint256 amount) internal virtual {\n  require(sender != address(0), \"ERC20: transfer from the zero address\");\n  require(recipient != address(0), \"ERC20: transfer to the zero address\");\n\n  _beforeTokenTransfer(sender, recipient, amount);\n\n  _balances[sender] = _balances[sender].sub(amount, \"ERC20: transfer amount exceeds balance\");\n  _balances[recipient] = _balances[recipient].add(amount);\n  emit Transfer(sender, recipient, amount);\n}\n</code></pre> <p>\u61c9\u7528\u7a0b\u5e8f\u5c07\u5411 <code>EvmKeeper</code> \u8a3b\u518a\u4e00\u500b <code>BankSendHook</code>\u3002 \u5b83\u8b58\u5225\u4ee5\u592a\u574a tx <code>Log</code> \u4e26\u5c07\u5176\u8f49\u63db\u70ba\u5c0d\u9280\u884c\u6a21\u584a\u7684 <code>SendCoinsFromAccountToAccount</code> \u65b9\u6cd5\u7684\u8abf\u7528\uff1a</p> <pre><code>\nconst ERC20EventTransfer = \"Transfer\"\n\n// PostTxProcessing implements EvmHooks.PostTxProcessing\nfunc (k Keeper) PostTxProcessing(\n ctx sdk.Context,\n msg core.Message,\n receipt *ethtypes.Receipt,\n) error {\n params := h.k.GetParams(ctx)\n if !params.EnableErc20 || !params.EnableEVMHook {\n  // no error is returned to allow for other post-processing txs\n  // to pass\n  return nil\n }\n\n erc20 := contracts.ERC20BurnableContract.ABI\n\n for i, log := range receipt.Logs {\n  if len(log.Topics) &lt; 3 {\n   continue\n  }\n\n  eventID := log.Topics[0] // event ID\n\n  event, err := erc20.EventByID(eventID)\n  if err != nil {\n   // invalid event for ERC20\n   continue\n  }\n\n  if event.Name != types.ERC20EventTransfer {\n   h.k.Logger(ctx).Info(\"emitted event\", \"name\", event.Name, \"signature\", event.Sig)\n   continue\n  }\n\n  transferEvent, err := erc20.Unpack(event.Name, log.Data)\n  if err != nil {\n   h.k.Logger(ctx).Error(\"failed to unpack transfer event\", \"error\", err.Error())\n   continue\n  }\n\n  if len(transferEvent) == 0 {\n   continue\n  }\n\n  tokens, ok := transferEvent[0].(*big.Int)\n  // safety check and ignore if amount not positive\n  if !ok || tokens == nil || tokens.Sign() != 1 {\n   continue\n  }\n\n  // check that the contract is a registered token pair\n  contractAddr := log.Address\n\n  id := h.k.GetERC20Map(ctx, contractAddr)\n\n  if len(id) == 0 {\n   // no token is registered for the caller contract\n   continue\n  }\n\n  pair, found := h.k.GetTokenPair(ctx, id)\n  if !found {\n   continue\n  }\n\n  // check that conversion for the pair is enabled\n  if !pair.Enabled {\n   // continue to allow transfers for the ERC20 in case the token pair is disabled\n   h.k.Logger(ctx).Debug(\n    \"ERC20 token -&gt; Cosmos coin conversion is disabled for pair\",\n    \"coin\", pair.Denom, \"contract\", pair.Erc20Address,\n   )\n   continue\n  }\n\n  // ignore as the burning always transfers to the zero address\n  to := common.BytesToAddress(log.Topics[2].Bytes())\n  if !bytes.Equal(to.Bytes(), types.ModuleAddress.Bytes()) {\n   continue\n  }\n\n  // check that the event is Burn from the ERC20Burnable interface\n  // NOTE: assume that if they are burning the token that has been registered as a pair, they want to mint a Cosmos coin\n\n  // create the corresponding sdk.Coin that is paired with ERC20\n  coins := sdk.Coins{{Denom: pair.Denom, Amount: sdk.NewIntFromBigInt(tokens)}}\n\n  // Mint the coin only if ERC20 is external\n  switch pair.ContractOwner {\n  case types.OWNER_MODULE:\n   _, err = h.k.CallEVM(ctx, erc20, types.ModuleAddress, contractAddr, true, \"burn\", tokens)\n  case types.OWNER_EXTERNAL:\n   err = h.k.bankKeeper.MintCoins(ctx, types.ModuleName, coins)\n  default:\n   err = types.ErrUndefinedOwner\n  }\n\n  if err != nil {\n   h.k.Logger(ctx).Debug(\n    \"failed to process EVM hook for ER20 -&gt; coin conversion\",\n    \"coin\", pair.Denom, \"contract\", pair.Erc20Address, \"error\", err.Error(),\n   )\n   continue\n  }\n\n  // Only need last 20 bytes from log.topics\n  from := common.BytesToAddress(log.Topics[1].Bytes())\n  recipient := sdk.AccAddress(from.Bytes())\n\n  // transfer the tokens from ModuleAccount to sender address\n  if err := h.k.bankKeeper.SendCoinsFromModuleToAccount(ctx, types.ModuleName, recipient, coins); err != nil {\n   h.k.Logger(ctx).Debug(\n    \"failed to process EVM hook for ER20 -&gt; coin conversion\",\n    \"tx-hash\", receipt.TxHash.Hex(), \"log-idx\", i,\n    \"coin\", pair.Denom, \"contract\", pair.Erc20Address, \"error\", err.Error(),\n   )\n   continue\n  }\n }\n\n return nil\n</code></pre> <p>\u6700\u5f8c\uff0c\u5728 app.go \u4e2d\u8a3b\u518a\u9264\u5b50\uff1a</p> <pre><code>app.EvmKeeper = app.EvmKeeper.SetHooks(app.Erc20Keeper)\n</code></pre>"},{"location":"evm/#_28","title":"\u4e8b\u4ef6","text":"<p><code>x/evm</code> \u6a21\u584a\u5728\u72c0\u614b\u57f7\u884c\u5f8c\u767c\u51fa Cosmos SDK \u4e8b\u4ef6\u3002 EVM \u6a21\u584a\u767c\u51fa\u76f8\u95dc\u4ea4\u6613\u5b57\u6bb5\u7684\u4e8b\u4ef6\uff0c\u4ee5\u53ca\u4ea4\u6613\u65e5\u8a8c\uff08\u4ee5\u592a\u574a\u4e8b\u4ef6\uff09\u3002</p>"},{"location":"evm/#msgethereumtx_2","title":"MsgEthereumTx","text":"\u7c7b\u578b \u5c5e\u6027 Key \u5c5e\u6027 Value ethereum_tx <code>\"amount\"</code> <code>{amount}</code> ethereum_tx <code>\"recipient\"</code> <code>{hex_address}</code> ethereum_tx <code>\"contract\"</code> <code>{hex_address}</code> ethereum_tx <code>\"txHash\"</code> <code>{tendermint_hex_hash}</code> ethereum_tx <code>\"ethereumTxHash\"</code> <code>{hex_hash}</code> ethereum_tx <code>\"txIndex\"</code> <code>{tx_index}</code> ethereum_tx <code>\"txGasUsed\"</code> <code>{gas_used}</code> tx_log <code>\"txLog\"</code> <code>{tx_log}</code> message <code>\"sender\"</code> <code>{eth_address}</code> message <code>\"action\"</code> <code>\"ethereum\"</code> message <code>\"module\"</code> <code>\"evm\"</code> <p>\u6b64\u5916\uff0cEVM \u6a21\u584a\u5728<code>EndBlock</code>\u671f\u9593\u70ba\u904e\u6ffe\u5668\u67e5\u8a62\u584a bloom \u767c\u51fa\u4e00\u500b\u4e8b\u4ef6\u3002</p>"},{"location":"evm/#abci_1","title":"ABCI","text":"\u985e\u578b \u5c6c\u6027 Key \u5c6c\u6027 Value block_bloom <code>\"bloom\"</code> <code>string(bloomBytes)</code>"},{"location":"evm/#_29","title":"\u53c3\u6578","text":"<p>evm \u6a21\u584a\u5305\u542b\u4ee5\u4e0b\u53c3\u6578\uff1a</p>"},{"location":"evm/#_30","title":"\u6a21\u584a\u53c3\u6578","text":"Key \u6578\u64da\u985e\u578b \u9ed8\u8a8d\u503c <code>EVMDenom</code> string <code>\"dst\"</code> <code>EnableCreate</code> bool <code>true</code> <code>EnableCall</code> bool <code>true</code> <code>ExtraEIPs</code> []int TBD <code>ChainConfig</code> ChainConfig See ChainConfig <p>:::\u63d0\u793a \u6ce8\u610f\uff1aSDK \u61c9\u7528\u60f3\u8981\u5c0e\u5165 EVM \u6a21\u584a\u4f5c\u70ba\u4f9d\u8cf4 \u5c07\u9700\u8981\u8a2d\u7f6e\u81ea\u5df1\u7684 <code>evm_denom</code>\uff08\u5373\u4e0d\u662f <code>\"dst\"</code>\uff09\u3002 :::</p>"},{"location":"evm/#enablecreate","title":"EnableCreate","text":"<p>EnableCreate \u53c3\u6578\u5207\u63db\u4f7f\u7528<code>vm.Create</code>\u51fd\u6578\u7684\u72c0\u614b\u8f49\u63db\u3002 \u7576\u7981\u7528\u8a72\u53c3\u6578\u6642\uff0c\u5b83\u5c07\u963b\u6b62\u6240\u6709\u5408\u7d04\u5275\u5efa\u529f\u80fd\u3002</p>"},{"location":"evm/#enablecall","title":"EnableCall","text":"<p>EnableCall \u53c3\u6578\u5207\u63db\u4f7f\u7528 <code>vm.Call</code> \u51fd\u6578\u7684\u72c0\u614b\u8f49\u63db\u3002 \u7576\u8a72\u53c3\u6578\u88ab\u7981\u7528\u6642\uff0c\u5b83\u5c07\u963b\u6b62\u8cec\u6236\u4e4b\u9593\u7684\u8f49\u8cec\u548c\u57f7\u884c\u667a\u80fd\u5408\u7d04\u8abf\u7528\u3002</p>"},{"location":"evm/#extra-eips","title":"Extra EIPs","text":"<p>\u984d\u5916\u7684 EIPs \u53c3\u6578\u5728\u61c9\u7528\u81ea\u5b9a\u7fa9\u8df3\u8f49\u8868\u7684\u4ee5\u592a\u574a VM <code>Config</code> \u4e0a\u5b9a\u7fa9\u4e86\u4e00\u7d44\u53ef\u6fc0\u6d3b\u7684\u4ee5\u592a\u574a\u6539\u9032\u5efa\u8b70 (EIPs)\u3002</p> <p>:::\u63d0\u793a \u6ce8\u610f: \u5176\u4e2d\u4e00\u4e9b EIP \u5df2\u7d93\u901a\u904e\u93c8\u914d\u7f6e\u555f\u7528\uff0c\u5177\u9ad4\u53d6\u6c7a\u65bc\u786c\u5206\u53c9\u6578\u91cf\u3002 :::</p> <p>\u652f\u6301\u7684\u53ef\u6fc0\u6d3b EIPS \u662f\uff1a</p> <ul> <li>EIP 1344</li> <li>EIP 1884</li> <li>EIP 2200</li> <li>EIP 2315</li> <li>EIP 2929</li> <li>EIP 3198</li> <li>EIP 3529</li> </ul>"},{"location":"evm/#chain-config","title":"Chain Config","text":"<p><code>ChainConfig</code> \u662f\u4e00\u7a2e protobuf \u5305\u88dd\u5668\u985e\u578b\uff0c\u5b83\u5305\u542b\u8207 go-ethereum <code>ChainConfig</code> \u53c3\u6578\u76f8\u540c\u7684\u5b57\u6bb5\uff0c\u4f46\u4f7f\u7528<code>*sdk.Int</code> \u985e\u578b\u800c\u4e0d\u662f<code>*big.Int</code>\u3002</p> <p>\u9ed8\u8a8d\u60c5\u6cc1\u4e0b\uff0c\u9664\u4e86<code>ConstantinopleBlock</code>\u4e4b\u5916\u7684\u6240\u6709\u584a\u914d\u7f6e\u5b57\u6bb5\u90fd\u5728\u5275\u4e16\u7d00\uff08\u9ad8\u5ea6 0\uff09\u555f\u7528\u3002</p>"},{"location":"evm/#chainconfig","title":"\u9ed8\u8ba4 ChainConfig","text":"\u540d\u79f0 \u9ed8\u8ba4\u503c HomesteadBlock 0 DAOForkBlock 0 DAOForkSupport <code>true</code> EIP150Block 0 EIP150Hash <code>0x0000000000000000000000000000000000000000000000000000000000000000</code> EIP155Block 0 EIP158Block 0 ByzantiumBlock 0 ConstantinopleBlock 0 PetersburgBlock 0 IstanbulBlock 0 MuirGlacierBlock 0 BerlinBlock 0 LondonBlock 0 ArrowGlacierBlock 0 GrayGlacierBlock 0 MergeNetsplitBlock 0 ShanghaiBlock 0 CancunBlock. 0"},{"location":"evm/#_31","title":"\u5ba2\u6236\u7aef","text":"<p>\u7528\u6236\u53ef\u4ee5\u4f7f\u7528 CLI\u3001JSON-RPC\u3001gRPC \u6216 REST \u67e5\u8a62 <code>evm</code> \u6a21\u584a\u4e26\u8207\u4e4b\u4ea4\u4e92\u3002</p>"},{"location":"evm/#cli","title":"CLI","text":"<p>\u5728\u4e0b\u9762\u627e\u5230\u4f7f\u7528 <code>x/evm</code> \u6a21\u584a\u6dfb\u52a0\u7684 <code>stcd</code> \u547d\u4ee4\u5217\u8868\u3002 \u60a8\u53ef\u4ee5\u4f7f\u7528 <code>stcd -h</code> \u547d\u4ee4\u7372\u53d6\u5b8c\u6574\u5217\u8868\u3002</p>"},{"location":"evm/#_32","title":"\u67e5\u8a62","text":"<p><code>query</code> \u547d\u4ee4\u5141\u8a31\u7528\u6236\u67e5\u8a62 <code>evm</code> \u72c0\u614b\u3002</p> <p><code>code</code></p> <p>\u5141\u8a31\u7528\u6236\u67e5\u8a62\u7d66\u5b9a\u5730\u5740\u7684\u667a\u80fd\u5408\u7d04\u4ee3\u78bc\u3002</p> <pre><code>stcd query evm code ADDRESS [flags]\n</code></pre> <pre><code># Example\n$ stcd query evm code 0x7bf7b17da59880d9bcca24915679668db75f9397\n\n# Output\ncode: \"0xef616c92f3cfc9e92dc270d6acff9cea213cecc7020a76ee4395af09bdceb4837a1ebdb5735e11e7d3adb6104e0c3ac55180b4ddf5e54d022cc5e8837f6a4f971b\"\n</code></pre> <p><code>storage</code></p> <p>\u5141\u8a31\u7528\u6236\u67e5\u8a62\u5177\u6709\u7d66\u5b9a\u9375\u548c\u9ad8\u5ea6\u7684\u5e33\u6236\u7684\u5b58\u5132\u3002</p> <pre><code>stcd query evm storage ADDRESS KEY [flags]\n</code></pre> <pre><code># Example\n$ stcd query evm storage 0x0f54f47bf9b8e317b214ccd6a7c3e38b893cd7f0 0 --height 0\n\n# Output\nvalue: \"0x0000000000000000000000000000000000000000000000000000000000000000\"\n</code></pre>"},{"location":"evm/#_33","title":"\u4ea4\u6613","text":"<p><code>tx</code> \u547d\u4ee4\u5141\u8a31\u7528\u6236\u8207 <code>evm</code> \u6a21\u584a\u9032\u884c\u4ea4\u4e92\u3002</p> <p><code>raw</code></p> <p>\u5141\u8a31\u7528\u6236\u5f9e\u539f\u59cb\u4ee5\u592a\u574a\u4ea4\u6613\u69cb\u5efa cosmos \u4ea4\u6613\u3002</p> <pre><code>stcd tx evm raw TX_HEX [flags]\n</code></pre> <pre><code># Example\n$ stcd tx evm raw 0xf9ff74c86aefeb5f6019d77280bbb44fb695b4d45cfe97e6eed7acd62905f4a85034d5c68ed25a2e7a8eeb9baf1b84\n\n# Output\nvalue: \"0x0000000000000000000000000000000000000000000000000000000000000000\"\n</code></pre>"},{"location":"evm/#grpc","title":"gRPC","text":""},{"location":"evm/#_34","title":"\u67e5\u8a62","text":"Verb Method \u8aaa\u660e <code>gRPC</code> <code>ethermint.evm.v1.Query/Account</code> \u7372\u53d6\u4ee5\u592a\u574a\u8cec\u6236 <code>gRPC</code> <code>ethermint.evm.v1.Query/CosmosAccount</code> \u7372\u53d6\u4ee5\u592a\u574a\u8cec\u6236\u7684 Cosmos \u5730\u5740 <code>gRPC</code> <code>ethermint.evm.v1.Query/ValidatorAccount</code> \u5f9e\u9a57\u8b49\u8005\u5171\u8b58\u5730\u5740\u7372\u53d6\u4ee5\u592a\u574a\u8cec\u6236 <code>gRPC</code> <code>ethermint.evm.v1.Query/Balance</code> \u7372\u53d6\u55ae\u500b EthAccount \u7684 EVM \u9762\u984d\u9918\u984d. <code>gRPC</code> <code>ethermint.evm.v1.Query/Storage</code> \u7372\u53d6\u55ae\u500b\u8cec\u6236\u6240\u6709\u5e63\u7684\u9918\u984d <code>gRPC</code> <code>ethermint.evm.v1.Query/Code</code> \u7372\u53d6\u55ae\u500b\u8cec\u6236\u6240\u6709\u5e63\u7684\u9918\u984d <code>gRPC</code> <code>ethermint.evm.v1.Query/Params</code> \u7372\u53d6x/evm\u6a21\u584a\u7684\u53c3\u6578 <code>gRPC</code> <code>ethermint.evm.v1.Query/EthCall</code> \u5be6\u73fe eth_call rpc api <code>gRPC</code> <code>ethermint.evm.v1.Query/EstimateGas</code> \u5be6\u73fe eth_estimateGas rpc api <code>gRPC</code> <code>ethermint.evm.v1.Query/TraceTx</code> \u5be6\u73fe debug_traceTransaction rpc api <code>gRPC</code> <code>ethermint.evm.v1.Query/TraceBlock</code> \u5be6\u73fe debug_traceBlockByNumber \u548c debug_traceBlockByHash rpc api <code>GET</code> <code>/ethermint/evm/v1/account/{address}</code> \u7372\u53d6\u4ee5\u592a\u574a\u8cec\u6236 <code>GET</code> <code>/ethermint/evm/v1/cosmos_account/{address}</code> \u7372\u53d6\u4ee5\u592a\u574a\u8cec\u6236\u7684 Cosmos \u5730\u5740 <code>GET</code> <code>/ethermint/evm/v1/validator_account/{cons_address}</code> \u5f9e\u9a57\u8b49\u8005\u5171\u8b58\u5730\u5740\u7372\u53d6\u4ee5\u592a\u574a\u8cec\u6236 <code>GET</code> <code>/ethermint/evm/v1/balances/{address}</code> \u7372\u53d6\u55ae\u500b EthAccount \u7684 EVM \u9762\u984d\u9918\u984d. <code>GET</code> <code>/ethermint/evm/v1/storage/{address}/{key}</code> \u7372\u53d6\u55ae\u500b\u8cec\u6236\u6240\u6709\u5e63\u7684\u9918\u984d <code>GET</code> <code>/ethermint/evm/v1/codes/{address}</code> \u7372\u53d6\u55ae\u500b\u8cec\u6236\u6240\u6709\u5e63\u7684\u9918\u984d <code>GET</code> <code>/ethermint/evm/v1/params</code> \u7372\u53d6x/evm\u6a21\u584a\u7684\u53c3\u6578 <code>GET</code> <code>/ethermint/evm/v1/eth_call</code> \u5be6\u73fe eth_call rpc api <code>GET</code> <code>/ethermint/evm/v1/estimate_gas</code> \u5be6\u73fe eth_estimateGas rpc api <code>GET</code> <code>/ethermint/evm/v1/trace_tx</code> \u5be6\u73fe debug_traceTransaction rpc api <code>GET</code> <code>/ethermint/evm/v1/trace_block</code> \u5be6\u73fe debug_traceBlockByNumber \u548c debug_traceBlockByHash rpc api"},{"location":"evm/#_35","title":"\u4ea4\u6613","text":"Verb Method \u8aaa\u660e <code>gRPC</code> <code>ethermint.evm.v1.Msg/EthereumTx</code> \u63d0\u4ea4\u4ee5\u592a\u574a\u4ea4\u6613 <code>POST</code> <code>/ethermint/evm/v1/ethereum_tx</code> \u63d0\u4ea4\u4ee5\u592a\u574a\u4ea4\u6613"},{"location":"faq/","title":"\u901a\u7528FAQ","text":"<p>\u67e5\u770b\u95dc\u65bc\u5728 DST \u4e0a\u7684\u5e38\u898b\u554f\u984c\u89e3\u7b54\u3002</p>"},{"location":"faq/#app","title":"APP","text":"APP\u67e5\u8a62\u6578\u64da\u70ba\u4f55\u6703\u9a57\u8b49\u5931\u6557? <p> APP\u7684\u9918\u984d\u67e5\u8a62\u548cTX\u7d50\u679c\u7684\u67e5\u8a62\u662f\u6709\u9632\u4f5c\u5f0a\u6821\u9a57\u6a5f\u5236\uff0c\u5982\u679c\u6821\u9a57\u7d50\u679c\u4e0d\u6b63\u78ba\uff0c\u5247\u6703\u9047\u5230\u6578\u64da\u67e5\u8a62\u6821\u9a57\u5931\u6557\u3002 </p> <p> APP\u555f\u52d5\u6642\u6703\u521d\u59cb\u5316\u9a57\u8b49\u7528\u6236\u7aef\uff0c\u5728\u53ef\u7528\u9598\u9053\u7bc0\u9ede\u88e1\u9762\u9078\u53d6\u9a57\u8b49\u7bc0\u9ede\u3002 \u7576\u67e5\u8a62\u9918\u984d\u548c\u67fb\u8a62TX\u72c0\u614b\u6642\uff0c\u67e5\u8a62\u7d50\u679c\u6703\u548c\u9a57\u8b49\u7bc0\u9ede\u9032\u884c\u6821\u9a57\uff0c\u5982\u679c\u6821\u9a57\u4e0d\u901a\u904e\u5247\u6703\u63d0\u793a\u932f\u8aa4</p>"},{"location":"faq/#_1","title":"\u7db2\u8def\u76f8\u95dc","text":"\u670d\u52d9\u5668\u9700\u8981\u958b\u653e\u54ea\u4e9b\u7aef\u53e3\u865f? <p> TCP\u958b\u653e\u7aef\u53e3\uff1a1317 , 8545 , 23478 , 26656 , 26657 , 28008 , 28043 , 50327 , 50328 </p> <p> UDP\u958b\u653e\u7aef\u53e3\uff1a3478, 50000~55000 </p> \u9598\u9053\u5730\u5740\u70ba\u4f55\u6703\u9a57\u8b49\u5931\u6557\uff1f \u5982\u4f55\u89e3\u51b3\uff1f <p> 1.\u9996\u5148\u89e3\u91cb\u4e0b\u70ba\u4ec0\u9ebc\u6703\u51fa\u73fe\u9598\u9053\u5730\u5740\u9a57\u8b49\u5931\u6557 </p> <p> \u7531\u65bc\u9598\u9053\u5730\u5740\u9700\u8981\u5c0d\u5916\u63d0\u4f9b\u670d\u52d9\uff0c\u9019\u5c31\u8981\u6c42\u9598\u9053\u5730\u5740\u5c0d\u5916\u5fc5\u9808\u662f\u958b\u653e\u7684\u3002 </p> <p> \u56d9\u6b64\uff0c\u5728\u8a2d\u5b9a\u9598\u9053\u5730\u5740\u6642\uff0c\u6703\u901a\u904e\u4e92\u806f\u7db2\u53bb\u6e2c\u8a66\u5730\u5740\u7684\u9023\u901a\u6027\u3002 \u7576\u8acb\u6c42\u767c\u9001\u5931\u6557\u6216\u8005\u8acb\u6c42\u7d50\u679c\u4e0d\u6b63\u78ba\u6642\uff0c\u5c31\u6703\u62cb\u51fa\u9598\u9053\u5730\u5740\u9a57\u8b49\u5931\u6557\u7684\u932f\u8aa4\u3002 </p> <p> 2.\u5982\u4f55\u89e3\u51b3\u9598\u9053\u5730\u5740\u9a57\u8b49\u5931\u6557\u7684\u554f\u984c </p> <p> \u9598\u9053\u5730\u5740\u9a57\u8b49\u5931\u6557\u672c\u8cea\u4e0a\u9084\u662f\u7db2\u7d61\u8a2a\u554f\u4e0d\u901a\uff0c\u8981\u5f9e\u7db2\u8def\u5c64\u4f86\u89e3\u51b3\u3002 \u89e3\u51b3\u9700\u8981\u4e00\u5b9a\u7684\u52d5\u624b\u80fd\u529b\uff0c\u5982\u679c\u6709\u56f0\u96e3\u5efa\u8b70\u5c0b\u627e\u5c0f\u5925\u4f34\u4f86\u5e6b\u52a9\u3002 <ul> <li>\u9996\u5148\u6aa2\u67e5\u8def\u7531\u5668\u8a2d\u5b9a\u662f\u5426\u6b63\u78ba\uff0c\u662f\u5426\u6b63\u78ba\u8a2d\u5b9a\u4e86\u57e0\u6620\u5c04\uff08\u9700\u8981\u6620\u5c04\u7684\u57e0\u865f\u6e05\u55ae\u53c3\u6537\u7576\u524d\u9801\u9762\u7684\u4ecb\u7d39\uff09</li> <li>\u5982\u679c\u9084\u672a\u89e3\u51b3\uff0c\u53ef\u4ee5\u6aa2\u67e5\u670d\u52d9\u5668\u7684\u9632\u706b\u7246\u662f\u5426\u555f\u7528\uff0c\u5982\u679c\u5df2\u555f\u52d5\u8acb\u6aa2\u67e5\u9700\u8981\u958b\u653e\u7684\u57e0\u6e05\u55ae\u662f\u5426\u90fd\u5df2\u7d93\u958b\u653e\u4e86.</li> <li>\u5982\u679c\u9084\u672a\u89e3\u51b3\uff0c\u53ef\u4ee5\u806f\u7cfb\u7576\u524d\u7684\u7db2\u7d61\u4f9b\u61c9\u5546\uff0c\u5411\u5176\u8aaa\u660e\u9700\u8981\u958b\u653e\u7684\u57e0\u6e05\u55ae\uff0c\u8b93\u5176\u5e6b\u52a9\u89e3\u6c7a.</li>"},{"location":"gateway/","title":"\u7db2\u95dc","text":"<p>\u6b64\u6a21\u584a\u8ca0\u8cac\u7db2\u95dc\u93c8\u4e0a\u6578\u64da\u7684\u7ba1\u7406</p> <pre><code>chat/\n\u251c\u2500\u2500 client\n\u2502   \u2514\u2500\u2500 rest\n\u2502        \u251c\u2500\u2500 error.go          # \u4ecb\u9762\u932f\u8aa4\u96c6\n\u2502        \u251c\u2500\u2500 grpc.go           # grpc\u67fb\u8a62\u65b9\u6cd5\n\u2502        \u251c\u2500\u2500 handle_comm.go    # comm\u6a21\u584a\u6d88\u606f\u524d\u7f6e\u8655\u7406\n\u2502        \u251c\u2500\u2500 handle_msg.go    # comm\u6a21\u584a\u6d88\u606f\u524d\u7f6e\u8655\u7406\n\u2502        \u251c\u2500\u2500 query.go          # \u4ecb\u9762\u67fb\u8a62\u51fd\u6578\n\u2502        \u251c\u2500\u2500 rest.go           # \u6d88\u606f\u8207\u67fb\u8a62\u8def\u7531\u7684\u6ce8\u518c\n\u2502        \u2514\u2500\u2500 tx.go             # tx\u76f8\u95dc\u65b9\u6cd5\uff0c\u5305\u62ec\u5ee3\u64ad\u7b49\n\u251c\u2500\u2500 keeper\n\u2502   \u251c\u2500\u2500 hooks.go          # \u9264\u5b50\u51fd\u6578\uff0c\u88ab\u5176\u4ed6\u6a21\u584a\u908f\u8f2f\u89f8\u767c\n\u2502   \u251c\u2500\u2500 keeper.go         # \u5b58\u5132\u7ba1\u7406\u5668\uff0c\u8655\u7406\u6a21\u584a\u7684\u696d\u52d9\u908f\u8f2f\uff0c\u4e26\u6709\u8a31\u53ef\u6b0a\u8a2a\u554f\u72c0\u614b\u6a39\u7684\u7279\u5b9a\u5b50\u6a39\n\u2502   \u251c\u2500\u2500 msg_server.go     # \u63d0\u4f9b\u4e0a\u93c8\u6d88\u606f\u7684\u670d\u52d9\u8655\u7406\u908f\u8f2f\n\u2502   \u251c\u2500\u2500 params.go         # \u6a21\u584a\u53c3\u6578\u7684\u8a2d\u5b9a\u548c\u7372\u53d6\n\u2502   \u251c\u2500\u2500 query.go          # \u72c0\u614b\u67fb\u8a62\u51fd\u6578\n\u251c\u2500\u2500 types\n\u2502\u00a0\u00a0 \u251c\u2500\u2500 codec.go          # \u7de8\u78bc\u6ce8\u518c\u985e\u578b\n\u2502\u00a0\u00a0 \u251c\u2500\u2500 errors.go         # \u6a21\u584a\u7279\u5b9a\u7684\u932f\u8aa4\n\u2502\u00a0\u00a0 \u251c\u2500\u2500 events.go         # \u5411Tendermint PubSub/Websocket\u66b4\u9732\u7684\u4e8b\u4ef6\n\u2502\u00a0\u00a0 \u251c\u2500\u2500 genesis.go        # \u6a21\u584a\u7684\u5275\u4e16\u72c0\u614b\n\u2502\u00a0\u00a0 \u251c\u2500\u2500 interface.go      # \u6a21\u584a\u7684\u4ecb\u9762\u96c6\u5408\n\u2502\u00a0\u00a0 \u251c\u2500\u2500 keys.go           # \u6a21\u584a\u5b58\u5132key\u4ee5\u53ca\u4e00\u4e9b\u5176\u4ed6\u7684\u5e38\u6578\n\u2502\u00a0\u00a0 \u251c\u2500\u2500 msg.go            # \u804a\u5929\u6a21\u584a\u4ea4\u6613\u6d88\u606f\n\u2502\u00a0\u00a0 \u251c\u2500\u2500 params.go         # \u6a21\u584a\u53ef\u4ee5\u901a\u904e\u6cbb\u7406\u6a21\u584a\u4fee\u6539\u7684\u81ea\u5b9a\u7fa9\u53c3\u6578\n\u2502\u00a0\u00a0 \u251c\u2500\u2500 interface.go      # \u5f15\u5165\u7684\u5916\u90e8\u6a21\u5757\u5b9e\u73b0\u7684\u65b9\u6cd5\n\u2502\u00a0\u00a0 \u2514\u2500\u2500 types.go          # \u6a21\u584a\u7684\u985e\u578b\u96c6\u5408\n\u251c\u2500\u2500 genesis.go            # ABCI\u7684\u5275\u4e16\u72c0\u614b\u521d\u59cb\u5316\u548c\u532f\u51fa\u529f\u80fd\n\u251c\u2500\u2500 handler.go            # \u6d88\u606f\u8def\u7531\n\u2514\u2500\u2500 module.go             # \u6a21\u584a\u7ba1\u7406\u5668\u7684\u6a21\u584a\u8a2d\u5b9a\n</code></pre>"},{"location":"gateway/#_1","title":"\u76ee\u5f55","text":""},{"location":"gateway/#_2","title":"\u7db2\u95dc","text":"<p>gateway\u6a21\u584a\u8ca0\u8cac\u7db2\u95dc\u93c8\u4e0a\u6578\u64da\u7684\u7ba1\u7406,\u5305\u62ec\u865f\u78bc\u6bb5\u7684\u6b78\u5c6c\uff0c\u7372\u5f97\u7b49</p>"},{"location":"gateway/#_3","title":"\u7db2\u95dc\u4fe1\u606f","text":"<p>\u7db2\u95dc\u8a3b\u518a\u9700\u8981\u586b\u5beb\u7db2\u95dc\u7684\u540d\u7a31\u3001\u7db2\u95dc\u901a\u8a0a\u5730\u5740\u3001APP\u6253\u5305\u7684\u540d\u7a31\u53ca\u9996\u500b\u865f\u78bc\u6bb5\u4fe1\u606f\u3002\u7db2\u95dc\u901a\u8a0a\u5730\u5740\u652f\u6301IP\u53ca\u57df\u540d\uff0c\u9700\u8981\u7d81\u5b9a50327\u901a\u8a0a\u7aef\u53e3\u3002 APP\u5305\u540d\u9700\u8981\u4ee5\u5c0f\u5beb\u5b57\u6bcd\u958b\u982d\u9032\u884c\u547d\u540d\uff0c\u9577\u5ea6\u4e0d\u53ef\u8d85\u904e32\u4f4d\u3002 \u7db2\u95dc\u4e0d\u53ef\u4ee5\u91cd\u8907\u8a3b\u518a\uff0c\u6bcf\u500bDPOS\u7bc0\u9ede\u53ea\u80fd\u8a3b\u518a\u4e00\u500b\u7db2\u95dc\u3002\u7db2\u95dc\u4fe1\u606f\u652f\u6301\u4fee\u6539\u540d\u7a31\u548c\u7db2\u95dc\u901a\u8a0a\u5730\u5740\u3002 \ud83d\udea8 \u5371\u96aa: \u4e00\u65e6\u4fee\u6539\u7db2\u95dc\u901a\u8a0a\u5730\u5740\u5f8c\uff0c\u7db2\u95dc\u7684\u804a\u5929\u4fe1\u606f\u5c07\u6703\u88ab\u91cd\u7f6e\uff0c\u8acb\u8b39\u614e\u64cd\u4f5c\u3002</p>"},{"location":"gateway/#_4","title":"\u865f\u78bc\u6bb5","text":"<p>\u9996\u6b21\u8a3b\u518a\u7db2\u95dc\u5fc5\u9808\u586b\u5beb\u4e00\u500b\u865f\u78bc\u6bb5\uff0c\u8a72\u865f\u78bc\u6bb5\u6703\u6a19\u8a18\u70ba\u7db2\u95dc\u7684\u9996\u500b\u865f\u78bc\u6bb5\u4f5c\u70ba\u901a\u8a0a\u57df\u540d\u4f7f\u7528\u3002 \u865f\u78bc\u6bb5\u9577\u5ea6\u53ef\u4ee5\u70ba5\u30016\u30017\uff0c\u7576\u7db2\u95dc\u865f\u78bc\u6bb5\u984d\u5ea6\u8db3\u5920\u6642\uff0c\u652f\u6301\u6dfb\u52a0\u591a\u500b\u865f\u78bc\u6bb5\u3002 \u865f\u78bc\u6bb5\u5206\u70ba\u4e09\u7a2e\u72c0\u614b :\u7d81\u5b9a\u4e2d\u3001\u8d16\u56de\u4e2d\u3001\u548c\u5df2\u89e3\u7d81\u3002\u5df2\u7d81\u5b9a\u548c\u8d16\u56de\u4e2d\u7684\u865f\u78bc\u6bb5\u4e0d\u80fd\u88ab\u5176\u4ed6\u7db2\u95dc\u6240\u4f7f\u7528\uff0c\u8d16\u56de\u4e2d\u7684\u865f\u78bc\u6bb5\u9ed8\u8a8d\u4e00\u5e74\u7684\u4fdd\u8b77\u671f\uff0c\u7576\u7db2\u95dc\u6240\u6709\u8005\u518d\u6b21\u8cea\u62bc\u5f8c\uff0c\u53ef\u4ee5\u518d\u6b21\u9078\u64c7\u8a72\u865f\u78bc\u6bb5\u4e26\u9032\u884c\u7d81\u5b9a\u3002 \u5df2\u89e3\u7d81\u7684\u865f\u78bc\u6bb5\u53ef\u4ee5\u88ab\u6240\u6709\u7db2\u95dc\u518d\u6b21\u4f7f\u7528\u3002</p>"},{"location":"gateway/#_5","title":"\u7db2\u95dc\u8cea\u62bc\u8207\u8d16\u56de","text":"<p>\u9ed8\u8a8d\u6bcf\u8cea\u62bc10\u500bFM\u53ef\u4ee5\u7372\u5f97\u4e00\u500b\u7db2\u95dc\u865f\u78bc\u6bb5\u984d\u5ea6\u3002 \u7576\u7db2\u95dc\u6240\u6709\u8005\u9032\u884cDPOS\u8d16\u56de\u6642\uff0c\u5c0d\u61c9\u6bcf\u8d16\u56de10\u500bFM\u5c31\u8981\u5c0d\u61c9\u8d16\u56de\u4e00\u500b\u865f\u78bc\u6bb5\u6216\u6e1b\u5c11\u5c0d\u61c9\u865f\u78bc\u6bb5\u7684\u984d\u5ea6\u3002 \u7576\u90e8\u5206\u8d16\u56de\u6642\uff0c\u9996\u500b\u865f\u78bc\u6bb5\u4e0d\u5141\u8a31\u8d16\u56de\uff0c\u53ea\u80fd\u9078\u64c7\u5176\u4ed6\u865f\u78bc\u6bb5\u3002\u5982\u679c\u662f\u8cea\u62bc\u5168\u90e8\u8d16\u56de\uff0c\u5247\u8d16\u56de\u6240\u6709\u865f\u78bc\u6bb5\u3002 \u5168\u90e8\u8cea\u62bc\u8d16\u56de\u5f8c\uff0c\u7db2\u95dc\u72c0\u614b\u8b8a\u70ba\u4e0d\u53ef\u7528\u72c0\u614b\u3002</p>"},{"location":"gateway/#_6","title":"\u529f\u80fd","text":"<p>\u5408\u7d04\u6a21\u584a<code>Keeper</code>\u6388\u4e88\u5c0d\u804a\u5929\u6a21\u584a\u72c0\u614b\u7684\u5b58\u53d6\u6b0a\u9650\u4e26\u5be6\u73fe<code>statedb</code>\uff0c\u4ee5\u652f\u6301<code>StateDB</code>\u5be6\u73fe\u3002 Keeper\u5305\u542b\u4e00\u500b\u5141\u8a31\u8cc7\u6599\u5eab\u7684\u5b58\u5132\u9375\u5beb\u5165\u53ea\u80fd\u7531Chat\u6a21\u584a\u8a2a\u554f\u7684\u591a\u5eab\u7684\u5177\u9ad4\u5b50\u6a39\u3002 \u800c\u4e0d\u662f\u4f7f\u7528\u6a39\u548c\u8cc7\u6599\u5eab\u9032\u884c\u67fb\u8a62\u548c\u6301\u4e45\u5316\uff08<code>StateDB</code>\u5be6\u73fe\uff09\uff0cDaoDst\u4f7f\u7528Cosmos\u7684<code>KVStore</code>\uff08\u9375\u503c\u5b58\u5132\uff09\u548cCosmos SDK\u7684<code>Keeper</code>\u4f86\u4fc3\u9032\u72c0\u614b\u8f49\u63db\u3002</p> <p>\u70ba\u4e86\u652f\u6301\u4ecb\u9762\u529f\u80fd\uff0c\u5b83\u5c0e\u5165\u4e867\u500b\u6a21\u584aKeepers:</p> <ul> <li><code>auth</code>: \u5e33\u865f\u7684\u589e\u522a\u6539\u67e5</li> <li><code>bank</code>: \u4f9b\u61c9\u91cf\u548c\u9918\u984d\u7684\u589e\u522a\u6539\u67e5</li> <li><code>staking</code>: \u9598\u9053\u76f8\u95dc\u8cc7\u6599\u7684\u7ba1\u7406</li> <li><code>pledge</code>: \u804a\u5929\u76f8\u95dc\u6578\u64da\u7684\u7ba1\u7406</li> <li><code>evm</code>: evm\u76f8\u95dc\u6578\u64da\u7684\u7ba1\u7406</li> <li><code>chat</code>: \u804a\u5929\u76f8\u95dc\u8cc7\u6599\u7684\u7ba1\u7406</li> <li><code>gateway</code>: \u9598\u9053\u8cc7\u6599\u7ba1\u7406</li> </ul> <pre><code>    type Keeper struct {\n        storeKey   sdk.StoreKey\n        cdc        codec.BinaryCodec\n        paramstore paramtypes.Subspace\n\n        stakingKeeper *stakingKeeper.Keeper\n        accountKeeper types.AccountKeeper\n        BankKeeper    types.BankKeeper\n        pledgeKeeper  types.PledgeKeeper\n        evmKeeper     types.EVMKeeper\n        chatKeeper    types.ChatKeeper\n        gatewayKeeper types.GatewayKeeper\n        erc20Keeper   erc20keeper.Keeper\n    }\n</code></pre>"},{"location":"gateway/#_7","title":"\u6d88\u606f","text":""},{"location":"gateway/#msgapptokenissue","title":"MsgAppTokenIssue","text":"<pre><code>\u901a\u904e\u6b64\u6d88\u606f\uff0c\u5099\u4efd\u7db2\u95dc\u7684\u9a57\u8b49\u5668\u5bc6\u9470\u7b49\u4fe1\u606f\n</code></pre> <pre><code>    type MsgGatewayUpload struct {\n        FromAddress    string `protobuf:\"bytes,1,opt,name=fromAddress,proto3\" json:\"fromAddress,omitempty\" yaml:\"from_address\"`\n        GatewayKeyInfo []byte `protobuf:\"bytes,2,opt,name=GatewayKeyInfo,proto3\" json:\"GatewayKeyInfo,omitempty\" yaml:\"gateway_key_info\"`\n    }\n</code></pre>"},{"location":"gateway/#msggatewayregister","title":"MsgGatewayRegister","text":"<pre><code>\u901a\u904e\u6b64\u6d88\u606f\uff0c\u8a3b\u518a\u6210\u70ba\u7db2\u95dc\uff0c\u4e26\u7372\u5f97did\u865f\u6bb5\n</code></pre> <pre><code>    type MsgGatewayRegister struct {\n        Address string `protobuf:\"bytes,1,opt,name=address,proto3\" json:\"address,omitempty\"`\n        GatewayName string `protobuf:\"bytes,2,opt,name=gateway_name,json=gatewayName,proto3\" json:\"gateway_name,omitempty\"`\n        GatewayUrl string `protobuf:\"bytes,3,opt,name=gateway_url,json=gatewayUrl,proto3\" json:\"gateway_url,omitempty\"`\n        Delegation string `protobuf:\"bytes,4,opt,name=delegation,proto3\" json:\"delegation,omitempty\"`\n        IndexNumber []string `protobuf:\"bytes,5,rep,name=index_number,json=indexNumber,proto3\" json:\"index_number,omitempty\"`\n    }\n</code></pre>"},{"location":"gateway/#msggatewayindexnum","title":"MsgGatewayIndexNum","text":"<pre><code>\u901a\u904e\u6b64\u6d88\u606f\uff0c\u7db2\u95dc\u53ef\u4ee5\u901a\u904e\u8cea\u62bc\u7372\u53d6\u984d\u5916\u7684did\u865f\u78bc\u6bb5\n</code></pre> <pre><code>    type MsgGatewayIndexNum struct {\n        DelegatorAddress string `protobuf:\"bytes,1,opt,name=delegator_address,json=delegatorAddress,proto3\" json:\"delegator_address,omitempty\" yaml:\"delegator_address\"`\n        ValidatorAddress string `protobuf:\"bytes,2,opt,name=validator_address,json=validatorAddress,proto3\" json:\"validator_address,omitempty\" yaml:\"validator_address\"`\n        IndexNumber []string `protobuf:\"bytes,3,rep,name=index_number,json=indexNumber,proto3\" json:\"index_number,omitempty\"`\n    }\n</code></pre>"},{"location":"gateway/#msggatewayundelegate","title":"MsgGatewayUndelegate","text":"<pre><code>\u901a\u904e\u6b64\u6d88\u606f\uff0c\u7db2\u95dc\u53ef\u4ee5\u8d16\u56de\u8cea\u62bc\n</code></pre> <pre><code>    type MsgGatewayUndelegate struct {\n        DelegatorAddress string      `protobuf:\"bytes,1,opt,name=delegator_address,json=delegatorAddress,proto3\" json:\"delegator_address,omitempty\" yaml:\"delegator_address\"`\n        ValidatorAddress string      `protobuf:\"bytes,2,opt,name=validator_address,json=validatorAddress,proto3\" json:\"validator_address,omitempty\" yaml:\"validator_address\"`\n        Amount           types1.Coin `protobuf:\"bytes,3,opt,name=amount,proto3\" json:\"amount\"`\n        IndexNumber []string `protobuf:\"bytes,4,rep,name=index_number,json=indexNumber,proto3\" json:\"index_number,omitempty\"`\n    }\n</code></pre>"},{"location":"gateway/#_8","title":"\u53c3\u6578","text":"<p>gateway\u6a21\u584a\u5305\u542b\u5982\u4e0b\u6a21\u584a\u53c3\u6578</p>"},{"location":"gateway/#_9","title":"\u53c3\u6578","text":"Key \u985e\u578b \u9810\u8a2d\u503c <code>IndexNumHeight</code> int64 <code>100</code> <code>RedeemFeeHeight</code> int64 <code>432000</code> <code>RedeemFee</code> github_com_cosmos_cosmos_sdk_types.Dec <code>0.1</code> <code>MinDelegate</code> github_com_cosmos_cosmos_sdk_types.Coin <code>10000000000000000000000fm</code> <code>Validity</code> int64 <code>5256000</code>"},{"location":"modules_accounts/","title":"\u6a21\u584a\u8cec\u865f","text":"<p>\u4e00\u4e9b\u6a21\u584a\u6709\u81ea\u5df1\u7684\u6a21\u584a\u5e33\u6236\u3002\u5c07\u5176\u8996\u70ba\u53ea\u80fd\u7531\u8a72\u6a21\u584a\u63a7\u5236\u7684\u9322\u5305\u3002 \u4e0b\u9762\u662f\u4e00\u500b\u6a21\u584a\u8868\uff0c\u5b83\u5011\u5404\u81ea\u7684\u9322\u5305\u5730\u5740\u548c\u6b0a\u9650\uff1a</p>"},{"location":"modules_accounts/#_2","title":"\u6a21\u584a\u5e33\u6236\u5217\u8868","text":"Name Address Permissions <code>claims</code> dst15cvq3ljql6utxseh0zau9m8ve2j8erz89m5wkz <code>none</code> <code>erc20</code> dst1glht96kr2rseywuvhhay894qw7ekuc4qg9z5nw <code>minter</code> <code>burner</code> <code>fee_collector</code> dst17xpfvakm2amg962yls6f84z3kell8c5ljcjw34 <code>none</code> <code>incentives</code> dst1krxwf5e308jmclyhfd9u92kp369l083wn67k4q <code>minter</code> <code>burner</code> <code>inflation</code> dst1d4e35hk3gk4k6t5gh02dcm923z8ck86qygxf38 <code>minter</code> <code>transfer</code> dst1yl6hdjhmkf37639730gffanpzndzdpmhv788dt <code>minter</code> <code>burner</code> <code>bonded_tokens_pool</code> dst1fl48vsnmsdzcv85q5d2q4z5ajdha8yu3h6cprl <code>burner</code> <code>staking</code> <code>not_bonded_tokens_pool</code> dst1tygms3xhhs3yv487phx3dw4a95jn7t7lr6ys4t <code>burner</code> <code>staking</code> <code>gov</code> dst10d07y265gmmuvt4z0w9aw880jnsr700jcrztvm <code>burner</code> <code>distribution</code> dst1jv65s3grqf6v6jl3dp4t6c9t9rk99cd8974jnh] <code>none</code> <code>evm</code> dst1vqu8rska6swzdmnhf90zuv0xmelej4lq0n56wq <code>minter</code> <code>burner</code> <code>ibc</code> dst1a53udazy8ayufvy0s434pfwjcedzqv345dnt3x <code>minter</code> <code>burner</code> <code>chat</code> dst1x8sx7lvfl6ue5rnvptl7rxr53samt0h4zxqkwg <code>minter</code> <code>burner</code> <code>chat_burn</code> dst1g7z9fjg8zyrj68a6rtqkfgldvjjjc3n7sucath <code>burner</code> <code>gateway</code> dst1f6j7u6875p2cvyrgjr0d2uecyzah0kgexwhr3g <code>none</code> <code>pledge</code> dst1nhta6gsf9x9l2pd2m5qg6lya0h3m0pjy4vtd35 <code>minter</code> <code>burner</code> <code>contract</code> dst1ejpjr43ht3y56pplm5pxpusmcrk9rkkvevc88d <code>none</code> <code>stakeContractDeploy</code> dst16vxjegtg3k5fvqcc55yd6cele9hx0nhv3lxzf0 <code>none</code> <code>tokenFactoryContractDeploy</code> dst10dkh3rvhgcj2vj4h36msncnkr5ps668x9uuva0 <code>none</code>"},{"location":"modules_accounts/#_3","title":"\u8cec\u6236\u6b0a\u9650","text":"<ul> <li><code>burner</code> \u6b0a\u9650\u662f\u6307\u8a72\u8cec\u6236\u5177\u6709\u92b7\u6bc0\u6216\u92b7\u6bc0\u4ee3\u5e63\u7684\u6b0a\u9650\u3002</li> <li><code>minter</code> \u6b0a\u9650\u8868\u793a\u6b64\u5e33\u6236\u6709\u6b0a\u9444\u9020\u6216\u5275\u5efa\u65b0\u4ee3\u5e63\u3002</li> <li><code>staking</code> \u6b0a\u9650\u610f\u5473\u8457\u8a72\u8cec\u6236\u6709\u6b0a\u4ee3\u8868\u5176\u6240\u6709\u8005\u6301\u6709\u4ee3\u5e63\u3002</li> </ul>"},{"location":"modules_accounts/#ibc","title":"IBC \u6a21\u584a\u5e33\u6236","text":"<p>\u6b64\u5916\uff0c\u9084\u6709\u8207 IBC \u8f49\u8cec\u76f8\u95dc\u806f\u7684\u6a21\u584a\u5e33\u6236\u3002 \u5c0d\u65bc\u6bcf\u500b IBC \u9023\u63a5\uff0c\u90fd\u6709\u4e00\u500b\u985e\u578b\u70ba<code>ModuleAccount</code>\u7684\u8cec\u6236\uff0c\u7528\u65bc\u5728 Daodst \u662f\u6e90\u93c8\u6642\u8a17\u7ba1\u8f49\u79fb\u7684\u786c\u5e63\u3002 \u4ed6\u5011\u7684\u5730\u5740\u662f\u4f7f\u7528\u5e33\u6236\u540d\u7a31\u7684 SHA256 \u6821\u9a57\u548c\u7684\u524d 20 \u500b\u5b57\u7bc0\u6d3e\u751f\u7684\uff0c\u4e26\u9075\u5faa ADR 028:</p> <pre><code>// accountName is composed by the current version the IBC tranfer module supports (in this case, ics20-1), the portID (transfer) and the channelID\naccountName := Version + \"\\0\" + portID + \"/\" + channelID\naddr := sha256.Sum256(accountName)[:20]\n\n// example for channel-0\naddr := sha256.Sum256(\"ics20-1\\0transfer/channel-0\")[:20]\n</code></pre> <p>\u9019\u53ef\u4ee5\u4f7f\u7528 IBC-go \u4e0a\u7684 <code>GetEscrowAccount</code> \u51fd\u6578.</p> <p>\ud83d\udce3 \u63d0\u793a :  \u57f7\u884c\u67e5\u8a62\u6642\u672a\u5217\u51fa\u9019\u4e9b\u8a17\u7ba1\u5e33\u6236\uff1a</p> <pre><code>stcd q auth module-accounts\n</code></pre> <p>\u767c\u751f\u9019\u7a2e\u60c5\u6cc1\u662f\u56e0\u70ba\u67e5\u8a62\u4e2d\u4f7f\u7528\u7684 <code>GetModuleAccount</code> \u51fd\u6578 \u50c5\u8003\u616e<code>AccountKeeper</code> \u7684<code>permAddrs</code> \u5730\u5716\u4e0a\u7684\u5e33\u6236\u3002</p> <p>\u6b64\u5730\u5740\u6620\u5c04\u5728\u7de8\u8b6f\u6642\u8a2d\u7f6e\uff0c\u7121\u6cd5\u5728\u904b\u884c\u6642\u66f4\u6539\u3002</p>"},{"location":"pc/","title":"PC\u7aef\u4f7f\u7528\u8aaa\u660e","text":""},{"location":"pc/#_1","title":"\u5b89\u88dd","text":"<pre><code>\u6253\u958b\u5b89\u88dd\u5305\uff0c\u8df3\u51fa\u5982\u4e0b\u4ecb\u9762\uff0c\u9ede\u64ca\u78ba\u5b9a\uff08\u90e8\u5206\u6bba\u6bd2\u8edf\u9ad4\u6703\u8aa4\u5831\uff09\n</code></pre> <pre><code>\u9078\u64c7\u5b89\u88dd\u76ee\u9304\uff08\u5efa\u8b70\u5927\u65bc1TB\uff09\n</code></pre> <pre><code>\u8010\u5fc3\u7b49\u5f85\u5b89\u88dd\u5b8c\u6210\n</code></pre>"},{"location":"pc/#_2","title":"\u6d41\u7a0b","text":"<pre><code>\u65b0\u5efa\u6216\u5c0e\u5165\u9322\u5305\u5730\u5740--&gt;\u5275\u5efadpos --&gt;\u5275\u5efa\u9598\u9053--&gt;\u8cea\u62bcFM --&gt;\u9818\u53d6\u734e\u52f5\n</code></pre>"},{"location":"pc/#_3","title":"\u65b0\u5efa\u9322\u5305","text":""},{"location":"pc/#_4","title":"\u5c0e\u5165\u9322\u5305","text":""},{"location":"pc/#dpos","title":"\u5275\u5efadpos","text":""},{"location":"pc/#_5","title":"\u7533\u8acb\u7db2\u95dc","text":""},{"location":"pc/#fm","title":"\u8cea\u62bcFM","text":""},{"location":"pc/#_6","title":"\u9818\u53d6\u734e\u52f5","text":""},{"location":"pc/#_7","title":"\u9996\u9801","text":"<pre><code>\u9996\u9801\u5305\u542b\u4e86\u4e00\u4e9b\u5168\u5c40\u6027\u7684\u67e5\u770b\u8207\u529f\u80fd\n\u5176\u4e2d\u5305\u62ec\uff1a\n\n\u67e5\u770b\u5340\u584a\u540c\u6b65\u60c5\u6cc1 \uff08\u4ecb\u9762\u53f3\u4e0a\u65b9\uff09\n</code></pre> <pre><code>\u67e5\u770b\u4efb\u52d9\u72c0\u614b\uff08\u4ecb\u9762\u53f3\u4e0a\u65b9\uff09\n</code></pre> <pre><code>\u7ba1\u7406\u8edf\u4ef6\u8a2d\u7f6e \uff08\u4ecb\u9762\u5de6\u4e0b\u89d2\uff09\n</code></pre>"},{"location":"pc/#_8","title":"\u64cd\u4f5c","text":"<pre><code>\u53f3\u4e0a\u89d2\u7684\u64cd\u4f5c\u53ef\u4ee5\u7ba1\u7406DID\u548c\u4fee\u6539\u7db2\u95dc\u4fe1\u606f\n</code></pre>"},{"location":"pc/#did","title":"DID\u6bb5\u7ba1\u7406","text":"<pre><code>\u53ef\u4ee5\u901a\u904e\u8cea\u62bcFM\u7684\u65b9\u5f0f\u7372\u53d6\u66f4\u591a\u7684DID\u865f\u6bb5\n</code></pre> <pre><code>\u9996\u9801\u5de6\u5074\u9078\u7dda\u689d\uff0c\u5305\u62ec\u8cc7\u7522\u548c\u7db2\u95dc\u5169\u500b\u9078\u9805\u5361\n</code></pre>"},{"location":"pc/#_9","title":"\u8cc7\u7522","text":"<pre><code>\u8cc7\u7522\u754c\u9762\u7ba1\u7406\u5305\u62ec\u9918\u984d\u3001\u8f49\u8cec\u3001\u4ea4\u6613\u8a18\u9304\u3001\u8cec\u865f\u7684\u7ba1\u7406\n\n\u5de6\u5074\u4e09\u500b\u6309\u9215\uff0c\u5206\u5225\u5c0d\u61c9 DST,FM\uff0cHASH\u4e09\u500b\u4e3b\u5e63\n</code></pre> <pre><code>\u53f3\u5074\u53ef\u4ee5\u67e5\u770b\u9918\u984d\u6578\u91cf \u4ea4\u6613\u8a18\u9304\uff0c\u4ee5\u53ca\u9032\u884c\u4e3b\u5e63\u7684\u767c\u9001\u548c\u63a5\u6536\n</code></pre> <pre><code>\u9019\u88e1\u5c0e\u51fa\u52a9\u8a18\u8a5e\uff0c\u4ee5\u53ca\u4fee\u6539\u5bc6\u78bc\n</code></pre>"},{"location":"pc/#_10","title":"\u7db2\u95dc","text":"<pre><code>\u7db2\u95dc\u529f\u80fd\u7ba1\u7406dpos\u8cea\u62bc\uff0c\u7db2\u95dc\u670d\u52d9\u5668\uff0c\u7db2\u95dcapp\uff0c\u7db2\u95dc\u5bc6\u9470\u7b49\n</code></pre>"},{"location":"pc/#dpos_1","title":"DPOS\u8cea\u62bc\u7ba1\u7406","text":"<pre><code>\u6210\u70ba\u9a57\u8b49\u5668\u5f8c\uff0c\u53ef\u4ee5\u5728 _DPOS\u8cea\u62bc\u7ba1\u7406_ \u9801\u9762\u67e5\u770b\u672c\u7bc0\u9ede\u7684DPOS\u72c0\u614b\n\n\u53ef\u4ee5\u9032\u884c\u8cea\u62bc\u8207\u8d16\u56de\n</code></pre> <pre><code>DPOS\u7684\u8d16\u56de\u4e0d\u662f\u7acb\u5373\u5230\u8cec\u7684\uff0c\u5728\u6b64\u67e5\u770b\u8d16\u56de\u72c0\u614b\n</code></pre> <pre><code>\u53ef\u4ee5\u67e5\u770b\u548c\u9818\u53d6\u8cea\u62bc\u734e\u52f5\u4ee5\u53ca\u4f63\u91d1\n</code></pre> <pre><code>\u5728\u6b64\u4fee\u6539\u7db2\u95dc\u7684\u8a2d\u7f6e\n</code></pre>"},{"location":"pc/#_11","title":"\u7db2\u95dc\u670d\u52d9\u5668\u8cc7\u6e90","text":""},{"location":"pc/#app","title":"\u7db2\u95dcapp","text":""},{"location":"pc/#_12","title":"\u7db2\u95dc\u5bc6\u9470","text":"<pre><code>\u7db2\u95dc\u5bc6\u9470\u7684\u4f7f\u7528\u65b9\u6cd5\u8a73\u898b\n</code></pre>"},{"location":"pc/#_13","title":"\u7db2\u95dc\u5bc6\u9470\u4f7f\u7528\u65b9\u6cd5","text":""},{"location":"pc/#_14","title":"\u8a2d\u7f6e","text":"<pre><code>\u8a2d\u7f6e\u5305\u62ec\uff1a\u7248\u672c\u6aa2\u6e2c\u3001\u8a9e\u8a00\u6aa2\u6e2c\u3001\u6b77\u53f2\u6e05\u9664\u8a2d\u7f6e\u3001\u7bc0\u9ede\u8a2d\u7f6e\u3001\u6578\u64da\u76ee\u9304\u8a2d\u7f6e\u3001\u8def\u7531\u5c64\u6578\u6aa2\u6e2c\n</code></pre>"},{"location":"pledge/","title":"\u8cea\u62bc","text":"<p>\u6b64\u6a21\u584a\u8ca0\u8cacDaoDst\u76f8\u95dc\u7684\u8cea\u62bc\uff0c\u92b7\u6bc0\uff0c\u734e\u52f5\u90e8\u5206</p> <pre><code>chat/\n\u251c\u2500\u2500 client\n\u2502   \u2514\u2500\u2500 rest\n\u2502        \u251c\u2500\u2500 error.go          # \u4ecb\u9762\u932f\u8aa4\u96c6\n\u2502        \u251c\u2500\u2500 grpc.go           # grpc\u67fb\u8a62\u65b9\u6cd5\n\u2502        \u251c\u2500\u2500 handle_pledge.go # pledge\u6a21\u584a\u6d88\u606f\u524d\u7f6e\u8655\u7406\n\u2502        \u251c\u2500\u2500 query.go          # \u4ecb\u9762\u67fb\u8a62\u51fd\u6578\n\u2502        \u251c\u2500\u2500 rest.go           # \u6d88\u606f\u8207\u67fb\u8a62\u8def\u7531\u7684\u6ce8\u518c\n\u2502        \u2514\u2500\u2500 tx.go             # tx\u76f8\u95dc\u65b9\u6cd5\uff0c\u5305\u62ec\u5ee3\u64ad\u7b49\n\u251c\u2500\u2500 keeper\n\u2502   \u251c\u2500\u2500 genesis.go        # \u6a21\u584a\u7684\u72c0\u614b\u5316\u548c\u532f\u51fa\n\u2502   \u251c\u2500\u2500 keeper.go         # \u5b58\u5132\u7ba1\u7406\u5668\uff0c\u8655\u7406\u6a21\u584a\u7684\u696d\u52d9\u908f\u8f2f\uff0c\u4e26\u6709\u8a31\u53ef\u6b0a\u8a2a\u554f\u72c0\u614b\u6a39\u7684\u7279\u5b9a\u5b50\u6a39\n\u2502   \u251c\u2500\u2500 msg_server.go     # \u63d0\u4f9b\u4e0a\u93c8\u6d88\u606f\u7684\u670d\u52d9\u8655\u7406\u908f\u8f2f\n\u2502   \u251c\u2500\u2500 params.go         # \u6a21\u584a\u53c3\u6578\u7684\u8a2d\u5b9a\u548c\u7372\u53d6\n\u2502   \u251c\u2500\u2500 query.go          # \u72c0\u614b\u67fb\u8a62\u51fd\u6578\n\u2502   \u251c\u2500\u2500 medal.go          # hash\u5e01\u8d28\u62bc\u8ba1\u7b97\u76f8\u5173\u903b\u8f91\u7b97\u6cd5\n\u2502   \u2514\u2500\u2500 mingkeeper.go     # \u94f8\u9020\u589e\u53d1\u76f8\u5173\u903b\u8f91\u7b97\u6cd5\n\u251c\u2500\u2500 types\n\u2502\u00a0\u00a0 \u251c\u2500\u2500 codec.go          # \u7de8\u78bc\u6ce8\u518c\u985e\u578b\n\u2502\u00a0\u00a0 \u251c\u2500\u2500 errors.go         # \u6a21\u584a\u7279\u5b9a\u7684\u932f\u8aa4\n\u2502\u00a0\u00a0 \u251c\u2500\u2500 events.go         # \u5411Tendermint PubSub/Websocket\u66b4\u9732\u7684\u4e8b\u4ef6\n\u2502\u00a0\u00a0 \u251c\u2500\u2500 genesis.go        # \u6a21\u584a\u7684\u5275\u4e16\u72c0\u614b\n\u2502\u00a0\u00a0 \u251c\u2500\u2500 interface.go      # \u6a21\u584a\u7684\u4ecb\u9762\u96c6\u5408\n\u2502\u00a0\u00a0 \u251c\u2500\u2500 keys.go           # \u6a21\u584a\u5b58\u5132key\u4ee5\u53ca\u4e00\u4e9b\u5176\u4ed6\u7684\u5e38\u6578\n\u2502\u00a0\u00a0 \u251c\u2500\u2500 msg.go            # \u804a\u5929\u6a21\u584a\u4ea4\u6613\u6d88\u606f\n\u2502\u00a0\u00a0 \u251c\u2500\u2500 params.go         # \u6a21\u584a\u53ef\u4ee5\u901a\u904e\u6cbb\u7406\u6a21\u584a\u4fee\u6539\u7684\u81ea\u5b9a\u7fa9\u53c3\u6578\n\u2502\u00a0\u00a0 \u251c\u2500\u2500 interface.go      # \u5f15\u5165\u7684\u5916\u90e8\u6a21\u5757\u5b9e\u73b0\u7684\u65b9\u6cd5\n\u2502\u00a0\u00a0 \u2514\u2500\u2500 types.go          # \u6a21\u584a\u7684\u985e\u578b\u96c6\u5408\n\u251c\u2500\u2500 genesis.go            # ABCI\u7684\u5275\u4e16\u72c0\u614b\u521d\u59cb\u5316\u548c\u532f\u51fa\u529f\u80fd\n\u251c\u2500\u2500 handler.go            # \u6d88\u606f\u8def\u7531\n\u2514\u2500\u2500 module.go             # \u6a21\u584a\u7ba1\u7406\u5668\u7684\u6a21\u584a\u8a2d\u5b9a\n</code></pre>"},{"location":"pledge/#_1","title":"\u76ee\u9304","text":""},{"location":"pledge/#pledge","title":"Pledge","text":"<pre><code>pledge\u6a21\u584a\u8ca0\u8cacDaoDST\u7684\u8cea\u62bc\u8207\u92b7\u6bc0\u7684\u90e8\u5206\n</code></pre>"},{"location":"pledge/#dst-hash","title":"DST &amp; HASH","text":"<pre><code>\u7528\u6236\u53ef\u4ee5\u901a\u904e\u92b7\u6bc0dst\u7684\u7ba1\u9053\u7372\u53d6hash\u4ee3\u5e63\uff0c\u540c\u6642\u8cea\u62bchash\u4f86\u6301\u7e8c\u7372\u53d6\u4e26\u96a8\u6642\u9078\u53d6dst\u734e\u52f5\uff0c\n\u5230\u9054\u4e00\u5b9a\u7b49\u7d1a\u5f8c\uff0chash\u53ef\u4ee5\u8d16\u56de\u4e26\u4ea4\u6613\n</code></pre>"},{"location":"pledge/#hash","title":"HASH","text":"<pre><code>\u5728\u6ce8\u518c\u804a\u5929\u6642\uff0c\u9700\u8981\u92b7\u6bc0\u4e00\u5b9a\u91cf\u7684dst\uff0c\u6309\u7167\u7b97\u704b\u514c\u63db\u6210hash\uff0c\u7372\u5f97\u7684hash\u5c07\u6703\u88ab\u81ea\u52d5\u8cea\u62bc\uff0c\u6309\u7167\u898f\u5247\uff0c\u6bcf\u6b21\u51fa\u584a\u90fd\u5c07\u7372\u5f97\u734e\u52f5\uff08dst\uff09\nhash\u7684\u8d16\u56de\u548c\u4ea4\u6613\u9700\u8981\u5230\u9054\u4e00\u5b9a\u81ea\u7531\u77f3\u5320\u7b49\u7d1a\n</code></pre>"},{"location":"pledge/#_2","title":"\u81ea\u7531\u77f3\u5320\u7b49\u7ea7","text":"<pre><code>\u63d0\u9ad8\u81ea\u7531\u77f3\u5320\u7b49\u7d1a\u6709\u4e00\u4e9b\u6b0a\u76ca\uff0c\u6bd4\u5982\u89e3\u9396hash\u7684\u8d16\u56de\u548c\u4ea4\u6613\uff0c\u63d0\u5347\u92b7\u6bc0dst\u7372\u5f97hash\u7684\u6bd4\u4f8b\uff0c\u89e3\u9396\u66f4\u591a\u804a\u5929\u623f\u9593\u6578\u91cf\uff0c\u63d0\u9ad8\u804a\u5929\u7dda\u4e0a\u5b58\u5132\u7a7a\u9593\u7b49\u3002\n\u81ea\u7531\u77f3\u5320\u7b49\u7d1a\u548chash\u8cea\u62bc\u91cf\u639b\u9264\uff0chash\u8cea\u62bc\u91cf\u8207\u7b49\u7d1a\u4e4b\u9593\u7684\u95dc\u4fc2\u53ef\u4ee5\u901a\u904e\u6295\u7968\u66f4\u6539\n</code></pre>"},{"location":"pledge/#hash_1","title":"HASH\u8f49\u5e33","text":"<pre><code>hash\u7684\u8f49\u5e33\u5c07\u6703\u6536\u53d6\u66f4\u591a\u7684gas\uff0c\u5927\u6982\u662f\u666e\u901a\u8f49\u5e33\u768410000\u500d\n</code></pre>"},{"location":"pledge/#dst","title":"\u92b7\u6bc0DST","text":"<pre><code>\u92b7\u6bc0DST\u6642\uff0c\u5c07\u6703\u6839\u64da\u92b7\u6bc0\u91cf\uff0c\u7d66\u6ce8\u518c\u9598\u9053\u548c\u7576\u524d\u9598\u9053\u589e\u767c\u4e00\u4e9b\u734e\u52f5\uff08dst\uff09\uff0c\u540c\u6642\u589e\u767c\u4e00\u4e9b\u734e\u52f5\u7d66\u7926\u5de5\n\n\u92b7\u6bc0DST\u514c\u63dbHASH\u7684\u7b97\u704b\u5982\u4e0b\n\n\u92b7\u6bc0\u91d1\u984d/\uff08\u7576\u65e5DST\u734e\u52f5\u589e\u767c\u91cf/\u5168\u7db2HASH\u7d2f\u8a08\u7372\u5f97\u91cf\uff09=\u7372\u5f97\u7684HASH\u6578\u91cf\n</code></pre>"},{"location":"pledge/#hash_2","title":"\u8cea\u62bcHASH","text":"<pre><code>\u8cea\u62bcHASH\u53ef\u4ee5\u6301\u7e8c\u7372\u5f97DST\u734e\u52f5\n\nDST\u6bcf\u6b21\u51fa\u584a\u90fd\u6703\u589e\u767c\uff0c\u7528\u6236\u6309\u7167hash\u8cea\u62bc\u5360\u6bd4\u7372\u5f97\u5176\u4e2d\u7684dst\u734e\u52f5\n\ndst\u6bcf\u6b21\u51fa\u584a\u589e\u767c\u6578\u91cf\u7684\u7b97\u704b\u5982\u4e0b\n\n\u584a\u901a\u8139=\uff08\uff080.35-\u6700\u8fd1100\u5929\u92b7\u6bc0\u6578\u91cf\uff09/ 0.35 *\uff08\u6700\u5927\u901a\u8139\u73873.65 -\u6700\u5c0f\u901a\u8139\u73871.21\uff09+\u6700\u5c0f\u901a\u8139\u73871.21\uff09/\u6bcf\u5e74\u51fa\u584a\u65785259600\n</code></pre>"},{"location":"pledge/#_3","title":"\u529f\u80fd","text":"<p>\u8d28\u62bc\u6a21\u584a' Keeper '\u6388\u4e88\u5c0d\u804a\u5929\u6a21\u584a\u72c0\u614b\u7684\u5b58\u53d6\u6b0a\u9650 \u4e26\u5be6\u73fe' statedb\u3002 \u4ecb\u9762\uff0c\u4ee5\u652f\u6301' StateDB '\u5be6\u73fe\u3002 Keeper\u5305\u542b\u4e00\u500b\u5141\u8a31\u8cc7\u6599\u5eab\u7684\u5b58\u5132\u9375 \u5beb\u5165\u53ea\u80fd\u7531Chat\u6a21\u584a\u8a2a\u554f\u7684\u591a\u5eab\u7684\u5177\u9ad4\u5b50\u6a39\u3002 \u800c\u4e0d\u662f\u4f7f\u7528\u6a39\u548c\u8cc7\u6599\u5eab\u9032\u884c\u67fb\u8a62\u548c\u6301\u4e45\u5316\uff08' StateDB '\u5be6\u73fe\uff09\uff0c DaoDst\u4f7f\u7528Cosmos\u7684\u201cKVStore\u201d\uff08\u9375\u503c\u5b58\u5132\uff09\u548cCosmos SDK\u7684\u201cKeeper\u201d\u4f86\u4fc3\u9032\u72c0\u614b\u8f49\u63db\u3002</p> <p>\u70ba\u4e86\u652f\u6301\u4ecb\u9762\u529f\u80fd\uff0c\u5b83\u5c0e\u5165\u4e864\u500b\u6a21\u584aKeepers:</p> <ul> <li><code>auth</code>: \u5e33\u865f\u7684\u589e\u5220\u6539\u67e5</li> <li><code>bank</code>: \u4f9b\u61c9\u91cf\u548c\u9918\u984d\u7684\u589e\u5220\u6539\u67e5</li> <li><code>comm</code>: \u9598\u9053\u76f8\u95dc\u8cc7\u6599\u7684\u7ba1\u7406</li> <li><code>chat</code>: \u804a\u5929\u76f8\u5173\u6570\u636e\u7684\u7ba1\u7406</li> </ul> <pre><code>type Keeper struct {\n    storeKey   sdk.StoreKey\n    cdc        codec.BinaryCodec\n    paramstore paramtypes.Subspace\n\n    hooks            types.PledgeHooks\n    AccountKeeper    types.AccountKeeper\n    BankKeeper       types.BankKeeper\n    CommKeeper       types.CommKeeper\n    ChatKeeper       types.ChatKeeper\n    FeeCollectorName string\n}\n\n</code></pre>"},{"location":"pledge/#_4","title":"\u6d88\u606f","text":""},{"location":"pledge/#msgpledge","title":"MsgPledge","text":"<pre><code>\u901a\u904e\u6b64\u6d88\u606f\uff0c\u767c\u8d77dst\u7684\u92b7\u6bc0\n</code></pre> <pre><code>    type MsgPledge struct {\n        FromAddress      string     `protobuf:\"bytes,1,opt,name=from_address,json=fromAddress,proto3\" json:\"from_address,omitempty\" yaml:\"from_address\"`\n        DelegatorAddress string     `protobuf:\"bytes,2,opt,name=delegator_address,json=delegatorAddress,proto3\" json:\"delegator_address,omitempty\" yaml:\"delegator_address\"`\n        ValidatorAddress string     `protobuf:\"bytes,3,opt,name=validator_address,json=validatorAddress,proto3\" json:\"validator_address,omitempty\" yaml:\"validator_address\"`\n        Amount           types.Coin `protobuf:\"bytes,4,opt,name=amount,proto3\" json:\"amount\"`\n    }\n</code></pre>"},{"location":"pledge/#msgwithdrawdelegatorreward","title":"MsgWithdrawDelegatorReward","text":"<pre><code>\u901a\u904e\u6b64\u6d88\u606f\uff0c\u9078\u53d6\u8cea\u62bchash\u7684dst\u734e\u52f5\n</code></pre> <pre><code>    type MsgWithdrawDelegatorReward struct {\n        DelegatorAddress string `protobuf:\"bytes,1,opt,name=delegator_address,json=delegatorAddress,proto3\" json:\"delegator_address,omitempty\" yaml:\"delegator_address\"`\n    }\n</code></pre>"},{"location":"pledge/#msgunpledge","title":"MsgUnpledge","text":"<pre><code>\u901a\u904e\u6b64\u6d88\u606f\uff0c\u8d16\u56de\u8cea\u62bc\u7684hash\n</code></pre> <pre><code>    type MsgUnpledge struct {\n        DelegatorAddress string     `protobuf:\"bytes,1,opt,name=delegator_address,json=delegatorAddress,proto3\" json:\"delegator_address,omitempty\" yaml:\"delegator_address\"`\n        Amount           types.Coin `protobuf:\"bytes,2,opt,name=amount,proto3\" json:\"amount\"`\n    }\n</code></pre>"},{"location":"pledge/#msgburngetmedal","title":"MsgBurnGetMedal","text":"<pre><code>\u92b7\u6bc0dst\u7372\u5f97Hash\n</code></pre> <pre><code>    type MsgBurnGetMedal struct {\n        FromAddress string     `protobuf:\"bytes,1,opt,name=from_address,json=fromAddress,proto3\" json:\"from_address,omitempty\" yaml:\"from_address\"`\n        ToAddress   string     `protobuf:\"bytes,2,opt,name=to_address,json=toAddress,proto3\" json:\"to_address,omitempty\" yaml:\"to_address\"`\n        Gateway     string     `protobuf:\"bytes,3,opt,name=gateway,proto3\" json:\"gateway,omitempty\" yaml:\"gateway\"`\n        BurnCoin    types.Coin `protobuf:\"bytes,4,opt,name=burn_coin,json=burnCoin,proto3\" json:\"burn_coin\" yaml:\"burn_coin\"`\n    }\n</code></pre>"},{"location":"pledge/#_5","title":"\u53c3\u6578","text":"<p>pledge\u6a21\u584a\u5305\u542b\u5982\u4e0b\u6a21\u584a\u53c3\u6578</p>"},{"location":"pledge/#_6","title":"\u53c3\u6578","text":"Key Type Default Value <code>KeyInflationDays</code> int64 <code>100</code> <code>InflationMax</code> github_com_cosmos_cosmos_sdk_types.Dec <code>3.65</code> <code>InflationMin</code> github_com_cosmos_cosmos_sdk_types.Dec <code>1.21</code> <code>GoalBonded</code> github_com_cosmos_cosmos_sdk_types.Dec <code>0.35</code> <code>BlocksPerYear</code> uint64 <code>5259600</code> <code>UnbondingHeight</code> int64 <code>302400</code> <code>MinBurnCoin</code> github_com_cosmos_cosmos_sdk_types.Coin <code>100000000000000000000dst</code> <code>BurnCurrentGatePercent</code> github_com_cosmos_cosmos_sdk_types.Dec <code>0.1</code> <code>BurnRegisterGatePercent</code> github_com_cosmos_cosmos_sdk_types.Dec <code>0.1</code> <code>BurnDposPercent</code> github_com_cosmos_cosmos_sdk_types.Dec <code>0.1</code> <code>BurnReturnDays</code> int64 <code>120</code> <code>BurnLevels</code> []BurnLevel"},{"location":"pledge/#_7","title":"\u92b7\u6bc0\u7b49\u7d1a","text":"<p>BurnLevels \u5b9a\u7fa9\u4e86\u81ea\u7531\u77f3\u5320\u7b49\u7d1a\u53ef\u4eab\u53d7\u7684\u76f8\u95dc\u6b0a\u76ca\uff0c\u5176\u4e2d\u5305\u62ec\u4e09\u7a2e\u6b0a\u76ca</p> <pre><code>1.\u92b7\u6bc0dst\u514c\u63dbhash\u7684\u6bd4\u4f8b\n2.\u804a\u5929\u5b58\u5132\u7a7a\u9593\n3.\u804a\u5929\u89e3\u9396\u623f\u9593\u6578\n</code></pre> Level MedalAmount AddPercent RoomAmount <code>1</code> <code>100</code> <code>1</code> <code>0</code> <code>2</code> <code>200</code> <code>2</code> <code>0</code> <code>3</code> <code>400</code> <code>3</code> <code>0</code> <code>4</code> <code>800</code> <code>4</code> <code>0</code> <code>5</code> <code>1600</code> <code>5</code> <code>1</code> <code>6</code> <code>3200</code> <code>6</code> <code>2</code> <code>7</code> <code>6400</code> <code>7</code> <code>3</code> <code>8</code> <code>12800</code> <code>8</code> <code>4</code> <code>9</code> <code>25600</code> <code>9</code> <code>5</code> <code>10</code> <code>51200</code> <code>12</code> <code>6</code> <code>11</code> <code>102400</code> <code>15</code> <code>7</code> <code>12</code> <code>204800</code> <code>18</code> <code>8</code> <code>13</code> <code>409600</code> <code>21</code> <code>9</code> <code>14</code> <code>819200</code> <code>24</code> <code>10</code> <code>15</code> <code>1638400</code> <code>27</code> <code>11</code> <code>16</code> <code>3276800</code> <code>30</code> <code>12</code> <code>17</code> <code>6553600</code> <code>33</code> <code>13</code> <code>18</code> <code>13107200</code> <code>36</code> <code>14</code> <code>19</code> <code>26214400</code> <code>39</code> <code>15</code> <code>20</code> <code>52428800</code> <code>43</code> <code>16</code> <code>21</code> <code>104857600</code> <code>47</code> <code>17</code> <code>22</code> <code>209715200</code> <code>51</code> <code>18</code> <code>23</code> <code>419430400</code> <code>55</code> <code>19</code> <code>24</code> <code>838860800</code> <code>59</code> <code>20</code> <code>25</code> <code>1677721600</code> <code>63</code> <code>21</code> <code>26</code> <code>3355443200</code> <code>67</code> <code>22</code> <code>27</code> <code>6710886400</code> <code>71</code> <code>23</code> <code>28</code> <code>13421772800</code> <code>75</code> <code>24</code> <code>29</code> <code>26843545600</code> <code>79</code> <code>25</code> <code>30</code> <code>53687091200</code> <code>84</code> <code>26</code> <code>31</code> <code>107374182400</code> <code>89</code> <code>27</code> <code>32</code> <code>214748364800</code> <code>94</code> <code>28</code> <code>33</code> <code>429496729600</code> <code>100</code> <code>29</code>"},{"location":"protocol/","title":"Protocol","text":""},{"location":"protocol/#_1","title":"\u8cec\u865f","text":"<p>\u53ef\u4ee5\u5728\u4e0d\u540c\u7684\u5340\u584a\u93c8\u4e0a\u4ee5\u7368\u7279\u7684\u65b9\u5f0f\u5275\u5efa\u548c\u8868\u793a\u52a0\u5bc6\u9322\u5305\uff08\u6216\u5e33\u6236\uff09\u3002\u5c0d\u65bc\u5728 Daodst \u4e0a\u8207\u5e33\u6236\u985e\u578b\u4ea4\u4e92\u7684\u958b\u767c\u4eba\u54e1\uff0c\u5728\u5176 dApp \u524d\u7aef\u7684\u9322\u5305\u96c6\u6210\u904e\u7a0b\u4e2d\uff0c\u91cd\u8981\u7684\u662f\u8981\u4e86\u89e3 Daodst \u4e0a\u7684\u8cec\u6236\u88ab\u5be6\u65bd\u70ba\u8207\u4ee5\u592a\u574a\u985e\u578b\u5730\u5740\u517c\u5bb9\u3002</p>"},{"location":"protocol/#_2","title":"\u5275\u5efa\u8cec\u865f","text":"<p>\u8981\u5275\u5efa\u4e00\u500b\u5e33\u6236\uff0c\u60a8\u53ef\u4ee5\u5275\u5efa\u79c1\u9470\u3001\u5bc6\u9470\u5eab\u6587\u4ef6\uff08\u53d7\u5bc6\u78bc\u4fdd\u8b77\u7684\u79c1\u9470\uff09\u6216\u52a9\u8a18\u8a5e\uff08\u53ef\u4ee5\u8a2a\u554f\u591a\u500b\u79c1\u9470\u7684\u4e00\u4e32\u55ae\u8a5e\uff09\u3002</p> <p>\u9664\u4e86\u5177\u6709\u4e0d\u540c\u7684\u5b89\u5168\u529f\u80fd\u5916\uff0c\u5b83\u5011\u4e4b\u9593\u6700\u5927\u7684\u5340\u5225\u5728\u65bc\u79c1\u9470\u6216\u5bc6\u9470\u5eab\u6587\u4ef6\u50c5\u5275\u5efa\u4e00\u500b\u5e33\u6236\u3002\u5275\u5efa\u4e00\u500b\u52a9\u8a18\u8a5e\u53ef\u4ee5\u8b93\u60a8\u63a7\u5236\u8a31\u591a\u5e33\u6236\uff0c\u6240\u6709\u5e33\u6236\u90fd\u53ef\u4ee5\u4f7f\u7528\u540c\u4e00\u500b\u77ed\u8a9e\u8a2a\u554f\u3002</p> <p>Cosmos \u5340\u584a\u93c8\u8207 Daodst \u4e00\u6a23\uff0c\u652f\u6301\u4f7f\u7528\u52a9\u8a18\u8a5e\u5275\u5efa\u5e33\u6236\uff0c\u4e5f\u7a31\u70ba\u5206\u5c64\u78ba\u5b9a\u6027\u5bc6\u9470\u751f\u6210\uff08HD \u5bc6\u9470\uff09\u3002\u9019\u5141\u8a31\u7528\u6236\u5728\u591a\u500b\u5340\u584a\u93c8\u4e0a\u5275\u5efa\u5e33\u6236\uff0c\u800c\u7121\u9700\u7ba1\u7406\u591a\u500b\u5bc6\u9470\u3002</p> <p>HD \u5bc6\u9470\u901a\u904e\u7372\u53d6\u52a9\u8a18\u8a5e\u4e26\u5c07\u5176\u8207\u4e00\u689d\u7a31\u70ba\u6d3e\u751f\u8def\u5f91\u7684\u4fe1\u606f\u7d44\u5408\u4f86\u751f\u6210\u5730\u5740\u3002\u5340\u584a\u93c8\u53ef\u4ee5\u5728\u5b83\u5011\u652f\u6301\u7684\u63a8\u5c0e\u8def\u5f91\u4e0a\u6709\u6240\u4e0d\u540c\u3002\u56e0\u6b64\uff0c\u8981\u901a\u904e\u5340\u584a\u93c8\u4e0a\u7684\u52a9\u8a18\u8a5e\u8a2a\u554f\u6240\u6709\u8cec\u6236\uff0c\u4f7f\u7528\u8a72\u5340\u584a\u93c8\u7684\u7279\u5b9a\u63a8\u5c0e\u8def\u5f91\u975e\u5e38\u91cd\u8981\u3002</p>"},{"location":"protocol/#_3","title":"\u4ee3\u7406\u8cec\u6236","text":"<p>\u8853\u8a9e\u201c\u8cec\u6236\u201d\u548c\u201c\u5730\u5740\u201d\u7d93\u5e38\u4e92\u63db\u4f7f\u7528\u4f86\u63cf\u8ff0\u52a0\u5bc6\u9322\u5305\u3002\u5728 Cosmos SDK \u4e2d\uff0c\u4e00\u500b\u8cec\u6236\u6307\u5b9a\u4e00\u5c0d\u516c\u9470\uff08PubKey\uff09\u548c\u79c1\u9470\uff08PrivKey\uff09\u3002\u6d3e\u751f\u8def\u5f91\u5b9a\u7fa9\u4e86\u79c1\u9470\u3001\u516c\u9470\u548c\u5730\u5740\u3002</p> <p>\u53ef\u4ee5\u6d3e\u751f PubKey \u4ee5\u751f\u6210\u4e0d\u540c\u683c\u5f0f\u7684\u5404\u7a2e\u5730\u5740\uff0c\u9019\u4e9b\u5730\u5740\u7528\u65bc\u8b58\u5225\u61c9\u7528\u7a0b\u5e8f\u4e2d\u7684\u7528\u6236\uff08\u4ee5\u53ca\u5176\u4ed6\u65b9\uff09\u3002 Cosmos \u93c8\u7684\u5e38\u898b\u5730\u5740\u5f62\u5f0f\u662f bech32 \u683c\u5f0f\uff08\u4f8b\u5982 dst1 ...\uff09\u3002\u5730\u5740\u4e5f\u8207\u6d88\u606f\u76f8\u95dc\u806f\u4ee5\u8b58\u5225\u6d88\u606f\u7684\u767c\u9001\u8005\u3002</p> <p>PrivKey \u7528\u65bc\u751f\u6210\u6578\u5b57\u7c3d\u540d\uff0c\u4ee5\u8b49\u660e\u8207 PrivKey \u95dc\u806f\u7684\u5730\u5740\u6279\u51c6\u7d66\u5b9a\u6d88\u606f\u3002\u901a\u904e\u5c0d PrivKey \u61c9\u7528\u52a0\u5bc6\u65b9\u6848\uff08\u7a31\u70ba\u6a62\u5713\u66f2\u7dda\u6578\u5b57\u7c3d\u540d\u7b97\u6cd5 (ECDSA)\uff09\u4f86\u57f7\u884c\u8b49\u660e\uff0c\u4ee5\u751f\u6210\u8207\u6d88\u606f\u4e2d\u7684\u5730\u5740\u9032\u884c\u6bd4\u8f03\u7684\u516c\u9470\u3002</p>"},{"location":"protocol/#daodst","title":"Daodst \u8cec\u865f","text":"<p>Daodst \u5b9a\u7fa9\u4e86\u81ea\u5df1\u7684\u81ea\u5b9a\u7fa9\u8cec\u6236\u985e\u578b\uff0c\u4ee5\u5be6\u73fe\u8207\u4ee5\u592a\u574a\u985e\u578b\u5730\u5740\u517c\u5bb9\u7684 HD \u9322\u5305\u3002\u5b83\u4f7f\u7528\u4ee5\u592a\u574a\u7684 ECDSA secp256k1 \u66f2\u7dda\u4f5c\u70ba\u5bc6\u9470 (eth_secp265k1) \u4e26\u6eff\u8db3 EIP84 \u7684\u5b8c\u6574 BIP44 \u8def\u5f91\u3002\u4e0d\u8981\u5c07\u9019\u689d\u52a0\u5bc6\u66f2\u7dda\u8207\u6bd4\u7279\u5e63\u7684 ECDSA secp256k1 \u66f2\u7dda\u6df7\u6dc6\u3002</p> <p>\u57fa\u65bc Daodst \u7684\u5e33\u6236\u7684\u6839 HD \u8def\u5f91\u662f <code>m/44'/60'/0'/0</code>\u3002 Daodst \u4f7f\u7528 Coin type 60 \u4f86\u652f\u6301\u4ee5\u592a\u574a\u985e\u578b\u7684\u8cec\u6236\uff0c\u4e0d\u50cf\u8a31\u591a\u5176\u4ed6\u4f7f\u7528 Coin type 118 \u7684 Cosmos \u93c8\uff08coin types \u5217\u8868</p> <p>\u81ea\u5b9a\u7fa9 Daodst EthAccount \u6eff\u8db3\u4f86\u81ea Cosmos SDK \u8eab\u4efd\u9a57\u8b49\u6a21\u584a\u7684 AccountI \u63a5\u53e3\uff0c\u4e26\u5305\u542b\u4ee5\u592a\u574a\u985e\u578b\u5730\u5740\u6240\u9700\u7684\u5176\u4ed6\u5b57\u6bb5\uff1a</p> <pre><code>// EthAccountI represents the interface of an EVM compatible account\ntype EthAccountI interface {\n    authtypes.AccountI\n    // EthAddress returns the ethereum Address representation of the AccAddress\n    EthAddress() common.Address\n    // CodeHash is the keccak256 hash of the contract code (if any)\n    GetCodeHash() common.Hash\n    // SetCodeHash sets the code hash to the account fields\n    SetCodeHash(code common.Hash) error\n    // Type returns the type of Ethereum Account (EOA or Contract)\n    Type() int8\n}\n</code></pre>"},{"location":"protocol/#_4","title":"\u5730\u5740\u548c\u516c\u9470","text":"<p>BIP-0173 \u70ba\u9694\u96e2\u898b\u8b49\u8f38\u51fa\u5730\u5740\u5b9a\u7fa9\u4e86\u4e00\u7a2e\u65b0\u683c\u5f0f\uff0c\u5176\u4e2d\u5305\u542b\u6a19\u8b58 Bech32 \u7528\u6cd5\u7684\u4eba\u985e\u53ef\u8b80\u90e8\u5206\u3002 Daodst \u4f7f\u7528\u4ee5\u4e0b HRP\uff08\u4eba\u985e\u53ef\u8b80\u524d\u7db4\uff09\u4f5c\u70ba\u57fa\u790e HRP\uff1a</p> \u7f51\u7edc \u4e3b\u7f51 \u6d4b\u8bd5\u7f51 daodst daodst daodst <p>\u5728 Daodst \u4e0a\u9ed8\u8a8d\u53ef\u7528\u7684\u5730\u5740/\u516c\u9470\u6709 3 \u7a2e\u4e3b\u8981\u985e\u578b\u7684 HRP\uff1a</p> <ul> <li>\u5e33\u6236\u7684\u5730\u5740\u548c\u5bc6\u9470\uff0c\u7528\u65bc\u8b58\u5225\u7528\u6236\uff08\u4f8b\u5982\u6d88\u606f\u7684\u767c\u4ef6\u4eba\uff09\u3002\u5b83\u5011\u662f\u4f7f eth_secp256k1 \u66f2\u7dda\u5f97\u51fa\u7684\u3002</li> <li>\u9a57\u8b49\u5668\u64cd\u4f5c\u54e1\u7684\u5730\u5740\u548c\u5bc6\u9470\uff0c\u7528\u65bc\u8b58\u5225\u9a57\u8b49\u5668\u7684\u64cd\u4f5c\u54e1\u3002\u5b83\u5011\u662f\u4f7f eth_secp256k1 \u66f2\u7dda\u5f97\u51fa\u7684\u3002</li> <li>\u5171\u8b58\u7bc0\u9ede\u7684\u5730\u5740\u548c\u5bc6\u9470\uff0c\u7528\u65bc\u6a19\u8b58\u53c3\u8207\u5171\u8b58\u7684\u9a57\u8b49\u7bc0\u9ede\u3002\u5b83\u5011\u662f\u4f7f\u7528 ed25519 \u66f2\u7dda\u5f97\u51fa\u7684</li> </ul> \u540d\u79f0 bech32 \u5730\u5740\u524d\u7f00 bech32  \u516c\u94a5\u524d\u7f00 \u66f2\u7ebf  \u5730\u5740\u5b57\u8282\u957f\u5ea6 \u516c\u94a5\u5b57\u8282\u957f\u5ea6 \u5e33\u6236 dst dstpub eth_secp256k1 20 33(compressed) \u9a57\u8b49\u5668\u64cd\u4f5c dstvaloper dstvaloperpub eth_secp256k1 20 33(compressed) \u5171\u8b58\u7bc0\u9ede dstvalcons dstvalconspub ed25519 dst 32"},{"location":"protocol/#_5","title":"\u5ba2\u6236\u7684\u5730\u5740\u683c\u5f0f","text":"<p>Eth\u8cec\u865f \u53ef\u4ee5\u7528 Bech32 (dst1...) \u548c\u5341\u516d\u9032\u5236 (0x...) \u683c\u5f0f\u8868\u793a\uff0c\u4ee5\u5be6\u73fe\u4ee5\u592a\u574a\u7684 Web3 \u5de5\u5177\u517c\u5bb9\u6027.</p> <p>Bech32 \u683c\u5f0f\u662f\u901a\u904e CLI \u548c REST \u5ba2\u6236\u7aef\u9032\u884c Cosmos-SDK \u67e5\u8a62\u548c\u4ea4\u6613\u7684\u9ed8\u8a8d\u683c\u5f0f\u3002\u53e6\u4e00\u65b9\u9762\uff0c\u5341\u516d\u9032\u5236\u683c\u5f0f\u662f\u4ee5\u592a\u574a common.Address \u8868\u793a Cosmos sdk.AccAddress\u3002</p> <ul> <li>\u5730\u5740 (Bech32): <code>dst1z3t55m0l9h0eupuz3dp5t5cypyv674jj7mz2jw</code></li> <li>\u5730\u5740 (EIP55 16\u9032\u5236): <code>0x91defC7fE5603DFA8CC9B655cF5772459BF10c6f</code></li> <li>\u58d3\u7e2e\u516c\u9470: <code>{\"@type\":\"/ethermint.crypto.v1.ethsecp256k1.PubKey\",\"key\":\"AsV5oddeB+hkByIJo/4lZiVUgXTzNfBPKC73cZ4K1YD2\"}</code></li> </ul>"},{"location":"protocol/#_6","title":"\u5730\u5740\u8f49\u63db","text":"<p>stcd debug addr  \u53ef\u7528\u65bc\u5728\u5341\u516d\u9032\u5236\u548c bech32 \u683c\u5f0f\u4e4b\u9593\u8f49\u63db\u5730\u5740\u3002\u4f8b\u5982\uff1a Bech32 <pre><code> $ stcd debug addr dst1z3t55m0l9h0eupuz3dp5t5cypyv674jj7mz2jw\n  Address: [20 87 74 109 255 45 223 158 7 130 139 67 69 211 4 9 25 175 86 82]\n  Address (hex): 14574A6DFF2DDF9E07828B4345D3040919AF5652\n  Bech32 Acc: dst1z3t55m0l9h0eupuz3dp5t5cypyv674jj7mz2jw\n  Bech32 Val: dstvaloper1z3t55m0l9h0eupuz3dp5t5cypyv674jjn4d6nn\n</code></pre> <p>Hex</p> <pre><code> $ stcd debug addr 14574A6DFF2DDF9E07828B4345D3040919AF5652\n  Address: [20 87 74 109 255 45 223 158 7 130 139 67 69 211 4 9 25 175 86 82]\n  Address (hex): 14574A6DFF2DDF9E07828B4345D3040919AF5652\n  Bech32 Acc: dst1z3t55m0l9h0eupuz3dp5t5cypyv674jj7mz2jw\n  Bech32 Val: dstvaloper1z3t55m0l9h0eupuz3dp5t5cypyv674jjn4d6nn\n</code></pre>"},{"location":"protocol/#key","title":"Key \u5c0e\u51fa","text":"<p>\u6211\u5011\u53ef\u4ee5\u4f7f\u7528\u5e36\u6709\u6a19\u8a8c --bech  (acc|val|cons) \u7684 stcd \u7684 keys show \u547d\u4ee4\u4f86\u7372\u53d6\u5730\u5740\u548c\u5bc6\u9470\uff0c\u5982\u4e0a\u6240\u8ff0\uff0c <p>\u666e\u901a\u8cec\u865f</p> <pre><code> $ stcd keys show dev0 --bech acc\n- name: dev0\n  type: local\n  address: dst1z3t55m0l9h0eupuz3dp5t5cypyv674jj7mz2jw\n  pubkey: '{\"@type\":\"/ethermint.crypto.v1.ethsecp256k1.PubKey\",\"key\":\"AsV5oddeB+hkByIJo/4lZiVUgXTzNfBPKC73cZ4K1YD2\"}'\n  mnemonic: \"\"\n</code></pre> <p>\u9a57\u8b49\u5668</p> <pre><code> $ stcd keys show dev0 --bech val\n- name: dev0\n  type: local\n  address: dstvaloper1z3t55m0l9h0eupuz3dp5t5cypyv674jjn4d6nn\n  pubkey: '{\"@type\":\"/ethermint.crypto.v1.ethsecp256k1.PubKey\",\"key\":\"AsV5oddeB+hkByIJo/4lZiVUgXTzNfBPKC73cZ4K1YD2\"}'\n  mnemonic: \"\"\n</code></pre> <p>\u5171\u8b58</p> <pre><code> $ stcd keys show dev0 --bech cons\n- name: dev0\n  type: local\n  address: dstvalcons1rllqa5d97n6zyjhy6cnscc7zu30zjn3f7wyj2n\n  pubkey: '{\"@type\":\"/ethermint.crypto.v1.ethsecp256k1.PubKey\",\"key\":\"A/fVLgIqiLykFQxum96JkSOoTemrXD0tFaFQ1B0cpB2c\"}'\n  mnemonic: \"\"\n</code></pre>"},{"location":"protocol/#_7","title":"\u8cec\u865f\u67e5\u8a62","text":"<p>\u60a8\u53ef\u4ee5\u4f7f\u7528 CLI\u3001gRPC \u6216</p> <p>\u547d\u4ee4\u884c\u754c\u9762</p> <pre><code># NOTE: the --output (-o) flag will define the output format in JSON or YAML (text)\nstcd q auth account $(stcd keys show dev0 -a) -o text\n\n'@type': /ethermint.types.v1.EthAccount\nbase_account:\naccount_number: \"0\"\naddress: dst1z3t55m0l9h0eupuz3dp5t5cypyv674jj7mz2jw\npub_key:\n  '@type': /ethermint.crypto.v1.ethsecp256k1.PubKey\n  key: AsV5oddeB+hkByIJo/4lZiVUgXTzNfBPKC73cZ4K1YD2\nsequence: \"1\"\ncode_hash: 0xc5d2460186f7233c927e7db2dcc703c0e500b653ca82273b7bfad8045d85a470\n</code></pre> <p>Cosmos gRPC and REST</p> <pre><code># GET /cosmos/auth/v1beta1/accounts/{address}\ncurl -X GET \"http://localhost:10337/cosmos/auth/v1beta1/accounts/dst14au322k9munkmx5wrchz9q30juf5wjgz2cfqku\" -H \"accept: application/json\"\n</code></pre> <p>JSON-RPC \u8981\u4f7f\u7528 Web3 \u6aa2\u7d22\u4ee5\u592a\u574a\u5341\u516d\u9032\u5236\u5730\u5740\uff0c\u8acb\u4f7f\u7528 JSON-RPC eth_accounts \u6216 personal_listAccounts \u7aef\u9ede</p> <pre><code># query against a local node\ncurl -X POST --data '{\"jsonrpc\":\"2.0\",\"method\":\"eth_accounts\",\"params\":[],\"id\":1}' -H \"Content-Type: application/json\" http://localhost:8545\n\ncurl -X POST --data '{\"jsonrpc\":\"2.0\",\"method\":\"personal_listAccounts\",\"params\":[],\"id\":1}' -H \"Content-Type: application/json\" http://localhost:8545\n</code></pre>"},{"location":"protocol/#id","title":"\u93c8ID","text":"<p>\u93c8 ID \u662f\u4ee3\u8868\u5340\u584a\u934a\u7db2\u7d61\u7684\u552f\u4e00\u6a19\u8b58\u7b26\u3002\u6211\u5011\u7528\u5b83\u4f86\u5340\u5206\u4e0d\u540c\u7684\u5340\u584a\u934a\u7db2\u7d61\uff0c\u4e26\u78ba\u4fdd\u4ea4\u6613\u548c\u6d88\u606f\u88ab\u767c\u9001\u5230\u6b63\u78ba\u7684\u7db2\u7d61\u3002 Daodst\u7db2\u7d61\u9075\u5faa identifier_EIP155-version \u7684\u683c\u5f0f\u3002</p>"},{"location":"protocol/#_8","title":"\u4e3b\u7db2","text":"\u540d\u7a31 \u93c8 ID \u6a19\u8b58\u7b26 EIP155 Number \u7248\u672c \u6fc0\u6d3b Daodst2 <code>daodst_7001-2</code> dst 7001 2 yes Daodst1 <code>Daodst_7001-1</code> dst 7001 1 no"},{"location":"protocol/#_9","title":"\u6e2c\u8a66\u7db2","text":"\u540d\u7a31 \u93c8 ID \u6a19\u8b58\u7b26 EIP155 Number \u7248\u672c \u6fc0\u6d3b Daodst Public Testnet <code>Daodst_7000-2</code> dst 9000 2 yes Daodst Public Testnet <code>Daodst_7000-1</code> dst 9000 1 no"},{"location":"protocol/#_10","title":"\u93c8\u8eab\u4efd","text":"<p>\u6bcf\u689d\u93c8\u90fd\u5fc5\u9808\u6709\u4e00\u500b\u552f\u4e00\u7684\u6a19\u8b58\u7b26\u6216 <code>chain-id</code>\u3002 Tendermint \u8981\u6c42\u6bcf\u500b\u61c9\u7528\u7a0b\u5e8f\u5728 genesis.json \u5b57\u6bb5 \u4e2d\u5b9a\u7fa9\u81ea\u5df1\u7684 <code>chain-id</code>\u3002\u4f46\u662f\uff0c\u70ba\u4e86\u540c\u6642\u7b26\u5408 EIP155 \u548c Cosmos \u93c8\u5347\u7d1a\u6a19\u6e96\uff0cDaodst \u517c\u5bb9\u93c8\u5fc5\u9808\u5be6\u73fe\u4ed6\u5011\u7684\u93c8\u6a19\u8b58\u7b26\u7684\u7279\u6b8a\u7d50\u69cb\u3002</p> <p>  \u7d50\u69cb </p> <p>Daodst \u93c8 ID \u5305\u542b 3 \u500b\u4e3b\u8981\u7d44\u4ef6</p> <ul> <li>\u6a19\u8b58\u7b26: \u5b9a\u7fa9\u61c9\u7528\u7a0b\u5e8f\u540d\u7a31\u7684\u975e\u7d50\u69cb\u5316\u5b57\u7b26\u4e32\u3002</li> <li>EIP155 Number: \u4e0d\u53ef\u8b8a EIP155 <code>CHAIN_ID</code>   \u5b9a\u7fa9\u91cd\u653e\u653b\u64ca\u4fdd\u8b77\u6578\u3002</li> <li>\u7248\u672c\u865f: \u662f\u93c8\u7576\u524d\u6b63\u5728\u904b\u884c\u7684\u7248\u672c\u865f\uff08\u59cb\u7d42\u70ba\u6b63\u6578\uff09\u3002\u6bcf\u6b21\u93c8\u5347\u7d1a\u6216\u5206\u53c9\u6642\uff0c\u9019\u500b\u6578\u5b57\u5fc5\u9808\u905e\u589e\uff0c\u4ee5\u907f\u514d\u7db2\u7d61\u6216\u5171\u8b58\u932f\u8aa4\u3002</li> </ul> <p>  \u683c\u5f0f </p> <p>genesis\u4e2d\u6307\u5b9a\u548cDaodst\u517c\u5bb9\u7684chain-id\u7684\u683c\u5f0f\u5982\u4e0b\uff1a</p> <pre><code>{identifier}_{EIP155}-{version}\n</code></pre> <p>\u4e0b\u8868\u63d0\u4f9b\u4e86\u4e00\u500b\u793a\u4f8b\uff0c\u5176\u4e2d\u7b2c\u4e8c\u884c\u5c0d\u61c9\u65bc\u7b2c\u4e00\u884c\u7684\u5347\u7d1a\uff1a</p> ChainID Identifier EIP155 Number Version Number <code>daodst_7000-1</code> dst 7000 1 <code>daodst_7000-2</code> dst 7000 2 <code>...</code> ... ... ... <code>daodst_7000-N</code> dst 7000 N"},{"location":"protocol/#_11","title":"\u7de8\u78bc","text":"<p>\u7de8\u78bc\u662f\u6307\u5c07\u6578\u64da\u5f9e\u4e00\u7a2e\u683c\u5f0f\u8f49\u63db\u70ba\u53e6\u4e00\u7a2e\u683c\u5f0f\u4ee5\u4f7f\u5176\u66f4\u52a0\u5b89\u5168\u548c\u9ad8\u6548\u7684\u904e\u7a0b\u3002</p> <p>\u5728\u5340\u584a\u93c8\u7684\u80cc\u666f\u4e0b\uff0c\u7de8\u78bc\u7528\u65bc\u78ba\u4fdd\u6578\u64da\u4ee5\u5b89\u5168\u4e14\u6613\u65bc\u8a2a\u554f\u7684\u65b9\u5f0f\u5b58\u5132\u548c\u50b3\u8f38\u3002</p> <p>\u905e\u6b78\u9577\u5ea6\u524d\u7db4 (RLP) \u662f\u4e00\u7a2e\u5728\u4ee5\u592a\u574a\u57f7\u884c\u5ba2\u6236\u7aef\u4e2d\u5ee3\u6cdb\u4f7f\u7528\u7684\u5e8f\u5217\u5316\u683c\u5f0f\u3002</p> <p>\u5b83\u7684\u76ee\u7684\u662f\u5c0d\u4efb\u610f\u5d4c\u5957\u7684\u4e8c\u9032\u5236\u6578\u64da\u6578\u7d44\u9032\u884c\u7de8\u78bc\uff0c\u662f\u4ee5\u592a\u574a\u4e2d\u7528\u65bc\u5e8f\u5217\u5316\u5c0d\u8c61\u7684\u4e3b\u8981\u7de8\u78bc\u65b9\u5f0f\u3002</p> <p>RLP \u50c5\u5c0d\u7d50\u69cb\u9032\u884c\u7de8\u78bc\uff0c\u800c\u5c07\u5c0d\u7279\u5b9a\u539f\u5b50\u6578\u64da\u985e\u578b\uff08\u4f8b\u5982\u5b57\u7b26\u4e32\u3001\u6574\u6578\u548c\u6d6e\u9ede\u6578\uff09\u7684\u7de8\u78bc\u7559\u7d66\u9ad8\u968e\u5354\u8b70\u3002</p> <p>\u5728\u4ee5\u592a\u574a\u4e2d\uff0c\u6574\u6578\u5fc5\u9808\u4ee5\u6c92\u6709\u524d\u5c0e\u96f6\u7684\u5927\u7aef\u4e8c\u9032\u5236\u5f62\u5f0f\u8868\u793a\uff0c\u4f7f\u5f97\u6574\u6578\u503c\u96f6\u7b49\u540c\u65bc\u7a7a\u5b57\u7bc0\u6578\u7d44\u3002</p> <p>RLP \u7de8\u78bc\u51fd\u6578\u63a5\u53d7\u4e00\u500b\u9805\u76ee\uff0c\u8a72\u9805\u76ee\u88ab\u5b9a\u7fa9\u70ba\u503c\u5728 [0x00, 0x7f] \u7bc4\u570d\u5167\u7684\u55ae\u500b\u5b57\u7bc0\u6216 0-55 \u5b57\u7bc0\u9577\u7684\u5b57\u7b26\u4e32\u3002</p> <p>\u5982\u679c\u5b57\u7b26\u4e32\u7684\u9577\u5ea6\u8d85\u904e 55 \u500b\u5b57\u7bc0\uff0c\u5247 RLP \u7de8\u78bc\u5305\u542b\u4e00\u500b\u503c\u70ba 0xb7\uff08dec.183\uff09\u7684\u5b57\u7bc0\u52a0\u4e0a\u9577\u5ea6 \u4e8c\u9032\u5236\u5f62\u5f0f\u7684\u5b57\u7b26\u4e32\u9577\u5ea6\u7684\u5b57\u7bc0\uff0c\u5f8c\u8ddf\u5b57\u7b26\u4e32\u7684\u9577\u5ea6\uff0c\u5f8c\u8ddf\u5b57\u7b26\u4e32\u3002</p> <p>RLP \u7528\u65bc\u54c8\u5e0c\u9a57\u8b49\uff0c\u5176\u4e2d\u901a\u904e\u7c3d\u7f72\u4ea4\u6613\u6578\u64da\u7684 RLP \u54c8\u5e0c\u4f86\u7c3d\u7f72\u4ea4\u6613\uff0c\u4e26\u4e14\u5340\u584a\u7531\u5176\u6a19\u982d\u7684 RLP \u54c8\u5e0c\u6a19\u8b58\u3002</p> <p>RLP \u9084\u7528\u65bc\u901a\u904e\u7db2\u7d61\u5c0d\u6578\u64da\u9032\u884c\u7de8\u78bc\uff0c\u4ee5\u53ca\u5728\u67d0\u4e9b\u60c5\u6cc1\u4e0b\u61c9\u8a72\u652f\u6301\u9ed8\u514b\u723e\u6a39\u6578\u64da\u7d50\u69cb\u7684\u9ad8\u6548\u7de8\u78bc\u3002</p> <p>\u4ee5\u592a\u574a\u57f7\u884c\u5c64\u4f7f\u7528 RLP \u4f5c\u70ba\u5e8f\u5217\u5316\u5c0d\u8c61\u7684\u4e3b\u8981\u7de8\u78bc\u65b9\u5f0f\uff0c\u4f46\u66f4\u65b0\u7684 Simple Serialize (SSZ) \u53d6\u4ee3\u4e86 RLP \u4f5c\u70ba\u4ee5\u592a\u574a 2.0 \u4e2d\u65b0\u5171\u8b58\u5c64\u7684\u7de8\u78bc\u3002</p> <p>Cosmos Stargate \u7248\u672c\u5f15\u5165\u4e86 protobuf \u4f5c\u70ba\u5ba2\u6236\u7aef\u548c\u72c0\u614b\u5e8f\u5217\u5316\u7684\u4e3b\u8981\u7de8\u78bc\u683c\u5f0f\u3002</p> <p>\u6240\u6709\u7528\u65bc\u72c0\u614b\u548c\u5ba2\u6236\u7aef\u7684 EVM \u6a21\u584a\u985e\u578b\uff0c\u5982\u4ea4\u6613\u6d88\u606f\u3001\u5275\u4e16\u3001\u67e5\u8a62\u670d\u52d9\u7b49\uff0c\u90fd\u5c07\u4f5c\u70ba\u5354\u8b70\u7de9\u885d\u5340\u6d88\u606f\u5be6\u73fe\u3002</p> <p>Cosmos SDK \u9084\u652f\u6301\u50b3\u7d71\u7684 Amino \u7de8\u78bc\u3002</p> <p>Protocol Buffers (protobuf) \u662f\u4e00\u7a2e\u8207\u8a9e\u8a00\u7121\u95dc\u7684\u4e8c\u9032\u5236\u5e8f\u5217\u5316\u683c\u5f0f\uff0c\u5b83\u6bd4 JSON \u66f4\u5c0f\u66f4\u5feb\u3002</p> <p>\u5b83\u7528\u65bc\u5e8f\u5217\u5316\u7d50\u69cb\u5316\u6578\u64da\uff0c\u4f8b\u5982\u6d88\u606f\uff0c\u4e26\u4e14\u88ab\u8a2d\u8a08\u70ba\u9ad8\u6548\u548c\u53ef\u64f4\u5c55\u7684\u3002</p> <p>\u7de8\u78bc\u683c\u5f0f\u4ee5\u8207\u8a9e\u8a00\u7121\u95dc\u7684\u8a9e\u8a00\u5b9a\u7fa9\uff0c\u7a31\u70ba Protocol Buffers Language (proto3)\uff0c\u7de8\u78bc\u7684\u6d88\u606f\u53ef\u7528\u65bc\u70ba\u5404\u7a2e\u7de8\u7a0b\u8a9e\u8a00\u751f\u6210\u4ee3\u78bc\u3002</p> <p>protobuf \u7684\u4e3b\u8981\u512a\u9ede\u662f\u5b83\u7684\u6548\u7387\uff0c\u9019\u5c0e\u81f4\u66f4\u5c0f\u7684\u6d88\u606f\u5927\u5c0f\u548c\u66f4\u5feb\u7684\u5e8f\u5217\u5316\u548c\u53cd\u5e8f\u5217\u5316\u6642\u9593\u3002</p> <p>RLP\u89e3\u78bc\u904e\u7a0b\u5982\u4e0b\uff1a\u6839\u64da\u8f38\u5165\u6578\u64da\u7684\u7b2c\u4e00\u500b\u5b57\u7bc0\uff08\u5373\u524d\u7db4\uff09\u89e3\u78bc\u6578\u64da\u985e\u578b\u3001\u5be6\u969b\u6578\u64da\u7684\u9577\u5ea6\u548c\u504f\u79fb\u91cf\uff1b\u6839\u64da\u6578\u64da\u7684\u985e\u578b\u548c\u504f\u79fb\u91cf\uff0c\u5c0d\u6578\u64da\u9032\u884c\u76f8\u61c9\u7684\u89e3\u78bc\u3002</p>"},{"location":"protocol/#_12","title":"\u5148\u6c7a\u689d\u4ef6\u95b1\u8b80","text":"<ul> <li>Cosmos SDK Encoding</li> <li>Ethereum RLP</li> </ul>"},{"location":"protocol/#_13","title":"\u7de8\u78bc\u683c\u5f0f","text":"<p> Protocol Buffers </p> <p>Cosmos Stargate \u7248\u672c\u5f15\u5165\u4e86 protobuf \u4f5c\u70ba\u5ba2\u6236\u7aef\u548c\u72c0\u614b\u5e8f\u5217\u5316\u7684\u4e3b\u8981\u7de8\u78bc\u683c\u5f0f\u3002</p> <p>\u6240\u6709\u7528\u65bc\u72c0\u614b\u548c\u5ba2\u6236\u7aef\uff08\u4ea4\u6613\u6d88\u606f\u3001\u5275\u4e16\u3001\u67e5\u8a62\u670d\u52d9\u7b49\uff09\u7684 EVM \u6a21\u584a\u985e\u578b\u90fd\u5c07\u4f5c\u70ba\u5354\u8b70\u7de9\u885d\u5340\u6d88\u606f\u5be6\u73fe\u3002</p> <p>  Amino </p> <p>Cosmos SDK \u9084\u652f\u6301\u820a\u7248 Amino \u7de8\u78bc\u683c\u5f0f\uff0c\u4ee5\u5411\u5f8c\u517c\u5bb9\u4ee5\u524d\u7684\u7248\u672c\uff0c\u7279\u5225\u662f\u7528\u65bc\u5ba2\u6236\u7aef\u7de8\u78bc\u548c\u4f7f\u7528 Ledger \u8a2d\u5099\u7c3d\u540d\u3002</p> <p>Daodst \u5728 EVM \u6a21\u584a\u4e2d\u4e0d\u652f\u6301 Amino\uff0c\u4f46\u6240\u6709\u5176\u4ed6\u555f\u7528\u5b83\u7684 Cosmos SDK \u6a21\u584a\u90fd\u652f\u6301\u5b83\u3002</p> <p>  RLP </p> <p>\u905e\u6b78\u9577\u5ea6\u524d\u7db4 (RLP) \u662f\u4e00\u7a2e\u7de8\u78bc/\u89e3\u78bc\u7b97\u6cd5\uff0c\u53ef\u5e8f\u5217\u5316\u6d88\u606f\u4e26\u5141\u8a31\u5feb\u901f\u91cd\u5efa\u7de8\u78bc\u6578\u64da\u3002</p> <p>Daodst \u4f7f\u7528 RLP \u7de8\u78bc/\u89e3\u78bc\u4ee5\u592a\u574a\u6d88\u606f\u4ee5\u9032\u884c JSON-RPC \u8655\u7406\uff0c\u4ee5\u4f7f\u6d88\u606f\u7b26\u5408\u6b63\u78ba\u7684\u4ee5\u592a\u574a\u683c\u5f0f\u3002\u9019\u5141\u8a31\u4ee5\u8207\u4ee5\u592a\u574a\u7684\u683c\u5f0f\u5b8c\u5168\u76f8\u540c\u7684\u683c\u5f0f\u5c0d\u6d88\u606f\u9032\u884c\u7de8\u78bc\u548c\u89e3\u78bc\u3002</p> <p><code>x/evm</code> \u4ea4\u6613 (<code>MsgEthereumTx</code>) \u7de8\u78bc\u662f\u901a\u904e\u5c07\u6d88\u606f\u8f49\u63db\u70ba go-ethereum \u7684 <code>Transaction</code> \u7136\u5f8c\u4f7f\u7528 RLP \u7de8\u7d44\u4ea4\u6613\u6578\u64da\u4f86\u57f7\u884c\u7684\uff1a</p> <pre><code>// TxEncoder overwrites sdk.TxEncoder to support MsgEthereumTx\nfunc (g txConfig) TxEncoder() sdk.TxEncoder {\nreturn func(tx sdk.Tx) ([]byte, error) {\n  msg, ok := tx.(*evmtypes.MsgEthereumTx)\n  if ok {\n    return msg.AsTransaction().MarshalBinary()\n  }\n  return g.TxConfig.TxEncoder()(tx)\n}\n}\n\n// TxDecoder overwrites sdk.TxDecoder to support MsgEthereumTx\nfunc (g txConfig) TxDecoder() sdk.TxDecoder {\nreturn func(txBytes []byte) (sdk.Tx, error) {\n  tx := &amp;ethtypes.Transaction{}\n\n  err := tx.UnmarshalBinary(txBytes)\n  if err == nil {\n    msg := &amp;evmtypes.MsgEthereumTx{}\n    msg.FromEthereumTx(tx)\n    return msg, nil\n  }\n\n  return g.TxConfig.TxDecoder()(txBytes)\n}\n}\n</code></pre>"},{"location":"protocol/#gas","title":"Gas\u548c\u624b\u7e8c\u8cbb","text":"<p>\u7528\u6236\u9700\u8981\u652f\u4ed8\u8cbb\u7528\u624d\u80fd\u5728 Daodst \u7db2\u7d61\u4e0a\u63d0\u4ea4\u4ea4\u6613\u3002 \u7531\u65bc\u4ee5\u592a\u574a\u548c Cosmos \u7684\u8cbb\u7528\u8655\u7406\u65b9\u5f0f\u4e0d\u540c\uff0c\u4e86\u89e3 Daodst \u5340\u584a\u93c8\u5982\u4f55\u5be6\u73fe\u8207 Cosmos SDK \u517c\u5bb9\u7684\u4ee5\u592a\u574a\u985e\u578b\u7684\u8cbb\u7528\u8a08\u7b97\u975e\u5e38\u91cd\u8981\u3002</p> <p>\u56e0\u6b64\uff0c\u672c\u6982\u8ff0\u89e3\u91cb\u4e86\u5929\u7136\u6c23\u8a08\u7b97\u7684\u57fa\u790e\u77e5\u8b58\u3001\u5982\u4f55\u70ba\u4ea4\u6613\u63d0\u4f9b\u8cbb\u7528\u4ee5\u53ca\u4ee5\u592a\u574a\u985e\u578b\u7684\u8cbb\u7528\u8a08\u7b97\u5982\u4f55\u4f7f\u7528\u8cbb\u7528\u5e02\u5834 (EIP1559) \u4f86\u78ba\u5b9a\u4ea4\u6613\u7684\u512a\u5148\u7d1a\u3002</p> <p>\u53e6\u5916\u8acb\u6ce8\u610f\uff0c\u8207 Daodst \u4e0a\u7684\u667a\u80fd\u5408\u7d04\u4ea4\u4e92\u6240\u652f\u4ed8\u7684\u8cbb\u7528\u53ef\u4ee5\u70ba\u667a\u80fd\u5408\u7d04\u90e8\u7f72\u8005\u8cfa\u53d6\u6536\u5165\u3002 \u6709\u95dc\u9019\u65b9\u9762\u7684\u4fe1\u606f\uff0c\u8acb\u524d\u5f80 develop\u3002</p> <p> \u5148\u6c7a\u689d\u4ef6\u95b1\u8b80 </p> <ul> <li>Cosmos SDK Gas</li> <li>Ethereum Gas</li> </ul> <p>  Basics </p> <p>  \u70ba\u4ec0\u9ebc\u4ea4\u6613\u9700\u8981\u624b\u7e8c\u8cbb? </p> <p>\u5982\u679c\u4efb\u4f55\u4eba\u90fd\u53ef\u4ee5\u514d\u8cbb\u5411\u7db2\u7d61\u63d0\u4ea4\u4ea4\u6613\uff0c\u5247\u7db2\u7d61\u53ef\u80fd\u6703\u88ab\u5c11\u6578\u53c3\u8207\u8005\u767c\u9001\u5927\u91cf\u6b3a\u8a50\u6027\u4ea4\u6613\u4ee5\u963b\u585e\u7db2\u7d61\u4e26\u4f7f\u5176\u7121\u6cd5\u6b63\u5e38\u5de5\u4f5c\u3002</p> <p>\u9019\u500b\u554f\u984c\u7684\u89e3\u6c7a\u65b9\u6848\u662f\u4e00\u500b\u53eb\u505a\u201cgas\u201d\u7684\u6982\u5ff5\uff0c\u5b83\u662f\u5728\u6574\u500b\u4ea4\u6613\u57f7\u884c\u904e\u7a0b\u4e2d\u6d88\u8017\u7684\u8cc7\u6e90\u3002</p> <p>\u5728\u5be6\u8e10\u4e2d\uff0c\u4ee3\u78bc\u57f7\u884c\u7684\u6bcf\u4e00\u6b65\u90fd\u6703\u6d88\u8017\u5c11\u91cfgas\uff0c\u5f9e\u800c\u6709\u6548\u5730\u5c0d\u9a57\u8b49\u8005\u8cc7\u6e90\u7684\u4f7f\u7528\u9032\u884c\u6536\u8cbb\uff0c\u4e26\u9632\u6b62\u60e1\u610f\u884c\u70ba\u8005\u96a8\u610f\u4e2d\u65b7\u7db2\u7d61\u3002</p> <p>  \u4ec0\u9ebc\u662f Gas? </p> <p>\u4e00\u822c\u4f86\u8aaa\uff0cgas \u662f\u8861\u91cf\u7279\u5b9a\u4ea4\u6613\u8a08\u7b97\u5f37\u5ea6\u7684\u55ae\u4f4d\u2014\u2014\u63db\u53e5\u8a71\u8aaa\uff0c\u8a55\u4f30\u548c\u57f7\u884c\u9019\u9805\u5de5\u4f5c\u9700\u8981\u591a\u5c11\u5de5\u4f5c\u91cf\u3002</p> <p>\u8907\u96dc\u7684\u591a\u6b65\u4ea4\u6613\uff0c\u4f8b\u5982\u59d4\u8a17\u7d66\u5341\u5e7e\u500b\u9a57\u8b49\u5668\u7684 Cosmos \u4ea4\u6613\uff0c\u6bd4\u7c21\u55ae\u7684\u55ae\u6b65\u4ea4\u6613\uff08\u4f8b\u5982\u5c07\u4ee3\u5e63\u767c\u9001\u5230\u53e6\u4e00\u500b\u5730\u5740\u7684 Cosmos \u4ea4\u6613\uff09\u9700\u8981\u66f4\u591a\u7684 gas\u3002</p> <p>\u5728\u63d0\u53ca\u4ea4\u6613\u6642\uff0c\u201cgas\u201d\u662f\u6307\u4ea4\u6613\u6240\u9700\u7684gas\u7e3d\u91cf\u3002</p> <p>\u4f8b\u5982\uff0c\u4e00\u7b46\u4ea4\u6613\u53ef\u80fd\u9700\u8981 300,000 \u55ae\u4f4d\u7684gas\u624d\u80fd\u57f7\u884c\u3002</p> <p>\u53ef\u4ee5\u5c07gas\u8996\u70ba\u623f\u5c4b\u6216\u5de5\u5ee0\u5167\u7684\u96fb\u529b (kWh)\uff0c\u6216\u6c7d\u8eca\u71c3\u6599\u3002</p> <p>\u9019\u500b\u60f3\u6cd5\u662f\u8981\u82b1\u4e00\u4e9b\u9322\u624d\u80fd\u5230\u9054\u67d0\u500b\u5730\u65b9\u3002</p> <p>\u66f4\u591a Gas \u4ecb\u7d39:</p> <ul> <li>Cosmos Gas Fees</li> <li>Cosmos Tx Lifecycle</li> <li>Ethereum Gas</li> </ul> <p>  \u5982\u4f55\u8a08\u7b97Gas </p> <p>\u4e00\u822c\u4f86\u8aaa\uff0c\u5982\u679c\u4e0d\u7c21\u55ae\u5730\u904b\u884c\u4ea4\u6613\uff0c\u5c31\u7121\u6cd5\u78ba\u5207\u77e5\u9053\u4ea4\u6613\u5c07\u82b1\u8cbb\u591a\u5c11 gas\u3002</p> <p>\u4f7f\u7528 Cosmos SDK\uff0c\u9019\u53ef\u4ee5\u901a\u904e\u6a21\u64ec Tx \u4f86\u5b8c\u6210\u3002</p> <p>\u5426\u5247\uff0c\u6709\u4e00\u4e9b\u65b9\u6cd5\u53ef\u4ee5\u6839\u64da\u4ea4\u6613\u5b57\u6bb5\u548c\u6578\u64da\u7684\u8a73\u7d30\u4fe1\u606f\u4f86\u4f30\u8a08\u4ea4\u6613\u5c07\u9700\u8981\u7684gas\u3002</p> <p>\u4f8b\u5982\uff0c\u5728 EVM \u7684\u60c5\u6cc1\u4e0b\uff0c\u6bcf\u500b\u5b57\u7bc0\u78bc\u64cd\u4f5c\u90fd\u6709 \u76f8\u61c9\u6578\u91cf\u7684gas\u3002</p> <p>\u66f4\u591a\u95dc\u65bcGas\u8a08\u7b97:</p> <ul> <li>Estimate Gas</li> <li>Executing EVM Bytecode</li> <li>Simulate a Cosmos SDK Tx</li> </ul> <p>  Gas\u548c\u624b\u7e8c\u8cbb\u7684\u95dc\u4fc2? </p> <p>Gas \u662f\u6307\u57f7\u884c\u6240\u9700\u7684\u8a08\u7b97\u5de5\u4f5c\uff0c\u800c\u8cbb\u7528\u662f\u6307\u60a8\u5be6\u969b\u82b1\u8cbb\u4f86\u57f7\u884c\u4ea4\u6613\u7684\u4ee3\u5e63\u6578\u91cf\u3002</p> <p>\u5b83\u5011\u662f\u4f7f\u7528\u4ee5\u4e0b\u516c\u5f0f\u5f97\u51fa\u7684\uff1a</p> <pre><code>Total Fees = Gas * Gas Price (the price per unit of gas)\n</code></pre> <p>\u5982\u679c <code>gas</code> \u4ee5 kWh \u70ba\u55ae\u4f4d\uff0c\u5247\u201cgas price\u201d\u5c07\u662f\u60a8\u7684\u80fd\u6e90\u4f9b\u61c9\u5546\u78ba\u5b9a\u7684\u8cbb\u7387\uff08\u4ee5\u7f8e\u5143/kWh \u70ba\u55ae\u4f4d\uff09\uff0c\u800c <code>fees\u200b\u200b</code> \u5c07\u662f\u60a8\u7684\u8cec\u55ae\u3002</p> <p>\u8207\u96fb\u529b\u4e00\u6a23\uff0cgas\u50f9\u683c\u5728\u67d0\u4e00\u5929\u53ef\u80fd\u6703\u6ce2\u52d5\uff0c\u5177\u9ad4\u53d6\u6c7a\u65bc\u7db2\u7d61\u6d41\u91cf\u3002</p> <p>\u66f4\u591a\u95dc\u65bc Gas \u548c \u624b\u7e8c\u8cbb:</p> <ul> <li>Cosmos Gas and Fees</li> <li>Ethereum Gas and Fees</li> </ul> <p>  Cosmos\u5982\u4f55\u8655\u7406\u624b\u7e8c\u8cbb? </p> <p>Cosmos \u7684gas\u8cbb\u76f8\u5c0d\u7c21\u55ae\u3002\u4f5c\u70ba\u7528\u6236\uff0c\u60a8\u6307\u5b9a\u5169\u500b\u5b57\u6bb5\uff1a</p> <ol> <li>\u5c0d\u61c9\u65bc\u57f7\u884c\u6c23\u9ad4\u4e0a\u9650\u7684 <code>GasLimit</code>\uff0c\u5b9a\u7fa9\u70ba<code>GasWanted</code></li> <li><code>Fees</code> \u6216 <code>GasPrice</code> \u4e4b\u4e00\uff0c\u5c07\u7528\u65bc\u6307\u5b9a\u6216\u8a08\u7b97\u4ea4\u6613\u8cbb\u7528</li> </ol> <p>\u7bc0\u9ede\u5c07\u5b8c\u5168\u6d88\u8017\u6240\u63d0\u4f9b\u7684\u8cbb\u7528\uff0c\u7136\u5f8c\u958b\u59cb\u57f7\u884c\u4ea4\u6613\u3002 \u5982\u679c\u5728\u57f7\u884c\u904e\u7a0b\u4e2d\u767c\u73fe<code>GasLimit</code>\u4e0d\u8db3\uff0c\u4ea4\u6613\u5c07\u5931\u6557\u4e26\u56de\u6efe\u4efb\u4f55\u66f4\u6539\uff0c\u4e0d\u9000\u9084\u63d0\u4f9b\u7684\u8cbb\u7528\u3002</p> <p>\u57fa\u65bc Cosmos SDK \u7684\u93c8\u7684\u9a57\u8b49\u8005\u53ef\u4ee5\u6307\u5b9a\u4ed6\u5011\u5728\u9078\u64c7\u8981\u5305\u542b\u5728\u5340\u584a\u4e2d\u7684\u4ea4\u6613\u6642\u5c07\u5f37\u5236\u57f7\u884c\u7684\u201c\u6700\u4f4e\u6c7d\u6cb9\u50f9\u683c\u201d\u3002</p> <p>\u56e0\u6b64\uff0c\u8cbb\u7528\u4e0d\u8db3\u7684\u4ea4\u6613\u5c07\u9047\u5230\u5ef6\u9072\u6216\u5fb9\u5e95\u5931\u6557\u3002</p> <p>\u5728\u6bcf\u500b\u5340\u584a\u7684\u958b\u59cb\uff0c\u524d\u4e00\u500b\u5340\u584a\u7684\u8cbb\u7528\u88ab\u5206\u914d\u7d66\u9a57\u8b49\u8005\u548c\u59d4\u8a17\u8005\uff0c\u4e4b\u5f8c\u5b83\u5011\u53ef\u4ee5\u88ab\u63d0\u53d6\u548c\u4f7f\u7528\u3002</p> <p>  \u5982\u4f55\u5728\u4ee5\u592a\u574a\u4e0a\u8655\u7406\u624b\u7e8c\u8cbb? </p> <p>\u4ee5\u592a\u574a\u7684\u8cbb\u7528\u5305\u62ec\u96a8\u8457\u6642\u9593\u7684\u63a8\u79fb\u5f15\u5165\u7684\u591a\u7a2e\u5be6\u73fe\u3002</p> <p>\u6700\u521d\uff0c\u7528\u6236\u6703\u5728\u4ea4\u6613\u4e2d\u6307\u5b9a <code>GasPrice</code> \u548c <code>GasLimit</code> \u2014\u2014\u5f88\u50cf Cosmos SDK \u4ea4\u6613\u3002</p> <p>\u5340\u584a\u63d0\u8b70\u8005\u5c07\u5f9e\u5340\u584a\u4e2d\u7684\u6bcf\u7b46\u4ea4\u6613\u4e2d\u6536\u53d6\u5168\u90e8\u6c7d\u6cb9\u8cbb\uff0c\u4e26\u4e14\u4ed6\u5011\u6703\u76f8\u61c9\u5730\u9078\u64c7\u8981\u5305\u542b\u7684\u4ea4\u6613\u3002</p> <p>\u96a8\u8457\u63d0\u6848 EIP-1559 \u548c\u502b\u6566\u786c\u5206\u53c9\uff0cgas \u8a08\u7b97\u767c\u751f\u4e86\u8b8a\u5316\u3002</p> <p>\u4e0a\u9762\u7684 <code>GasPrice</code> \u73fe\u5728\u88ab\u5206\u6210\u5169\u500b\u7368\u7acb\u7684\u90e8\u5206\uff1a<code>BaseFee</code> \u548c <code>PriorityFee</code>\u3002</p> <p><code>BaseFee</code> \u662f\u6839\u64da\u5340\u584a\u5927\u5c0f\u81ea\u52d5\u8a08\u7b97\u7684\uff0c\u4e00\u65e6\u5340\u584a\u88ab\u6316\u51fa\u5c31\u6703\u88ab\u92b7\u6bc0\u3002</p> <p><code>PriorityFee</code> \u4ea4\u7d66\u63d0\u8b70\u8005\u4e26\u4ee3\u8868\u4e00\u500b\u5c0f\u8cbb\uff0c\u6216\u6fc0\u52f5\u63d0\u8b70\u8005\u5c07\u4ea4\u6613\u5305\u542b\u5728\u4e00\u500b\u5340\u584a\u4e2d\u3002</p> <pre><code>Gas Price = Base Fee + Priority Fee\n</code></pre> <p>\u5728\u4ea4\u6613\u4e2d\uff0c\u9664\u4e86\u50cf\u4ee5\u524d\u4e00\u6a23\u6307\u5b9a <code>gas_limit</code> \u4e4b\u5916\uff0c\u7528\u6236\u9084\u53ef\u4ee5\u6307\u5b9a\u5c0d\u61c9\u65bc\u7e3d <code>GasPrice</code> \u7684 <code>max_fee_per_gas</code> \u548c\u5c0d\u61c9\u65bc\u6700\u5927 <code>PriorityFee</code> \u7684 <code>max_priority_fee_per_gas</code>\u3002</p> <p>\u6240\u6709\u4e0d\u9700\u8981\u57f7\u884c\u7684\u591a\u9918\u6c23\u9ad4\u90fd\u9000\u9084\u7d66\u7528\u6236\u3002</p> <p>\u66f4\u591a\u95dc\u65bc Ethereum \u624b\u7e8c\u8cbb:</p> <ul> <li>Gas Calculation Docs</li> <li>Proposal EIP-1559</li> </ul> <p>   \u5be6\u65bd </p> <p>  \u5982\u4f55\u5728Daodst\u4e0a\u8655\u7406Gas\u548c\u624b\u7e8c\u8cbb? </p> <p>\u5f9e\u6839\u672c\u4e0a\u8aaa\uff0cDaodst \u662f\u4e00\u500b Cosmos SDK \u93c8\uff0c\u53ef\u4f5c\u70ba Cosmos SDK \u6a21\u584a\u7684\u4e00\u90e8\u5206\u5be6\u73fe EVM \u517c\u5bb9\u6027\u3002\u7531\u65bc\u9019\u7a2e\u67b6\u69cb\uff0c\u6240\u6709 EVM \u4ea4\u6613\u6700\u7d42\u90fd\u88ab\u7de8\u78bc\u70ba Cosmos SDK \u4ea4\u6613\u4e26\u66f4\u65b0 Cosmos SDK \u7ba1\u7406\u7684\u72c0\u614b\u3002\u7531\u65bc\u6240\u6709\u4ea4\u6613\u90fd\u8868\u793a\u70ba Cosmos SDK \u4ea4\u6613\uff0c\u56e0\u6b64\u4ea4\u6613\u8cbb\u7528\u53ef\u4ee5\u5728\u4e0d\u540c\u57f7\u884c\u5c64\u3002</p> <p>\u5be6\u969b\u4e0a\uff0c\u8655\u7406\u8cbb\u7528\u5305\u62ec\u6a19\u6e96\u7684 Cosmos SDK \u908f\u8f2f\u3001\u4e00\u4e9b\u4ee5\u592a\u574a\u908f\u8f2f\u548c customDaodst \u908f\u8f2f\u3002\u5927\u591a\u6578\u60c5\u6cc1\u4e0b\uff0c\u8cbb\u7528\u7531 <code>fee_collector</code> \u6a21\u584a\u6536\u53d6\uff0c\u7136\u5f8c\u652f\u4ed8\u7d66\u9a57\u8b49\u8005\u548c\u59d4\u8a17\u8005\u3002\u4e00\u4e9b\u95dc\u9375\u7684\u5340\u5225\u5982\u4e0b\uff1a</p> <p>1.Fee \u5e02\u5834\u6a21\u584a</p> <p>\u70ba\u4e86\u5728 Daodst \u7684 EVM \u5c64\u4e0a\u652f\u6301 EIP-1559 \u6c23\u9ad4\u548c\u8cbb\u7528\u8a08\u7b97\uff0cDaodst \u8ddf\u8e2a\u70ba\u6bcf\u500b\u5340\u584a\u4f9b\u61c9\u7684\u6c23\u9ad4\uff0c\u4e26\u4f7f\u7528\u5b83\u4f86\u8a08\u7b97\u672a\u4f86 EVM \u4ea4\u6613\u7684\u57fa\u672c\u8cbb\u7528\uff0c\u5f9e\u800c\u5be6\u73fe EIP \u6307\u5b9a\u7684 EVM \u52d5\u614b\u8cbb\u7528\u548c\u4ea4\u6613\u512a\u5148\u7d1a -1559\u3002</p> <p>\u5c0d\u65bc EVM \u4ea4\u6613\uff0c\u6bcf\u500b\u7bc0\u9ede\u90fd\u7e5e\u904e\u5176\u672c\u5730\u7684 <code>min-gas-prices</code> \u914d\u7f6e\uff0c\u800c\u662f\u61c9\u7528 EIP-1559 \u8cbb\u7528\u908f\u8f2f\u2014\u2014gas \u50f9\u683c\u5fc5\u9808\u7c21\u55ae\u5730\u5927\u65bc\u5168\u5c40 <code>min-gas-price</code> \u548c\u5340\u584a\u7684 <code>BaseFee</code> \uff0c\u5269\u9918\u90e8\u5206\u88ab\u8996\u70ba\u512a\u5148\u5c0f\u8cbb\u3002</p> <p>\u9019\u5141\u8a31\u9a57\u8b49\u8005\u5728\u4e0d\u61c9\u7528 Cosmos SDK \u8cbb\u7528\u908f\u8f2f\u7684\u60c5\u6cc1\u4e0b\u8a08\u7b97\u4ee5\u592a\u574a\u8cbb\u7528\u3002</p> <p>\u8207\u4ee5\u592a\u574a\u4e0d\u540c\uff0cDaodst \u4e0a\u7684\u201cBaseFee\u201d\u4e0d\u6703\u88ab\u92b7\u6bc0\uff0c\u800c\u662f\u5206\u767c\u7d66\u9a57\u8b49\u8005\u548c\u59d4\u8a17\u8005</p> <p>\u6b64\u5916\uff0c<code>BaseFee</code> \u53d7\u5168\u5c40<code>min-gas-price</code> \u7684\u4e0b\u9650\uff08\u76ee\u524d\uff0c\u5168\u5c40<code>min-gas-price</code> \u53c3\u6578\u8a2d\u7f6e\u70ba\u96f6\uff0c\u5118\u7ba1\u5b83\u53ef\u4ee5\u901a\u904e\u6cbb\u7406\u9032\u884c\u66f4\u65b0\uff09\u3002</p> <p>2.EVM Gas\u8fd4\u9084</p> <p>Daodst \u6703\u70ba EVM \u4ea4\u6613\u9000\u9084\u4e00\u5c0f\u90e8\u5206\uff08\u9ed8\u8a8d\u60c5\u6cc1\u4e0b\u81f3\u5c11 50%\uff09\u672a\u4f7f\u7528\u7684\u6c23\u9ad4\uff0c\u4ee5\u63a5\u8fd1\u4ee5\u592a\u574a\u4e0a\u7684\u7576\u524d\u884c\u70ba\u3002 </p> <p>3.\u6536\u5165\u6a21\u584a</p> <p>Daodst \u958b\u767c\u6536\u5165\u6a21\u584a\u4f5c\u70ba\u734e\u52f5\u958b\u767c\u4eba\u54e1\u5275\u5efa\u6709\u7528\u7684 dApp \u7684\u4e00\u7a2e\u65b9\u5f0f\u2014\u2014\u4efb\u4f55\u5728 Daodst \u6536\u5165\u6a21\u584a\u8a3b\u518a\u7684\u5408\u540c\u90fd\u6703\u5f9e\u8207\u5408\u540c\u4ea4\u4e92\u7684\u6bcf\u7b46\u4ea4\u6613\u4e2d\u5411\u5408\u540c\u958b\u767c\u4eba\u54e1\u734e\u52f5\u4e00\u5c0f\u90e8\u5206\u4ea4\u6613\u8cbb\u7528\uff08\u76ee\u524d\u70ba 95%\uff09. \u9a57\u8b49\u8005\u548c\u59d4\u8a17\u8005\u8cfa\u53d6\u5269\u9918\u90e8\u5206\u3002</p> <p>  \u8a73\u7d30\u6642\u9593\u8868 </p> <p>1.\u7bc0\u9ede\u57f7\u884c\u524d\u4e00\u500b\u584a\u4e26\u904b\u884c <code>EndBlock</code> \u639b\u9264 * \u4f5c\u70ba\u6b64\u639b\u9264\u7684\u4e00\u90e8\u5206\uff0cFeeMarket (EIP-1559) \u6a21\u584a\u5f9e\u8a72\u584a\u4e0a\u7684\u4ea4\u6613\u4e2d\u8ddf\u8e2a\u7e3d\u7684 <code>TransientGasWanted</code>\u3002 \u9019\u5c07\u7528\u65bc\u4e0b\u4e00\u500b\u5340\u584a\u7684 <code>BaseFee</code>\u3002</p> <p>2.\u7bc0\u9ede\u63a5\u6536\u5f8c\u7e8c\u5340\u584a\u7684\u4ea4\u6613\u4e26\u5c07\u9019\u4e9b\u4ea4\u6613\u516b\u5366\u7d66\u540c\u884c*\u9019\u4e9b\u53ef\u4ee5\u6309\u5305\u542b\u7684\u8cbb\u7528\u50f9\u683c\u6392\u5e8f\u548c\u512a\u5148\u7d1a\uff08\u4f7f\u7528 EIP-1559 \u8cbb\u7528\u512a\u5148\u6a5f\u5236\u9032\u884c EVM \u4ea4\u6613 \uff0c\u5c07\u5305\u542b\u5728\u4e0b\u4e00\u500b\u5340\u584a\u4e2d</p> <p>3.\u7bc0\u9ede\u70ba\u5f8c\u7e8c\u584a\u904b\u884c <code>BeginBlock</code> * FeeMarket \u6a21\u584a\u8a08\u7b97 <code>BaseFee</code> \u4f7f\u7528\u524d\u4e00\u500b\u584a\u4e2d\u7684\u7e3d <code>GasWanted</code> \u61c9\u7528\u65bc\u6b64\u584a\u3002 * \u5206\u914d\u6a21\u584a distributes \u524d\u4e00\u500b\u5340\u584a\u7684\u8cbb\u7528\u734e\u52f5\u7d66\u9a57\u8b49\u8005\u548c\u59d4\u8a17\u8005</p> <p>4.\u5c0d\u65bc\u5c07\u5305\u542b\u5728\u6b64\u584a\u4e2d\u7684\u6bcf\u500b\u6709\u6548\u4ea4\u6613\uff0c\u7bc0\u9ede\u57f7\u884c\u4ee5\u4e0b\u64cd\u4f5c\uff1a</p> <p> \u4ed6\u5011\u904b\u884c\u4e00\u500b\u5c0d\u61c9\u65bc\u4ea4\u6613\u985e\u578b\u7684<code>AnteHandler</code> \u3002</p> <p>\u9019\u500b\u6d41\u7a0b:</p> <ol> <li>\u57f7\u884c\u57fa\u672c\u4ea4\u6613\u9a57\u8b49</li> <li>\u9a57\u8b49\u63d0\u4f9b\u7684\u8cbb\u7528\u662f\u5426\u5927\u65bc\u5168\u7403\u548c\u672c\u5730\u6700\u5c0f\u9a57\u8b49\u5668\u503c\u4e26\u4e14\u5927\u65bc\u8a08\u7b97\u51fa\u7684<code>BaseFee</code>    3.\uff08\u5c0d\u65bc\u4ee5\u592a\u574a\u4ea4\u6613\uff09\u6436\u4f54EVM\u4ea4\u6613\u6d88\u8017gas</li> <li>\u6263\u9664\u7528\u6236\u7684\u4ea4\u6613\u624b\u7e8c\u8cbb\uff0c\u8f49\u5165<code>fee_collector</code>\u6a21\u584a</li> <li> <p>\u589e\u52a0\u7576\u524d\u5340\u584a\u4e2d\u7684 <code>TransientGasWanted</code>\uff0c\u7528\u65bc\u8a08\u7b97\u4e0b\u4e00\u500b\u5340\u584a\u7684 <code>BaseFee</code></p> <p>\u7136\u5f8c\uff0c\u5c0d\u65bc\u6a19\u6e96Cosmos\u4ea4\u6613,\u7bc0\u9ede</p> <ul> <li>\u57f7\u884c\u4ea4\u6613\u4e26\u66f4\u65b0\u72c0\u614b</li> <li>\u4ea4\u6613\u6d88\u8017gas</li> </ul> <p>\u5c0d\u65bc\u4ee5\u592a\u574a\u4ea4\u6613\uff0c\u7bc0\u9ede:</p> <ul> <li>\u57f7\u884c\u4ea4\u6613\u4e26\u66f4\u65b0\u72c0\u614b</li> <li>\u8a08\u7b97\u4f7f\u7528\u7684gas\u4e26\u8207\u4f9b\u61c9\u7684gas\u9032\u884c\u6bd4\u8f03\uff0c\u7136\u5f8c\u9000\u9084\u6307\u5b9a\u90e8\u5206\u7684\u5269\u9918\u90e8\u5206</li> <li>\u5982\u679c\u4ea4\u6613\u8207\u5df2\u8a3b\u518a\u7684\u667a\u80fd\u5408\u7d04\u4ea4\u4e92\uff0c\u5247\u5c07\u4e00\u5c0f\u90e8\u5206\u7528\u4f5c\u6536\u5165\u7684\u8cbb\u7528\u4f5c\u70ba\u6536\u5165\u6a21\u584a\u7684\u4e00\u90e8\u5206\u767c\u9001\u7d66\u5408\u540c\u958b\u767c\u5546</li> </ul> </li> <li> <p>\u7bc0\u9ede\u70ba\u6b64\u584a\u904b\u884c <code>EndBlock</code> \u4e26\u5b58\u5132\u584a\u7684 <code>GasWanted</code></p> </li> </ol> <p>  \u8a73\u7d30\u505a\u6cd5 </p> <p>  Cosmos <code>Gas</code> </p> <p>\u5728 Cosmos SDK \u4e2d\uff0cgas \u4e3b\u8981\u5728 <code>GasMeter</code>\u548c <code>BlockGasMeter</code> \u4e2d\u9032\u884c\u8ddf\u8e2a\uff1a</p> <ul> <li><code>GasMeter</code>\uff1a\u8ddf\u8e2a\u5c0e\u81f4\u72c0\u614b\u8f49\u63db\u7684\u57f7\u884c\u904e\u7a0b\u4e2d\u6d88\u8017\u7684\u6c23\u9ad4\u3002\u5b83\u5728\u6bcf\u6b21\u4ea4\u6613\u57f7\u884c\u6642\u91cd\u7f6e\u3002</li> <li><code>BlockGasMeter</code>\uff1a\u8ddf\u8e2a\u5340\u584a\u4e2d\u6d88\u8017\u7684\u6c23\u9ad4\u4e26\u5f37\u5236\u6c23\u9ad4\u4e0d\u8d85\u904e\u9810\u5b9a\u7fa9\u7684\u9650\u5236\u3002\u6b64\u9650\u5236\u5728 Tendermint \u5171\u8b58\u53c3\u6578\u4e2d\u5b9a\u7fa9\uff0c\u53ef\u4ee5\u901a\u904e\u6cbb\u7406\u53c3\u6578\u66f4\u6539\u63d0\u6848\u9032\u884c\u66f4\u6539\u3002</li> </ul> <p>\u7531\u65bc gas \u662f\u6309\u5b57\u7bc0\u5b9a\u50f9\u7684\uff0c\u56e0\u6b64\u76f8\u540c\u7684\u4ea4\u4e92\u5728\u53c3\u6578\u503c\u8f03\u5927\u7684\u60c5\u6cc1\u4e0b\u6bd4\u8f03\u5c0f\u7684\u53c3\u6578\u503c\u66f4\u8017\u8cbb\u6c23\u9ad4\uff08\u8207\u4ee5\u592a\u574a\u7684 <code>uint256</code> \u503c\u4e0d\u540c\uff0cCosmos SDK \u6578\u503c\u4f7f\u7528 Big.Int \u985e\u578b\uff0c\u5b83\u5011\u662f\u52d5\u614b\u8abf\u6574\u5927\u5c0f\u7684\uff09\u3002</p> <p>\u53ef\u4ee5\u5728\u6b64\u8655 \u627e\u5230\u6709\u95dc\u4f5c\u70ba Cosmos SDK \u4e00\u90e8\u5206\u7684 gas \u7684\u66f4\u591a\u4fe1\u606f\u3002</p> <p>  \u5339\u914dEVM Gas\u6d88\u8017 </p> <p>Daodst \u662f\u4e00\u689d EVM \u517c\u5bb9\u93c8\uff0c\u652f\u6301\u4ee5\u592a\u574a Web3 \u5de5\u5177\u3002\u51fa\u65bc\u9019\u500b\u539f\u56e0\uff0c\u6c23\u9ad4\u6d88\u8017\u5fc5\u9808\u8207\u5176\u4ed6 EVM \u76f8\u7576\uff0c\u6700\u91cd\u8981\u7684\u662f\u4ee5\u592a\u574a\u3002</p> <p>EVM \u548c Cosmos \u72c0\u614b\u8f49\u63db\u4e4b\u9593\u7684\u4e3b\u8981\u5340\u5225\u5728\u65bc\uff0cEVM \u70ba\u6bcf\u500b\u64cd\u4f5c\u78bc\u4f7f\u7528\u4e00\u500b gas table\uff0c\u800c Cosmos \u4f7f\u7528<code>GasConfig</code>\u70ba\u6bcf\u500b CRUD \u64cd\u4f5c\u6536\u53d6 gas\uff0c\u65b9\u6cd5\u662f\u70ba\u8a2a\u554f\u6578\u64da\u5eab\u8a2d\u7f6e\u56fa\u5b9a\u7684\u6bcf\u5b57\u7bc0\u6210\u672c\u3002</p> <p>+++ https://github.com/cosmos/cosmos-sdk/blob/3fd376bd5659f076a4dc79b644573299fd1ec1bf/store/types/gas.go#L187-L196</p> <p>\u70ba\u4e86\u5339\u914dEVM\u6d88\u8017\u7684gas\uff0c\u5ffd\u7565SDK\u4e2d\u7684gas\u6d88\u8017\u908f\u8f2f\uff0c\u53d6\u800c\u4ee3\u4e4b\u7684\u662f\u6d88\u8017\u7684gas\u662f\u901a\u904e\u5f9e\u6d88\u606f\u4e0a\u5b9a\u7fa9\u7684\u6c23\u9ad4\u9650\u5236\u4e2d\u6e1b\u53bb\u72c0\u614b\u8f49\u63db\u5269\u9918\u6c23\u9ad4\u52a0\u4e0a\u9000\u6b3e\u4f86\u8a08\u7b97\u7684\u3002</p> <p>\u70ba\u4e86\u5ffd\u7565 SDK \u7684 gas \u6d88\u8017\uff0c\u6211\u5011\u5c07\u4ea4\u6613<code>GasMeter</code>\u8a08\u6578\u91cd\u7f6e\u70ba 0\uff0c\u4e26\u624b\u52d5\u5c07\u5176\u8a2d\u7f6e\u70ba EVM \u6a21\u584a\u5728\u57f7\u884c\u7d50\u675f\u6642\u8a08\u7b97\u51fa\u7684<code>gasUsed</code>\u503c\u3002</p> <p> <code>AnteHandler</code> </p> <p>Cosmos SDK <code>AnteHandler</code> \u5728\u4ea4\u6613\u57f7\u884c\u4e4b\u524d\u57f7\u884c\u57fa\u672c\u6aa2\u67e5\u3002</p> <p>\u9019\u4e9b\u6aa2\u67e5\u901a\u5e38\u662f\u7c3d\u540d\u9a57\u8b49\u3001\u4ea4\u6613\u5b57\u6bb5\u9a57\u8b49\u3001\u4ea4\u6613\u8cbb\u7528\u7b49\u3002</p> <p>\u95dc\u65bc gas \u6d88\u8017\u548c\u8cbb\u7528\uff0c<code>AnteHandler</code> \u6aa2\u67e5\u7528\u6236\u662f\u5426\u6709\u8db3\u5920\u7684\u9918\u984d\u4f86\u652f\u4ed8 tx \u6210\u672c\uff08\u91d1\u984d\u52a0\u4e0a\u8cbb\u7528\uff09\uff0c\u4e26\u6aa2\u67e5\u6d88\u606f\u4e2d\u5b9a\u7fa9\u7684 gas \u9650\u5236\u662f\u5426\u5927\u65bc\u6216\u7b49\u65bc\u8a08\u7b97\u7684\u56fa\u6709 gas \u6d88\u606f\u3002</p> <p>  Gas \u8fd4\u8fd8  </p> <p>\u5728 EVM \u4e2d\uff0cgas \u53ef\u4ee5\u5728\u57f7\u884c\u4e4b\u524d\u6307\u5b9a\u3002 \u6307\u5b9a\u7684\u5168\u90e8\u6c23\u9ad4\u5728\u57f7\u884c\u958b\u59cb\u6642\uff08\u5728<code>AnteHandler</code>\u6b65\u9a5f\u671f\u9593\uff09\u88ab\u6d88\u8017\uff0c\u5982\u679c\u57f7\u884c\u5f8c\u6709\u4efb\u4f55\u6c23\u9ad4\u5269\u9918\uff0c\u5269\u9918\u7684\u6c23\u9ad4\u5c07\u9000\u9084\u7d66\u7528\u6236\u3002</p> <p>\u6b64\u5916\uff0cEVM \u9084\u53ef\u4ee5\u5b9a\u7fa9\u8981\u8fd4\u9084\u7d66\u7528\u6236\u7684\u6c23\u9ad4\uff0c\u4f46\u9019\u4e9b\u6c23\u9ad4\u5c07\u88ab\u9650\u5236\u70ba\u6240\u7528\u6c23\u9ad4\u7684\u4e00\u5c0f\u90e8\u5206\uff0c\u5177\u9ad4\u53d6\u6c7a\u65bc\u6240\u4f7f\u7528\u7684\u5206\u53c9/\u7248\u672c\u3002</p> <p>  \u96f6\u624b\u7eed\u8d39\u4ea4\u6613  </p> <p>\u5728 Cosmos \u4e2d\uff0c<code>AnteHandler</code> \u4e0d\u5f37\u5236\u57f7\u884c\u6700\u4f4e gas \u50f9\u683c\uff0c\u56e0\u70ba<code>min-gas-prices</code>\u662f\u6839\u64da\u672c\u5730\u7bc0\u9ede/\u9a57\u8b49\u5668\u6aa2\u67e5\u7684\u3002</p> <p>\u63db\u53e5\u8a71\u8aaa\uff0c\u63a5\u53d7\u7684\u6700\u4f4e\u8cbb\u7528\u7531\u7db2\u7d61\u7684\u9a57\u8b49\u8005\u6c7a\u5b9a\uff0c\u6bcf\u500b\u9a57\u8b49\u8005\u53ef\u4ee5\u70ba\u5176\u8cbb\u7528\u6307\u5b9a\u4e0d\u540c\u7684\u6700\u4f4e\u503c\u3002</p> <p>\u5982\u679c\u81f3\u5c11\u6709\u4e00\u500b\u9a57\u8b49\u8005\u9858\u610f\u5728\u4ed6\u5011\u63d0\u8b70\u7684\u5340\u584a\u4e2d\u5305\u542b<code>0</code> gas price \u7684\u4ea4\u6613\uff0c\u9019\u53ef\u80fd\u5141\u8a31\u6700\u7d42\u7528\u6236\u63d0\u4ea4 0 \u8cbb\u7528\u4ea4\u6613\u3002</p> <p>\u51fa\u65bc\u540c\u6a23\u7684\u539f\u56e0\uff0c\u5728 Daodst \u4e2d\uff0c\u5c0d\u65bc<code>evm</code>\u6a21\u584a\u5b9a\u7fa9\u7684\u4ea4\u6613\u985e\u578b\u4ee5\u5916\u7684\u4ea4\u6613\u985e\u578b\uff0c\u53ef\u4ee5\u767c\u9001<code>0</code>\u8cbb\u7528\u7684\u4ea4\u6613\u3002</p> <p>EVM \u6a21\u584a\u4ea4\u6613\u4e0d\u80fd\u6709\u201c0\u201d\u8cbb\u7528\uff0c\u56e0\u70ba EVM \u672c\u8eab\u5c31\u9700\u8981 gas\u3002</p> <p>\u6b64\u6aa2\u67e5\u7531 EVM \u4e8b\u52d9\u7121\u72c0\u614b\u9a57\u8b49\uff08\u5373<code>ValidateBasic</code>\uff09\u51fd\u6578\u4ee5\u53ca Daodst \u5b9a\u7fa9\u7684\u81ea\u5b9a\u7fa9<code>AnteHandler</code>\u5b8c\u6210\u3002</p> <p>  Gas \u9884\u4f30  </p> <p>\u4ee5\u592a\u574a\u63d0\u4f9b\u4e86\u4e00\u500b JSON-RPC \u7aef\u9ede<code>eth_estimateGas</code>\u4f86\u5e6b\u52a9\u7528\u6236\u5728\u4ed6\u5011\u7684\u4ea4\u6613\u4e2d\u8a2d\u7f6e\u6b63\u78ba\u7684\u6c23\u9ad4\u9650\u5236\u3002</p> <p>\u56e0\u6b64\uff0c\u5728 Daodst \u4e2d\u5be6\u73fe\u4e86\u4e00\u500b\u7279\u5b9a\u7684\u67e5\u8a62 API <code>EstimateGas</code>\u3002 \u5b83\u5c07\u91dd\u5c0d\u7576\u524d\u5340\u584a/\u72c0\u614b\u61c9\u7528\u4ea4\u6613\u4e26\u57f7\u884c\u4e8c\u9032\u5236\u641c\u7d22\u4ee5\u627e\u5230\u8fd4\u56de\u7d66\u7528\u6236\u7684\u6700\u4f73\u6c23\u9ad4\u503c\uff08\u76f8\u540c\u7684\u4ea4\u6613\u5c07\u4e00\u904d\u53c8\u4e00\u904d\u5730\u61c9\u7528\uff0c\u76f4\u5230\u6211\u5011\u627e\u5230\u5931\u6557\u524d\u6240\u9700\u7684\u6700\u5c0f\u6c23\u9ad4\uff09 .</p> <p>\u6211\u5011\u9700\u8981\u4f7f\u7528\u4e8c\u5206\u67e5\u627e\u7684\u539f\u56e0\u662f\u4ea4\u6613\u6240\u9700\u7684 gas \u53ef\u80fd\u9ad8\u65bc\u61c9\u7528\u4ea4\u6613\u5f8c EVM \u8fd4\u56de\u7684\u503c\uff0c\u56e0\u6b64\u6211\u5011\u9700\u8981\u5617\u8a66\u76f4\u5230\u627e\u5230\u6700\u512a\u503c\u3002</p> <p>\u5728\u6574\u500b\u57f7\u884c\u904e\u7a0b\u4e2d\u5c07\u4f7f\u7528\u7de9\u5b58\u4e0a\u4e0b\u6587\u4ee5\u907f\u514d\u66f4\u6539\u5728\u72c0\u614b\u4e2d\u6301\u4e45\u5316\u3002</p> <p>\u5c0d\u65bc Cosmos Tx\uff0c\u958b\u767c\u8005\u53ef\u4ee5\u4f7f\u7528 Cosmos SDK \u7684\u3010\u4ea4\u6613\u6a21\u64ec\u3011(https://docs.cosmos.network/main/run-node/txs#simulating-a-transaction) \u4f86\u5275\u5efa\u6e96\u78ba\u7684\u9810\u4f30\u3002</p> <p>  \u8de8\u94fe Gas \u548c \u624b\u7eed\u8d39  </p> <p>\u5047\u8a2d\u7528\u6236\u901a\u904e IBC \u8f49\u8cec\u5c07\u4ee3\u5e63\u5f9e\u93c8 A \u8f49\u79fb\u5230 Daodst\uff0c\u4e26\u5e0c\u671b\u57f7\u884c Daodst \u4ea4\u6613\u2014\u2014\u4f46\u662f\uff0c\u4ed6\u5011\u6c92\u6709\u4efb\u4f55 Daodst \u4ee3\u5e63\u4f86\u652f\u4ed8\u8cbb\u7528\u3002Cosmos SDK \u5f15\u5165\u4e86 <code>Tips</code> \u4f86\u89e3\u6c7a\u9019\u500b\u554f\u984c\uff1b \u7528\u6236\u53ef\u4ee5\u4f7f\u7528\u4e0d\u540c\u7684\u4ee3\u5e63\u652f\u4ed8\u8cbb\u7528\u2014\u2014\u5728\u672c\u4f8b\u4e2d\uff0c\u662f\u4f86\u81ea\u93c8 A \u7684\u4ee3\u5e63\u3002</p> <p>\u70ba\u4e86\u4f7f\u7528\u5c0f\u8cbb\u652f\u4ed8\u4ea4\u6613\u8cbb\u7528\uff0c\u8a72\u7528\u6236\u53ef\u4ee5\u7c3d\u7f72\u4e00\u7b46\u4e0d\u5e36\u5c0f\u8cbb\u7684\u4ea4\u6613\uff0c\u7136\u5f8c\u5c07\u4ea4\u6613\u767c\u9001\u7d66\u8cbb\u7528\u4e2d\u7e7c\u5668\u3002   \u7136\u5f8c\uff0c\u8cbb\u7528\u4e2d\u7e7c\u5668\u5c07\u4ee5\u672c\u5730\u8ca8\u5e63\uff08\u5728\u672c\u4f8b\u4e2d\u70ba dst\uff09\u652f\u4ed8\u8cbb\u7528\uff0c\u4e26\u6536\u5230\u4ed8\u6b3e\u5c0f\u8cbb\uff0c\u5145\u7576\u4e2d\u4ecb\u4ea4\u6613\u6240\u3002</p> <p>\u6709\u95dc Cosmos \u7684\u66f4\u591a\u4fe1\u606f\uff1a</p> <ul> <li>Cosmos \u63d0\u793a\u6587\u6a94</li> </ul> <p>  \u4f7f\u7528Daodst CLI\u5904\u7406Gas\u548c\u624b\u7eed\u8d39  </p> <p>\u4f7f\u7528 Daodst CLI \u5ba2\u6236\u7aef\u5ee3\u64ad\u4ea4\u6613\u6642\uff0c\u7528\u6236\u61c9\u8003\u616e\u53ef\u7528\u7684\u9078\u9805\u3002 \u5411\u7db2\u7d61\u767c\u9001\u4ea4\u6613\u6642\u9700\u8981\u8003\u616e\u4e09\u500b\u6a19\u8a8c\uff1a</p> <ul> <li><code>--fees</code>: \u96a8\u4ea4\u6613\u4e00\u8d77\u652f\u4ed8\u7684\u8cbb\u7528\uff1b \u4f8b\u5982\uff1a10dst\u3002 \u9ed8\u8a8d\u70ba\u6240\u9700\u8cbb\u7528\u3002</li> <li><code>--gas</code>: \u6bcf\u7b46\u4ea4\u6613\u8a2d\u7f6e\u7684\u6c23\u9ad4\u9650\u5236\uff1b \u9ed8\u8a8d\u503c\u70ba 200000\u3002</li> <li><code>--gas-prices</code>: gas \u50f9\u683c\u4f86\u78ba\u5b9a\u4ea4\u6613\u8cbb\u7528\uff08\u4f8b\u5982 10dst\uff09\u3002</li> </ul> <p>\u4f46\u662f\uff0c\u4e26\u975e\u6240\u6709\u9019\u4e9b\u90fd\u9700\u8981\u5728\u6bcf\u500b\u4e8b\u52d9\u4e2d\u5b9a\u7fa9\u3002 \u6b63\u78ba\u7684\u7d44\u5408\u662f\uff1a</p> <ul> <li><code>--fees=auto</code>: \u81ea\u52d5\u4f30\u7b97\u8cbb\u7528\u548c\u6c7d\u6cb9\uff08\u8207 --gas=auto \u76f8\u540c\u7684\u884c\u70ba\uff09\u3002   \u5982\u679c\u4f7f\u7528\u4efb\u4f55\u5176\u4ed6\u8207\u8cbb\u7528\u76f8\u95dc\u7684\u6a19\u8a8c\uff08\u4f8b\u5982\uff0c<code>--gas-prices</code>\u3001<code>--fees</code>\uff09\uff0c\u5247\u6703\u5f15\u767c\u932f\u8aa4</li> <li><code>--gas=auto</code>: \u8207 <code>--fees=auto</code> \u76f8\u540c\u7684\u884c\u70ba\u3002   \u5982\u679c\u4f7f\u7528\u4efb\u4f55\u5176\u4ed6\u8207\u8cbb\u7528\u76f8\u95dc\u7684\u6a19\u8a8c\uff08\u4f8b\u5982\uff0c<code>--gas-prices</code>\u3001<code>--fees</code>\uff09\uff0c\u5247\u6703\u5f15\u767c\u932f\u8aa4</li> <li><code>--gas={int}</code>: \u4f7f\u7528\u6307\u5b9a\u7684\u6c23\u9ad4\u91cf\u548c\u4ea4\u6613\u6240\u9700\u7684\u8cbb\u7528</li> <li><code>--fees={int}{denom}</code>: \u4f7f\u7528 tx \u7684\u6307\u5b9a\u8cbb\u7528\u3002 \u5c0d tx \u4f7f\u7528 gas \u9ed8\u8a8d\u503c (200000)\u3002</li> <li><code>--fees={int}{denom} --gas={int}</code>: \u4f7f\u7528\u6307\u5b9a\u7684\u6c23\u9ad4\u548c\u8cbb\u7528\u3002 \u4f7f\u7528\u63d0\u4f9b\u7684\u53c3\u6578\u8a08\u7b97 gas-price</li> <li><code>--gas-prices={int}{denom}</code>: \u4f7f\u7528\u63d0\u4f9b\u7684 gas \u50f9\u683c\u548c\u9ed8\u8a8d gas \u91cf (200000)</li> <li><code>--gas-prices={int}{denom} --gas={int}</code>: \u4f7f\u7528\u70ba tx \u6307\u5b9a\u7684\u6c23\u9ad4\uff0c\u4e26\u4f7f\u7528\u76f8\u61c9\u7684\u53c3\u6578\u8a08\u7b97\u8cbb\u7528\u3002</li> </ul> <p>\u8b80\u8005\u61c9\u6ce8\u610f\uff0c\u524d\u5169\u500b\u9078\u9805\u70ba\u65b0\u7528\u6236\u63d0\u4f9b\u4e86\u66f4\u53cb\u597d\u7684\u7528\u6236\u9ad4\u9a57\uff0c\u800c\u5f8c\u8005\u5247\u9069\u7528\u65bc\u66f4\u9ad8\u7d1a\u7684\u7528\u6236\uff0c\u4ed6\u5011\u5e0c\u671b\u5c0d\u9019\u4e9b\u53c3\u6578\u6709\u66f4\u591a\u7684\u63a7\u5236\u6b0a\u3002</p> <p>\u8a72\u5718\u968a\u5f15\u5165\u4e86<code>\u81ea\u52d5</code>\u6a19\u8a8c\u9078\u9805\uff0c\u53ef\u4ee5\u81ea\u52d5\u8a08\u7b97\u57f7\u884c\u4ea4\u6613\u6240\u9700\u7684\u6c7d\u6cb9\u548c\u8cbb\u7528\u3002\u901a\u904e\u9019\u7a2e\u65b9\u5f0f\uff0c\u65b0\u7528\u6236\u6216\u958b\u767c\u4eba\u54e1\u53ef\u4ee5\u57f7\u884c\u4ea4\u6613\u800c\u7121\u9700\u5b9a\u7fa9\u7279\u5b9a\u7684 gas \u548c\u8cbb\u7528\u503c\u3002</p> <p>\u4f7f\u7528 <code>auto</code> \u6a19\u8a8c\u6709\u6642\u53ef\u80fd\u7121\u6cd5\u6839\u64da\u7db2\u7d61\u6d41\u91cf\u4f30\u7b97\u6b63\u78ba\u7684 gas \u548c\u8cbb\u7528\u3002 \u70ba\u4e86\u514b\u670d\u9019\u500b\u554f\u984c\uff0c\u60a8\u53ef\u4ee5\u70ba <code>--gas-adjustment</code> \u6a19\u8a8c\u4f7f\u7528\u66f4\u9ad8\u7684\u503c\u3002 \u9ed8\u8a8d\u60c5\u6cc1\u4e0b\uff0c\u5b83\u8a2d\u7f6e\u70ba<code>1.2</code>\u3002 \u7576\u4f30\u8a08\u503c\u4e0d\u8db3\u6642\uff0c\u91cd\u8a66\u66f4\u9ad8\u7684 gas \u8abf\u6574\uff0c\u4f8b\u5982 <code>--gas-adjustment 1.3</code>\u3002</p> <p>\u4e0d\u80fd\u7d50\u5408\u4f7f\u7528 <code>--gas-prices</code> \u548c <code>--fees</code> \u6a19\u8a8c\u3002 \u5982\u679c\u662f\u9019\u6a23\uff0c\u7528\u6236\u5c07\u6536\u5230\u4e00\u689d\u932f\u8aa4\u6d88\u606f\uff0c\u6307\u51fa\u7121\u6cd5\u540c\u6642\u63d0\u4f9b\u8cbb\u7528\u548c\u6c7d\u6cb9\u50f9\u683c\u3002</p> <p>\u8acb\u8a18\u4f4f\uff0c\u5982\u679c\u63d0\u4f9b\u7684\u8cbb\u7528\u6216\u6c7d\u6cb9\u91cf\u4e0d\u8db3\uff0c\u4e0a\u8ff0\u7d44\u5408\u53ef\u80fd\u6703\u5931\u6557\u3002 \u5982\u679c\u662f\u9019\u7a2e\u60c5\u6cc1\uff0cCLI \u5c07\u8fd4\u56de\u4e00\u689d\u5305\u542b\u7279\u5b9a\u539f\u56e0\u7684\u932f\u8aa4\u6d88\u606f\u3002 \u4f8b\u5982\uff1a</p> <pre><code>raw_log: 'out of gas in location: submit proposal; gasWanted: 200000, gasUsed: 263940.\n  Please retry with a gas (--gas flag) amount higher than gasUsed: out of gas'\n</code></pre>"},{"location":"protocol/#_14","title":"\u5bc6\u9470\u7ba1\u7406","text":"<p>A mnemonic phrase, also known as a seed phrase, is a set of words used to recover or restore a cryptocurrency wallet. It acts as a backup to access your digital assets in case you lose access to the original wallet. The phrase is typically a series of 12-24 words that are generated when you create a wallet, and it should be kept secure and  private.</p> <p>The importance of mnemonic phrases lies in the fact that cryptocurrencies are stored in a decentralized manner, meaning that there is no central authority or institution that holds or controls your funds. This means that if you lose access to your wallet (e.g. forget your password, lose your device), you will not be able to recover your funds without the mnemonic phrase.</p> <p>Therefore, it is crucial to store your mnemonic phrase in a safe and secure place, such as a physical paper or a secure digital file. Additionally, it is recommended to make multiple copies and store them in different locations, so that you can access your funds in case of any emergency.</p> <p>:::note \u52a9\u8a18\u7b26\u77ed\u8a9e\u8207\u79c1\u9470 A seed phrase, also known as a recovery phrase or backup phrase, is a sequence of words used to generate a private key. It is typically a set of 12 or 24 words, and it's used to recover or restore access to a cryptocurrency wallet in case the original private key is lost or damaged. A seed phrase can be used to generate multiple private keys, which can be used to access multiple cryptocurrency addresses and balances.</p> <p>On the other hand, a private key is a long string of characters that is used to sign transactions and provide access to your cryptocurrency funds. The private key is generated from the seed phrase and is unique to each cryptocurrency address. It is used to create digital signatures for transactions, which ensure that the transaction is legitimate and has been authorized by the rightful owner of the funds.</p> <p>In conclusion, the security of your private keys and mnemonic phrase is of utmost importance. If your private keys  are compromised, it can put all associated accounts at risk. However, the loss of your mnemonic phrase can have  even more severe consequences as it is used to generate multiple private keys. Therefore, it is crucial to take   proper measures to safeguard both your private keys and mnemonic phrase to avoid any catastrophic loss.</p> <p>:::</p> <p> Daodst CLI\u4e2d\u7684\u52a9\u8a18\u7b26 </p> <p>:::note Before proceeding with the CLI, please insure you have <code>stcd</code> installed. Installation instruction are located  :::</p> <p>When you create a new key, you'll receive a mnemonic phrase that can be used to restore that key. Backup the mnemonic phrase:</p> <pre><code>stcd keys add dev0\n{\n  \"name\": \"dev0\",\n  \"type\": \"local\",\n  \"address\": \"dst1n253dl2tgyhxjm592p580c38r4dn8023ctv28d\",\n  \"pubkey\": '{\"@type\":\"/ethermint.crypto.v1.ethsecp256k1.PubKey\",\"key\":\"ArJhve4v5HkLm+F7ViASU/rAGx7YrwU4+XKV2MNJt+Cq\"}',\n  \"mnemonic\": \"\"\n}\n\n**Important** write this mnemonic phrase in a safe place.\nIt is the only way to recover your account if you ever forget your password.\n\n# &lt;24 word mnemonic phrase&gt;\n</code></pre> <p>To restore the key:</p> <pre><code>$ stcd keys add dev0-restored --recover\n&gt; Enter your bip39 mnemonic\nbanner genuine height east ghost oak toward reflect asset marble else explain foster car nest make van divide twice culture announce shuffle net peanut\n{\n  \"name\": \"dev0-restored\",\n  \"type\": \"local\",\n  \"address\": \"dst1n253dl2tgyhxjm592p580c38r4dn8023ctv28d\",\n  \"pubkey\": '{\"@type\":\"/ethermint.crypto.v1.ethsecp256k1.PubKey\",\"key\":\"ArJhve4v5HkLm+F7ViASU/rAGx7YrwU4+XKV2MNJt+Cq\"}'\n}\n</code></pre>"},{"location":"protocol/#_15","title":"\u5bc6\u9470\u5c0e\u51fa","text":"<p> Tendermint-\u79c1\u9470\u683c\u5f0f </p> <p>To backup this type of key without the mnemonic phrase, do the following:</p> <pre><code>stcd keys export dev0\nEnter passphrase to decrypt your key:\nEnter passphrase to encrypt the exported key:\n-----BEGIN TENDERMINT PRIVATE KEY-----\nkdf: bcrypt\nsalt: 14559BB13D881A86E0F4D3872B8B2C82\ntype: secp256k1\n\n# &lt;Tendermint private key&gt;\n-----END TENDERMINT PRIVATE KEY-----\n\n$ echo \"\\\n-----BEGIN TENDERMINT PRIVATE KEY-----\nkdf: bcrypt\nsalt: 14559BB13D881A86E0F4D3872B8B2C82\ntype: secp256k1\n\n# &lt;Tendermint private key&gt;\n-----END TENDERMINT PRIVATE KEY-----\" &gt; dev0.export\n</code></pre> <p> Ethereum-\u79c1\u9470\u683c\u5f0f </p> <p>:::tip Note: These types of keys are MetaMask-compatible. :::</p> <p>To backup this type of key without the mnemonic phrase, do the following:</p> <pre><code>stcd keys unsafe-export-eth-key dev0 &gt; dev0.export\n**WARNING** this is an unsafe way to export your unencrypted private key, are you sure? [y/N]: y\nEnter keyring passphrase:\n</code></pre>"},{"location":"protocol/#_16","title":"\u5bc6\u9470\u5c0e\u5165","text":"<p> Tendermint-\u79c1\u9470\u683c\u5f0f s</p> <pre><code>$ stcd keys import dev0-imported ./dev0.export\nEnter passphrase to decrypt your key:\n</code></pre> <p> Ethereum-\u79c1\u9470\u683c\u5f0f </p> <pre><code>$ stcd keys unsafe-import-eth-key dev0-imported ./dev0.export\nEnter passphrase to encrypt your key:\n</code></pre>"},{"location":"protocol/#_17","title":"\u9a57\u8b49","text":"<p>Verify that your key has been restored using the following command:</p> <pre><code>$ stcd keys list\n[\n  {\n    \"name\": \"dev0-imported\",\n    \"type\": \"local\",\n    \"address\": \"dst1n253dl2tgyhxjm592p580c38r4dn8023ctv28d\",\n    \"pubkey\": '{\"@type\":\"/ethermint.crypto.v1.ethsecp256k1.PubKey\",\"key\":\"ArJhve4v5HkLm+F7ViASU/rAGx7YrwU4+XKV2MNJt+Cq\"}'\n  },\n  {\n    \"name\": \"dev0-restored\",\n    \"type\": \"local\",\n    \"address\": \"dst1n253dl2tgyhxjm592p580c38r4dn8023ctv28d\",\n    \"pubkey\": '{\"@type\":\"/ethermint.crypto.v1.ethsecp256k1.PubKey\",\"key\":\"ArJhve4v5HkLm+F7ViASU/rAGx7YrwU4+XKV2MNJt+Cq\"}'\n  },\n  {\n    \"name\": \"dev0\",\n    \"type\": \"local\",\n    \"address\": \"dst1n253dl2tgyhxjm592p580c38r4dn8023ctv28d\",\n    \"pubkey\": '{\"@type\":\"/ethermint.crypto.v1.ethsecp256k1.PubKey\",\"key\":\"ArJhve4v5HkLm+F7ViASU/rAGx7YrwU4+XKV2MNJt+Cq\"}'\n  }\n]\n</code></pre>"},{"location":"protocol/#_18","title":"\u5c0e\u5165/\u5c0e\u51fa \u72c0\u614b","text":"<p>Daodst can dump the entire application state to a JSON file. This, besides upgrades, can be useful for manual analysis of the state at a given height.</p>"},{"location":"protocol/#_19","title":"\u5c0e\u51fa\u72c0\u614b","text":"<p>Export state with:</p> <pre><code>stcd export &gt; new_genesis.json\n</code></pre> <p>You can also export state from a particular height (at the end of processing the block of that height):</p> <pre><code>stcd export --height [height] &gt; new_genesis.json\n</code></pre> <p>If you plan to start a new network for 0 height (i.e genesis) from the exported state, export with the <code>--for-zero-height</code> flag:</p> <pre><code>stcd export --height [height] --for-zero-height &gt; new_genesis.json\n</code></pre>"},{"location":"protocol/#_20","title":"\u624b\u52d5\u9077\u79fb\u72c0\u614b","text":"<p>If you want to migrate state manually, e.g. for local testing purpose. Note that for regular chain upgrades, a manual state migration is not required.</p> <p>After exporting your state into a json file, you can replace the old <code>genesis.json</code> with <code>new_genesis.json</code>.</p> <pre><code>cp -f genesis.json new_genesis.json\nmv new_genesis.json genesis.json\n</code></pre> <p>At this point, you might want to run a script to update the exported genesis into a genesis state that is compatible with your new version.</p> <p>You can use the <code>migrate</code> command to migrate from a given version to the next one (eg: <code>v0.X.X</code> to <code>v1.X.X</code>):</p> <pre><code>stcd migrate TARGET_VERSION GENESIS_FILE --chain-id=&lt;new_chain_id&gt; --genesis-time=&lt;yyyy-mm-ddThh:mm:ssZ&gt;\n</code></pre>"},{"location":"protocol/#_21","title":"\u591a\u7c3d","text":"<p>Learn how to generate, sign and broadcast a transaction using the keyring multisig.</p> <p>A multisig account is an Daodst account with a special key that can require more than one signature to sign transactions. This can be useful for increasing the security of the account or for requiring the consent of multiple parties to make transactions. Multisig accounts can be created by specifying:</p> <ul> <li>threshold number of signatures required</li> <li>the public keys involved in signing</li> </ul> <p>To sign with a multisig account, the transaction must be signed individually by the different keys specified for the account. Then, the signatures will be combined into a multi-signature which can be used to sign the transaction. If fewer than the threshold number of signatures needed are present, the resultant multi-signature is considered invalid.</p>"},{"location":"protocol/#_22","title":"\u751f\u6210\u591a\u7c3d\u5bc6\u9470\u5c0d","text":"<pre><code>stcd keys add --multisig=name1,name2,name3[...] --multisig-threshold=K new_key_name\n</code></pre> <p><code>K</code> is the minimum number of private keys that must have signed the transactions that carry the public key's address as signer.</p> <p>The <code>--multisig</code> flag must contain the name of public keys that will be combined into a public key that will be generated and stored as <code>new_key_name</code> in the local database. All names supplied through <code>--multisig</code> must already exist  in the local database.</p> <p>Unless the flag <code>--nosort</code> is set, the order in which the keys are supplied on the command line does not matter, i.e. the  following commands generate two identical keys:</p> <pre><code>stcd keys add --multisig=p1,p2,p3 --multisig-threshold=2 multisig_address\nstcd keys add --multisig=p2,p3,p1 --multisig-threshold=2 multisig_address\n</code></pre> <p>Multisig addresses can also be generated on-the-fly and printed through the which command:</p> <pre><code>stcd keys show --multisig-threshold=K name1 name2 name3 [...]\n</code></pre>"},{"location":"protocol/#_23","title":"\u7c3d\u540d\u4ea4\u6613","text":"<p> Step 1: \u521b\u5efa\u591a\u7b7e\u5bc6\u94a5 </p> <p>Let's assume that you have <code>test1</code> and <code>test2</code> want to make a multisig account with <code>test3</code>.</p> <p>First import the public keys of <code>test3</code> into your keyring.</p> <pre><code>stcd keys add \\\n    test3 \\\n    --pubkey=dstpub1addwnpepqgcxazmq6wgt2j4rdfumsfwla0zfk8e5sws3p3zg5dkm9007hmfysxas0u2\n</code></pre> <p>Generate the multisig key with 2/3 threshold.</p> <pre><code>stcd keys add \\\n    multi \\\n    --multisig=test1,test2,test3 \\\n    --multisig-threshold=2\n</code></pre> <p>You can see its address and details:</p> <pre><code>stcd keys show multi\n\n- name: multi\n  type: multi\n  address: dst1e0fx0q9meawrcq7fmma9x60gk35lpr4xk3884m\n  pubkey: dstpub1ytql0csgqgfzd666axrjzq3mxw59ys6yqcd3ydjvhgs0uzs6kdk5fp4t73gmkl8t6y02yfq7tvfzd666axrjzq3sd69kp5usk492x6nehqjal67ynv0nfqapzrzy3gmdk27la0kjfqfzd666axrjzq6utqt639ka2j3xkncgk65dup06t297ccljmxhvhu3rmk92u3afjuyz9dg9\n  mnemonic: \"\"\n  threshold: 0\n  pubkeys: []\n</code></pre> <p>Let's add 10 dst to the multisig wallet:</p> <pre><code>stcd tx bank send \\\n    test1 \\\n    dst1e0fx0q9meawrcq7fmma9x60gk35lpr4xk3884m \\\n    10000000000000000000adst \\\n    --chain-id=daodst_7000-4 \\\n    --gas=auto \\\n    --fees=1000000adst \\\n    --broadcast-mode=block\n</code></pre> <p> Step 2: \u5275\u5efa\u591a\u7c3d\u4ea4\u6613 </p> <p>We want to send 5 dst from our multisig account to <code>dst1rgjxswhuxhcrhmyxlval0qa70vxwvqn2e0srft</code>.</p> <pre><code>stcd tx bank send \\\n    dst1rgjxswhuxhcrhmyxlval0qa70vxwvqn2e0srft \\\n    dst157g6rn6t6k5rl0dl57zha2wx72t633axqyvvwq \\\n    5000000000000000000dst \\\n    --gas=200000 \\\n    --fees=1000000dst \\\n    --chain-id=daodst_7000-4 \\\n    --generate-only &gt; unsignedTx.json\n</code></pre> <p>The file <code>unsignedTx.json</code> contains the unsigned transaction encoded in JSON.</p> <pre><code>{\n  \"body\": {\n    \"messages\": [\n      {\n        \"@type\": \"/cosmos.bank.v1beta1.MsgSend\",\n        \"from_address\": \"dst1rgjxswhuxhcrhmyxlval0qa70vxwvqn2e0srft\",\n        \"to_address\": \"dst157g6rn6t6k5rl0dl57zha2wx72t633axqyvvwq\",\n        \"amount\": [\n          {\n            \"denom\": \"dst\",\n            \"amount\": \"5000000000000000000\"\n          }\n        ]\n      }\n    ],\n    \"memo\": \"\",\n    \"timeout_height\": \"0\",\n    \"extension_options\": [],\n    \"non_critical_extension_options\": []\n  },\n  \"auth_info\": {\n    \"signer_infos\": [],\n    \"fee\": {\n      \"amount\": [\n        {\n          \"denom\": \"dst\",\n          \"amount\": \"1000000\"\n        }\n      ],\n      \"gas_limit\": \"200000\",\n      \"payer\": \"\",\n      \"granter\": \"\"\n    }\n  },\n  \"signatures\": []\n}\n</code></pre> <p> Step 3: \u55ae\u7368\u7c3d\u540d </p> <p>Sign with <code>test1</code> and <code>test2</code> and create individual signatures.</p> <pre><code>stcd tx sign \\\n    unsignedTx.json \\\n    --multisig=dst1e0fx0q9meawrcq7fmma9x60gk35lpr4xk3884m \\\n    --from=test1 \\\n    --output-document=test1sig.json \\\n    --chain-id=daodst_7000-4\n</code></pre> <pre><code>stcd tx sign \\\n    unsignedTx.json \\\n    --multisig=dst1e0fx0q9meawrcq7fmma9x60gk35lpr4xk3884m \\\n    --from=test2 \\\n    --output-document=test2sig.json \\\n    --chain-id=daodst_7000-4\n</code></pre> <p> Step 4: \u5275\u5efa\u591a\u91cd\u7c3d\u540d </p> <p>Combine signatures to sign transaction.</p> <pre><code>stcd tx multisign \\\n    unsignedTx.json \\\n    multi \\\n    test1sig.json test2sig.json \\\n    --output-document=signedTx.json \\\n    --chain-id=daodst_7000-4\n</code></pre> <p>The TX is now signed:</p> <pre><code>{\n  \"body\": {\n    \"messages\": [\n      {\n        \"@type\": \"/cosmos.bank.v1beta1.MsgSend\",\n        \"from_address\": \"dst1rgjxswhuxhcrhmyxlval0qa70vxwvqn2e0srft\",\n        \"to_address\": \"dst157g6rn6t6k5rl0dl57zha2wx72t633axqyvvwq\",\n        \"amount\": [\n          {\n            \"denom\": \"dst\",\n            \"amount\": \"5000000000000000000\"\n          }\n        ]\n      }\n    ],\n    \"memo\": \"\",\n    \"timeout_height\": \"0\",\n    \"extension_options\": [],\n    \"non_critical_extension_options\": []\n  },\n  \"auth_info\": {\n    \"signer_infos\": [\n      {\n        \"public_key\": {\n          \"@type\": \"/cosmos.crypto.multisig.LegacyAminoPubKey\",\n          \"threshold\": 2,\n          \"public_keys\": [\n            {\n              \"@type\": \"/cosmos.crypto.secp256k1.PubKey\",\n              \"key\": \"ApCzSG8k7Tr4aM6e4OJRExN7cNtvH21L9azbh+uRrvt4\"\n            },\n            {\n              \"@type\": \"/cosmos.crypto.secp256k1.PubKey\",\n              \"key\": \"Ah91erz8ChNanqLe9ea948rvAiXMCRlR5Ka7EE/c0xUK\"\n            },\n            {\n              \"@type\": \"/cosmos.crypto.secp256k1.PubKey\",\n              \"key\": \"A0OjtIUCFJM3AobJ9HJTWKP9RZV2+WPcwVjLgsAidrZ/\"\n            }\n          ]\n        },\n        \"mode_info\": {\n          \"multi\": {\n            \"bitarray\": {\n              \"extra_bits_stored\": 3,\n              \"elems\": \"wA==\"\n            },\n            \"mode_infos\": [\n              {\n                \"single\": {\n                  \"mode\": \"SIGN_MODE_LEGACY_AMINO_JSON\"\n                }\n              },\n              {\n                \"single\": {\n                  \"mode\": \"SIGN_MODE_LEGACY_AMINO_JSON\"\n                }\n              }\n            ]\n          }\n        },\n        \"sequence\": \"1\"\n      }\n    ],\n    \"fee\": {\n      \"amount\": [\n        {\n          \"denom\": \"dst\",\n          \"amount\": \"1000000\"\n        }\n      ],\n      \"gas_limit\": \"200000\",\n      \"payer\": \"\",\n      \"granter\": \"\"\n    }\n  },\n  \"signatures\": [\n    \"CkCEeIbeGc+I1ipZuhp/0KhVNnWAv2tTlvgo5x61lzk1KHmLPV38m/YFurrFt5cm5+fqIXrn+FlOjrJuzBhw8ogYCkCawm9mpXsBHk0CFsE5618fVnvScEkfrzW0c2jCcjqV8EPuj3ut74UWzZyQkwtJGxUWtro9EgnGsB7Di1Gzizst\"\n  ]\n}\n</code></pre> <p> Step 5: \u5ee3\u64ad\u4ea4\u6613 </p> <pre><code>stcd tx broadcast signedTx.json \\\n    --chain-id=daodst_7000-4 \\\n    --broadcast-mode=block\n</code></pre>"},{"location":"protocol/#pending","title":"Pending \u72c0\u614b","text":"<p>\u7576\u4e00\u7b46\u4ea4\u6613\u88ab\u63d0\u4ea4\u5230\u4ee5\u592a\u574a\u7db2\u7d61\u6642\uff0c\u5b83\u9996\u5148\u9032\u5165\u5f85\u8655\u7406\u72c0\u614b\uff0c\u7b49\u5f85\u7bc0\u9ede\u57f7\u884c\u3002</p> <p>\u5982\u679c\u4ea4\u6613\u4e2d\u7684 gas \u50f9\u683c\u8a2d\u7f6e\u5f97\u975e\u5e38\u4f4e\u4e26\u4e14\u7bc0\u9ede\u6b63\u5fd9\u65bc\u8655\u7406\u5176\u4ed6\u66f4\u9ad8 gas \u50f9\u683c\u7684\u4ea4\u6613\uff0c\u5247\u4ea4\u6613\u53ef\u80fd\u6703\u5728\u66f4\u9577\u7684\u6642\u9593\u5167\u8655\u65bc\u5f85\u8655\u7406\u72c0\u614b\u3002</p> <p>\u5728\u639b\u8d77\u72c0\u614b\u671f\u9593\uff0c\u5141\u8a31\u4ea4\u6613\u767c\u8d77\u8005\u96a8\u6642\u66f4\u6539\u4ea4\u6613\u5b57\u6bb5\u3002</p> <p>\u4ed6\u5011\u53ef\u4ee5\u901a\u904e\u767c\u9001\u5177\u6709\u76f8\u540c\u96a8\u6a5f\u6578\u7684\u53e6\u4e00\u7b46\u4ea4\u6613\u4f86\u505a\u5230\u9019\u4e00\u9ede\u3002</p> <p> \u5148\u6c7a\u689d\u4ef6\u95b1\u8b80 </p> <ul> <li>Cosmos SDK Mempool</li> </ul> <p> Daodst \u5c0d\u6bd4 Ethereum </p> <p>\u5728\u4ee5\u592a\u574a\u4e2d\uff0c\u5f85\u8655\u7406\u7684\u5340\u584a\u662f\u5728\u7926\u5de5\u6392\u968a\u7b49\u5f85\u751f\u7522\u6642\u751f\u6210\u7684\u3002</p> <p>\u9019\u4e9b\u672a\u6c7a\u5340\u584a\u5305\u62ec\u7926\u5de5\u6839\u64da\u652f\u4ed8\u7684\u6700\u9ad8 gas \u734e\u52f5\u6311\u9078\u51fa\u7684\u672a\u6c7a\u4ea4\u6613\u3002</p> <p>\u9019\u7a2e\u6a5f\u5236\u7684\u5b58\u5728\u662f\u56e0\u70ba\u5728\u4ee5\u592a\u574a\u7db2\u7d61\u4e0a\u4e0d\u53ef\u80fd\u5be6\u73fe\u5340\u584a\u6700\u7d42\u6027\u3002</p> <p>\u584a\u4ee5\u6982\u7387\u78ba\u5b9a\u6027\u63d0\u4ea4\uff0c\u9019\u610f\u5473\u8457\u96a8\u8457\u6642\u9593\uff08\u548c\u584a\uff09\u7684\u6d41\u901d\uff0c\u4ea4\u6613\u548c\u584a\u8b8a\u5f97\u4e0d\u592a\u53ef\u80fd\u88ab\u9084\u539f\u3002</p> <p>Daodst \u5728\u9019\u65b9\u9762\u7684\u8a2d\u8a08\u5b8c\u5168\u4e0d\u540c\uff0c\u56e0\u70ba\u6c92\u6709\u201c\u5f85\u5b9a\u72c0\u614b\u201d\u7684\u6982\u5ff5\u3002</p> <p>Daodst \u4f7f\u7528 Tendermint Core BFT \u5171\u8b58\uff0c\u70ba\u4ea4\u6613\u63d0\u4f9b\u5373\u6642\u7d42\u7d50\u6027\u3002</p> <p>\u51fa\u65bc\u9019\u500b\u539f\u56e0\uff0cEthermint \u4e0d\u9700\u8981\u639b\u8d77\u72c0\u614b\u6a5f\u5236\uff0c\u56e0\u70ba\u6240\u6709\uff08\u5982\u679c\u4e0d\u662f\u5927\u591a\u6578\uff09\u4ea4\u6613\u90fd\u5c07\u63d0\u4ea4\u5230\u4e0b\u4e00\u500b\u5340\u584a\uff08Cosmos \u93c8\u4e0a\u7684\u5e73\u5747\u5340\u584a\u6642\u9593\u7d04\u70ba 8 \u79d2\uff09\u3002</p> <p>\u7136\u800c\uff0c\u9019\u6703\u5c0e\u81f4\u4e00\u4e9b\u8207\u4ee5\u592a\u574a Web3 \u517c\u5bb9\u7684\u67e5\u8a62\u51fa\u73fe\u554f\u984c\uff0c\u9019\u4e9b\u67e5\u8a62\u53ef\u80fd\u6703\u9032\u5165\u639b\u8d77\u72c0\u614b\u3002</p> <p>\u8207\u4ee5\u592a\u574a\u7684\u53e6\u4e00\u500b\u986f\u8457\u5340\u5225\u662f\uff0c\u5340\u584a\u662f\u7531\u9a57\u8b49\u8005\u6216\u5340\u584a\u751f\u7522\u8005\u751f\u6210\u7684\uff0c\u4ed6\u5011\u4ee5\u5148\u9032\u5148\u51fa (FIFO) \u7684\u65b9\u5f0f\u5c07\u672c\u5730\u5167\u5b58\u6c60\u4e2d\u7684\u4ea4\u6613\u5305\u542b\u5230\u5340\u584a\u4e2d\u3002</p> <p>Daodst \u4e0a\u7684\u4ea4\u6613\u4e0d\u80fd\u5f9e Tendermint \u7bc0\u9ede mempool \u4e2d\u6392\u5e8f\u6216\u6311\u9078\u51fa\u4f86\u3002</p> <p> Pending \u72c0\u614b\u968a\u5217 </p> <p>Daodst \u5c07\u9032\u884c\u67e5\u8a62\uff0c\u4ee5\u8aaa\u660e\u7bc0\u9ede\u4ea4\u6613\u5167\u5b58\u6c60\u4e2d\u5b58\u5728\u7684\u4efb\u4f55\u672a\u78ba\u8a8d\u4ea4\u6613\u3002</p> <p>\u9032\u884c\u7684\u639b\u8d77\u72c0\u614b\u67e5\u8a62\u5c07\u662f\u4e3b\u89c0\u7684\uff0c\u4e26\u4e14\u5c07\u5728\u76ee\u6a19\u7bc0\u9ede\u7684\u5167\u5b58\u6c60\u4e0a\u9032\u884c\u67e5\u8a62\u3002</p> <p>\u56e0\u6b64\uff0c\u5c0d\u65bc\u5169\u500b\u4e0d\u540c\u7bc0\u9ede\u7684\u76f8\u540c\u67e5\u8a62\uff0c\u639b\u8d77\u72c0\u614b\u5c07\u4e0d\u76f8\u540c\u3002</p> <p> JSON-RPC Calls on Pending Transactions </p> <ul> <li><code>eth_getBalance</code></li> <li><code>eth_getTransactionCount</code></li> <li><code>eth_getBlockTransactionCountByNumber</code></li> <li><code>eth_getBlockByNumber</code></li> <li><code>eth_getTransactionByHash</code></li> <li><code>eth_getTransactionByBlockNumberAndIndex</code></li> <li><code>eth_sendTransaction</code></li> </ul>"},{"location":"protocol/#_24","title":"\u4ee3\u5e63","text":""},{"location":"protocol/#daodst_1","title":"Daodst \u4ee3\u5e63","text":"<p>EVM \u4e0a\u7528\u65bc\u8cea\u62bc\u3001\u6cbb\u7406\u548c\u6c23\u9ad4\u6d88\u8017\u7684\u9762\u984d\u662f DST\u3002 Daodst \u63d0\u4f9b\u4ee5\u4e0b\u5be6\u7528\u7a0b\u5e8f\uff1a\u4fdd\u8b77\u6b0a\u76ca\u8b49\u660e\u93c8\u3001\u7528\u65bc\u6cbb\u7406\u5efa\u8b70\u7684\u4ee3\u5e63\u3001\u5411\u9a57\u8b49\u8005\u548c\u7528\u6236\u5206\u914d\u8cbb\u7528\uff0c\u4ee5\u53ca\u4f5c\u70ba\u5728 EVM \u4e0a\u904b\u884c\u667a\u80fd\u5408\u7d04\u7684\u71c3\u6599\u3002</p> <p>Daodst \u4f7f\u7528 Atto DST \u4f5c\u70ba\u57fa\u790e\u9762\u984d\u4ee5\u4fdd\u6301\u8207\u4ee5\u592a\u574a\u7684\u5c0d\u7b49\u3002 \u8cc7\u7522\u5206\u70ba\u4e09\u985e\uff1a</p> <ul> <li>\u539f\u751f DST \u4ee3\u5e63</li> <li>IBC\u4ee3\u5e63\uff08\u901a\u904e IBC\uff09</li> <li>\u4ee5\u592a\u574a\u985e\u578b\u7684\u4ee3\u5e63\uff0c\u4f8b\u5982 ERC-20</li> </ul> <p>\u9019\u8207\u4ee5\u592a\u574a\u7684\u9762\u984d\u76f8\u5339\u914d\uff1a</p> <p><code>1 ETH = 10&lt;sup&gt;18&lt;/sup&gt; wei</code></p>"},{"location":"protocol/#cosmos","title":"Cosmos \u4ee3\u5e63","text":"<p>\u8cec\u6236\u53ef\u4ee5\u5728\u5176\u9918\u984d\u4e2d\u64c1\u6709 Cosmos \u5e63\uff0c\u9019\u4e9b\u5e63\u7528\u65bc\u8207\u5176\u4ed6 Cosmos \u7684\u64cd\u4f5c\u548c\u4ea4\u6613\u3002 \u9019\u4e9b\u4f8b\u5b50\u5305\u62ec\u4f7f\u7528\u4ee3\u5e63\u9032\u884c\u8cea\u62bc\u3001IBC \u8f49\u8cec\u3001\u6cbb\u7406\u5b58\u6b3e\u548c EVM\u3002</p>"},{"location":"protocol/#evm","title":"EVM \u4ee3\u5e63","text":"<p>Daodst \u8207 ERC20 \u4ee3\u5e63\u548c EVM \u539f\u751f\u652f\u6301\u7684\u5176\u4ed6\u4e0d\u53ef\u66ff\u4ee3\u4ee3\u5e63\u6a19\u6e96\uff08EIP721\u3001EIP1155\uff09\u517c\u5bb9\u3002</p> <p>  Daodst \u8cc7\u7522\u9801 </p> <p>Daodst \u5100\u8868\u677f\u4e0a\u7684\u529f\u80fd\u3002</p> <p>Daodst \u555f\u7528\u6b64\u529f\u80fd\uff0c\u901a\u904e\u6df7\u6dc6\u8cc7\u7522\u985e\u578b\u9060\u96e2\u7528\u6236\u4e26\u5141\u8a31\u4ed6\u5011\u5c08\u6ce8\u65bc\u4ea4\u4e92\u4f86\u5e6b\u52a9\u6539\u5584\u7528\u6236\u9ad4\u9a57\u3002</p> <p>\u8a72\u5354\u8b70\u901a\u904e\u8655\u7406\u8f49\u63db\u7c21\u5316\u4e86\u6d41\u7a0b\uff0c\u4e26\u70ba\u7528\u6236\u63d0\u4f9b\u4e86\u7c21\u5316\u7684\u9762\u984d\u548c\u4ed6\u5011\u6301\u6709\u7684\u8cc7\u7522\u6578\u91cf\u3002</p> <p>\u6709\u95dc\u6211\u5011\u5982\u4f55\u8655\u7406\u4ee4\u724c\u8a3b\u518a\u7684\u66f4\u591a\u4fe1\u606f\uff0c\u8acb\u8a2a\u554f \u6b64\u8655\u3002</p>"},{"location":"protocol/#_25","title":"\u4ea4\u6613","text":"<p>\u4ea4\u6613\u662f\u6307\u7531\u8cec\u6236\u767c\u8d77\u7684\u6539\u8b8a\u5340\u584a\u93c8\u72c0\u614b\u7684\u52d5\u4f5c\u3002</p> <p>\u70ba\u4e86\u6709\u6548\u5730\u57f7\u884c\u72c0\u614b\u66f4\u6539\uff0c\u6bcf\u7b46\u4ea4\u6613\u90fd\u6703\u5ee3\u64ad\u5230\u6574\u500b\u7db2\u7d61\u3002</p> <p>\u4efb\u4f55\u7bc0\u9ede\u90fd\u53ef\u4ee5\u5ee3\u64ad\u8acb\u6c42\u5728\u5340\u584a\u93c8\u72c0\u614b\u6a5f\u4e0a\u57f7\u884c\u7684\u4ea4\u6613\uff1b</p> <p>\u767c\u751f\u9019\u7a2e\u60c5\u6cc1\u5f8c\uff0c\u9a57\u8b49\u5668\u5c07\u9a57\u8b49\u3001\u57f7\u884c\u4ea4\u6613\u4e26\u5c07\u7522\u751f\u7684\u72c0\u614b\u66f4\u6539\u50b3\u64ad\u5230\u7db2\u7d61\u7684\u5176\u9918\u90e8\u5206\u3002</p> <p>\u70ba\u4e86\u8655\u7406\u6bcf\u7b46\u4ea4\u6613\uff0c\u7db2\u7d61\u4e0a\u7684\u8a08\u7b97\u8cc7\u6e90\u90fd\u6703\u88ab\u6d88\u8017\u3002</p> <p>\u56e0\u6b64\uff0c\u201cgas\u201d\u7684\u6982\u5ff5\u662f\u4f5c\u70ba\u9a57\u8b49\u8005\u8655\u7406\u4ea4\u6613\u6240\u9700\u7684\u8a08\u7b97\u7684\u53c3\u8003\u800c\u51fa\u73fe\u7684\u3002</p> <p>\u7528\u6236\u5fc5\u9808\u70ba\u6b64\u8a08\u7b97\u4ed8\u8cbb\uff0c\u6240\u6709\u4ea4\u6613\u90fd\u9700\u8981\u76f8\u95dc\u8cbb\u7528\u3002</p> <p>\u8a72\u8cbb\u7528\u662f\u6839\u64da\u57f7\u884c\u4ea4\u6613\u6240\u9700\u7684 gas \u548c gas \u50f9\u683c\u8a08\u7b97\u7684\u3002</p> <p>\u6b64\u5916\uff0c\u4ea4\u6613\u9700\u8981\u4f7f\u7528\u767c\u9001\u65b9\u7684\u79c1\u9470\u9032\u884c\u7c3d\u540d\u3002</p> <p>\u9019\u8b49\u660e\u4ea4\u6613\u53ea\u80fd\u4f86\u81ea\u767c\u4ef6\u4eba\uff0c\u800c\u4e0d\u662f\u6b3a\u8a50\u6027\u767c\u9001\u3002</p> <p>\u7c21\u800c\u8a00\u4e4b\uff0c\u5c07\u7c3d\u540d\u4ea4\u6613\u63d0\u4ea4\u5230\u7db2\u7d61\u5f8c\u7684\u4ea4\u6613\u751f\u547d\u9031\u671f\u5982\u4e0b\uff1a</p> <ul> <li>\u4ea4\u6613\u54c8\u5e0c\u662f\u52a0\u5bc6\u751f\u6210\u7684\u3002</li> <li>\u8a72\u4ea4\u6613\u88ab\u5ee3\u64ad\u5230\u7db2\u7d61\u4e26\u6dfb\u52a0\u5230\u7531\u6240\u6709\u5176\u4ed6\u672a\u6c7a\u7db2\u7d61\u4ea4\u6613\u7d44\u6210\u7684\u4ea4\u6613\u6c60\u4e2d\u3002</li> <li>\u9a57\u8b49\u8005\u5fc5\u9808\u9078\u64c7\u4f60\u7684\u4ea4\u6613\u4e26\u5c07\u5176\u5305\u542b\u5728\u4e00\u500b\u584a\u4e2d\uff0c\u4ee5\u9a57\u8b49\u4ea4\u6613\u4e26\u8a8d\u70ba\u5b83\u201c\u6210\u529f\u201d\u3002</li> </ul> <p>\u95dc\u65bc\u4ea4\u6613\u751f\u547d\u9031\u671f\u7684\u66f4\u8a73\u7d30\u89e3\u91cb\uff0c\u8acb\u53c3\u898b\u76f8\u61c9\u90e8\u5206\u3002</p> <p>\u4ea4\u6613\u54c8\u5e0c\u662f\u4e00\u500b\u552f\u4e00\u6a19\u8b58\u7b26\uff0c\u53ef\u7528\u65bc\u6aa2\u67e5\u4ea4\u6613\u4fe1\u606f\uff0c\u4f8b\u5982\uff0c\u767c\u51fa\u7684\u4e8b\u4ef6\u662f\u5426\u6210\u529f\u3002</p> <p>\u4ea4\u6613\u53ef\u80fd\u56e0\u5404\u7a2e\u539f\u56e0\u800c\u5931\u6557\u3002</p> <p>\u4f8b\u5982\uff0c\u63d0\u4f9b\u7684 gas \u6216\u8cbb\u7528\u53ef\u80fd\u4e0d\u8db3\u3002</p> <p>\u6b64\u5916\uff0c\u4ea4\u6613\u9a57\u8b49\u53ef\u80fd\u6703\u5931\u6557\u3002</p> <p>\u6bcf\u7b46\u4ea4\u6613\u90fd\u6709\u7279\u5b9a\u7684\u689d\u4ef6\uff0c\u5fc5\u9808\u6eff\u8db3\u9019\u4e9b\u689d\u4ef6\u624d\u80fd\u88ab\u8996\u70ba\u6709\u6548\u3002</p> <p>\u4e00\u500b\u5ee3\u6cdb\u7684\u9a57\u8b49\u662f\u767c\u9001\u8005\u662f\u4ea4\u6613\u7c3d\u540d\u8005\u3002</p> <p>\u5728\u9019\u7a2e\u60c5\u6cc1\u4e0b\uff0c\u5982\u679c\u60a8\u5728\u767c\u4ef6\u4eba\u5730\u5740\u8207\u7c3d\u540d\u8005\u5730\u5740\u4e0d\u540c\u7684\u5730\u65b9\u767c\u9001\u4ea4\u6613\uff0c\u5373\u4f7f\u8cbb\u7528\u8db3\u5920\uff0c\u4ea4\u6613\u4e5f\u6703\u5931\u6557\u3002</p> <p>\u5982\u4eca\uff0c\u4ea4\u6613\u4e0d\u50c5\u53ef\u4ee5\u5728\u63d0\u4ea4\u7684\u93c8\u4e0a\u9032\u884c\u72c0\u614b\u8f49\u63db\uff0c\u9084\u53ef\u4ee5\u5728\u53e6\u4e00\u689d\u5340\u584a\u93c8\u4e0a\u9032\u884c\u4ea4\u6613\u3002</p> <p>\u93c8\u9593\u4ea4\u6613\u53ef\u4ee5\u901a\u904e \u5340\u584a\u93c8\u9593\u901a\u4fe1\u5354\u8b70 (IBC) \u5be6\u73fe\u3002</p> <p>\u5728\u4e0b\u9762\u7684\u90e8\u5206\u4e2d\u627e\u5230\u66f4\u8a73\u7d30\u7684\u89e3\u91cb\u3002</p>"},{"location":"protocol/#_26","title":"\u4ea4\u6613\u985e\u578b","text":"<p>Daodst \u652f\u6301\u5169\u7a2e\u4ea4\u6613\u985e\u578b\uff1a</p> <ol> <li>Cosmos \u4ea4\u6613</li> <li>Ethereum \u4ea4\u6613</li> </ol> <p>\u9019\u662f\u53ef\u80fd\u7684\uff0c\u56e0\u70ba Daodst \u4f7f\u7528 Cosmos-SDK \u4e26\u5be6\u73fe\u4e86 \u4ee5\u592a\u574a\u865b\u64ec\u6a5f \u4f5c\u70ba\u4e00\u500b\u6a21\u584a\u3002</p> <p>\u901a\u904e\u9019\u7a2e\u65b9\u5f0f\uff0cDaodst \u63d0\u4f9b\u4e86\u4ee5\u592a\u574a\u548c Cosmos \u93c8\u7d44\u5408\u7684\u7279\u6027\u548c\u529f\u80fd\uff0c\u7b49\u7b49\u3002</p> <p>\u5118\u7ba1\u9019\u5169\u7a2e\u4ea4\u6613\u985e\u578b\u4e2d\u5305\u542b\u7684\u5927\u90e8\u5206\u4fe1\u606f\u76f8\u4f3c\uff0c\u4f46\u5b83\u5011\u4e4b\u9593\u5b58\u5728\u5dee\u7570\u3002</p> <p>\u4e00\u500b\u91cd\u8981\u7684\u5340\u5225\u662f\uff0cCosmos \u4ea4\u6613\u5141\u8a31\u5728\u540c\u4e00\u4ea4\u6613\u4e2d\u767c\u9001\u591a\u689d\u6d88\u606f\u3002</p> <p>\u76f8\u53cd\uff0c\u4ee5\u592a\u574a\u4ea4\u6613\u5247\u6c92\u6709\u9019\u7a2e\u53ef\u80fd\u3002</p> <p>\u70ba\u4e86\u5c07\u9019\u5169\u7a2e\u985e\u578b\u7d50\u5408\u5728\u4e00\u8d77\uff0cDaodst \u5c07\u4ee5\u592a\u574a\u4ea4\u6613\u5be6\u73fe\u70ba\u55ae\u500b <code>sdk.Msg</code> \u5305\u542b\u5728 <code>auth.StdTx</code> \u4e2d\u3002</p> <p>\u6b64\u6d88\u606f\u4e2d\u5305\u542b\u6240\u6709\u76f8\u95dc\u7684\u4ee5\u592a\u574a\u4ea4\u6613\u4fe1\u606f\u3002</p> <p>\u9019\u5305\u62ec\u7c3d\u540d\u3001\u6c23\u9ad4\u3001\u6709\u6548\u8f09\u8377\u7b49\u3002</p> <p>\u5728\u4ee5\u4e0b\u90e8\u5206\u4e2d\u627e\u5230\u6709\u95dc\u9019\u5169\u7a2e\u985e\u578b\u7684\u66f4\u591a\u4fe1\u606f\u3002</p>"},{"location":"protocol/#cosmos_1","title":"Cosmos \u4ea4\u6613","text":"<p>On Cosmos chains, transactions are comprised of metadata held in contexts and <code>sdk.Msg</code>s that trigger state changes within a module through the module's Protobuf Msg service.</p> <p>When users want to interact with an application and make state changes (e.g. sending coins), they create transactions. Cosmos transactions can have multiple <code>sdk.Msg</code>s. Each of these must be signed using the private key associated with the appropriate account(s), before the transaction is broadcasted to the network.</p> <p>A Cosmos transaction includes the following information:</p> <ul> <li><code>Msgs</code>: an array of msgs (<code>sdk.Msg</code>)</li> <li><code>GasLimit</code>: option chosen by the users for how to calculate how much gas they will need to pay</li> <li><code>FeeAmount</code>: max amount user is willing to pay in fees</li> <li><code>TimeoutHeight</code>: block height until which the transaction is valid</li> <li><code>Signatures</code>: array of signatures from all signers of the tx</li> <li><code>Memo</code>: a note or comment to send with the transaction</li> </ul> <p>To submit a Cosmos transaction, users must use one of the provided clients.</p>"},{"location":"protocol/#ethereum","title":"Ethereum \u4ea4\u6613","text":"<p>Ethereum transactions refer to actions initiated by EOAs (externally-owned accounts, managed by humans), rather than internal smart contract calls. Ethereum transactions transform the state of the EVM and therefore must be broadcasted to the entire network.</p> <p>Ethereum transactions also require a fee, known as <code>gas</code>. (EIP-1559) introduced the idea of a base fee, along with a priority fee which serves as an incentive for miners to include specific transactions in blocks.</p> <p>There are several categories of Ethereum transactions:</p> <ul> <li>regular transactions: transactions from one account to another</li> <li>contract deployment transactions: transactions without a <code>to</code> address, where the contract code is sent in the <code>data</code> field</li> <li>execution of a contract: transactions that interact with a deployed smart contract,   where the <code>to</code> address is the smart contract address</li> </ul> <p>An Ethereum transaction includes the following information:</p> <ul> <li><code>recipient</code>: receiving address</li> <li><code>signature</code>: sender's signature</li> <li><code>nonce</code>: counter of tx number from account</li> <li><code>value</code>: amount of ETH to transfer (in wei)</li> <li><code>data</code>: include arbitrary data. Used when deploying a smart contract or making a smart contract method call</li> <li><code>gasLimit</code>: max amount of gas to be consumed</li> <li><code>maxPriorityFeePerGas</code>: mas gas to be included as tip to validators</li> <li><code>maxFeePerGas</code>: max amount of gas to be paid for tx</li> </ul> <p>For more information on Ethereum transactions and the transaction lifecycle, go here.</p> <p>Daodst supports the following Ethereum transactions.</p> <p>:::tip Note: Unprotected legacy transactions are not supported by default. :::</p> <ul> <li>Dynamic Fee Transactions (EIP-1559)</li> <li>Access List Transactions (EIP-2930)</li> <li>Legacy Transactions (EIP-2718)</li> </ul> <p>Daodst is capable of processing Ethereum transactions by wrapping them on a <code>sdk.Msg</code>. Daodst achieves this by using the <code>MsgEthereumTx</code>. This message encapsulates an Ethereum transaction as an SDK message and contains the necessary transaction data fields.</p> <p>One remark about the <code>MsgEthereumTx</code> is that it implements both the <code>sdk.Msg</code> and <code>sdk.Tx</code> interfaces (generally SDK messages only implement the former, while the latter is a group of messages bundled together). The reason of this, is because the <code>MsgEthereumTx</code> must not be included in a <code>auth.StdTx</code> (SDK's standard transaction type) as it performs gas and fee checks using the Ethereum logic from Geth instead of the Cosmos SDK checks done on the auth module <code>AnteHandler</code>.</p>"},{"location":"protocol/#_27","title":"\u93c8\u9593\u4ea4\u6613","text":"<p>Interchain transactions refer to the transfer of digital assets or data between two or more different blockchain networks.</p> <p>Each blockchain network has its own unique protocol and data structure, making it difficult to directly transfer assets or data from one blockchain to another. Interchain transactions allow for the transfer of assets and data between different blockchains by using intermediary mechanisms or protocols.</p> <p>One such mechanism is a cross-chain bridge, which acts as a connector between different blockchains, enabling the transfer of assets or data. Cross-chain bridges typically require some form of trust or consensus mechanism to ensure the security and integrity of the transaction.</p> <p>Another possibility is to use the IBC (Inter-Blockchain Communication) protocol. To make an interchain transaction using IBC a user needs to:</p> <ul> <li>Choose the source and destination blockchain networks that the user wants to transfer assets or data between.</li> <li>Ensure that both blockchain networks have implemented the IBC protocol</li> <li>Ensure there's a connection and channel established between the two blockchain networks using IBC</li> <li>Initiate the transfer of assets or data: this is done by sending a transaction from the source blockchain   to the destination blockchain through the IBC channel</li> </ul> <p>Interchain transactions are becoming increasingly important as the number of different blockchain networks and applications continues to grow. They enable the interoperability of different blockchain networks, allowing for greater flexibility and efficiency in the transfer of digital assets and data.</p>"},{"location":"protocol/#_28","title":"\u4ea4\u6613\u6191\u8b49","text":"<p>A transaction receipt shows data returned by an Ethereum client to represent the result of a particular transaction, including a hash of the transaction, its block number, the amount of gas used, and, in case of deployment of a smart contract, the address of the contract. Additionally, it includes custom information from the events emitted in the smart contract.</p> <p>A receipt contains the following information:</p> <ul> <li><code>transactionHash</code> : hash of the transaction.</li> <li><code>transactionIndex</code>: integer of the transactions index position in the block.</li> <li><code>blockHash</code>: hash of the block where this transaction was in.</li> <li><code>blockNumber</code>: block number where this transaction was in.</li> <li><code>from</code>: address of the sender.</li> <li><code>to</code>: address of the receiver. null when its a contract creation transaction.</li> <li><code>cumulativeGasUsed</code> : The total amount of gas used when this transaction was executed in the block.</li> <li><code>effectiveGasPrice</code> : The sum of the base fee and tip paid per unit of gas.</li> <li><code>gasUsed</code> : The amount of gas used by this specific transaction alone.</li> <li><code>contractAddress</code> : The contract address created, if the transaction was a contract creation, otherwise null.</li> <li><code>logs</code>: Array of log objects, which this transaction generated.</li> <li><code>logsBloom</code>: Bloom filter for light clients to quickly retrieve related logs.</li> <li><code>type</code>: integer of the transaction type, 0x00 for legacy transactions, 0x01 for access list types,   0x02 for dynamic fees. It also returns either.</li> <li><code>root</code> : transaction stateroot (pre Byzantium)</li> <li><code>status</code>: either 1 (success) or 0 (failure)</li> </ul>"},{"location":"validator/","title":"\u6982\u8ff0","text":""},{"location":"validator/#_2","title":"\u8a2d\u7f6e\u548c\u914d\u7f6e","text":""},{"location":"validator/#_3","title":"\u904b\u884c\u9a57\u8b49\u5668","text":""},{"location":"validator/#_4","title":"\u914d\u7f6e","text":""},{"location":"validator/#_5","title":"\u786c\u76e4\u4f7f\u7528\u512a\u5316","text":""},{"location":"validator/#_6","title":"\u72c0\u614b\u540c\u6b65","text":""},{"location":"validator/#_7","title":"\u5167\u5b58\u6c60","text":""},{"location":"validator/#_8","title":"\u9a57\u8b49\u5668\u5e38\u898b\u554f\u984c","text":""},{"location":"validator/#_9","title":"\u9a57\u8b49\u5668\u5b89\u5168","text":""},{"location":"validator/#ddos","title":"\u54e8\u5175\u7bc0\u9ede (DDOS \u4fdd\u8b77)","text":""},{"location":"validator/#_10","title":"\u5bc6\u9470\u5099\u4efd","text":""},{"location":"validator/#_11","title":"\u5347\u7d1a","text":""},{"location":"validator/#_12","title":"\u5347\u7d1a\u6e05\u55ae","text":""},{"location":"validator/#_13","title":"\u786c\u5206\u53c9\u5347\u7d1a","text":""},{"location":"validator/#_14","title":"\u624b\u52d5\u5347\u7d1a","text":""},{"location":"validator/#_15","title":"\u6e2c\u8a66\u7db2","text":""},{"location":"validator/#_16","title":"\u4e3b\u7db2","text":""},{"location":"chat/chat_doc/","title":"\u670d\u52d9\u6587\u6a94","text":""},{"location":"chat/chat_doc/#_2","title":"\u6982\u8ff0","text":"<p>\u804a\u5929\u670d\u52d9\u662f\u57fa\u65bcmatrix\u5354\u8b70\u958b\u767c\u7684\u804a\u5929\u670d\u52d9\uff0c\u652f\u6301\u57fa\u65bc\u623f\u9593\u548c\u4e8b\u4ef6\u7684\u52a0\u5bc6\u901a\u4fe1\u3002 \u540c\u6642\u652f\u6301\u806f\u90a6\u5236\u7684\u8de8\u670d\u52d9\u7bc0\u9ede\u901a\u4fe1\uff0c\u4ee5\u53ca\u57fa\u65bcwebrtc\u7684\u9ede\u5c0d\u9ede\u97f3\u8996\u983b\u901a\u8a71\u3002</p> <p>\u8de8\u670d\u52d9\u7bc0\u9ede\u7684\u901a\u8a0a\u793a\u610f</p> <pre><code>    { Matrix client A }                             { Matrix client B }\n        ^          |                                    ^          |\n        |  events  |  Client-Server API                 |  events  |\n        |          V                                    |          V\n    +------------------+                            +------------------+\n    |                  |---------( HTTP )---------&gt; |                  |\n    |   homeserver     |                            |   homeserver     |\n    |                  |&lt;--------( HTTP )---------- |                  |\n    +------------------+      Server-Server API     +------------------+\n                          History Synchronisation\n                              (Federation)\n</code></pre>"},{"location":"chat/chat_doc/#_3","title":"\u57fa\u790e\u6982\u5ff5","text":""},{"location":"chat/chat_doc/#servername","title":"Servername\uff08\u865b\u64ec\u57df\u540d\uff09","text":"<p>servername\u4f5c\u70ba\u804a\u5929\u670d\u52d9\u7684\u865b\u64ec\u57df\u540d\uff08domain\uff09\uff0c\u548c\u7528\u6236\u7684\u9322\u5305\u5730\u5740\u5171\u540c\u69cb\u6210\u7528\u6236ID</p>"},{"location":"chat/chat_doc/#users","title":"Users\uff08\u7528\u6236\uff09","text":"<p>\u6bcf\u500b\u5ba2\u6236\u7aef\u95dc\u806f\u4e00\u500b\u8cec\u865f\uff0c\u7528\u4f86\u4f5c\u70ba\u804a\u5929\u7cfb\u7d71\u7684\u552f\u4e00\u8eab\u4efd\u8b58\u5225\uff0c\u5373userID\u3002\u9019\u500b\u8cec\u865f\u8207homeserver\u76f8\u95dc\u806f\u5f62\u6210\u4e00\u500b\u7a7a\u9593\u5206\u9694\u5316\u7684\u8cec\u865f\uff0c\u5f62\u5982\uff1a</p> <pre><code>@localpart:domain\n</code></pre>"},{"location":"chat/chat_doc/#devices","title":"Devices\uff08\u8a2d\u5099\uff09","text":"<p>\u5728\u804a\u5929\u7cfb\u7d71\u5167\u5b9a\u7fa9\u4e86\u4e00\u500b\u8a2d\u5099\u7684\u6982\u5ff5\uff0c\u9019\u500b\u8a2d\u5099\u53ef\u4ee5\u662f\u4e00\u500b\u684c\u9762\u5ba2\u6236\u7aef\uff0c\u4e00\u4e9b\u700f\u89bd\u5668\uff0c\u4e00\u500b\u5b89\u5353\u8a2d\u5099\u6216\u8005\u4e00\u500biPone\u7b49\u7b49\uff08\u76ee\u524d\u50c5\u958b\u653e\u5b89\u5353\u8a2d\u5099\uff09\u3002 \u4e00\u500b\u804a\u5929\u7cfb\u7d71\u7684\u8a2d\u5099\u5c31\u95dc\u806f\u65bc\u4e00\u500b\u73fe\u5be6\u4e2d\u7684\u7269\u7406\u8a2d\u5099\u6216\u8005\u79fb\u52d5\u61c9\u7528\u3002</p> <p>\u8a2d\u5099\u4e3b\u8981\u61c9\u7528\u65bc\u7ba1\u7406\u7528\u65bc\u7aef\u5c0d\u7aef\u52a0\u5bc6\u7684\u5bc6\u9470\uff08\u6bcf\u500b\u8a2d\u5099\u53ef\u4ee5\u5f97\u5230\u81ea\u5df1\u7684\u89e3\u5bc6\u79d8\u9470\u62f7\u8c9d\uff09\uff0c\u540c\u6642\u5728\u76f8\u540c\u8cec\u865f\u7684\u5176\u5b83\u8a2d\u5099\u9032\u884c\u9023\u63a5\u6642\u63d0\u4f9b\u5e6b\u52a9\u3002</p> <p>\u7576\u4e00\u500b\u7528\u6236\u7b2c\u4e00\u6b21\u4f7f\u7528\u5ba2\u6236\u7aef\u7684\u6642\u5019\uff0c\u5ba2\u6236\u7aef\u6703\u628a\u81ea\u5df1\u8a3b\u518a\u70ba\u65b0\u8a2d\u5099\u3002\u4e0d\u540c\u7684\u8a2d\u5099\u901a\u904e\u8a2d\u5099ID\uff08device_id\uff09\u9032\u884c\u8eab\u4efd\u8b58\u5225\uff0c\u8a2d\u5099ID\u5c0d\u65bc\u6bcf\u500b\u7528\u6236\u662f\u552f\u4e00\u7684\u3002 \u7528\u6236\u53ef\u4ee5\u7d66\u8a2d\u5099\u5b9a\u7fa9\u4e00\u500b\u4eba\u6027\u5316\u7684\u53ef\u8b80\u7684\u8a2d\u5099\u540d\u7a31\uff0c\u7528\u65bc\u4ed6\u5011\u4f86\u7ba1\u7406\u8a2d\u5099\u3002</p>"},{"location":"chat/chat_doc/#events","title":"Events\uff08\u4e8b\u4ef6\uff09","text":"<p>\u6240\u6709\u804a\u5929\u5167\u7684\u6578\u64da\u4ea4\u63db\u90fd\u662f\u57fa\u65bcevent\u4e8b\u4ef6\u9032\u884c\u7684\u3002\u901a\u904e\u4e8b\u4ef6\u5b9a\u7fa9\u5ba2\u6236\u7aef\u884c\u70ba\uff0c\u6bcf\u500b\u4e8b\u4ef6\u90fd\u6709\u4e00\u500btype\u985e\u578b\u5c6c\u6027\uff0c\u7528\u4f86\u5340\u5206\u6578\u64da\u985e\u578b\u3002\u6bcf\u500b\u4e8b\u4ef6\u985e\u578b\u5fc5\u9808\u662f\u5168\u5c40\u552f\u4e00\u7684\uff0c \u9075\u5faaJava\u547d\u540d\u7a7a\u9593\u7684\u547d\u540d\u898f\u5247\uff0c\u4f8b\u5982m.room.message\u4ee3\u8868\u623f\u9593\u5167\u7684\u6d88\u606f\u4e8b\u4ef6\u3002</p>"},{"location":"chat/chat_doc/#event-graphs","title":"Event Graphs\uff08\u4e8b\u4ef6\u5716\uff09","text":"<p>\u623f\u9593\u5167\u7684\u6240\u6709\u4e8b\u4ef6\u6578\u64da\u4ea4\u63db\u88ab\u5b58\u5132\u5728\u4e00\u500b\u7a31\u4f5c\u4e8b\u4ef6\u5716(Event Graphs)\u7684\u6709\u5411\u7121\u74b0\u5716\u5167\u3002\u5716\u4e2d\u7684\u6bcf\u500b\u4e8b\u4ef6\u6309\u7167\u6642\u9593\u9806\u5e8f\u6392\u5217\u800c\u6210\u3002</p> <p>\u901a\u5e38\uff0c\u4e00\u500b\u4e8b\u4ef6\u53ea\u6709\u4e00\u500b\u7236\u4e8b\u4ef6\uff1a\u767c\u9001\u6d88\u606f\u6642\u623f\u9593\u4e2d\u7684\u6700\u65b0\u6d88\u606f\u3002 \u4f46\u662f\uff0c\u5bb6\u5ead\u670d\u52d9\u5668(homeserver)\u5728\u767c\u9001\u6d88\u606f\u6642\u53ef\u80fd\u6703\u5408\u6cd5\u5730\u76f8\u4e92\u7af6\u722d\uff0c\u5f9e\u800c\u5c0e\u81f4\u55ae\u500b\u4e8b\u4ef6\u6709\u591a\u500b\u5f8c\u7e7c\u4e8b\u4ef6\u3002 \u56e0\u6b64\uff0c\u6dfb\u52a0\u5230\u5716\u4e2d\u7684\u4e0b\u4e00\u500b\u4e8b\u4ef6\u5c07\u6709\u591a\u500b\u7236\u9805\u3002\u6bcf\u500b\u4e8b\u4ef6\u5716\u90fd\u6709\u4e00\u500b\u6c92\u6709\u7236\u4e8b\u4ef6\u7684\u6839\u4e8b\u4ef6\u3002</p> <p>\u70ba\u4e86\u6392\u5e8f\u548c\u7c21\u5316\u5716\u4e2d\u4e8b\u4ef6\u4e4b\u9593\u7684\u6642\u9593\u9806\u5e8f\u6bd4\u8f03\uff0c\u5bb6\u5ead\u670d\u52d9\u5668\u5728\u6bcf\u500b\u4e8b\u4ef6\u4e0a\u7dad\u8b77\u4e00\u500b\u6df1\u5ea6\u5143\u6578\u64da\u5b57\u6bb5\u3002 \u4e8b\u4ef6\u7684\u6df1\u5ea6\u662f\u4e00\u500b\u6b63\u6574\u6578\uff0c\u56b4\u683c\u5927\u65bc\u5176\u4efb\u4f55\u7236\u4e8b\u4ef6\u7684\u6df1\u5ea6\u3002 \u6839\u4e8b\u4ef6\u7684\u6df1\u5ea6\u61c9\u70ba 1\u3002\u56e0\u6b64\uff0c\u5982\u679c\u4e00\u500b\u4e8b\u4ef6\u5728\u53e6\u4e00\u500b\u4e8b\u4ef6\u4e4b\u524d\uff0c\u5247\u5b83\u7684\u6df1\u5ea6\u5fc5\u9808\u56b4\u683c\u5c0f\u65bc 1\u3002</p>"},{"location":"chat/chat_doc/#room-structure","title":"Room structure\uff08\u623f\u9593\u7d50\u69cb\uff09","text":"<p>\u623f\u9593\u662f\u4e00\u500b\u6982\u5ff5\u6027\u7684\u5730\u65b9\uff0c\u7528\u6236\u53ef\u4ee5\u5728\u5176\u4e2d\u767c\u9001\u548c\u63a5\u6536\u4e8b\u4ef6\u3002 \u4e8b\u4ef6\u88ab\u767c\u9001\u5230\u4e00\u500b\u623f\u9593\uff0c\u8a72\u623f\u9593\u4e2d\u5177\u6709\u8db3\u5920\u8a2a\u554f\u6b0a\u9650\u7684\u6240\u6709\u53c3\u8207\u8005\u90fd\u5c07\u6536\u5230\u8a72\u4e8b\u4ef6\u3002 \u623f\u9593\u901a\u904e\u201c\u623f\u9593 ID\u201d\u5728\u5167\u90e8\u552f\u4e00\u6a19\u8b58\uff0c\u5177\u6709\u4ee5\u4e0b\u5f62\u5f0f\uff1a</p> <pre><code>!room_id:domain  # room_id\uff1a\u4e00\u500b16\u4f4d\u7684\u96a8\u6a5f\u5b57\u7b26\u4e32\n</code></pre> <p>\u6bcf\u500b\u623f\u9593\u53ea\u6709\u4e00\u500b\u623f\u9593ID\u3002 \u96d6\u7136\u623f\u9593 ID \u78ba\u5be6\u5305\u542b\u57df\uff0c\u4f46\u5b83\u50c5\u7528\u65bc\u5168\u5c40\u547d\u540d\u7a7a\u9593\u623f\u9593 ID\u3002\u8a72\u623f\u9593\u4e0d\u5728\u6307\u5b9a\u7684\u57df\u4e2d\u3002</p> <p>\u4e0b\u9762\u7684\u6982\u5ff5\u5716\u986f\u793a\u4e86\u4e00\u500b m.room.message \u4e8b\u4ef6\u88ab\u767c\u9001\u5230\u623f\u9593 !qporfwt:matrix.org\uff1a</p> <pre><code>\n    { @alice:matrix.org }                             { @bob:example.org }\n            |                                                 ^\n            |                                                 |\n    [HTTP POST]                                  [HTTP GET]\n    Room ID: !qporfwt:matrix.org                 Room ID: !qporfwt:matrix.org\n    Event type: m.room.message                   Event type: m.room.message\n    Content: { JSON object }                     Content: { JSON object }\n            |                                                 |\n            V                                                 |\n    +------------------+                          +------------------+\n    |   homeserver     |                          |   homeserver     |\n    |   matrix.org     |                          |   example.org    |\n    +------------------+                          +------------------+\n            |                                                 ^\n            |         [HTTP PUT]                              |\n            |         Room ID: !qporfwt:matrix.org            |\n            |         Event type: m.room.message              |\n            |         Content: { JSON object }                |\n            `-------&gt; Pointer to the preceding message  ------`\n                      PKI signature from matrix.org\n                      Transaction-layer metadata\n                      PKI Authorization header\n\n                  ....................................\n                 |           Shared Data              |\n                 | State:                             |\n                 |   Room ID: !qporfwt:matrix.org     |\n                 |   Servers: matrix.org, example.org |\n                 |   Members:                         |\n                 |    - @alice:matrix.org             |\n                 |    - @bob:example.org              |\n                 | Messages:                          |\n                 |   - @alice:matrix.org              |\n                 |     Content: { JSON object }       |\n                 |....................................|\n\n</code></pre> <p>\u806f\u90a6\u6a5f\u5236\u5728\u591a\u500bhomeserver\u4e4b\u9593\u7dad\u8b77\u6bcf\u500b\u623f\u9593\u7684\u5171\u4eab\u6578\u64da\u7d50\u69cb\u3002\u6578\u64da\u5206\u70ba\u6d88\u606f\u4e8b\u4ef6\u548c\u72c0\u614b\u4e8b\u4ef6\u3002</p> <p>\u6d88\u606f\u4e8b\u4ef6\uff1a\u9019\u4e9b\u63cf\u8ff0\u4e86\u623f\u9593\u5167\u7684\u77ac\u614b\u201c\u4e00\u6b21\u6027\u201d\u6d3b\u52d5\uff0c\u4f8b\u5982\u5373\u6642\u6d88\u606f\u3001VoIP \u547c\u53eb\u8a2d\u7f6e\u3001\u6587\u4ef6\u50b3\u8f38\u7b49\u3002\u5b83\u5011\u901a\u5e38\u63cf\u8ff0\u901a\u4fe1\u6d3b\u52d5\u3002</p> <p>\u72c0\u614b\u4e8b\u4ef6\uff1a\u9019\u4e9b\u63cf\u8ff0\u4e86\u5c0d\u8207\u623f\u9593\u76f8\u95dc\u7684\u7d66\u5b9a\u6301\u4e45\u4fe1\u606f\uff08\u201c\u72c0\u614b\u201d\uff09\u7684\u66f4\u65b0\uff0c\u4f8b\u5982\u623f\u9593\u7684\u540d\u7a31\u3001\u4e3b\u984c\u3001\u6210\u54e1\u8cc7\u683c\u3001\u53c3\u8207\u7684\u670d\u52d9\u5668\u7b49\u3002\u72c0\u614b\u88ab\u5efa\u6a21\u70ba\u9375/\u503c\u5c0d\u7684\u67e5\u627e\u8868 \u6bcf\u500b\u623f\u9593\uff0c\u6bcf\u500b\u9375\u90fd\u662f state_key \u548c\u4e8b\u4ef6\u985e\u578b\u7684\u5143\u7d44\u3002\u6bcf\u500b\u72c0\u614b\u4e8b\u4ef6\u90fd\u6703\u66f4\u65b0\u7d66\u5b9a\u9375\u7684\u503c\u3002</p> <p>\u7d66\u5b9a\u9ede\u7684\u623f\u9593\u72c0\u614b\u662f\u901a\u904e\u8003\u616e\u5716\u4e2d\u7d66\u5b9a\u4e8b\u4ef6\u4e4b\u524d\u548c\u5305\u62ec\u7d66\u5b9a\u4e8b\u4ef6\u7684\u6240\u6709\u4e8b\u4ef6\u4f86\u8a08\u7b97\u7684\u3002\u5728\u4e8b\u4ef6\u63cf\u8ff0\u76f8\u540c\u72c0\u614b\u7684\u60c5\u6cc1\u4e0b\uff0c\u61c9\u7528\u5408\u4f75\u885d\u7a81\u7b97\u6cd5\u3002\u72c0\u614b\u89e3\u6790\u7b97\u6cd5\u662f\u53ef\u50b3\u905e\u7684\uff0c\u4e0d\u4f9d\u8cf4\u65bc\u670d\u52d9\u5668\u72c0\u614b\uff0c\u56e0\u70ba\u5b83\u5fc5\u9808\u59cb\u7d42\u9078\u64c7\u76f8\u540c\u7684\u4e8b\u4ef6\uff0c\u800c\u4e0d\u7ba1\u670d\u52d9\u5668\u6216\u63a5\u6536\u4e8b\u4ef6\u7684\u9806\u5e8f\u5982\u4f55\u3002\u4e8b\u4ef6\u7531\u539f\u59cb\u670d\u52d9\u5668\u7c3d\u540d\uff08\u7c3d\u540d\u5305\u62ec\u7236\u95dc\u4fc2\uff0c \u985e\u578b\u3001\u6df1\u5ea6\u548c\u6709\u6548\u8ca0\u8f09\u54c8\u5e0c\uff09\u4e26\u901a\u904e\u806f\u5408\u63a8\u9001\u5230\u623f\u9593\u4e2d\u7684\u53c3\u8207\u670d\u52d9\u5668\uff0c\u76ee\u524d\u4f7f\u7528\u5168\u7db2\u72c0\u62d3\u64b2\u3002\u670d\u52d9\u5668\u9084\u53ef\u4ee5\u901a\u904e\u806f\u5408\u5f9e\u53c3\u8207\u623f\u9593\u7684\u5176\u4ed6\u670d\u52d9\u5668\u8acb\u6c42\u56de\u586b\u4e8b\u4ef6\u3002</p>"},{"location":"chat/chat_doc/#room-aliases","title":"Room Aliases(\u623f\u9593\u5225\u540d)","text":"<p>\u6bcf\u500b\u623f\u9593\u4e5f\u53ef\u4ee5\u6709\u591a\u500b\u201c\u623f\u9593\u5225\u540d\u201d\uff0c\u5982\u4e0b\u6240\u793a\uff1a</p> <pre><code>  #room_alias:domain\n</code></pre> <p>\u623f\u9593\u5225\u540d\u201c\u6307\u5411\u201d\u623f\u9593 ID\uff0c\u662f\u7528\u65bc\u516c\u4f48\u548c\u767c\u73fe\u623f\u9593\u7684\u4eba\u985e\u53ef\u8b80\u6a19\u7c64\u3002\u5225\u540d\u6307\u5411\u7684\u623f\u9593 ID \u53ef\u4ee5\u901a\u904e\u8a2a\u554f\u6307\u5b9a\u7684\u57df\u4f86\u7372\u53d6\u3002\u8acb\u6ce8\u610f\uff0c\u5f9e\u623f\u9593\u5225\u540d\u5230\u623f\u9593 ID \u7684\u6620\u5c04\u4e0d\u662f\u56fa\u5b9a\u7684\uff0c\u4e26\u4e14\u53ef\u80fd\u6703\u96a8\u8457\u6642\u9593\u7684\u63a8\u79fb\u800c\u6539\u8b8a\u4ee5\u6307\u5411\u4e0d\u540c\u7684\u623f\u9593 ID\u3002\u56e0\u6b64\uff0c\u5ba2\u6236\u7aef\u61c9\u8a72\u5c07\u623f\u9593\u5225\u540d\u89e3\u6790\u70ba\u623f\u9593 ID \u4e00\u6b21\uff0c\u7136\u5f8c\u5728\u5f8c\u7e8c\u8acb\u6c42\u4e2d\u4f7f\u7528\u8a72 ID\u3002</p> <p>\u89e3\u6790\u623f\u9593\u5225\u540d\u6642\uff0c\u670d\u52d9\u5668\u9084\u5c07\u97ff\u61c9\u623f\u9593\u4e2d\u53ef\u7528\u65bc\u52a0\u5165\u7684\u670d\u52d9\u5668\u5217\u8868\u3002</p> <pre><code>    HTTP GET\n    #matrix:example.org      !aaabaa:matrix.org\n       |                    ^\n       |                    |\n    _______V____________________|____\n    |          example.org           |\n    | Mappings:                      |\n    | #matrix &gt;&gt; !aaabaa:matrix.org  |\n    | #golf   &gt;&gt; !wfeiofh:sport.com  |\n    | #bike   &gt;&gt; !4rguxf:matrix.org  |\n    |________________________________|\n</code></pre>"},{"location":"chat/chat_doc/#identity","title":"Identity(\u8eab\u4efd)","text":"<p>Matrix \u4e2d\u7684\u7528\u6236\u662f\u901a\u904e\u4ed6\u5011\u7684 Matrix \u7528\u6236 ID \u4f86\u8b58\u5225\u7684\u3002\u4f46\u662f\uff0c\u4e5f\u53ef\u4ee5\u4f7f\u7528\u73fe\u6709\u7684\u7b2c 3 \u65b9 ID \u540d\u7a31\u7a7a\u9593\u4f86\u8b58\u5225 Matrix \u7528\u6236\u3002\u77e9\u9663\u201c\u8eab\u4efd\u201d\u63cf\u8ff0\u4e86\u7528\u6236 ID \u548c\u93c8\u63a5\u5230\u5176\u5e33\u6236\u7684\u7b2c\u4e09\u65b9\u540d\u7a31\u7a7a\u9593\u4e2d\u7684\u4efb\u4f55\u5176\u4ed6\u73fe\u6709 ID\u3002 Matrix \u7528\u6236\u53ef\u4ee5\u5c07\u96fb\u5b50\u90f5\u4ef6\u5730\u5740\u3001\u793e\u4ea4\u7db2\u7d61\u5e33\u6236\u548c\u96fb\u8a71\u865f\u78bc\u7b49\u7b2c\u4e09\u65b9 ID (3PID) \u93c8\u63a5\u5230\u4ed6\u5011\u7684\u7528\u6236 ID\u3002\u93c8\u63a5 3PID \u6703\u5275\u5efa\u5f9e 3PID \u5230\u7528\u6236 ID \u7684\u6620\u5c04\u3002 Matrix \u7528\u6236\u96a8\u5f8c\u53ef\u4ee5\u4f7f\u7528\u6b64\u6620\u5c04\u4f86\u767c\u73fe\u5176\u806f\u7e6b\u4eba\u7684\u7528\u6236 ID\u3002\u70ba\u4e86\u78ba\u4fdd\u5f9e 3PID \u5230\u7528\u6236 ID \u7684\u6620\u5c04\u662f\u771f\u5be6\u7684\uff0c\u4e00\u500b\u5168\u7403\u806f\u5408\u7684\u53ef\u4fe1\u201c\u8eab\u4efd\u670d\u52d9\u5668\u201d\uff08IS\uff09\u96c6\u7fa4\u88ab\u7528\u4f86\u9a57\u8b49 3PID \u4e26\u4fdd\u5b58\u548c\u5fa9\u5236\u6620\u5c04\u3002</p> <p>\u70ba\u4e86\u4f7f\u5ba2\u6236\u7aef\u61c9\u7528\u7a0b\u5e8f\u6210\u70ba Matrix \u751f\u614b\u7cfb\u7d71\u7684\u4e00\u90e8\u5206\uff0c\u4e0d\u9700\u8981\u4f7f\u7528 IS\u3002\u4f46\u662f\uff0c\u5982\u679c\u6c92\u6709\u4e00\u500b\u5ba2\u6236\u7aef\u5c07\u7121\u6cd5\u4f7f\u7528 3PID \u67e5\u627e\u7528\u6236 ID\u3002</p>"},{"location":"chat/chat_doc/#private-user-data","title":"Private User Data\uff08\u7528\u6236\u96b1\u79c1\u6578\u64da\uff09","text":"<p>\u7528\u6236\u9084\u53ef\u4ee5\u5728\u4ed6\u5011\u7684\u5e33\u6236\u4e2d\u5b58\u5132\u4efb\u610f\u79c1\u9470/\u503c\u6578\u64da\u2014\u2014\u4f8b\u5982\u5ba2\u6236\u7aef\u9996\u9078\u9805\u6216\u7f3a\u5c11\u4efb\u4f55\u5176\u4ed6\u5c08\u7528 API \u7684\u670d\u52d9\u5668\u914d\u7f6e\u8a2d\u7f6e\u3002 API \u8207\u7ba1\u7406\u914d\u7f6e\u6587\u4ef6\u6578\u64da\u5c0d\u7a31\u3002</p>"},{"location":"chat/client_server/","title":"\u5ba2\u6237\u7aef-\u670d\u52a1\u5668\u63a5\u53e3","text":"<p>\u5ba2\u6237\u7aef-\u670d\u52a1\u5668 API \u5141\u8bb8\u5ba2\u6237\u7aef \u53d1\u9001\u6d88\u606f,\u63a7\u5236\u623f\u95f4\u548c\u540c\u6b65\u5bf9\u8bdd\u5386\u53f2\u8bb0\u5f55\u3002\u662f\u7684 \u65e8\u5728\u652f\u6301\u4e0d\u5b58\u50a8\u72b6\u6001\u7684\u8f7b\u91cf\u7ea7\u5ba2\u6237\u7aef\u548c \u6839\u636e\u9700\u8981\u4ece\u670d\u52a1\u5668\u5ef6\u8fdf\u52a0\u8f7d\u6570\u636e - \u4ee5\u53ca\u91cd\u91cf\u7ea7\u6570\u636e \u7ef4\u62a4\u670d\u52a1\u5668\u72b6\u6001\u7684\u5b8c\u6574\u672c\u5730\u6301\u4e45\u526f\u672c\u7684\u5ba2\u6237\u7aef\u3002</p>"},{"location":"chat/client_server/#1","title":"1.\u63a5\u53e3\u6807\u51c6","text":"<p>Matrix \u4e2d\u5ba2\u6237\u7aef-\u670d\u52a1\u5668\u901a\u4fe1\u7684\u5f3a\u5236\u57fa\u7ebf\u662f \u901a\u8fc7 HTTP API \u4ea4\u6362 JSON \u5bf9\u8c61\u3002\u66f4\u9ad8\u6548\u7684\u8fd0\u8f93\u53ef\u80fd\u662f \u5c06\u6765\u6307\u5b9a\u4e3a\u53ef\u9009\u6269\u5c55\u3002</p> <p>\u5efa\u8bae\u4f7f\u7528 HTTPS \u8fdb\u884c\u901a\u4fe1\u3002\u4f7f\u7528\u7eaf HTTP \u4e0d\u662f \u63a8\u8350\u7684\u5916\u90e8\u6d4b\u8bd5\u73af\u5883\u3002</p> <p>\u5ba2\u6237\u7aef\u4f7f\u7528\u4e0d\u900f\u660e\u5b57\u7b26\u4e32access_token\u8fdb\u884c\u8eab\u4efd\u9a8c\u8bc1\u3002</p> <p>\u6240\u6709\u548c\u7aef\u70b9,\u9664\u4e86 POST /_matrix/media/v3/upload \u548c PUT /_matrix/media/v3/upload/{serverName}/{mediaId}, \u8981\u6c42\u5ba2\u6237\u7aef\u63d0\u4f9b\u5305\u542b\uff08\u53ef\u80fd\u4e3a\u7a7a\uff09\u7684\u8bf7\u6c42\u6b63\u6587POST JSON \u5bf9\u8c61\u3002\u5ba2\u6237\u7aef\u5e94\u4e3a\u5177\u6709PUT JSON \u6b63\u6587\u7684\u6240\u6709\u8bf7\u6c42\u63d0\u4f9b\u6807\u5934Content-Type application/json,\u4f46\u8fd9\u4e0d\u662f\u5fc5\u9700\u7684\u3002</p> <p>\u540c\u6837,\u6240\u6709\u7aef\u70b9\u90fd\u8981\u6c42\u670d\u52a1\u5668\u8fd4\u56de JSON \u5bf9\u8c61, \u9664\u4e86\u5bf9 GET /matrix/media/v200/download/{serverName}/{mediaId} \u548c GET / matrix/media/v3/thumbnail/{serverName}/{mediaId} \u7684 3 \u4e2a\u54cd\u5e94\u3002 \u670d\u52a1\u5668\u5fc5\u987b\u5305\u542b\u6240\u6709 JSON \u54cd\u5e94\u7684\u6807\u5934\u3002Content-Typeapplication/json</p> <p>\u8bf7\u6c42\u6216\u54cd\u5e94\u4e2d\u7684\u6240\u6709 JSON \u6570\u636e\u90fd\u5fc5\u987b\u4f7f\u7528 UTF-8 \u8fdb\u884c\u7f16\u7801\u3002</p> <p>\u53e6\u8bf7\u53c2\u9605\u9644\u5f55\u4e2d\u7684\u77e9\u9635 API \u7ea6\u5b9a,\u4e86\u89e3\u6240\u6709\u77e9\u9635 API \u5e94\u9075\u5faa\u7684\u7ea6\u5b9a, \u548c\u4e0b\u9762\u7684 Web \u6d4f\u89c8\u5668\u5ba2\u6237\u7aef\u4ee5\u83b7\u53d6\u5176\u4ed6 \u670d\u52a1\u5668\u54cd\u5e94\u7684\u8981\u6c42\u3002</p>"},{"location":"chat/client_server/#11","title":"1.1 \u6807\u51c6\u9519\u8bef\u54cd\u5e94","text":"<p>\u5728\u77e9\u9635API\u7ea7\u522b\u53d1\u751f\u7684\u4efb\u4f55\u9519\u8bef\u90fd\u5fc5\u987b\u8fd4\u56de\"\u6807\u51c6\" \u9519\u8bef\u54cd\u5e94\"\u3002\u8fd9\u662f\u4e00\u4e2a JSON \u5bf9\u8c61,\u5982\u4e0b\u6240\u793a:</p> <pre><code>{\n  \"errcode\": \"&lt;error code&gt;\",\n  \"error\": \"&lt;error message&gt;\"\n}\n</code></pre> <p>\u8be5\u5b57\u7b26\u4e32\u5c06\u662f\u4eba\u7c7b\u53ef\u8bfb\u7684\u9519\u8bef\u6d88\u606f,\u901a\u5e38\u4e3a \u89e3\u91ca\u51fa\u4e86\u4ec0\u4e48\u95ee\u9898\u7684\u53e5\u5b50\u3002error</p> <p>\u8be5\u5b57\u7b26\u4e32\u5c06\u662f\u4e00\u4e2a\u552f\u4e00\u7684\u5b57\u7b26\u4e32,\u53ef\u7528\u4e8e\u5904\u7406 \u9519\u8bef\u6d88\u606f,\u4f8b\u5982 .\u9519\u8bef\u4ee3\u7801\u5e94\u5177\u6709\u5176\u547d\u540d\u7a7a\u95f4 \u5728\u6240\u6709\u5927\u5199\u5b57\u6bcd\u4e2d\u9996\u5148,\u7136\u540e\u662f\u5355\u4e2a.\u4f8b\u5982,\u5982\u679c\u6709\u81ea\u5b9a\u4e49 \u547d\u540d\u7a7a\u95f4\u548c\u4ee3\u7801,\u9519\u8bef\u4ee3\u7801\u5e94 \u8096\u3002\u7531\u6b64\u5b9a\u4e49\u7684\u9519\u8bef\u4ee3\u7801 \u89c4\u8303\u5e94\u8be5\u5f00\u59cb\u3002errcodeM_FORBIDDEN_com.mydomain.hereFORBIDDENCOM.MYDOMAIN.HERE_FORBIDDENM_</p> <p>\u4e00\u4e9b\u5b9a\u4e49\u4e86\u9519\u8bef\u4e2d\u5e94\u8be5\u5b58\u5728\u7684\u5176\u4ed6\u952e \u54cd\u5e94\u5bf9\u8c61,\u4f46\u952e\u548c\u5fc5\u987b\u59cb\u7ec8\u5b58\u5728\u3002errcodeerrorerrcode</p> <p>\u9519\u8bef\u901a\u5e38\u6700\u597d\u7531\u5176\u9519\u8bef\u4ee3\u7801\u8868\u793a,\u800c\u4e0d\u662f \u8fd4\u56de\u7684 HTTP \u72b6\u6001\u4ee3\u7801\u3002\u9047\u5230\u9519\u8bef\u7801\u65f6, \u5ba2\u6237\u7aef\u5e94\u9996\u9009 HTTP \u72b6\u6001\u4ee3\u7801\u4f5c\u4e3a\u66f4\u53ef\u9760\u7684\u53c2\u8003 \u95ee\u9898\u662f\u4ec0\u4e48\u3002\u4f8b\u5982,\u5982\u679c\u5ba2\u6237\u7aef\u6536\u5230\u9519\u8bef \u7684\u4ee3\u7801,\u4f46\u8bf7\u6c42\u7ed9\u51fa\u4e86 400 \u9519\u8bef\u8bf7\u6c42\u72b6\u6001 \u4ee3\u7801,\u5ba2\u6237\u7aef\u5e94\u5c06\u9519\u8bef\u89c6\u4e3a\u8d44\u6e90\u4e0d\u662f \u53d1\u73b0\u3002\u4f46\u662f,\u5982\u679c\u5ba2\u6237\u7aef\u6536\u5230\u9519\u8bef\u4ee3\u7801 400 \u9519\u8bef\u8bf7\u6c42,\u5219\u5ba2\u6237\u7aef\u5e94\u5047\u5b9a \u8bf7\u6c42\u65e0\u6548\u3002M_UNKNOWNM_NOT_FOUNDM_UNKNOWN</p>"},{"location":"chat/client_server/#111","title":"1.1.1 \u5e38\u89c1\u9519\u8bef","text":"<p>\u4efb\u4f55 API \u7aef\u70b9\u90fd\u53ef\u4ee5\u8fd4\u56de\u8fd9\u4e9b\u9519\u8bef\u4ee3\u7801:</p> <p>M_FORBIDDEN\u7981\u6b62\u8bbf\u95ee,\u4f8b\u5982\u672a\u7ecf\u8bb8\u53ef\u52a0\u5165\u623f\u95f4,\u767b\u5f55\u5931\u8d25\u3002</p> <p>M_UNKNOWN_TOKEN\u65e0\u6cd5\u8bc6\u522b\u6307\u5b9a\u7684\u8bbf\u95ee\u6216\u5237\u65b0\u4ee4\u724c\u3002</p> <p>\u5176\u4ed6\u54cd\u5e94\u53c2\u6570 \u4e0a\u53ef\u80fd\u5b58\u5728 \u54cd\u5e94 401 HTTP \u72b6\u6001\u4ee3\u7801\u3002\u67e5\u770b\u8f6f\u6ce8\u9500 \u90e8\u5206\u4e86\u89e3\u66f4\u591a\u4fe1\u606f\u3002soft_logout</p> <p>M_MISSING_TOKEN\u6ca1\u6709\u4e3a\u8bf7\u6c42\u6307\u5b9a\u8bbf\u95ee\u4ee4\u724c\u3002</p> <p>M_BAD_JSON\u8bf7\u6c42\u5305\u542b\u6709\u6548\u7684 JSON,\u4f46\u683c\u5f0f\u4ee5\u67d0\u79cd\u65b9\u5f0f\u4e0d\u6b63\u786e,\u4f8b\u5982 \u7f3a\u5c11\u5fc5\u9700\u7684\u952e,\u952e\u7684\u503c\u65e0\u6548\u3002</p> <p>M_NOT_JSON\u8bf7\u6c42\u4e0d\u5305\u542b\u6709\u6548\u7684 JSON\u3002</p> <p>M_NOT_FOUND\u627e\u4e0d\u5230\u6b64\u8bf7\u6c42\u7684\u8d44\u6e90\u3002</p> <p>M_LIMIT_EXCEEDED\u5728\u77ed\u65f6\u95f4\u5185\u53d1\u9001\u4e86\u592a\u591a\u8bf7\u6c42\u3002\u7a0d\u7b49\u7247\u523b \u7136\u540e\u91cd\u8bd5\u3002</p> <p>M_UNRECOGNIZED\u670d\u52a1\u5668\u65e0\u6cd5\u7406\u89e3\u8be5\u8bf7\u6c42\u3002\u9884\u8ba1\u8fd9\u5c06\u8fd4\u56de 404 HTTP \u72b6\u6001\u4ee3\u7801\uff08\u5982\u679c\u7ec8\u7ed3\u70b9\u672a\u5b9e\u73b0\uff09\u6216 405 HTTP \u72b6\u6001 \u4ee3\u7801\uff08\u5982\u679c\u7ec8\u7ed3\u70b9\u5df2\u5b9e\u73b0,\u4f46\u4f7f\u7528\u4e86\u4e0d\u6b63\u786e\u7684 HTTP \u65b9\u6cd5\uff09\u3002</p> <p>M_UNKNOWN\u53d1\u751f\u672a\u77e5\u9519\u8bef\u3002</p>"},{"location":"chat/client_server/#112","title":"1.1.2 \u5176\u4ed6\u9519\u8bef\u4ee3\u7801","text":"<p>\u4ee5\u4e0b\u9519\u8bef\u4ee3\u7801\u7279\u5b9a\u4e8e\u67d0\u4e9b\u7ec8\u7ed3\u70b9\u3002</p> <p>M_UNAUTHORIZED\u8bf7\u6c42\u672a\u6b63\u786e\u6388\u6743\u3002\u901a\u5e38\u662f\u7531\u4e8e\u767b\u5f55\u5931\u8d25\u3002</p> <p>M_USER_DEACTIVATED\u4e0e\u8bf7\u6c42\u5173\u8054\u7684\u7528\u6237\u6807\u8bc6\u5df2\u88ab\u505c\u7528\u3002\u901a\u5e38 \u5bf9\u4e8e\u8bc1\u660e\u8eab\u4efd\u9a8c\u8bc1\u7684\u7ec8\u7ed3\u70b9,\u4f8b\u5982 \u3002/login</p> <p>M_USER_IN_USE\u5c1d\u8bd5\u6ce8\u518c\u5df2\u5360\u7528\u7684\u7528\u6237 ID \u65f6\u9047\u5230\u6b64\u95ee\u9898\u3002</p> <p>M_INVALID_USERNAME\u5c1d\u8bd5\u6ce8\u518c\u65e0\u6548\u7684\u7528\u6237 ID \u65f6\u9047\u5230\u3002</p> <p>M_ROOM_IN_USE\u5f53\u63d0\u4f9b\u7ed9 API \u7684\u623f\u95f4\u522b\u540d\u5df2\u5728 \u4e2d\u65f6\u53d1\u9001 \u7528\u3002createRoom</p> <p>M_INVALID_ROOM_STATE\u5f53\u63d0\u4f9b\u7ed9 API \u7684\u521d\u59cb\u72b6\u6001\u65e0\u6548\u65f6\u53d1\u9001\u3002createRoom</p> <p>M_THREEPID_IN_USE\u5f53\u63d0\u4f9b\u7ed9 API \u7684\u4e09pid \u65e0\u6cd5\u4f7f\u7528\u65f6\u53d1\u9001,\u56e0\u4e3a\u76f8\u540c \u4e09PID\u5df2\u7ecf\u5728\u4f7f\u7528\u4e2d\u3002</p> <p>M_THREEPID_NOT_FOUND\u5f53\u63d0\u4f9b\u7ed9 API \u7684\u4e09 pid \u7531\u4e8e\u6ca1\u6709\u8bb0\u5f55\u800c\u65e0\u6cd5\u4f7f\u7528\u65f6\u53d1\u9001 \u627e\u5230\u4e86\u5339\u914d\u7684\u4e09\u76ae\u3002</p> <p>M_THREEPID_AUTH_FAILED\u65e0\u6cd5\u5bf9\u7b2c\u4e09\u65b9\u6807\u8bc6\u7b26\u6267\u884c\u8eab\u4efd\u9a8c\u8bc1\u3002</p> <p>M_THREEPID_DENIED\u670d\u52a1\u5668\u4e0d\u5141\u8bb8\u4f7f\u7528\u6b64\u7b2c\u4e09\u65b9\u6807\u8bc6\u7b26\u3002\u8fd9\u53ef\u80fd\u4f1a\u53d1\u751f \u4f8b\u5982,\u5982\u679c\u670d\u52a1\u5668\u53ea\u5141\u8bb8\u6765\u81ea \u7279\u5b9a\u57df\u3002</p> <p>M_SERVER_NOT_TRUSTED\u5ba2\u6237\u7aef\u7684\u8bf7\u6c42\u4f7f\u7528\u4e86\u7b2c\u4e09\u65b9\u670d\u52a1\u5668,\u4f8b\u5982\u8eab\u4efd\u670d\u52a1\u5668, \u6b64\u670d\u52a1\u5668\u4e0d\u4fe1\u4efb\u3002</p> <p>M_UNSUPPORTED_ROOM_VERSION\u5ba2\u6237\u7aef\u521b\u5efa\u623f\u95f4\u7684\u8bf7\u6c42\u4f7f\u7528\u4e86 \u670d\u52a1\u5668\u4e0d\u652f\u6301\u3002</p> <p>M_INCOMPATIBLE_ROOM_VERSION\u5ba2\u6237\u7aef\u5c1d\u8bd5\u52a0\u5165\u5177\u6709\u670d\u52a1\u5668\u7248\u672c\u7684\u6587\u4ef6\u5ba4 \u4e0d\u652f\u6301\u3002\u68c0\u67e5\u9519\u8bef\u54cd\u5e94\u7684\u5c5e\u6027 \u5bf9\u4e8e\u623f\u95f4\u7684\u7248\u672c\u3002room_version</p> <p>M_BAD_STATE\u65e0\u6cd5\u6267\u884c\u8bf7\u6c42\u7684\u72b6\u6001\u66f4\u6539,\u4f8b\u5982\u5c1d\u8bd5 \u53d6\u6d88\u7981\u6b62\u672a\u88ab\u7981\u6b62\u7684\u7528\u6237\u3002</p> <p>M_GUEST_ACCESS_FORBIDDEN\u5ba2\u623f\u6216\u8d44\u6e90\u4e0d\u5141\u8bb8\u5ba2\u4eba\u8bbf\u95ee\u3002</p> <p>M_CAPTCHA_NEEDED\u9700\u8981\u9a8c\u8bc1\u7801\u624d\u80fd\u5b8c\u6210\u8bf7\u6c42\u3002</p> <p>M_CAPTCHA_INVALID\u63d0\u4f9b\u7684\u9a8c\u8bc1\u7801\u4e0e\u9884\u671f\u4e0d\u7b26\u3002</p> <p>M_MISSING_PARAM\u8bf7\u6c42\u4e2d\u7f3a\u5c11\u5fc5\u9700\u53c2\u6570\u3002</p> <p>M_INVALID_PARAM\u6307\u5b9a\u7684\u53c2\u6570\u5177\u6709\u9519\u8bef\u7684\u503c\u3002\u4f8b\u5982, \u670d\u52a1\u5668\u9700\u8981\u4e00\u4e2a\u6574\u6570,\u800c\u662f\u6536\u5230\u4e00\u4e2a\u5b57\u7b26\u4e32\u3002</p> <p>M_TOO_LARGE\u8bf7\u6c42\u6216\u5b9e\u4f53\u592a\u5927\u3002</p> <p>M_EXCLUSIVE\u8bf7\u6c42\u7684\u8d44\u6e90\u7531\u5e94\u7528\u7a0b\u5e8f\u670d\u52a1\u4fdd\u7559,\u6216\u8005 \u53d1\u51fa\u8bf7\u6c42\u7684\u5e94\u7528\u7a0b\u5e8f\u670d\u52a1\u5c1a\u672a\u521b\u5efa\u8d44\u6e90\u3002</p> <p>M_RESOURCE_LIMIT_EXCEEDED\u65e0\u6cd5\u5b8c\u6210\u8bf7\u6c42,\u56e0\u4e3a\u4e3b\u670d\u52a1\u5668\u5df2\u8fbe\u5230 \u5bf9\u5176\u65bd\u52a0\u7684\u8d44\u6e90\u9650\u5236\u3002\u4f8b\u5982,\u5171\u4eab\u4e2d\u4fdd\u5b58\u7684\u5bb6\u5ead\u670d\u52a1\u5668 \u5982\u679c\u6258\u7ba1\u73af\u5883\u4e5f\u5f00\u59cb\u4f7f\u7528,\u5219\u53ef\u80fd\u4f1a\u8fbe\u5230\u8d44\u6e90\u9650\u5236 \u5927\u91cf\u5185\u5b58\u6216\u78c1\u76d8\u7a7a\u95f4\u3002\u9519\u8bef\u5fc5\u987b\u6709\u4e00\u4e2a\u5b57\u6bb5 \u4e3a\u6536\u5230\u9519\u8bef\u7684\u7528\u6237\u63d0\u4f9b\u4e00\u4e2a\u53ef\u4ee5\u8054\u7cfb\u7684\u5730\u65b9\u3002 \u901a\u5e38,\u6b64\u9519\u8bef\u5c06\u51fa\u73b0\u5728\u5c1d\u8bd5\u4fee\u6539\u7684\u8def\u7531\u4e0a \u72b6\u6001\uff08\u4f8b\u5982:\u53d1\u9001\u6d88\u606f,\u5e10\u6237\u6570\u636e\u7b49\uff09\u800c\u4e0d\u662f\u8def\u7531 \u4ec5\u8bfb\u53d6\u72b6\u6001\uff08\u4f8b\u5982:,\u83b7\u53d6\u5e10\u6237\u6570\u636e\u7b49\uff09\u3002admin_contact/sync</p> <p>M_CANNOT_LEAVE_SERVER_NOTICE_ROOM\u7528\u6237\u65e0\u6cd5\u62d2\u7edd\u52a0\u5165\u670d\u52a1\u5668\u901a\u77e5\u5ba4\u7684\u9080\u8bf7\u3002 \u6709\u5173\u8be6\u7ec6\u4fe1\u606f,\u8bf7\u53c2\u9605\u670d\u52a1\u5668\u901a\u77e5\u6a21\u5757\u3002</p>"},{"location":"chat/client_server/#12","title":"1.2 \u4ea4\u6613\u6807\u8bc6\u7b26","text":"<p>\u5ba2\u6237\u7aef-\u670d\u52a1\u5668 API \u901a\u5e38\u7528\u4e8e\u63d0\u4ea4\u8bf7\u6c42 HTTP \u8def\u5f84\u4e2d\u5ba2\u6237\u7aef\u751f\u6210\u7684\u4e8b\u52a1\u6807\u8bc6\u7b26\u3002HTTP PUT</p> <p>\u4e8b\u52a1 ID \u7684\u76ee\u7684\u662f\u5141\u8bb8\u4e3b\u670d\u52a1\u5668\u533a\u5206 \u6765\u81ea\u5148\u524d\u8bf7\u6c42\u7684\u91cd\u65b0\u4f20\u8f93\u7684\u65b0\u8bf7\u6c42,\u4ee5\u4fbf\u5b83\u53ef\u4ee5\u53d1\u51fa \u8bf7\u6c42\u5e42\u7b49\u3002</p> <p>\u4ea4\u6613 ID \u53ea\u80fd\u7528\u4e8e\u6b64\u76ee\u7684\u3002</p> <p>\u4ece\u5ba2\u6237\u7aef\u7684\u89d2\u5ea6\u6765\u770b,\u5728\u8bf7\u6c42\u5b8c\u6210\u540e,\u5e94\u4e3a\u4e0b\u4e00\u4e2a\u8bf7\u6c42\u66f4\u6539\u503c\uff08\u672a\u6307\u5b9a how;a \u5efa\u8bae\u5355\u8c03\u9012\u589e\u6574\u6570\uff09\u3002{txnId}</p> <p>\u5982\u679c \u4e8b\u52a1 ID \u4e0e\u4e0a\u4e00\u4e2a\u8bf7\u6c42\u76f8\u540c,\u5e76\u4e14 HTTP \u8bf7\u6c42\u662f\u76f8\u540c\u7684\u3002</p> <p>\u5982\u679c\u5df2\u8bc6\u522b\u51fa\u91cd\u4f20,\u5219\u4e3b\u670d\u52a1\u5668\u5e94\u8fd4\u56de \u4e0e\u539f\u59cb\u8bf7\u6c42\u76f8\u540c\u7684 HTTP \u54cd\u5e94\u4ee3\u7801\u548c\u5185\u5bb9\u3002 \u4f8b\u5982,\u5c06\u8fd4\u56de\u4e00\u4e2a \u4e0e\u539f\u59cb\u8bf7\u6c42 \u54cd\u5e94\u6b63\u6587\u3002PUT /_ matrix/client/v3/rooms/{roomId}/send/{eventType}/{txnId}200 OKevent_id</p> <p>\u9664\u4e86 HTTP \u8def\u5f84,\u4e8b\u52a1 ID \u7684\u4f5c\u7528\u57df\u662f\"\u5ba2\u6237\u7aef\" \u4f1a\u8bdd\",\u5176\u4e2d\u8be5\u4f1a\u8bdd\u7531\u7279\u5b9a\u8bbf\u95ee\u4ee4\u724c\u6807\u8bc6\u3002 \u5237\u65b0\u8bbf\u95ee\u4ee4\u724c\u65f6, \u4fdd\u7559\u4e8b\u52a1 ID \u7684\u8303\u56f4\u3002\u8fd9\u610f\u5473\u7740\u5982\u679c\u5ba2\u6237\u7aef \u4ee4\u724c\u7528\u4f5c\u5176\u4e8b\u52a1 ID,\u5c06\u4ee4\u724c\u5237\u65b0\u4e3a ,\u5e76\u518d\u6b21\u4f7f\u7528\u5b83,\u8fd9\u5c06\u88ab\u5047\u5b9a\u4e3a\u91cd\u590d\u8bf7\u6c42 \u5e76\u88ab\u5ffd\u7565\u3002\u5982\u679c\u5ba2\u6237\u7aef\u6ce8\u9500\u5e76\u5728 \u548c \u4ee4\u724c\u4e4b\u95f4\u91cd\u65b0\u6ce8\u9500,\u5219\u53ef\u4ee5\u4e3a\u6bcf\u4e2a\u4ee4\u724c\u4f7f\u7528\u4e00\u6b21\u3002ATXN1BTXN1ABTXN1</p> <p>\u67d0\u4e9b API \u7aef\u70b9\u53ef\u80fd\u5141\u8bb8\u6216\u8981\u6c42\u4f7f\u7528\u8bf7\u6c42 \u6ca1\u6709\u4ea4\u6613 ID\u3002\u5982\u679c\u8fd9\u662f\u53ef\u9009\u7684,\u5f3a\u70c8\u5efa\u8bae\u4f7f\u7528\u8bf7\u6c42\u3002POSTPUT</p>"},{"location":"chat/client_server/#2","title":"2.\u7f51\u9875\u6d4f\u89c8\u5668\u5ba2\u6237\u7aef","text":"<p>\u671f\u671b\u67d0\u4e9b\u5ba2\u6237\u7aef\u5c06\u88ab\u5199\u5165\u4ee5\u8fd0\u884c\u662f\u73b0\u5b9e\u7684 \u5728 Web \u6d4f\u89c8\u5668\u6216\u7c7b\u4f3c\u73af\u5883\u4e2d\u3002\u5728\u8fd9\u4e9b\u60c5\u51b5\u4e0b, \u4e3b\u670d\u52a1\u5668\u5e94\u54cd\u5e94\u98de\u884c\u524d\u8bf7\u6c42\u5e76\u63d0\u4f9b\u8de8\u6e90 \u6240\u6709\u8bf7\u6c42\u4e0a\u7684\u8d44\u6e90\u5171\u4eab \uff08CORS\uff09 \u6807\u5934\u3002</p> <p>\u670d\u52a1\u5668\u5fc5\u987b\u671f\u671b\u5ba2\u6237\u7aef\u4f1a\u901a\u8fc7\u8bf7\u6c42\u63a5\u8fd1\u5b83\u4eec,\u4ece\u800c\u5141\u8bb8\u5ba2\u6237\u7aef\u53d1\u73b0 CORS \u6807\u5934\u3002\u6240\u6709\u7aef\u70b9 \u5728\u6b64\u89c4\u8303\u4e2d\u652f\u6301\u8be5\u65b9\u6cd5,\u4f46\u662f\u670d\u52a1\u5668 \u5728\u63a5\u8fd1\u7aef\u70b9\u65f6,\u4e0d\u5f97\u6267\u884c\u4e3a\u7aef\u70b9\u5b9a\u4e49\u7684\u4efb\u4f55\u903b\u8f91 \u4e0e\u8bf7\u6c42\u3002OPTIONSOPTIONSOPTIONS</p> <p>\u5f53\u5ba2\u6237\u7aef\u5411\u670d\u52a1\u5668\u53d1\u51fa\u8bf7\u6c42\u65f6,\u670d\u52a1\u5668\u5e94 \u4f7f\u7528\u8be5\u8def\u7531\u7684 CORS \u6807\u5934\u8fdb\u884c\u54cd\u5e94\u3002\u63a8\u8350\u7684\u53ef\u66ff\u4ee3\u8d44\u6e90\u4fdd\u62a4\u8ba1\u5212 \u670d\u52a1\u5668\u5728\u6240\u6709\u8bf7\u6c42\u4e0a\u8fd4\u56de\u7684\u6807\u5934\u5305\u62ec:</p> <pre><code>    Access-Control-Allow-Origin: *\n    Access-Control-Allow-Methods: GET, POST, PUT, DELETE, OPTIONS\n    Access-Control-Allow-Headers: X-Requested-With, Content-Type, Authorization\n</code></pre>"},{"location":"chat/client_server/#3","title":"3.\u670d\u52a1\u5668\u53d1\u73b0","text":"<p>\u4e3a\u4e86\u5141\u8bb8\u7528\u6237\u8fde\u63a5\u5230\u77e9\u9635\u670d\u52a1\u5668\u800c\u65e0\u9700 \u663e\u5f0f\u6307\u5b9a\u4e3b\u670d\u52a1\u5668\u7684 URL \u6216\u5176\u4ed6\u53c2\u6570,\u5ba2\u6237\u7aef \u5e94\u4f7f\u7528\u81ea\u52a8\u53d1\u73b0\u673a\u5236\u6765\u786e\u5b9a\u670d\u52a1\u5668\u7684 URL \u57fa\u4e8e\u7528\u6237\u7684\u77e9\u9635 ID\u3002\u81ea\u52a8\u53d1\u73b0\u53ea\u80fd\u5728\u767b\u5f55\u65f6\u5b8c\u6210 \u65f6\u95f4\u3002</p> <p>\u5728\u672c\u8282\u4e2d,\u4ee5\u4e0b\u672f\u8bed\u5177\u6709\u7279\u5b9a\u542b\u4e49:</p> <p>PROMPT\u4ece\u7528\u6237\u90a3\u91cc\u68c0\u7d22\u7279\u5b9a\u4fe1\u606f\u7684\u65b9\u5f0f \u9002\u5408\u73b0\u6709\u7684\u5ba2\u6237\u7aef\u7528\u6237\u4f53\u9a8c\uff08\u5982\u679c\u5ba2\u6237\u7aef\u662f \u503e\u5411\u4e8e\u8fd9\u6837\u505a\u3002\u5982\u679c\u6ca1\u6709\u597d\u7684\u7528\u6237,\u5219\u53ef\u80fd\u4f1a\u53d1\u751f\u6545\u969c \u5728\u8fd9\u4e00\u70b9\u4e0a,\u8fd9\u65b9\u9762\u7684\u7ecf\u9a8c\u662f\u53ef\u80fd\u7684\u3002</p> <p>IGNORE\u505c\u6b62\u5f53\u524d\u7684\u81ea\u52a8\u53d1\u73b0\u673a\u5236\u3002\u5982\u679c\u6ca1\u6709\u66f4\u591a\u7684\u81ea\u52a8\u53d1\u73b0 \u673a\u5236\u662f\u53ef\u7528\u7684,\u90a3\u4e48\u5ba2\u6237\u7aef\u53ef\u4ee5\u4f7f\u7528\u5176\u4ed6\u65b9\u6cd5 \u786e\u5b9a\u6240\u9700\u7684\u53c2\u6570,\u4f8b\u5982\u63d0\u793a\u7528\u6237,\u6216 \u4f7f\u7528\u9ed8\u8ba4\u503c\u3002</p> <p>FAIL_PROMPT\u901a\u77e5\u7528\u6237\u81ea\u52a8\u53d1\u73b0\u7531\u4e8e\u6570\u636e\u65e0\u6548/\u7a7a\u548c\u53c2\u6570\u800c\u5931\u8d25\u3002PROMPT</p> <p>FAIL_ERROR\u901a\u77e5\u7528\u6237\u81ea\u52a8\u53d1\u73b0\u672a\u8fd4\u56de\u4efb\u4f55\u53ef\u7528\u7684 URL\u3002\u505a \u4e0d\u8981\u7ee7\u7eed\u5f53\u524d\u767b\u5f55\u8fc7\u7a0b\u3002\u6b64\u65f6, \u5df2\u83b7\u53d6\u6709\u6548\u6570\u636e,\u4f46\u6ca1\u6709\u670d\u52a1\u5668\u53ef\u7528\u4e8e\u4e3a\u5ba2\u6237\u7aef\u63d0\u4f9b\u670d\u52a1\u3002 \u4e0d\u5e94\u5c1d\u8bd5\u8fdb\u4e00\u6b65\u731c\u6d4b,\u7528\u6237\u5e94\u8fdb\u884c \u8ba4\u771f\u51b3\u5b9a\u4e0b\u4e00\u6b65\u8be5\u505a\u4ec0\u4e48\u3002</p>"},{"location":"chat/client_server/#31-well-known-uri","title":"3.1 Well-known URI","text":"<p>\u8be5\u65b9\u6cd5\u4f7f\u7528\u9884\u5b9a\u4f4d\u7f6e\u7684 JSON \u6587\u4ef6\u6765 \u6307\u5b9a\u53c2\u6570\u503c\u3002\u6b64\u65b9\u6cd5\u7684\u6d41\u7a0b\u5982\u4e0b:.well-known</p> <ol> <li>\u901a\u8fc7\u62c6\u5206 \u7b2c\u4e00\u4e2a\u5192\u53f7\u5904\u7684\u77e9\u9635 ID\u3002</li> <li>\u4ece\u670d\u52a1\u5668\u540d\u79f0\u4e2d\u63d0\u53d6\u4e3b\u673a\u540d\u3002</li> <li>\u5411 \u53d1\u51fa GET \u8bf7\u6c42\u3002https://hostname/.well-known/matrix/client<ol> <li>\u5982\u679c\u8fd4\u56de\u7684\u72b6\u6001\u4ee3\u7801\u4e3a 404,\u5219 .IGNORE</li> <li>\u5982\u679c\u8fd4\u56de\u7684\u72b6\u6001\u4ee3\u7801\u4e0d\u662f 200,\u6216\u8005\u54cd\u5e94\u6b63\u6587\u4e3a \u7a7a\u7684,\u7136\u540e.FAIL_PROMPT</li> <li>\u5c06\u54cd\u5e94\u6b63\u6587\u89e3\u6790\u4e3a JSON \u5bf9\u8c61<ol> <li>\u5982\u679c\u65e0\u6cd5\u89e3\u6790\u5185\u5bb9,\u5219 .FAIL_PROMPT</li> </ol> </li> <li>\u4ece\u5c5e\u6027\u4e2d\u63d0\u53d6\u503c\u3002 \u6b64\u503c\u5c06\u7528\u4f5c\u4e3b\u670d\u52a1\u5668\u7684\u57fa\u672c URL\u3002base_urlm.homeserver<ol> <li>\u5982\u679c\u672a\u63d0\u4f9b\u6b64\u503c,\u5219 .FAIL_PROMPT</li> </ol> </li> <li>\u9a8c\u8bc1\u4e3b\u670d\u52a1\u5668\u57fa\u672c URL:<ol> <li>\u5c06\u5176\u89e3\u6790\u4e3a URL\u3002\u5982\u679c\u5b83\u4e0d\u662f URL,\u5219 .FAIL_ERROR</li> <li>\u5ba2\u6237\u7aef\u5e94\u9a8c\u8bc1 URL \u662f\u5426\u6307\u5411\u6709\u6548\u7684 \u4e3b\u670d\u52a1\u5668 \u5728\u63a5\u53d7\u5b83\u4e4b\u524d,\u901a\u8fc7\u8fde\u63a5\u5230 /_matrix/\u5ba2\u6237\u7aef/\u7248\u672c\u7aef\u70b9,\u786e\u4fdd\u5b83 \u4e0d\u8fd4\u56de\u9519\u8bef,\u5e76\u89e3\u6790\u548c\u9a8c\u8bc1 \u6570\u636e\u7b26\u5408\u9884\u671f\u7684\u54cd\u5e94\u683c\u5f0f\u3002\u5982\u679c\u6709\u4efb\u4f55\u6b65\u9aa4 \u5728\u9a8c\u8bc1\u5931\u8d25\u65f6,.\u9a8c\u8bc1\u662f    \u4f5c\u4e3a\u9488\u5bf9\u914d\u7f6e\u9519\u8bef\u7684\u7b80\u5355\u68c0\u67e5\u5b8c\u6210,\u5728 \u4ee5\u786e\u4fdd\u53d1\u73b0\u7684\u5730\u5740\u6307\u5411 \u6709\u6548\u7684\u4e3b\u670d\u52a1\u5668\u3002FAIL_ERROR</li> <li>\u8bf7\u52a1\u5fc5\u6ce8\u610f,\u8be5\u503c\u53ef\u80fd\u5305\u62ec \u5c3e\u968f .\u6d88\u8d39\u8005\u5e94\u51c6\u5907\u597d\u5904\u7406\u8fd9\u4e24\u79cd\u60c5\u51b5\u3002base_url/</li> </ol> </li> <li>\u5982\u679c\u8be5\u5c5e\u6027\u5b58\u5728,\u8bf7\u63d0\u53d6\u503c\u4ee5\u7528\u4f5c\u8eab\u4efd\u670d\u52a1\u5668\u7684\u57fa\u672c URL\u3002 \u6b64 URL \u7684\u9a8c\u8bc1\u6309\u4e0a\u8ff0\u6b65\u9aa4\u5b8c\u6210,\u4f46\u7528\u4f5c\u8981\u8fde\u63a5\u5230\u7684\u7ec8\u7ed3\u70b9\u3002\u5982\u679c\u8be5\u5c5e\u6027\u5b58\u5728,\u4f46\u6ca1\u6709\u503c,\u5219 .m.identity_serverbase_url/_    matrix/identity/v2m.identity_serverbase_urlFAIL_PROMPT</li> </ol> </li> </ol>"},{"location":"chat/client_server/#get-well-knownmatrixclient","title":"GET /.well-known/matrix/client","text":"<p>\u83b7\u53d6\u6709\u5173\u57df\u7684\u53d1\u73b0\u4fe1\u606f\u3002\u8be5\u6587\u4ef6\u53ef\u80fd\u5305\u62ec \u9644\u52a0\u952e,\u5fc5\u987b\u9075\u5faa Java \u5305\u547d\u540d\u7ea6\u5b9a, \u4f8b\u5982.\u8fd9\u53ef\u786e\u4fdd\u5c5e\u6027\u540d\u79f0 \u4e3a\u6bcf\u4e2a\u5e94\u7528\u7a0b\u5e8f\u9002\u5f53\u5730\u547d\u540d,\u5e76\u964d\u4f4e \u51b2\u7a81\u3002com.example.myapp.property</p> <p>\u8bf7\u6ce8\u610f,\u6b64\u7ec8\u7ed3\u70b9\u4e0d\u4e00\u5b9a\u7531\u4e3b\u670d\u52a1\u5668\u5904\u7406, \u4f46\u7531\u53e6\u4e00\u4e2a\u7f51\u7edc\u670d\u52a1\u5668\u4f7f\u7528,\u7528\u4e8e\u53d1\u73b0\u4e3b\u670d\u52a1\u5668 URL\u3002</p> <p>\u54cd\u5e94\u793a\u4f8b:</p> <pre><code>    {\n  \"m.homeserver\": {\n    \"base_url\": \"https://matrix.example.com\"\n  },\n  \"m.identity_server\": {\n    \"base_url\": \"https://identity.example.com\"\n  },\n  \"org.example.custom.property\": {\n    \"app_url\": \"https://custom.app.example.org\"\n  }\n}\n</code></pre>"},{"location":"chat/client_server/#get-_matrixclientversions","title":"GET /_matrix/client/versions","text":"<p>\u83b7\u53d6\u670d\u52a1\u5668\u652f\u6301\u7684\u89c4\u8303\u7248\u672c\u3002</p> <p>\u503c\u5c06\u91c7\u7528\u5f62\u5f0f\u6216\u5386\u53f2\u6848\u4f8b\u3002\u6709\u5173\u8be6\u7ec6\u4fe1\u606f,\u8bf7\u53c2\u9605\u89c4\u8303\u7248\u672c\u63a7\u5236 \u4fe1\u606f\u3002vX.YrX.Y.Z</p> <p>\u670d\u52a1\u5668\u53ef\u80fd\u4f1a\u989d\u5916\u516c\u5e03\u5176\u652f\u6301\u7684\u5b9e\u9a8c\u6027\u529f\u80fd \u901a\u8fc7\u3002\u8fd9\u4e9b\u529f\u80fd\u5e94\u5177\u6709\u547d\u540d\u7a7a\u95f4,\u5e76\u4e14 \u5982\u679c\u9700\u8981,\u53ef\u4ee5\u9009\u62e9\u5728\u5176\u540d\u79f0\u4e2d\u5305\u542b\u7248\u672c\u4fe1\u606f\u3002 \u6b64\u5904\u5217\u51fa\u7684\u529f\u80fd\u4e0d\u9002\u7528\u4e8e\u9009\u62e9\u6027\u5207\u6362\u77e9\u9635\u7684\u5404\u4e2a\u90e8\u5206 \u89c4\u8303,\u5e94\u4ec5\u7528\u4e8e\u64ad\u53d1\u5bf9\u529f\u80fd\u7684\u652f\u6301 \u5c1a\u672a\u8fdb\u5165\u89c4\u8303\u3002\u4f8b\u5982,\u5f53\u524d\u529f\u80fd\u3002 \u6b63\u5728\u8fdb\u884c\u63d0\u6848\u6d41\u7a0b\u53ef\u80fd\u4f1a\u51fa\u73b0\u5728\u8fd9\u91cc\u5e76\u6700\u7ec8\u88ab\u91c7\u7eb3 \u4e00\u65e6\u529f\u80fd\u8fdb\u5165\u89c4\u8303\u5e76\u4e14\u670d\u52a1\u5668\u8ba4\u4e3a\u5b83,\u5c31\u8131\u79bb\u6b64\u5217\u8868 \u8fd9\u6837\u505a\u662f\u5408\u7406\u7684\u3002\u670d\u52a1\u5668\u53ef\u80fd\u5e0c\u671b\u5728\u6b64\u5904\u4fdd\u7559\u5e7f\u544a\u529f\u80fd \u5728\u5b83\u4eec\u88ab\u53d1\u5e03\u5230\u89c4\u8303\u4e2d\u540e,\u8ba9\u5ba2\u6237\u6709\u673a\u4f1a \u9002\u5f53\u5347\u7ea7\u3002\u6b64\u5916,\u5ba2\u6237\u7aef\u5e94\u907f\u514d\u4f7f\u7528\u4e0d\u7a33\u5b9a \u7a33\u5b9a\u7248\u672c\u4e2d\u7684\u529f\u80fd\u3002unstable_features</p> <p>\u54cd\u5e94\u793a\u4f8b:</p> <pre><code>    {\n  \"unstable_features\": {\n    \"org.example.my_feature\": true\n  },\n  \"versions\": [\n    \"r0.0.1\",\n    \"v1.1\"\n  ]\n}\n</code></pre>"},{"location":"chat/client_server/#4","title":"4. \u5ba2\u6237\u7aef\u8eab\u4efd\u9a8c\u8bc1","text":"<p>\u5927\u591a\u6570 API \u7aef\u70b9\u8981\u6c42\u7528\u6237\u901a\u8fc7\u5448\u73b0\u6765\u6807\u8bc6\u81ea\u5df1 \u4ee5\u524d\u4ee5\u67e5\u8be2\u5f62\u5f0f\u83b7\u5f97\u7684\u51ed\u636e access_token\u53c2\u6570\u6216\u901a\u8fc7\u6388\u6743\u6807\u5934 Bearer $access_token\u3002 \u8bbf\u95ee\u4ee4\u724c\u901a\u5e38\u901a\u8fc7\u767b\u5f55\u6216\u6ce8\u518c\u8fc7\u7a0b\u83b7\u53d6\u3002\u8bbf\u95ee\u4ee4\u724c \u53ef\u4ee5\u8fc7\u671f;\u53ef\u4ee5\u4f7f\u7528\u5237\u65b0\u4ee4\u724c\u751f\u6210\u65b0\u7684\u8bbf\u95ee\u4ee4\u724c\u3002</p>"},{"location":"chat/client_server/#41","title":"4.1 \u4f7f\u7528\u8bbf\u95ee\u4ee4\u724c","text":"<p>\u8bbf\u95ee\u4ee4\u724c\u53ef\u4ee5\u901a\u8fc7\u4e24\u79cd\u65b9\u5f0f\u63d0\u4f9b,\u8fd9\u4e24\u79cd\u65b9\u5f0f\u90fd\u662f\u4e3b\u670d\u52a1\u5668 \u5fc5\u987b\u652f\u6301:</p> <pre><code>1. \u901a\u8fc7\u67e5\u8be2\u5b57\u7b26\u4e32\u53c2\u6570 .access_token=TheTokenHere \n2. \u901a\u8fc7\u8bf7\u6c42\u6807\u5934 .Authorization: Bearer TheTokenHere\n</code></pre> <p>\u9f13\u52b1\u5ba2\u6237\u5c3d\u53ef\u80fd\u4f7f\u7528\u6807\u5934 \u4ee5\u9632\u6b62\u8bbf\u95ee\u4ee4\u724c\u5728\u8bbf\u95ee/HTTP \u65e5\u5fd7\u4e2d\u6cc4\u9732\u3002\u67e5\u8be2 \u5b57\u7b26\u4e32\u5e94\u4ec5\u5728\u6807\u5934\u4e3a \u5ba2\u6237\u7aef\u65e0\u6cd5\u8bbf\u95ee\u3002AuthorizationAuthorization</p> <p>\u5f53\u51ed\u636e\u9700\u8981\u4f46\u7f3a\u5931\u6216\u65e0\u6548\u65f6,HTTP \u8c03\u7528\u5c06 \u8fd4\u56de\u72b6\u6001\u4e3a 401 \u548c\u9519\u8bef\u4ee3\u7801,\u6216\u5206\u522b\u8fd4\u56de\u3002\u8bf7\u6ce8\u610f,\u9519\u8bef\u4ee3\u7801 \u53ef\u80fd\u610f\u5473\u7740\u4ee5\u4e0b\u56db\u79cd\u60c5\u51b5\u4e4b\u4e00:M_MISSING_TOKENM_UNKNOWN_TOKENM_UNKNOWN_TOKEN</p> <pre><code>1. \u8bbf\u95ee\u4ee4\u724c\u4ece\u672a\u6709\u6548\u3002\n2. \u8bbf\u95ee\u4ee4\u724c\u5df2\u6ce8\u9500\u3002\n3. \u8bbf\u95ee\u4ee4\u724c\u5df2\u8f6f\u6ce8\u9500\u3002\n4. [\u5728 v1.3 \u4e2d\u6dfb\u52a0] \u8bbf\u95ee\u4ee4\u724c\u9700\u8981\u5237\u65b0\u3002\n</code></pre> <p>\u5f53\u5ba2\u6237\u7aef\u6536\u5230\u9519\u8bef\u4ee3\u7801 \u65f6,\u5b83\u5e94\u8be5:M_UNKNOWN_TOKEN</p> <ul> <li>\u5c1d\u8bd5\u5237\u65b0\u4ee4\u724c\uff08\u5982\u679c\u5b83\u6709\u5237\u65b0\uff09 \u4ee4 \u724c;</li> <li>\u5982\u679csoft_logout\u8bbe\u7f6e\u4e3a ,\u5b83\u53ef\u4ee5\u63d0\u4f9b \u91cd\u65b0\u767b\u5f55\u7528\u6237,\u4fdd\u7559\u4efb\u4f55\u5ba2\u6237\u7aef\u7684\u6301\u4e45 \u4fe1\u606f;true</li> <li>\u5426\u5219,\u5c06\u7528\u6237\u89c6\u4e3a\u5df2\u6ce8\u9500\u3002</li> </ul>"},{"location":"chat/client_server/#42","title":"4.2 \u8bbf\u95ee\u4ee4\u724c\u548c\u8bbe\u5907\u4e4b\u95f4\u7684\u5173\u7cfb","text":"<p>\u5ba2\u6237\u7aef\u8bbe\u5907\u4e0e\u8bbf\u95ee\u5bc6\u5207\u76f8\u5173 \u4ee4\u724c\u548c\u5237\u65b0\u4ee4\u724c\u3002\u77e9\u9635\u670d\u52a1\u5668\u5e94\u8bb0\u5f55\u54ea\u4e2a\u8bbe\u5907 \u6bcf\u4e2a\u8bbf\u95ee\u4ee4\u724c\u548c\u5237\u65b0\u4ee4\u724c\u90fd\u5206\u914d\u7ed9,\u4ee5\u4fbf \u53ef\u4ee5\u6b63\u786e\u5904\u7406\u540e\u7eed\u8bf7\u6c42\u3002\u5f53\u5237\u65b0\u4ee4\u724c\u4e3a \u7528\u4e8e\u751f\u6210\u65b0\u7684\u8bbf\u95ee\u4ee4\u724c\u548c\u5237\u65b0\u4ee4\u724c,\u5373\u65b0\u7684\u8bbf\u95ee \u548c\u5237\u65b0\u4ee4\u724c\u73b0\u5728\u7ed1\u5b9a\u5230\u4e0e \u521d\u59cb\u5237\u65b0\u4ee4\u724c\u3002</p> <p>\u9ed8\u8ba4\u60c5\u51b5\u4e0b,\u767b\u5f55\u548c\u6ce8\u518c\u8fc7\u7a0b\u81ea\u52a8\u751f\u6210\u65b0\u7684 .\u5ba2\u6237\u4e5f\u53ef\u4ee5\u81ea\u7531 \u751f\u6210\u81ea\u5df1\u7684,\u6216\u8005,\u524d\u63d0\u662f\u7528\u6237\u4fdd\u6301\u4e0d\u53d8, \u91cd\u7528\u8bbe\u5907:\u65e0\u8bba\u54ea\u79cd\u60c5\u51b5,\u5ba2\u6237\u7aef\u90fd\u5e94\u4f20\u9012 \u8bf7\u6c42\u6b63\u6587\u3002\u5982\u679c\u5ba2\u6237\u7aef\u8bbe\u7f6e ,\u670d\u52a1\u5668\u5c06 \u4f7f\u4ee5\u524d\u5206\u914d\u7ed9\u8be5\u8bbe\u5907\u7684\u4efb\u4f55\u8bbf\u95ee\u548c\u5237\u65b0\u4ee4\u724c\u65e0\u6548\u3002device_iddevice_iddevice_iddevice_id</p>"},{"location":"chat/client_server/#43","title":"4.3 \u5237\u65b0\u8bbf\u95ee\u4ee4\u724c","text":"<p>\u8bbf\u95ee\u4ee4\u724c\u53ef\u80fd\u4f1a\u5728\u4e00\u5b9a\u65f6\u95f4\u540e\u8fc7\u671f\u3002\u4efb\u4f55 HTTP \u8c03\u7528 \u4f7f\u7528\u8fc7\u671f\u7684\u8bbf\u95ee\u4ee4\u724c\u5c06\u8fd4\u56de\u9519\u8bef\u4ee3\u7801, \u6700\u597d\u5e26 .\u5f53\u5ba2\u6237\u7aef\u6536\u5230\u6b64\u9519\u8bef\u5e76\u4e14 \u5177\u6709\u5237\u65b0\u4ee4\u724c,\u5b83\u5e94\u5c1d\u8bd5\u901a\u8fc7\u8c03\u7528 /refresh \u6765\u5237\u65b0\u8bbf\u95ee\u4ee4\u724c\u3002\u5ba2\u6237\u8fd8\u53ef\u4ee5\u5237\u65b0\u4ed6\u4eec\u7684 \u968f\u65f6\u8bbf\u95ee\u4ee4\u724c,\u5373\u4f7f\u5b83\u5c1a\u672a\u8fc7\u671f\u3002\u5982\u679c\u4ee4\u724c\u5237\u65b0 \u6210\u529f\u540e,\u5ba2\u6237\u7aef\u5e94\u5c06\u65b0\u4ee4\u724c\u7528\u4e8e\u5c06\u6765\u7684\u8bf7\u6c42,\u5e76\u4e14\u53ef\u4ee5 \u4f7f\u7528\u65b0\u4ee4\u724c\u91cd\u8bd5\u4ee5\u524d\u5931\u8d25\u7684\u8bf7\u6c42\u3002\u5f53\u8bbf\u95ee\u4ee4\u724c \u5237\u65b0\u540e,\u53ef\u80fd\u4f1a\u8fd4\u56de\u65b0\u7684\u5237\u65b0\u4ee4\u724c;\u5982\u679c\u65b0\u7684\u5237\u65b0\u4ee4\u724c\u662f \u7ed9\u5b9a,\u65e7\u7684\u5237\u65b0\u4ee4\u724c\u5c06\u5931\u6548,\u800c\u65b0\u7684\u5237\u65b0\u4ee4\u724c\u5c06\u5931\u6548 \u5e94\u5728\u9700\u8981\u5237\u65b0\u8bbf\u95ee\u4ee4\u724c\u65f6\u4f7f\u7528\u3002M_UNKNOWN_TOKENsoft_logout: true</p> <p>\u65e7\u7684\u5237\u65b0\u4ee4\u724c\u5728\u65b0\u7684\u8bbf\u95ee\u4ee4\u724c\u6216\u5237\u65b0\u4ee4\u724c\u4e4b\u524d\u4e00\u76f4\u6709\u6548 ,\u6b64\u65f6\u5c06\u540a\u9500\u65e7\u7684\u5237\u65b0\u4ee4\u724c\u3002\u8fd9\u53ef\u786e\u4fdd\u5982\u679c \u5ba2\u6237\u7aef\u65e0\u6cd5\u63a5\u6536\u6216\u4fdd\u7559\u65b0\u4ee4\u724c,\u5b83\u5c06\u80fd\u591f\u91cd\u590d \u5237\u65b0\u64cd\u4f5c\u3002</p> <p>\u5982\u679c\u4ee4\u724c\u5237\u65b0\u5931\u8d25\u5e76\u4e14\u9519\u8bef\u54cd\u5e94\u5305\u542b\u5c5e\u6027,\u5219\u5ba2\u6237\u7aef\u53ef\u4ee5\u5c06\u5176\u89c6\u4e3a\u8f6f\u6ce8\u9500,\u5e76\u5c1d\u8bd5\u901a\u8fc7\u91cd\u65b0\u767b\u5f55\u6765\u83b7\u53d6\u65b0\u7684\u8bbf\u95ee\u4ee4\u724c\u3002\u5982\u679c\u9519\u8bef \u54cd\u5e94\u4e0d\u5305\u542b\u5c5e\u6027,\u5ba2\u6237\u7aef\u5e94 \u5c06\u7528\u6237\u89c6\u4e3a\u5df2\u6ce8\u9500\u3002soft_logout: truesoft_logout: true</p> <p>\u4e0d\u652f\u6301\u5237\u65b0\u4ee4\u724c\u7684\u5ba2\u6237\u7aef\u7684\u5904\u7406\u7531\u4e3b\u670d\u52a1\u5668\u51b3\u5b9a; \u5ba2\u6237\u7aef\u901a\u8fc7\u5728 /login \u548c /register \u7ec8\u7ed3\u70b9\u7684\u8bf7\u6c42\u6b63\u6587\u4e2d\u5305\u542b\u5c5e\u6027\u6765\u6307\u793a\u5176\u5bf9\u5237\u65b0\u4ee4\u724c\u7684\u652f\u6301\u3002\u4f8b\u5982,\u5bb6\u5ead\u670d\u52a1\u5668 \u53ef\u80fd\u5141\u8bb8\u4f7f\u7528\u672a\u8fc7\u671f\u7684\u8bbf\u95ee\u4ee4\u724c,\u6216\u8005\u53ef\u80fd\u4f7f\u8bbf\u95ee\u4ee4\u724c\u8fc7\u671f \u65e0\u8bba\u5982\u4f55,\u5e76\u4f9d\u8d56\u4e8e\u4e0d\u652f\u6301\u7684\u5ba2\u6237\u7aef\u4e0a\u7684\u8f6f\u6ce8\u9500\u884c\u4e3a \u5237\u65b0\u3002refresh_token: true</p>"},{"location":"chat/client_server/#44","title":"4.4 \u8f6f\u6ce8\u9500","text":"<p>\u5982\u679c\u670d\u52a1\u5668\u9700\u8981,\u5ba2\u6237\u7aef\u53ef\u4ee5\u5904\u4e8e\"\u8f6f\u6ce8\u9500\"\u72b6\u6001 \u5728\u7ee7\u7eed\u4e4b\u524d\u91cd\u65b0\u8fdb\u884c\u8eab\u4efd\u9a8c\u8bc1,\u4f46\u4e0d\u5e0c\u671b\u4f7f \u5ba2\u6237\u7aef\u4f1a\u8bdd\u3002\u670d\u52a1\u5668\u6307\u793a\u5ba2\u6237\u7aef\u5904\u4e8e\u8f6f\u6ce8\u9500\u72b6\u6001 \u901a\u8fc7\u5728\u9519\u8bef\u54cd\u5e94\u4e2d\u5305\u542b\u53c2\u6570\u6765\u72b6\u6001;\u53c2\u6570\u9ed8\u8ba4\u4e3a \u3002\u5982\u679c\u53c2\u6570\u88ab\u7701\u7565\u6216\u4e3a ,\u8fd9\u610f\u5473\u7740\u670d\u52a1\u5668\u5177\u6709 \u5df2\u9500\u6bc1\u4f1a\u8bdd,\u5ba2\u6237\u7aef\u4e0d\u5e94\u91cd\u7528\u5b83\u3002\u4e5f\u5c31\u662f\u8bf4,\u4efb\u4f55 \u5ba2\u6237\u7aef\u6301\u6709\u7684\u6301\u4e45\u72b6\u6001,\u4f8b\u5982\u52a0\u5bc6\u5bc6\u94a5\u548c\u8bbe\u5907 \u4fe1\u606f,\u4e0d\u5f97\u91cd\u590d\u4f7f\u7528,\u5fc5\u987b\u4e22\u5f03\u3002\u5982\u679c\u662f,\u5ba2\u6237\u7aef\u53ef\u4ee5\u91cd\u7528\u4efb\u4f55\u6301\u4e45\u72b6\u6001\u3002soft_logout: trueM_UNKNOWN_TOKENsoft_logoutfalsesoft_logoutfalsesoft_logouttrue</p> <p>[\u5728 v1.3 \u4e2d\u66f4\u6539]</p> <p>\u6536\u5230\u6b64\u7c7b\u54cd\u5e94\u7684\u5ba2\u6237\u7aef\u53ef\u4ee5\u5c1d\u8bd5\u5237\u65b0\u5176\u8bbf\u95ee\u4ee4\u724c\uff08\u5982\u679c\u5b83\u6709\u5237\u65b0\uff09 \u4ee4\u724c\u53ef\u7528\u3002\u5982\u679c\u6ca1\u6709\u53ef\u7528\u7684\u5237\u65b0\u4ee4\u724c,\u6216\u8005\u6b63\u5728\u5237\u65b0 \u5931\u8d25,\u5ba2\u6237\u7aef\u53ef\u4ee5\u901a\u8fc7 \u6307\u5b9a\u5b83\u5df2\u7528\u4e8e\u767b\u5f55 API \u7684\u8bbe\u5907 ID\u3002soft_logout: true</p>"},{"location":"chat/client_server/#45-api","title":"4.5 \u7528\u6237\u4ea4\u4e92\u5f0f\u8eab\u4efd\u9a8c\u8bc1 API","text":""},{"location":"chat/client_server/#451","title":"4.5.1 \u6982\u8ff0","text":"<p>\u67d0\u4e9b API \u7aef\u70b9\u9700\u8981\u4e0e\u7528\u6237\u4ea4\u4e92\u7684\u8eab\u4efd\u9a8c\u8bc1\u3002 \u4e3b\u670d\u52a1\u5668\u53ef\u4ee5\u63d0\u4f9b\u8bb8\u591a\u4e0d\u540c\u7684\u8eab\u4efd\u9a8c\u8bc1\u65b9\u5f0f,\u4f8b\u5982 \u4f5c\u4e3a\u7528\u6237/\u5bc6\u7801\u8eab\u4efd\u9a8c\u8bc1,\u901a\u8fc7\u5355\u70b9\u767b\u5f55\u670d\u52a1\u5668 \uff08SSO\uff09 \u767b\u5f55\u7b49\u3002 \u6b64\u89c4\u8303\u672a\u5b9a\u4e49\u4e3b\u670d\u52a1\u5668\u5e94\u5982\u4f55\u6388\u6743 \u4ed6\u4eec\u7684\u7528\u6237,\u800c\u662f\u5b9a\u4e49\u4e86\u6807\u51c6\u63a5\u53e3 \u5e94\u9075\u5faa\u5b9e\u73b0,\u4ee5\u4fbf\u4efb\u4f55\u5ba2\u6237\u7aef\u90fd\u53ef\u4ee5\u767b\u5f55\u5230\u4efb\u4f55 \u4e3b\u670d\u52a1\u5668\u3002</p> <p>\u8be5\u8fc7\u7a0b\u91c7\u53d6\u4e00\u4e2a\u6216\u591a\u4e2a\"\u9636\u6bb5\"\u7684\u5f62\u5f0f\u3002\u5728\u6bcf\u4e2a\u9636\u6bb5 \u5ba2\u6237\u7aef\u4e3a\u7ed9\u5b9a\u7684\u8eab\u4efd\u9a8c\u8bc1\u7c7b\u578b\u63d0\u4ea4\u4e00\u7ec4\u6570\u636e\u5e76\u7b49\u5f85 \u6765\u81ea\u670d\u52a1\u5668\u7684\u54cd\u5e94,\u8fd9\u5c06\u662f\u6700\u7ec8\u6210\u529f\u6216 \u8bf7\u6c42\u6267\u884c\u5176\u4ed6\u9636\u6bb5\u3002\u8fd9\u79cd\u4ea4\u6362\u4e00\u76f4\u6301\u7eed\u5230 \u6700\u540e\u7684\u6210\u529f\u3002</p> <p>\u5bf9\u4e8e\u6bcf\u4e2a\u7aef\u70b9,\u670d\u52a1\u5668\u63d0\u4f9b\u4e00\u4e2a\u6216\u591a\u4e2a\u5ba2\u6237\u7aef\u7684\"\u6d41\" \u53ef\u7528\u4e8e\u5bf9\u81ea\u8eab\u8fdb\u884c\u8eab\u4efd\u9a8c\u8bc1\u3002\u6bcf\u4e2a\u6d41\u7a0b\u5305\u62ec\u4e00\u7cfb\u5217\u9636\u6bb5, \u5982\u4e0a\u6240\u8ff0\u3002\u5ba2\u6237\u7aef\u53ef\u4ee5\u81ea\u7531\u9009\u62e9\u5b83\u9075\u5faa\u7684\u6d41\u7a0b, \u4f46\u662f,\u6d41\u7684\u5404\u4e2a\u9636\u6bb5\u5fc5\u987b\u6309\u987a\u5e8f\u5b8c\u6210\u3002\u672a\u80fd\u9075\u5faa \u6309\u987a\u5e8f\u6392\u5217\u7684\u6d41\u5fc5\u987b\u4ea7\u751f HTTP 401 \u54cd\u5e94,\u5982\u5b9a\u4e49 \u4e0b\u9762\u3002\u5f53\u6d41\u4e2d\u7684\u6240\u6709\u9636\u6bb5\u90fd\u5b8c\u6210\u540e,\u8eab\u4efd\u9a8c\u8bc1\u662f \u5b8c\u6210,API \u8c03\u7528\u6210\u529f\u3002</p>"},{"location":"chat/client_server/#452-rest-api-api","title":"4.5.2 REST API \u4e2d\u7684\u7528\u6237\u4ea4\u4e92\u5f0f API","text":"<p>\u5728\u672c\u89c4\u8303\u4e2d\u63cf\u8ff0\u7684 REST API \u4e2d,\u8eab\u4efd\u9a8c\u8bc1\u7684\u5de5\u4f5c\u65b9\u5f0f\u4e3a \u4ea4\u6362 JSON \u5b57\u5178\u7684\u5ba2\u6237\u7aef\u548c\u670d\u52a1\u5668\u3002\u670d\u52a1\u5668\u6307\u793a \u901a\u8fc7 HTTP 401 \u6b63\u6587\u9700\u8981\u54ea\u4e9b\u8eab\u4efd\u9a8c\u8bc1\u6570\u636e \u54cd\u5e94,\u5ba2\u6237\u7aef\u901a\u8fc7\u8bf7\u6c42\u53c2\u6570\u63d0\u4ea4\u8be5\u8eab\u4efd\u9a8c\u8bc1\u6570\u636e\u3002auth</p> <p>\u5ba2\u6237\u7aef\u5e94\u9996\u5148\u53d1\u51fa\u4e0d\u5e26\u53c2\u6570\u7684\u8bf7\u6c42\u3002 \u4e3b\u670d\u52a1\u5668\u8fd4\u56de\u5e26\u6709 JSON \u6b63\u6587\u7684 HTTP 401 \u54cd\u5e94,\u5982\u4e0b\u6240\u793a:auth</p> <pre><code>HTTP/1.1 401 Unauthorized\nContent-Type: application/json\n</code></pre> <pre><code>    {\n  \"flows\": [\n    {\n      \"stages\": [\n        \"example.type.foo\",\n        \"example.type.bar\"\n      ]\n    },\n    {\n      \"stages\": [\n        \"example.type.foo\",\n        \"example.type.baz\"\n      ]\n    }\n  ],\n  \"params\": {\n    \"example.type.baz\": {\n      \"example_key\": \"foobar\"\n    }\n  },\n  \"session\": \"xxxxxx\"\n}\n</code></pre> <p>\u9664\u4e86 \u4e4b\u5916,\u6b64\u5bf9\u8c61\u8fd8\u5305\u542b\u4e00\u4e9b\u989d\u5916\u7684\u4fe1\u606f:flows</p> <ul> <li>params:\u6b64\u90e8\u5206\u5305\u542b\u5ba2\u6237\u7aef\u5c06\u8981\u63d0\u4f9b\u7684\u4efb\u4f55\u4fe1\u606f \u9700\u8981\u77e5\u9053\u624d\u80fd\u4f7f\u7528\u7ed9\u5b9a\u7c7b\u578b\u7684\u8eab\u4efd\u9a8c\u8bc1\u3002\u5bf9\u4e8e\u6bcf\u4e2a \u63d0\u4f9b\u7684\u8eab\u4efd\u9a8c\u8bc1\u7c7b\u578b,\u8be5\u7c7b\u578b\u53ef\u80fd\u5728\u6b64\u7c7b\u578b\u4e2d\u4f5c\u4e3a\u5bc6\u94a5\u5b58\u5728 \u5b57\u5178\u3002\u4f8b\u5982,OAuth \u5ba2\u6237\u7aef ID \u7684\u516c\u5171\u90e8\u5206\u53ef\u4ee5\u662f \u5728\u8fd9\u91cc\u7ed9\u51fa\u3002</li> <li>session:\u8fd9\u662f\u5ba2\u6237\u7aef\u5fc5\u987b\u4f20\u56de\u7684\u4f1a\u8bdd\u6807\u8bc6\u7b26 \u5230\u4e3b\u670d\u52a1\u5668\uff08\u5982\u679c\u63d0\u4f9b\u4e86\uff09,\u5728\u968f\u540e\u7684\u8eab\u4efd\u9a8c\u8bc1\u5c1d\u8bd5\u4e2d \u5728\u540c\u4e00\u4e2a API \u8c03\u7528\u4e2d\u3002</li> </ul> <p>\u7136\u540e,\u5ba2\u6237\u7aef\u9009\u62e9\u4e00\u4e2a\u6d41\u5e76\u5c1d\u8bd5\u5b8c\u6210\u7b2c\u4e00\u9636\u6bb5\u3002 \u5b83\u901a\u8fc7\u91cd\u65b0\u63d0\u4ea4\u76f8\u540c\u7684\u8bf7\u6c42\u5e76\u5728\u63d0\u4ea4\u7684\u5bf9\u8c61\u4e2d\u6dfb\u52a0\u5bc6\u94a5\u6765\u5b9e\u73b0\u6b64\u76ee\u7684\u3002\u6b64\u5b57\u5178\u5305\u542b\u4e00\u4e2a\u952e,\u5176\u503c\u662f\u8eab\u4efd\u9a8c\u8bc1\u7c7b\u578b\u7684\u540d\u79f0,\u8be5 \u5ba2\u6237\u7aef\u6b63\u5728\u5c1d\u8bd5\u5b8c\u6210\u3002\u5b83\u8fd8\u5fc5\u987b\u5305\u542b\u4e00\u4e2a\u5bc6\u94a5 \u4f7f\u7528\u4e3b\u670d\u52a1\u5668\u7ed9\u51fa\u7684\u4f1a\u8bdd\u5bc6\u94a5\u7684\u503c\uff08\u5982\u679c \u9274\u4e8e\u3002\u5b83\u8fd8\u5305\u542b\u4f9d\u8d56\u4e8e\u8eab\u4efd\u9a8c\u8bc1\u7c7b\u578b\u7684\u5176\u4ed6\u952e \u4f01\u56fe\u3002\u4f8b\u5982,\u5982\u679c\u5ba2\u6237\u7aef\u6b63\u5728\u5c1d\u8bd5\u5b8c\u6210\u8eab\u4efd\u9a8c\u8bc1 \u952e\u5165 ,\u5b83\u53ef\u80fd\u4f1a\u63d0\u4ea4\u5982\u4e0b\u5185\u5bb9:authtypesessionexample.type.foo</p> <pre><code>POST /_matrix/client/v3/endpoint HTTP/1.1\nContent-Type: application/json\n</code></pre> <pre><code>{\n  \"a_request_parameter\": \"something\",\n  \"another_request_parameter\": \"something else\",\n  \"auth\": {\n    \"type\": \"example.type.foo\",\n    \"session\": \"xxxxxx\",\n    \"example_credential\": \"verypoorsharedsecret\"\n  }\n}\n</code></pre> <p>\u5982\u679c\u4e3b\u670d\u52a1\u5668\u8ba4\u4e3a\u8eab\u4efd\u9a8c\u8bc1\u5c1d\u8bd5\u6210\u529f,\u4f46 \u4ecd\u7136\u9700\u8981\u66f4\u591a\u9636\u6bb5\u624d\u80fd\u5b8c\u6210,\u5b83\u8fd4\u56deHTTP\u72b6\u6001401 \u4ee5\u53ca\u4e0e\u672a\u5c1d\u8bd5\u8eab\u4efd\u9a8c\u8bc1\u65f6\u76f8\u540c\u7684\u5bf9\u8c61, \u6dfb\u52a0\u5bc6\u94a5,\u8be5\u5bc6\u94a5\u662f\u8eab\u4efd\u9a8c\u8bc1\u7c7b\u578b\u7684\u6570\u7ec4 \u5ba2\u6237\u7aef\u5df2\u6210\u529f\u5b8c\u6210:completed</p> <pre><code>HTTP/1.1 401 Unauthorized\nContent-Type: application/json\n</code></pre> <pre><code>{\n  \"completed\": [\n    \"example.type.foo\"\n  ],\n  \"flows\": [\n    {\n      \"stages\": [\n        \"example.type.foo\",\n        \"example.type.bar\"\n      ]\n    },\n    {\n      \"stages\": [\n        \"example.type.foo\",\n        \"example.type.baz\"\n      ]\n    }\n  ],\n  \"params\": {\n    \"example.type.baz\": {\n      \"example_key\": \"foobar\"\n    }\n  },\n  \"session\": \"xxxxxx\"\n}\n</code></pre> <p>\u5404\u4e2a\u9636\u6bb5\u53ef\u80fd\u9700\u8981\u591a\u4e2a\u8bf7\u6c42\u624d\u80fd\u5b8c\u6210,\u5728 \u5728\u8fd9\u79cd\u60c5\u51b5\u4e0b,\u54cd\u5e94\u5c06\u597d\u50cf\u8bf7\u6c42\u672a\u7ecf\u8eab\u4efd\u9a8c\u8bc1 \u6dfb\u52a0\u7531\u8eab\u4efd\u9a8c\u8bc1\u7c7b\u578b\u5b9a\u4e49\u7684\u4efb\u4f55\u5176\u4ed6\u5bc6\u94a5\u3002</p> <p>\u5982\u679c\u4e3b\u670d\u52a1\u5668\u786e\u5b9a\u67d0\u4e2a\u9636\u6bb5\u7684\u5c1d\u8bd5\u4e0d\u6210\u529f, \u4f46\u5ba2\u6237\u7aef\u53ef\u80fd\u4f1a\u8fdb\u884c\u7b2c\u4e8c\u6b21\u5c1d\u8bd5,\u5b83\u8fd4\u56de\u76f8\u540c\u7684 HTTP \u72b6\u6001 401 \u54cd\u5e94\u5982\u4e0a\u6240\u8ff0,\u5e76\u6dfb\u52a0\u4e86\u63cf\u8ff0\u9519\u8bef\u7684\u6807\u51c6\u548c\u5b57\u6bb5\u3002\u4f8b\u5982:errcodeerror</p> <pre><code>HTTP/1.1 401 Unauthorized\nContent-Type: application/json\n</code></pre> <pre><code>{\n  \"errcode\": \"M_FORBIDDEN\",\n  \"error\": \"Invalid password\",\n  \"completed\": [\n    \"example.type.foo\"\n  ],\n  \"flows\": [\n    {\n      \"stages\": [\n        \"example.type.foo\",\n        \"example.type.bar\"\n      ]\n    },\n    {\n      \"stages\": [\n        \"example.type.foo\",\n        \"example.type.baz\"\n      ]\n    }\n  ],\n  \"params\": {\n    \"example.type.baz\": {\n      \"example_key\": \"foobar\"\n    }\n  },\n  \"session\": \"xxxxxx\"\n}\n</code></pre> <p>\u5982\u679c\u8bf7\u6c42\u7531\u4e8e\u8eab\u4efd\u9a8c\u8bc1\u4ee5\u5916\u7684\u539f\u56e0\u800c\u5931\u8d25,\u5219\u670d\u52a1\u5668 \u8fd4\u56de\u6807\u51c6\u683c\u5f0f\u7684\u9519\u8bef\u6d88\u606f\u3002\u4f8b\u5982:</p> <pre><code>HTTP/1.1 400 Bad request\nContent-Type: application/json\n</code></pre> <pre><code>{\n  \"errcode\": \"M_EXAMPLE_ERROR\",\n  \"error\": \"Something was wrong\"\n}\n</code></pre> <p>\u5982\u679c\u5ba2\u6237\u7aef\u5df2\u5b8c\u6210\u6d41\u7684\u6240\u6709\u9636\u6bb5,\u5219\u4e3b\u670d\u52a1\u5668 \u6267\u884c API \u8c03\u7528\u5e76\u6b63\u5e38\u8fd4\u56de\u7ed3\u679c\u3002\u5df2\u5b8c\u6210\u7684\u9636\u6bb5 \u5ba2\u6237\u7aef\u65e0\u6cd5\u91cd\u8bd5,\u56e0\u6b64\u670d\u52a1\u5668\u5fc5\u987b\u8fd4\u56de 401 \u5305\u542b\u5df2\u5b8c\u6210\u9636\u6bb5\u7684\u54cd\u5e94,\u6216 API \u8c03\u7528\u7684\u7ed3\u679c\uff08\u5982\u679c\u5168\u90e8\uff09 \u5f53\u5ba2\u6237\u7aef\u91cd\u8bd5\u9636\u6bb5\u65f6,\u9636\u6bb5\u5df2\u5b8c\u6210\u3002</p> <p>\u67d0\u4e9b\u8eab\u4efd\u9a8c\u8bc1\u7c7b\u578b\u53ef\u4ee5\u901a\u8fc7 \u77e9\u9635\u5ba2\u6237\u7aef,\u4f8b\u5982,\u53ef\u4ee5\u5b8c\u6210\u7535\u5b50\u90ae\u4ef6\u786e\u8ba4 \u5f53\u7528\u6237\u5355\u51fb\u7535\u5b50\u90ae\u4ef6\u4e2d\u7684\u94fe\u63a5\u65f6\u3002\u5728\u8fd9\u79cd\u60c5\u51b5\u4e0b,\u5ba2\u6237\u7aef \u4f7f\u7528\u4ec5\u5305\u542b\u4f1a\u8bdd\u5bc6\u94a5\u7684\u8eab\u4efd\u9a8c\u8bc1\u5b57\u5178\u91cd\u8bd5\u8bf7\u6c42\u3002 \u5bf9\u6b64\u7684\u54cd\u5e94\u5c06\u4e0e\u5ba2\u6237\u7aef\u5c1d\u8bd5\u76f8\u540c \u6b63\u5e38\u5b8c\u6210\u8eab\u4efd\u9a8c\u8bc1\u72b6\u6001,\u5373\u8bf7\u6c42\u5c06 \u5b8c\u6210\u6216\u8bf7\u6c42\u8eab\u4efd\u9a8c\u8bc1,\u662f\u5426\u5b58\u5728\u8be5\u8eab\u4efd\u9a8c\u8bc1\u7c7b\u578b \u5728\"\u5df2\u5b8c\u6210\"\u6570\u7ec4\u4e2d\u6307\u793a\u8be5\u9636\u6bb5\u662f\u5426\u5b8c\u6210\u3002</p>"},{"location":"chat/client_server/#453","title":"4.5.3 \u4f8b","text":"<p>\u5728\u9ad8\u7ea7\u522b\u4e0a,\u5bf9 API \u8c03\u7528\u53d1\u51fa\u7684\u8bf7\u6c42\u5b8c\u6210\u8eab\u4efd\u9a8c\u8bc1 \u5177\u6709\u4e09\u4e2a\u9636\u6bb5\u7684\u6d41\u5c06\u7c7b\u4f3c\u4e8e\u4e0b\u56fe:</p> <pre><code>    _______________________\n    |       Stage 0         |\n    | No auth               |\n    |  ___________________  |\n    | |_Request_1_________| | &lt;-- Returns \"session\" key which is used throughout.\n    |_______________________|\n             |\n             |\n    _________V_____________\n    |       Stage 1         |\n    | type: \"&lt;auth type1&gt;\"  |\n    |  ___________________  |\n    | |_Request_1_________| |\n    |_______________________|\n             |\n             |\n    _________V_____________\n    |       Stage 2         |\n    | type: \"&lt;auth type2&gt;\"  |\n    |  ___________________  |\n    | |_Request_1_________| |\n    |  ___________________  |\n    | |_Request_2_________| |\n    |  ___________________  |\n    | |_Request_3_________| |\n    |_______________________|\n             |\n             |\n    _________V_____________\n    |       Stage 3         |\n    | type: \"&lt;auth type3&gt;\"  |\n    |  ___________________  |\n    | |_Request_1_________| | &lt;-- Returns API response\n    |_______________________|\n</code></pre>"},{"location":"chat/client_server/#454","title":"4.5.4 \u8eab\u4efd\u9a8c\u8bc1\u7c7b\u578b","text":"<p>\u6b64\u89c4\u8303\u5b9a\u4e49\u4e86\u4ee5\u4e0b\u8eab\u4efd\u9a8c\u8bc1\u7c7b\u578b:</p> <ul> <li>m.login.password</li> <li>m.login.recaptcha</li> <li>m.login.sso</li> <li>m.login.email.identity</li> <li>m.login.msisdn</li> <li>m.login.dummy</li> <li>m.login.registration_token</li> </ul>"},{"location":"chat/client_server/#455","title":"4.5.5 \u540e\u5907","text":"<p>\u4e0d\u80fd\u671f\u671b\u5ba2\u6237\u80fd\u591f\u77e5\u9053\u5982\u4f55\u5904\u7406\u6bcf\u4e2a \u5355\u4e00\u767b\u5f55\u7c7b\u578b\u3002\u5982\u679c\u5ba2\u6237\u7aef\u4e0d\u77e5\u9053\u5982\u4f55\u5904\u7406\u7ed9\u5b9a\u7684\u767b\u5f55 \u7c7b\u578b,\u5b83\u53ef\u4ee5\u5c06\u7528\u6237\u5b9a\u5411\u5230\u5177\u6709\u56de\u9000 URL \u7684 Web \u6d4f\u89c8\u5668 \u9875\u9762,\u5141\u8bb8\u7528\u6237\u5728\u5e26\u5916\u5b8c\u6210\u8be5\u767b\u5f55\u6b65\u9aa4 \u5728\u4ed6\u4eec\u7684\u7f51\u7edc\u6d4f\u89c8\u5668\u4e2d\u3002\u5b83\u5e94\u8be5\u6253\u5f00\u7684 URL \u662f:</p> <pre><code>/_matrix/client/v3/auth/&lt;auth type&gt;/fallback/web?session=&lt;session ID&gt;\n</code></pre> <p>\u5176\u4e2d \u662f\u5b83\u6b63\u5728\u5c1d\u8bd5\u7684\u9636\u6bb5\u7684\u7c7b\u578b\u540d\u79f0,\u662f\u4e3b\u670d\u52a1\u5668\u63d0\u4f9b\u7684\u4f1a\u8bdd\u7684 ID\u3002auth typesession ID</p> <p>\u8fd9\u5fc5\u987b\u8fd4\u56de\u53ef\u4ee5\u6267\u884c\u6b64\u8eab\u4efd\u9a8c\u8bc1\u7684 HTML \u9875\u9762 \u9636\u6bb5\u3002\u6b64\u9875\u9762\u5fc5\u987b\u4f7f\u7528\u4ee5\u4e0b JavaScript \u5728 \u8eab\u4efd\u9a8c\u8bc1\u5df2\u5b8c\u6210:</p> <pre><code>if (window.onAuthDone) {\n    window.onAuthDone();\n} else if (window.opener &amp;&amp; window.opener.postMessage) {\n    window.opener.postMessage(\"authDone\", \"*\");\n}\n</code></pre> <p>\u8fd9\u5141\u8bb8\u5ba2\u6237\u7aef\u5b89\u6392\u5728\u5d4c\u5165\u5f0f\u6d4f\u89c8\u5668\u4e2d\u5b9a\u4e49\u5168\u5c40\u51fd\u6570,\u6216\u4f7f\u7528HTML5\u8de8\u6587\u6863 \u6d88\u606f\u4f20\u9012 API, \u5230 \u63a5\u6536\u8eab\u4efd\u9a8c\u8bc1\u9636\u6bb5\u5df2\u5b8c\u6210\u7684\u901a\u77e5\u3002onAuthDone</p> <p>\u5ba2\u6237\u7aef\u6536\u5230\u8eab\u4efd\u9a8c\u8bc1\u9636\u6bb5\u7684\u901a\u77e5\u540e \u5df2\u5b8c\u6210,\u5b83\u5e94\u8be5\u4f7f\u7528\u8eab\u4efd\u9a8c\u8bc1\u5b57\u5178\u91cd\u65b0\u63d0\u4ea4\u8bf7\u6c42 \u4ec5\u4f7f\u7528\u4f1a\u8bdd ID:</p> <pre><code>{\n  \"session\": \"&lt;session ID&gt;\"\n}\n</code></pre> <p>4.5.6 \u6807\u8bc6\u7b26\u7c7b\u578b</p> <p>\u67d0\u4e9b\u8eab\u4efd\u9a8c\u8bc1\u673a\u5236\u4f7f\u7528\u7528\u6237\u6807\u8bc6\u7b26\u5bf9\u8c61\u6765\u6807\u8bc6 \u4e00\u4e2a\u7528\u6237\u3002\u7528\u6237\u6807\u8bc6\u7b26\u5bf9\u8c61\u6709\u4e00\u4e2a\u5b57\u6bb5\u6765\u6307\u793a \u6b63\u5728\u4f7f\u7528\u7684\u6807\u8bc6\u7b26\u7c7b\u578b,\u5e76\u4e14\u6839\u636e\u7c7b\u578b,\u5177\u6709\u5176\u4ed6 \u63d0\u4f9b\u6807\u8bc6\u7528\u6237\u6240\u9700\u4fe1\u606f\u7684\u5b57\u6bb5,\u5982\u6240\u8ff0 \u4e0b\u9762\u3002type</p> <p>\u6b64\u89c4\u8303\u5b9a\u4e49\u4e86\u4ee5\u4e0b\u6807\u8bc6\u7b26\u7c7b\u578b:</p> <ul> <li>m.id.user</li> <li>m.id.thirdparty</li> <li>m.id.phone</li> </ul>"},{"location":"chat/client_server/#46","title":"4.6 \u767b\u5f55","text":"<p>\u5ba2\u6237\u7aef\u53ef\u4ee5\u4f7f\u7528 API \u83b7\u53d6\u8bbf\u95ee\u4ee4\u724c\u3002/login</p> <p>\u8bf7\u6ce8\u610f,\u6b64\u7ec8\u7ed3\u70b9\u5f53\u524d\u4e0d\u4f7f\u7528\u7528\u6237\u4ea4\u4e92\u5f0f\u8eab\u4efd\u9a8c\u8bc1 \u539f\u6599\u836f\u3002</p> <p>\u5bf9\u4e8e\u7b80\u5355\u7684\u7528\u6237\u540d/\u5bc6\u7801\u767b\u5f55,\u5ba2\u6237\u7aef\u5e94\u63d0\u4ea4\u8bf7\u6c42,\u5982\u4e0b\u6240\u793a:/login</p> <pre><code>{\n  \"type\": \"m.login.password\",\n  \"identifier\": {\n    \"type\": \"m.id.user\",\n    \"user\": \"&lt;user_id or user localpart&gt;\"\n  },\n  \"password\": \"&lt;password&gt;\"\n}\n</code></pre> <p>\u6216\u8005,\u5ba2\u6237\u7aef\u53ef\u4ee5\u4f7f\u7528\u7ed1\u5b9a\u5230\u7528\u6237\u5e10\u6237\u7684 3PID \u4e3b\u670d\u52a1\u5668\u4f7f\u7528 /account/3pid API \u800c\u4e0d\u662f\u663e\u5f0f\u63d0\u4f9b,\u5982\u4e0b\u6240\u793a:user</p> <pre><code>{\n  \"type\": \"m.login.password\",\n  \"identifier\": {\n    \"medium\": \"&lt;The medium of the third-party identifier&gt;\",\n    \"address\": \"&lt;The canonicalised third-party address of the user&gt;\"\n  },\n  \"password\": \"&lt;password&gt;\"\n}\n</code></pre> <p>\u5982\u679c\u4e3b\u670d\u52a1\u5668\u4e0d\u77e5\u9053\u63d0\u4f9b\u7684 3PID, \u4e3b\u670d\u52a1\u5668\u5fc5\u987b\u54cd\u5e94 \u3002403 Forbidden</p> <p>\u8981\u4f7f\u7528\u767b\u5f55\u4ee4\u724c\u767b\u5f55,\u5ba2\u6237\u7aef\u5e94\u63d0\u4ea4\u8bf7\u6c42 \u5982\u4e0b:/login</p> <pre><code>{\n\"type\": \"m.login.token\",\n\"token\": \"&lt;login token&gt;\"\n}\n</code></pre> <p>\u5fc5\u987b\u5bf9\u7528\u6237 ID \u8fdb\u884c\u7f16\u7801,\u56e0\u4e3a\u6ca1\u6709\u5176\u4ed6\u6807\u8bc6 \u8bf7\u6c42\u4e2d\u7684\u6570\u636e\u3002\u5728\u4ee4\u724c\u65e0\u6548\u7684\u60c5\u51b5\u4e0b,\u4e3b\u670d\u52a1\u5668\u5fc5\u987b \u54cd\u5e94 \u548c\u9519\u8bef\u4ee3\u7801 \u3002token403 ForbiddenM_FORBIDDEN</p> <p>\u5982\u679c\u4e3b\u670d\u52a1\u5668\u64ad\u53d1\u4e3a\u53ef\u884c\u7684\u6d41,\u5e76\u4e14 \u5ba2\u6237\u7aef\u652f\u6301\u5b83,\u5ba2\u6237\u7aef\u5e94\u5c06\u7528\u6237\u91cd\u5b9a\u5411\u5230\u7aef\u70b9,\u4ee5\u4fbf\u901a\u8fc7 SSO \u767b\u5f55\u5ba2\u6237\u7aef\u3002\u8eab\u4efd\u9a8c\u8bc1\u540e \u5b8c\u6210\u540e,\u5ba2\u6237\u7aef\u5c06\u9700\u8981\u63d0\u4ea4\u5339\u914d\u7684\u8bf7\u6c42\u3002m.login.sso/redirect/loginm.login.token</p>"},{"location":"chat/client_server/#get-_matrixclientv3login","title":"GET /_matrix/client/v3/login","text":"<p>\u83b7\u53d6\u4e3b\u670d\u52a1\u5668\u652f\u6301\u7684\u767b\u5f55\u7c7b\u578b\u4ee5\u5bf9\u7528\u6237\u8fdb\u884c\u8eab\u4efd\u9a8c\u8bc1\u3002\u5ba2\u6237 \u5e94\u8be5\u9009\u62e9\u5176\u4e2d\u4e4b\u4e00\u5e76\u5728\u767b\u5f55\u65f6\u63d0\u4f9b\u5b83\u3002type</p> <pre><code>{\n  \"flows\": [\n    {\n      \"type\": \"m.login.password\"\n    }\n  ]\n}\n</code></pre>"},{"location":"chat/client_server/#post-_matrixclientv3login","title":"POST /_matrix/client/v3/login","text":"<p>\u5bf9\u7528\u6237\u8fdb\u884c\u8eab\u4efd\u9a8c\u8bc1,\u5e76\u9881\u53d1\u4ed6\u4eec\u53ef\u4ee5\u7684\u8bbf\u95ee\u4ee4\u724c \u7528\u4e8e\u5728\u540e\u7eed\u8bf7\u6c42\u4e2d\u6388\u6743\u81ea\u5df1\u3002</p> <p>\u5982\u679c\u5ba2\u6237\u7aef\u672a\u63d0\u4f9b ,\u5219\u670d\u52a1\u5668\u5fc5\u987b \u81ea\u52a8\u751f\u6210\u4e00\u4e2a\u3002device_id</p> <p>\u8fd4\u56de\u7684\u8bbf\u95ee\u4ee4\u724c\u5fc5\u987b\u4e0e\u5ba2\u6237\u7aef\u63d0\u4f9b\u7684\u6216\u7531\u670d\u52a1\u5668\u751f\u6210\u7684\u76f8\u5173\u8054\u3002\u670d\u52a1\u5668\u53ef\u80fd \u4f7f\u4ee5\u524d\u4e0e\u8be5\u8bbe\u5907\u5173\u8054\u7684\u4efb\u4f55\u8bbf\u95ee\u4ee4\u724c\u65e0\u6548\u3002\u8bf7\u53c2\u9605\u8bbf\u95ee\u4ee4\u724c\u548c\u8bbe\u5907\u4e4b\u95f4\u7684\u5173\u7cfb\u3002device_id</p> <pre><code>{\n  \"identifier\": {\n    \"type\": \"m.id.user\",\n    \"user\": \"cheeky_monkey\"\n  },\n  \"initial_device_display_name\": \"Jungle Phone\",\n  \"password\": \"ilovebananas\",\n  \"type\": \"m.login.password\"\n}\n</code></pre> <pre><code>{\n  \"access_token\": \"abc123\",\n  \"device_id\": \"GHTYAJCE\",\n  \"expires_in_ms\": 60000,\n  \"refresh_token\": \"def456\",\n  \"user_id\": \"@cheeky_monkey:matrix.org\",\n  \"well_known\": {\n    \"m.homeserver\": {\n      \"base_url\": \"https://example.org\"\n    },\n    \"m.identity_server\": {\n      \"base_url\": \"https://id.example.org\"\n    }\n  }\n}\n</code></pre>"},{"location":"chat/client_server/#post-_matrixclientv3refresh","title":"POST /_matrix/client/v3/refresh","text":"<p>v1.3 \u4e2d\u65b0\u589e</p> <p>\u5237\u65b0\u8bbf\u95ee\u4ee4\u724c\u3002\u5ba2\u6237\u7aef\u5e94\u4f7f\u7528\u8fd4\u56de\u7684\u8bbf\u95ee\u4ee4\u724c \u8fdb\u884c\u540e\u7eed API \u8c03\u7528\u65f6,\u5e76\u5b58\u50a8\u8fd4\u56de\u7684\u5237\u65b0\u4ee4\u724c \uff08\u5982\u679c\u7ed9\u5b9a\uff09,\u4ee5\u4fbf\u5728\u5fc5\u8981\u65f6\u5237\u65b0\u65b0\u7684\u8bbf\u95ee\u4ee4\u724c\u3002</p> <p>\u5237\u65b0\u8bbf\u95ee\u4ee4\u724c\u540e,\u670d\u52a1\u5668\u53ef\u4ee5\u9009\u62e9 \u4f7f\u65e7\u8bbf\u95ee\u4ee4\u724c\u7acb\u5373\u5931\u6548,\u4e5f\u53ef\u4ee5\u9009\u62e9\u4e0d\u4f7f\u65e7\u8bbf\u95ee\u4ee4\u724c\u5931\u6548 \u4f8b\u5982,\u8bbf\u95ee\u4ee4\u724c\u662f\u5426\u5f88\u5feb\u5c31\u4f1a\u8fc7\u671f\u3002\u5ba2\u6237\u5e94\u8be5 \u4e0d\u5bf9\u65e7\u8bbf\u95ee\u4ee4\u724c\u4ecd\u7136\u6709\u6548\u505a\u51fa\u4efb\u4f55\u5047\u8bbe, \u5e76\u5e94\u6539\u7528\u65b0\u63d0\u4f9b\u7684\u8bbf\u95ee\u4ee4\u724c\u3002</p> <p>\u65e7\u7684\u5237\u65b0\u4ee4\u724c\u5728\u65b0\u7684\u8bbf\u95ee\u4ee4\u724c\u6216\u5237\u65b0\u4ee4\u724c\u4e4b\u524d\u4e00\u76f4\u6709\u6548 ,\u6b64\u65f6\u5c06\u540a\u9500\u65e7\u7684\u5237\u65b0\u4ee4\u724c\u3002</p> <p>\u8bf7\u6ce8\u610f,\u6b64\u7aef\u70b9\u4e0d\u9700\u8981\u901a\u8fc7 \u8bbf\u95ee\u4ee4\u724c\u3002\u8eab\u4efd\u9a8c\u8bc1\u901a\u8fc7\u5237\u65b0\u4ee4\u724c\u63d0\u4f9b\u3002</p> <p>\u5df2\u4e3a\u6b64\u7ec8\u7ed3\u70b9\u7981\u7528\u5e94\u7528\u7a0b\u5e8f\u670d\u52a1\u6807\u8bc6\u65ad\u8a00\u3002</p> <pre><code>\n{\n  \"refresh_token\": \"some_token\"\n}\n</code></pre> <pre><code>{\n  \"access_token\": \"a_new_token\",\n  \"expires_in_ms\": 60000,\n  \"refresh_token\": \"another_new_token\"\n}\n</code></pre>"},{"location":"chat/client_server/#post-_matrixclientv3logout","title":"POST /_matrix/client/v3/logout","text":"<p>\u4f7f\u73b0\u6709\u8bbf\u95ee\u4ee4\u724c\u5931\u6548,\u4f7f\u5176\u4e0d\u80fd\u518d\u7528\u4e8e \u6388\u6743\u3002\u4e0e\u8bbf\u95ee\u4ee4\u724c\u5173\u8054\u7684\u8bbe\u5907\u4e5f\u5c06\u88ab\u5220\u9664\u3002\u8bbe\u5907\u7684\u8bbe\u5907\u5bc6\u94a5\u5c06\u4e0e\u8bbe\u5907\u4e00\u8d77\u5220\u9664\u3002</p> <pre><code>{}\n</code></pre>"},{"location":"chat/client_server/#post-_matrixclientv3logoutall","title":"POST /_matrix/client/v3/logout/all","text":"<p>\u4f7f\u7528\u6237\u7684\u6240\u6709\u8bbf\u95ee\u4ee4\u724c\u5931\u6548,\u4ee5\u4fbf\u5b83\u4eec\u4e0d\u80fd\u518d\u7528\u4e8e \u6388\u6743\u3002\u8fd9\u5305\u62ec\u53d1\u51fa\u6b64\u8bf7\u6c42\u7684\u8bbf\u95ee\u4ee4\u724c\u3002\u6240\u6709\u8bbe\u5907 \u5bf9\u4e8e\u7528\u6237\u4e5f\u5c06\u88ab\u5220\u9664\u3002\u8bbe\u5907\u7684\u8bbe\u5907\u5bc6\u94a5\u4e3a \u4e0e\u8bbe\u5907\u4e00\u8d77\u5220\u9664\u3002</p> <p>\u6b64\u7ec8\u7ed3\u70b9\u4e0d\u4f7f\u7528\u7528\u6237\u4ea4\u4e92\u5f0f\u8eab\u4efd\u9a8c\u8bc1 API,\u56e0\u4e3a \u7528\u6237\u4ea4\u4e92\u5f0f\u8eab\u4efd\u9a8c\u8bc1\u65e8\u5728\u9632\u6b62\u4ee5\u4e0b\u653b\u51fb:\u6709\u4eba\u638c\u63e1\u4e86\u4e00\u4e2a\u8bbf\u95ee\u4ee4\u724c,\u7136\u540e\u63a5\u7ba1\u4e86\u8be5\u5e10\u6237\u3002\u8fd9 \u7ec8\u7ed3\u70b9\u4f7f\u7528\u6237\u7684\u6240\u6709\u8bbf\u95ee\u4ee4\u724c\u5931\u6548,\u5305\u62ec \u8bf7\u6c42,\u56e0\u6b64\u653b\u51fb\u8005\u65e0\u6cd5\u63a5\u7ba1\u5e10\u6237 \u8fd9\u8fb9\u3002</p> <pre><code>{}\n</code></pre>"},{"location":"chat/client_server/#47","title":"4.7 \u5e10\u6237\u6ce8\u518c\u548c\u7ba1\u7406","text":""},{"location":"chat/client_server/#post-_matrixclientv3accountdeactivate","title":"POST /_matrix/client/v3/account/deactivate","text":"<p>\u505c\u7528\u7528\u6237\u5e10\u6237,\u5220\u9664\u7528\u6237\u7684\u6240\u6709\u80fd\u529b \u518d\u6b21\u767b\u5f55\u3002</p> <p>\u6b64 API \u7ec8\u7ed3\u70b9\u4f7f\u7528\u7528\u6237\u4ea4\u4e92\u5f0f\u8eab\u4efd\u9a8c\u8bc1 API\u3002</p> <p>\u5982\u679c\u5ba2\u6237\u7aef\u5177\u6709 \u6d3b\u52a8\u4f1a\u8bdd\u3002</p> <p>\u4e3b\u670d\u52a1\u5668\u53ef\u80fd\u4f1a\u66f4\u6539\u53ef\u7528\u7684\u6d41,\u5177\u4f53\u53d6\u51b3\u4e8e \u63d0\u4f9b\u4e86\u6709\u6548\u7684\u8bbf\u95ee\u4ee4\u724c\u3002</p> <p>\u4e0e\u5176\u4ed6\u7aef\u70b9\u4e0d\u540c,\u6b64\u7aef\u70b9\u4e0d\u91c7\u7528\u53c2\u6570,\u56e0\u4e3a\u4e3b\u670d\u52a1\u5668\u5e94\u5c06\u8bf7\u6c42\u7b7e\u540d\u5230 \u800c\u662f\u6807\u8bc6\u670d\u52a1\u5668\u3002id_access_token</p> <pre><code>req\n\n{\n  \"auth\": {\n    \"example_credential\": \"verypoorsharedsecret\",\n    \"session\": \"xxxxx\",\n    \"type\": \"example.type.foo\"\n  },\n  \"id_server\": \"example.org\"\n}\n</code></pre> <pre><code>200\n\n{\n  \"id_server_unbind_result\": \"success\"\n}\n</code></pre> <pre><code>401\n\n{\n  \"completed\": [\n    \"example.type.foo\"\n  ],\n  \"flows\": [\n    {\n      \"stages\": [\n        \"example.type.foo\"\n      ]\n    }\n  ],\n  \"params\": {\n    \"example.type.baz\": {\n      \"example_key\": \"foobar\"\n    }\n  },\n  \"session\": \"xxxxxxyz\"\n}\n</code></pre> <pre><code>429\n\n{\n  \"errcode\": \"M_LIMIT_EXCEEDED\",\n  \"error\": \"Too many requests\",\n  \"retry_after_ms\": 2000\n}\n</code></pre>"},{"location":"chat/client_server/#post-_matrixclientv3accountpassword","title":"POST /_matrix/client/v3/account/password","text":"<p>\u66f4\u6539\u6b64\u4e3b\u670d\u52a1\u5668\u4e0a\u5e10\u6237\u7684\u5bc6\u7801\u3002</p> <p>\u6b64 API \u7aef\u70b9\u4f7f\u7528\u7528\u6237\u4ea4\u4e92\u5f0f\u8eab\u4efd\u9a8c\u8bc1 API \u6765 \u786e\u4fdd\u66f4\u6539\u5bc6\u7801\u7684\u7528\u6237\u5b9e\u9645\u4e0a\u662f \u5e10\u6237\u3002</p> <p>\u5982\u679c\u5ba2\u6237\u7aef\u5177\u6709 \u6d3b\u52a8\u4f1a\u8bdd\u3002</p> <p>\u4e3b\u670d\u52a1\u5668\u53ef\u80fd\u4f1a\u66f4\u6539\u53ef\u7528\u7684\u6d41,\u5177\u4f53\u53d6\u51b3\u4e8e \u63d0\u4f9b\u4e86\u6709\u6548\u7684\u8bbf\u95ee\u4ee4\u724c\u3002\u4e3b\u670d\u52a1\u5668\u4e0d\u5e94\u64a4\u9500 \u8bf7\u6c42\u4e2d\u63d0\u4f9b\u7684\u8bbf\u95ee\u4ee4\u724c\u3002\u662f\u5426\u4e3a\u5176\u4ed6\u8bbf\u95ee\u4ee4\u724c \u540a\u9500\u7684\u7528\u6237\u53d6\u51b3\u4e8e\u8bf7\u6c42\u53c2\u6570\u3002</p> <pre><code>{\n  \"auth\": {\n    \"example_credential\": \"verypoorsharedsecret\",\n    \"session\": \"xxxxx\",\n    \"type\": \"example.type.foo\"\n  },\n  \"logout_devices\": true,\n  \"new_password\": \"ihatebananas\"\n}\n</code></pre> <pre><code>{}\n</code></pre>"},{"location":"chat/client_server/#post-_matrixclientv3accountpasswordemailrequesttoken","title":"POST /_matrix/client/v3/account/password/email/requestToken","text":"<p>\u4e3b\u670d\u52a1\u5668\u5fc5\u987b\u68c0\u67e5\u7ed9\u5b9a\u7684\u7535\u5b50\u90ae\u4ef6\u5730\u5740\u662f\u5426\u4e3a \u4e0e\u6b64\u4e3b\u670d\u52a1\u5668\u4e0a\u7684\u5e10\u6237\u5173\u8054\u3002\u6b64\u63a5\u53e3\u5e94\u4e3a \u7528\u4e8e\u5728\u5bf9\u7ec8\u7ed3\u70b9\u8fdb\u884c\u8eab\u4efd\u9a8c\u8bc1\u65f6\u8bf7\u6c42\u9a8c\u8bc1\u4ee4\u724c\u3002/account/password</p> <p>\u6b64 API \u7684\u53c2\u6570\u548c\u54cd\u5e94\u4e0e /register/email/requestToken \u7aef\u70b9\u7684\u53c2\u6570\u548c\u54cd\u5e94\u76f8\u540c,\u53ea\u662f\u5982\u679c\u6ca1\u6709\u4e0e \u53ef\u4ee5\u627e\u5230\u7ed9\u5b9a\u7684\u7535\u5b50\u90ae\u4ef6\u5730\u5740\u3002\u670d\u52a1\u5668\u53ef\u80fd\u4f1a\u53d1\u9001 \u5411\u7ed9\u5b9a\u5730\u5740\u53d1\u9001\u7535\u5b50\u90ae\u4ef6,\u63d0\u793a\u7528\u6237\u521b\u5efa\u5e10\u6237\u3002 \u53ef\u80fd\u65e0\u6cd5\u9000\u8d27\u3002M_THREEPID_NOT_FOUNDM_THREEPID_IN_USE</p> <p>\u4e3b\u670d\u52a1\u5668\u5e94\u9a8c\u8bc1\u7535\u5b50\u90ae\u4ef6\u672c\u8eab,\u65b9\u6cd5\u662f\u53d1\u9001 \u9a8c\u8bc1\u7535\u5b50\u90ae\u4ef6\u672c\u8eab\u6216\u4f7f\u7528\u5b83\u53ef\u4ee5\u63a7\u5236\u7684\u670d\u52a1\u3002</p> <pre><code>{\n  \"client_secret\": \"monkeys_are_GREAT\",\n  \"email\": \"alice@example.org\",\n  \"id_server\": \"id.example.com\",\n  \"next_link\": \"https://example.org/congratulations.html\",\n  \"send_attempt\": 1\n}\n</code></pre> <pre><code>{\n  \"sid\": \"123abc\",\n  \"submit_url\": \"https://example.org/path/to/submitToken\"\n}\n</code></pre>"},{"location":"chat/client_server/#post-_matrixclientv3accountpasswordmsisdnrequesttoken","title":"POST /_matrix/client/v3/account/password/msisdn/requestToken","text":"<p>\u4e3b\u670d\u52a1\u5668\u5fc5\u987b\u68c0\u67e5\u7ed9\u5b9a\u7684\u7535\u8bdd\u53f7\u7801\u662f\u5426\u4e3a \u4e0e\u6b64\u4e3b\u670d\u52a1\u5668\u4e0a\u7684\u5e10\u6237\u5173\u8054\u3002\u6b64\u63a5\u53e3\u5e94\u4e3a \u7528\u4e8e\u5728\u5bf9\u7ec8\u7ed3\u70b9\u8fdb\u884c\u8eab\u4efd\u9a8c\u8bc1\u65f6\u8bf7\u6c42\u9a8c\u8bc1\u4ee4\u724c\u3002/account/password</p> <p>\u6b64 API \u7684\u53c2\u6570\u548c\u54cd\u5e94\u4e0e /register/msisdn/requestToken \u7ec8\u7ed3\u70b9\u7684\u53c2\u6570\u548c\u54cd\u5e94\u76f8\u540c,\u53ea\u662f\u5982\u679c\u6ca1\u6709\u4e0e \u53ef\u4ee5\u627e\u5230\u7ed9\u5b9a\u7684\u7535\u8bdd\u53f7\u7801\u3002\u670d\u52a1\u5668\u53ef\u80fd\u4f1a\u6539\u4e3a\u53d1\u9001\u77ed\u4fe1 \u5230\u63d0\u793a\u7528\u6237\u521b\u5efa\u5e10\u6237\u7684\u7ed9\u5b9a\u7535\u8bdd\u53f7\u7801\u3002 \u53ef\u80fd\u65e0\u6cd5\u9000\u8d27\u3002M_THREEPID_NOT_FOUNDM_THREEPID_IN_USE</p> <p>\u4e3b\u670d\u52a1\u5668\u5e94\u9a8c\u8bc1\u7535\u8bdd\u53f7\u7801\u672c\u8eab,\u65b9\u6cd5\u662f\u53d1\u9001 \u9a8c\u8bc1\u6d88\u606f\u672c\u8eab\u6216\u901a\u8fc7\u4f7f\u7528\u5b83\u53ef\u4ee5\u63a7\u5236\u7684\u670d\u52a1\u3002</p> <pre><code>{\n  \"client_secret\": \"monkeys_are_GREAT\",\n  \"country\": \"GB\",\n  \"id_server\": \"id.example.com\",\n  \"next_link\": \"https://example.org/congratulations.html\",\n  \"phone_number\": \"07700900001\",\n  \"send_attempt\": 1\n}\n</code></pre> <pre><code>{\n  \"sid\": \"123abc\",\n  \"submit_url\": \"https://example.org/path/to/submitToken\"\n}\n</code></pre>"},{"location":"chat/client_server/#post-_matrixclientv3register","title":"POST /_matrix/client/v3/register","text":"<p>\u6b64 API \u7d42\u7d50\u9ede\u4f7f\u7528\u4f7f\u7528\u8005\u4e92\u52d5\u5f0f\u8eab\u4efd\u9a57\u8b49 API,\u4f46 \u6b63\u5728\u8a3b\u518a\u4f86\u8cd3\u5e33\u6236\u7684\u60c5\u6cc1\u3002</p> <p>\u5728\u6b64\u4e3b\u4f3a\u670d\u5668\u4e0a\u8a3b\u518a\u4e00\u500b\u5e33\u6236\u3002</p> <p>\u6709\u5169\u7a2e\u985e\u578b\u7684\u4f7f\u7528\u8005\u5e33\u6236:</p> <ul> <li>user\u5e33\u6236\u3002\u9019\u4e9b\u5e33\u6236\u53ef\u4ee5\u4f7f\u7528\u672c\u898f\u7bc4\u4e2d\u63cf\u8ff0\u7684\u5b8c\u6574 API\u3002</li> <li>guest\u5e33\u6236\u3002\u9019\u4e9b\u5e33\u6236\u53ef\u80fd\u5177\u6709\u6709\u9650\u7684\u8a31\u53ef\u6b0a,\u4e26\u4e14\u53ef\u80fd\u4e26\u975e\u53d7\u6240\u6709\u4f3a\u670d\u5668\u652f\u63f4</li> </ul> <p>\u5982\u679c\u8a3b\u518a\u6210\u529f,\u6b64\u7d42\u7d50\u9ede\u5c07\u9812\u767c\u8a2a\u554f\u4ee4\u724c \u7528\u6236\u7aef\u53ef\u4ee5\u4f7f\u7528 \u5728\u5f8c\u7e8c\u8acb\u6c42\u4e2d\u6388\u6b0a\u81ea\u8eab\u3002</p> <p>\u5982\u679c\u5ba2\u6236\u7aef\u672a\u63d0\u4f9b ,\u5247\u4f3a\u670d\u5668\u5fc5\u9808 \u81ea\u52d5\u751f\u6210\u4e00\u500b\u3002device_id</p> <p>\u4f3a\u670d\u5668\u61c9\u6839\u64da\u63d0\u4f9b\u7684\u4f7f\u7528\u8005 ID \u8a3b\u518a\u4e00\u500b\u5e33\u6236\uff08\u5982\u679c\u6709\uff09\u3002\u8acb\u6ce8\u610f,\u77e9\u9663\u4f7f\u7528\u8005ID\u7684\u8a9e\u6cd5 localparts \u53d7\u5230\u9650\u5236,\u56e0\u6b64\u4f3a\u670d\u5668\u5fc5\u9808\u4ee5\u908f\u8f2f\u65b9\u5f0f\u5c07\u63d0\u4f9b\u7684\u6620\u5c04\u5230 \u4e0a,\u6216\u8005\u62d2\u7d55\u4efb\u4f55\u4e0d\u7b26\u5408\u8a9e\u6cd5\u7684\u5167\u5bb9\u3002usernameusernameuser_idusernameM_INVALID_USERNAME</p> <p>\u77e9\u9663\u7528\u6236\u7aef\u4e0d\u5f97\u5047\u5b9a\u8a3b\u518a\u7684\u672c\u5730\u90e8\u5206\u8207\u63d0\u4f9b\u7684 .user_idusername</p> <p>\u8fd4\u56de\u7684\u8a2a\u554f\u4ee4\u724c\u5fc5\u9808\u8207\u7528\u6236\u7aef\u63d0\u4f9b\u7684\u6216\u7531\u4f3a\u670d\u5668\u751f\u6210\u7684\u76f8\u95dc\u806f\u3002\u4f3a\u670d\u5668\u53ef\u80fd \u4f7f\u4ee5\u524d\u8207\u8a72\u8a2d\u5099\u95dc\u806f\u7684\u4efb\u4f55\u8a2a\u554f\u4ee4\u724c\u7121\u6548\u3002\u8acb\u53c3\u95b1\u8a2a\u554f\u4ee4\u724c\u548c\u8a2d\u5099\u4e4b\u9593\u7684\u95dc\u4fc2\u3002device_id</p> <p>\u8a3b\u518a\u4f86\u8cd3\u5e33\u6236\u6642,\u8acb\u6c42\u6b63\u6587\u4e2d\u7684\u6240\u6709\u53c3\u6578 \u5fc5\u9808\u5ffd\u7565\u9664\u5916 \u7531\u4f3a\u670d\u5668\u3002\u4f3a\u670d\u5668\u5fc5\u9808\u70ba\u5e33\u6236\u9078\u64c7\u4e00\u500b \u7121\u8ad6\u8f38\u5165\u5982\u4f55\u3002initial_device_display_namedevice_id</p> <p>\u8acb\u6c42\u6b63\u6587\u793a\u4f8b</p> <pre><code>{\n  \"auth\": {\n    \"example_credential\": \"verypoorsharedsecret\",\n    \"session\": \"xxxxx\",\n    \"type\": \"example.type.foo\"\n  },\n  \"device_id\": \"GHTYAJCE\",\n  \"initial_device_display_name\": \"Jungle Phone\",\n  \"password\": \"ilovebananas\",\n  \"username\": \"cheeky_monkey\"\n}\n</code></pre> <p>200 \u56de\u61c9</p> <pre><code>{\n  \"access_token\": \"abc123\",\n  \"device_id\": \"GHTYAJCE\",\n  \"user_id\": \"@cheeky_monkey:matrix.org\"\n}\n</code></pre>"},{"location":"chat/client_server/#get-_matrixclientv3registeravailable","title":"GET /_matrix/client/v3/register/available","text":"<p>\u6aa2\u67e5\u4f7f\u7528\u8005\u540d\u662f\u5426\u53ef\u7528\u65bc\u4f3a\u670d\u5668\u4e14\u6709\u6548\u3002</p> <p>\u4f3a\u670d\u5668\u61c9\u6aa2\u67e5\u4ee5\u78ba\u4fdd\u5728\u8acb\u6c42\u6642 \u8acb\u6c42\u7684\u4f7f\u7528\u8005\u540d\u53ef\u4f9b\u4f7f\u7528\u3002\u9019\u5305\u62ec\u9a57\u8b49 \u61c9\u7528\u7a0b\u5f0f\u670d\u52d9\u5c1a\u672a\u8072\u660e\u4f7f\u7528\u8005\u540d,\u4e26\u4e14\u8a72\u4f7f\u7528\u8005\u540d \u7b26\u5408\u4f3a\u670d\u5668\u7684\u6240\u9700\u8981\u6c42\uff08\u4f8b\u5982,\u4f3a\u670d\u5668\u53ef\u4ee5\u6307\u793a \u5b83\u4e0d\u5141\u8a31\u5e36\u4e0b\u5283\u7dda\u7684\u4f7f\u7528\u8005\u540d\uff09\u3002</p> <p>\u77e9\u9663\u7528\u6236\u7aef\u53ef\u80fd\u5e0c\u671b\u5728\u5617\u8a66\u8a3b\u518a\u4e4b\u524d\u4f7f\u7528\u6b64 API, \u4f46\u662f,\u5ba2\u6236\u7aef\u9084\u5fc5\u9808\u6ce8\u610f,\u901a\u5e38\u4e0d\u6703\u4f7f\u7528\u6b64 API \u4fdd\u7559\u4f7f\u7528\u8005\u540d\u3002\u9019\u53ef\u80fd\u610f\u5473\u8457\u4f7f\u7528\u8005\u540d\u8b8a\u5f97\u4e0d\u53ef\u7528 \u5728\u6aa2\u67e5\u5176\u53ef\u7528\u6027\u548c\u5617\u8a66\u8a3b\u518a\u5b83\u4e4b\u9593\u3002</p> <p>200 \u56de\u61c9</p> <pre><code>{\n  \"available\": true\n}\n</code></pre> <p>400 \u56de\u61c9</p> <pre><code>{\n  \"errcode\": \"M_USER_IN_USE\",\n  \"error\": \"Desired user ID is already taken.\"\n}\n</code></pre>"},{"location":"chat/client_server/#post-_matrixclientv3registeremailrequesttoken","title":"POST /_matrix/client/v3/register/email/requestToken","text":"<p>\u4e3b\u4f3a\u670d\u5668\u5fc5\u9808\u6aa2\u67e5\u7d66\u5b9a\u7684\u96fb\u5b50\u90f5\u4ef6\u4f4d\u5740\u662f\u5426\u5c1a\u672a\u8207\u6b64\u4e3b\u4f3a\u670d\u5668\u4e0a\u7684\u5e33\u6236\u95dc\u806f\u3002\u4e3b\u4f3a\u670d\u5668 \u61c9\u901a\u904e\u767c\u9001\u9a57\u8b49\u96fb\u5b50\u90f5\u4ef6\u4f86\u9a57\u8b49\u96fb\u5b50\u90f5\u4ef6\u672c\u8eab \u672c\u8eab\u6216\u901a\u904e\u4f7f\u7528\u5b83\u53ef\u4ee5\u63a7\u5236\u7684\u670d\u52d9\u3002</p> <p>\u8acb\u6c42\u6b63\u6587\u793a\u4f8b</p> <pre><code>{\n  \"client_secret\": \"monkeys_are_GREAT\",\n  \"email\": \"alice@example.org\",\n  \"id_server\": \"id.example.com\",\n  \"next_link\": \"https://example.org/congratulations.html\",\n  \"send_attempt\": 1\n}\n</code></pre> <p>200 \u56de\u61c9</p> <pre><code>{\n  \"sid\": \"123abc\",\n  \"submit_url\": \"https://example.org/path/to/submitToken\"\n}\n</code></pre>"},{"location":"chat/client_server/#post-_matrixclientv3registermsisdnrequesttoken","title":"POST /_matrix/client/v3/register/msisdn/requestToken","text":"<p>\u4e3b\u4f3a\u670d\u5668\u5fc5\u9808\u6aa2\u67e5\u7d66\u5b9a\u7684\u96fb\u8a71\u865f\u78bc\u662f\u5426\u5c1a\u672a\u8207\u6b64\u4e3b\u4f3a\u670d\u5668\u4e0a\u7684\u5e33\u6236\u95dc\u806f\u3002\u4e3b\u4f3a\u670d\u5668 \u61c9\u901a\u904e\u767c\u9001\u9a57\u8b49\u4f86\u9a57\u8b49\u96fb\u8a71\u865f\u78bc\u672c\u8eab \u6d88\u606f\u672c\u8eab\u6216\u901a\u904e\u4f7f\u7528\u5b83\u53ef\u4ee5\u63a7\u5236\u7684\u670d\u52d9\u3002</p> <p>\u8acb\u6c42\u6b63\u6587\u793a\u4f8b</p> <pre><code>{\n  \"client_secret\": \"monkeys_are_GREAT\",\n  \"country\": \"GB\",\n  \"id_server\": \"id.example.com\",\n  \"next_link\": \"https://example.org/congratulations.html\",\n  \"phone_number\": \"07700900001\",\n  \"send_attempt\": 1\n}\n</code></pre> <p>200 \u56de\u61c9</p> <pre><code>{\n  \"sid\": \"123abc\",\n  \"submit_url\": \"https://example.org/path/to/submitToken\"\n}\n</code></pre>"},{"location":"chat/client_server/#48","title":"4.8 \u6dfb\u52a0\u5e33\u6236\u7ba1\u7406\u806f\u7e6b\u8cc7\u8a0a","text":""},{"location":"chat/client_server/#post-_matrixclientv3account3pidunbind","title":"POST /_matrix/client/v3/account/3pid/unbind","text":"<p>\u5f9e\u63d0\u4f9b\u7684\u8eab\u4efd\u4f3a\u670d\u5668\u4e2d\u522a\u9664\u4f7f\u7528\u8005\u7684\u7b2c\u4e09\u65b9\u6a19\u8b58\u78bc \u7121\u9700\u5c07\u5176\u5f9e\u4e3b\u4f3a\u670d\u5668\u4e2d\u522a\u9664\u3002</p> <p>\u8207\u5176\u4ed6\u7aef\u9ede\u4e0d\u540c,\u6b64\u7aef\u9ede\u4e0d\u63a1\u7528\u53c3\u6578,\u56e0\u70ba\u4e3b\u4f3a\u670d\u5668\u61c9\u5c07\u8acb\u6c42\u7c3d\u540d\u5230 \u800c\u662f\u6a19\u8b58\u4f3a\u670d\u5668\u3002id_access_token</p> <p>\u8acb\u6c42\u6b63\u6587\u793a\u4f8b</p> <pre><code>{\n  \"address\": \"example@example.org\",\n  \"id_server\": \"example.org\",\n  \"medium\": \"email\"\n}\n</code></pre> <p>200 \u56de\u61c9</p> <pre><code>{\n  \"id_server_unbind_result\": \"success\"\n}\n</code></pre>"},{"location":"chat/client_server/#49","title":"4.9 \u5f80\u4f86\u5e33\u6236\u8cc7\u8a0a","text":""},{"location":"chat/client_server/#get-_matrixclientv3accountwhoami","title":"GET /_matrix/client/v3/account/whoami","text":"<p>\u7372\u53d6\u6709\u95dc\u7d66\u5b9a\u8a2a\u554f\u4ee4\u724c\u7684\u6240\u6709\u8005\u7684\u8cc7\u8a0a\u3002</p> <p>\u8acb\u6ce8\u610f,\u8207\u5ba2\u6236\u7aef-\u4f3a\u670d\u5668 API \u7684\u5176\u9918\u90e8\u5206\u4e00\u6a23, \u61c9\u7528\u7a0b\u5f0f\u670d\u52d9\u53ef\u80fd\u6703\u507d\u88dd\u6210\u5176\u4f7f\u7528\u8005 \u547d\u540d\u7a7a\u9593,\u901a\u904e\u63d0\u4f9b\u67e5\u8a62\u53c3\u6578\u3002\u5728\u6b64 \u5728\u9019\u7a2e\u60c5\u6cc1\u4e0b,\u4f3a\u670d\u5668\u61c9\u9a57\u8b49\u7d66\u5b9a\u7684\u662f\u5426\u7531\u61c9\u7528\u670d\u52d9\u8a3b\u518a,\u4e26\u5728\u56de\u61c9\u4e2d\u8fd4\u56de body\u3002user_iduser_id</p> <p>200 \u56de\u61c9</p> <pre><code>{\n  \"device_id\": \"ABC1234\",\n  \"user_id\": \"@joe:example.org\"\n}\n</code></pre>"},{"location":"chat/client_server/#491","title":"4.9.1 \u6709\u95dc\u8eab\u4efd\u4f3a\u670d\u5668\u7684\u8aaa\u660e","text":"<p>Matrix \u4e2d\u7684\u8b58\u5225\u4f3a\u670d\u5668\u5132\u5b58\u7d81\u5b9a\uff08\u95dc\u4fc2\uff09 \u4f7f\u7528\u8005\u7684\u7b2c\u4e09\u65b9\u6a19\u8b58\u78bc,\u901a\u5e38\u662f\u96fb\u5b50\u90f5\u4ef6\u6216\u96fb\u8a71\u865f\u78bc,\u4ee5\u53ca \u4ed6\u5011\u7684\u4f7f\u7528\u8005ID\u3002\u7528\u6236\u9078\u64c7\u8eab\u4efd\u4f3a\u670d\u5668\u540e,\u8a72\u8eab\u4efd \u4f3a\u670d\u5668\u61c9\u7531\u6240\u6709\u7528\u6236\u7aef\u4f7f\u7528\u3002</p> <p>\u7528\u6236\u7aef\u53ef\u4ee5\u901a\u904e\u5e33\u6236\u6578\u64da\u4e8b\u4ef6\u67e5\u770b\u7528\u6236\u9078\u64c7\u4e86\u54ea\u500b\u8eab\u4efd\u4f3a\u670d\u5668,\u5982\u4e0b\u6240\u8ff0\u3002\u5ba2\u6236 \u61c9\u907f\u514d\u5411\u4efb\u4f55\u8eab\u4efd\u4f3a\u670d\u5668\u767c\u51fa\u8acb\u6c42,\u76f4\u5230 \u7684\u5b58\u5728\u88ab\u78ba\u8a8d\u70ba\uff08\u4e0d\u5b58\u5728\uff09\u3002\u5982\u679c \u5b58\u5728,\u7528\u6236\u7aef\u61c9\u6aa2\u67e5\u4e8b\u4ef6\u5167\u5bb9\u4e2d\u662f\u5426\u5b58\u5728\u5c6c\u6027\u3002\u5982\u679c\u5b58\u5728,\u5247 \u7528\u6236\u7aef\u61c9\u4f7f\u7528\u8a72\u5c6c\u6027\u4e2d\u7684\u6a19\u8b58\u4f3a\u670d\u5668\u4f5c\u70ba\u6a19\u8b58 \u7528\u6236\u7684\u4f3a\u670d\u5668\u3002\u5982\u679c\u7f3a\u5c11,\u6216\u8005\u5e33\u6236\u6578\u64da \u4e8b\u4ef6\u4e0d\u5b58\u5728,\u5ba2\u6236\u7aef\u61c9\u4f7f\u7528\u4efb\u4f55\u9810\u8a2d\u503c \u901a\u5e38\u9069\u7528\u65bc\u8eab\u4efd\u4f3a\u670d\u5668\uff08\u5982\u679c\u9069\u7528\uff09\u3002\u5ba2\u6236\u4e0d\u61c9 \u7576\u4f7f\u7528\u8005\u4f7f\u7528\u9810\u8a2d\u8eab\u4efd\u4f3a\u670d\u5668\u66f4\u65b0\u5e33\u6236\u6578\u64da\u6642 \u5176\u5e33\u6236\u6578\u64da\u4e2d\u7f3a\u5c11\u8eab\u4efd\u4f3a\u670d\u5668\u3002m.identity_serverm.identity_serverbase_urlbase_urlbase_url</p> <p>\u5ba2\u6236\u61c9\u5075\u807d\u5e33\u6236\u7684\u66f4\u6539 \u6578\u64da\u4e8b\u4ef6,\u4e26\u66f4\u65b0\u4ed6\u5011\u6b63\u5728\u806f\u7e6b\u7684\u8eab\u4efd\u4f3a\u670d\u5668 \u7d50\u679c\u3002m.identity_server</p> <p>\u5982\u679c\u7528\u6236\u7aef\u63d0\u4f9b\u4e86\u4e00\u7a2e\u8a2d\u7f6e\u8981\u4f7f\u7528\u7684\u8eab\u4efd\u4f3a\u670d\u5668\u7684\u65b9\u6cd5,\u5247\u5fc5\u9808 \u76f8\u61c9\u5730\u66f4\u65b0\u7684\u503c\u3002A \u7684 MUST \u88ab\u8996\u70ba\u4f7f\u7528\u8005\u4e0d\u60f3\u4f7f\u7528 \u8eab\u4efd\u4f3a\u670d\u5668,\u56e0\u6b64\u7981\u7528\u6240\u6709\u76f8\u95dc\u529f\u80fd\u3002m.identity_serverbase_urlnull</p> <p>\u5ba2\u6236\u61c9\u907f\u514d\u5c07\u5e33\u6236\u6578\u64da\u4f5c\u70ba\u9077\u79fb\u9032\u884c\u586b\u5145 \u91dd\u5c0d\u7f3a\u5c11\u5e33\u6236\u6578\u64da\u7684\u4f7f\u7528\u8005\u7684\u6b65\u9a5f,\u9664\u975e\u7528\u6236\u8a2d\u7f6e \u7528\u6236\u7aef\u5167\u7684\u8eab\u4efd\u4f3a\u670d\u5668\u70ba\u503c\u3002\u4f8b\u5982,\u4f7f\u7528\u8005 \u6c92\u6709\u5e33\u6236\u6578\u64da\u4e8b\u4ef6\u4e0d\u61c9\u6700\u7d42 \u5728\u5e33\u6236\u6578\u64da\u4e2d\u4f7f\u7528\u5ba2\u6236\u7aef\u7684\u9810\u8a2d\u8eab\u4efd\u4f3a\u670d\u5668,\u9664\u975e \u4f7f\u7528\u8005\u9996\u5148\u8a2a\u554f\u5176\u5e33\u6236\u8a2d\u7f6e\u4ee5\u8a2d\u7f6e\u8eab\u4efd\u4f3a\u670d\u5668\u3002m.identity_server</p> <p>\u4f8b\u5b50</p> <pre><code>{\n  \"content\": {\n    \"base_url\": \"https://example.org\"\n  },\n  \"type\": \"m.identity_server\"\n}\n</code></pre>"},{"location":"chat/client_server/#5","title":"5. \u80fd\u529b\u5354\u5546","text":"<p>\u4e3b\u4f3a\u670d\u5668\u53ef\u80fd\u4e0d\u652f\u63f4\u67d0\u4e9b\u64cd\u4f5c,\u5ba2\u6236\u7aef\u5fc5\u9808\u80fd\u5920 \u67e5\u8a62\u4e3b\u4f3a\u670d\u5668\u53ef\u4ee5\u63d0\u4f9b\u548c\u4e0d\u80fd\u63d0\u4f9b\u7684\u5167\u5bb9\u3002\u4f8b\u5982,\u4e00\u500b \u5bb6\u5ead\u4f3a\u670d\u5668\u53ef\u80fd\u4e0d\u652f\u63f4\u4f7f\u7528\u8005\u6309\u539f\u6a23\u66f4\u6539\u5176\u5bc6\u78bc \u914d\u7f6e\u70ba\u5c0d\u5916\u90e8\u7cfb\u7d71\u57f7\u884c\u8eab\u4efd\u9a57\u8b49\u3002</p> <p>\u901a\u904e\u6b64\u7cfb\u7d71\u5ba3\u50b3\u7684\u529f\u80fd\u65e8\u5728 \u901a\u544a\u5728 API \u4e2d\u53ef\u9078\u7684\u529f\u80fd,\u6216\u8005\u4f9d\u8cf4\u65bc \u4f7f\u7528\u8005\u6216\u4f3a\u670d\u5668\u72c0\u614b\u7684\u67d0\u7a2e\u65b9\u5f0f\u3002\u9019\u500b\u7cfb\u7d71\u4e0d\u61c9\u8a72 \u7528\u65bc\u5ba3\u50b3\u4e0d\u7a69\u5b9a\u6216\u5be6\u9a57\u6027\u529f\u80fd - \u9019\u66f4\u597d \u7531\u7aef\u9ede\u5b8c\u6210\u3002/versions</p> <p>\u5408\u7406\u80fd\u529b\u7684\u4e00\u4e9b\u7bc4\u4f8b\u5305\u62ec:</p> <ul> <li>\u4f3a\u670d\u5668\u662f\u5426\u652f\u63f4\u7528\u6236\u72c0\u614b\u3002</li> <li>\u4f3a\u670d\u5668\u662f\u5426\u652f\u63f4\u53ef\u9078\u529f\u80fd,\u4f8b\u5982\u4f7f\u7528\u8005\u6216 \u623f\u9593\u76ee\u9304\u3002</li> <li>\u5c0d\u7528\u6236\u7aef\u65bd\u52a0\u7684\u901f\u7387\u9650\u5236\u6216\u6a94\u985e\u578b\u9650\u5236 \u4f3a\u670d\u5668\u3002</li> </ul> <p>\u4e0d\u61c9\u6210\u70ba\u529f\u80fd\u7684\u4e00\u4e9b\u7bc4\u4f8b\u5305\u62ec:</p> <ul> <li>\u4f3a\u670d\u5668\u662f\u5426\u652f\u6301\u898f\u7bc4\u4e2d\u7684\u529f\u80fd\u3002unstable</li> <li>\u5a92\u9ad4\u5927\u5c0f\u9650\u5236 - \u9019\u4e9b\u9650\u5236\u7531 /config API \u8655\u7406\u3002</li> <li>\u7528\u65bc\u901a\u4fe1\u7684\u53ef\u9078\u7de8\u78bc\u6216\u66ff\u4ee3\u50b3\u8f38 \u4f3a\u670d\u5668</li> </ul> <p>\u524d\u7db4\u70ba\u7684\u529f\u80fd\u4fdd\u7559\u7528\u65bc\u5728 \u77e9\u9663\u898f\u7bc4,\u800c\u5176\u4ed6\u503c\u53ef\u80fd\u7531\u4f3a\u670d\u5668\u4f7f\u7528 Java \u5305\u547d\u540d\u7d04\u5b9a\u3002\u77e9\u9663\u652f\u63f4\u7684\u529f\u80fd \u898f\u7bc4\u5c07\u5728\u672c\u7bc0\u5f8c\u9762\u5b9a\u7fa9\u3002m.</p>"},{"location":"chat/client_server/#get-_matrixclientv3capabilities","title":"GET /_matrix/client/v3/capabilities","text":"<p>\u7372\u53d6\u6709\u95dc\u4f3a\u670d\u5668\u652f\u63f4\u7684\u529f\u80fd\u96c6\u7684\u8cc7\u8a0a \u548c\u5176\u4ed6\u76f8\u95dc\u529f\u80fd\u3002</p> <p>200 \u56de\u61c9</p> <pre><code>{\n  \"capabilities\": {\n    \"com.example.custom.ratelimit\": {\n      \"max_requests_per_hour\": 600\n    },\n    \"m.change_password\": {\n      \"enabled\": false\n    },\n    \"m.room_versions\": {\n      \"available\": {\n        \"1\": \"stable\",\n        \"2\": \"stable\",\n        \"3\": \"unstable\",\n        \"test-version\": \"unstable\"\n      },\n      \"default\": \"1\"\n    }\n  }\n}\n</code></pre>"},{"location":"chat/client_server/#51-mchange_password","title":"5.1 m.change_password\u80fd\u529b","text":"<p>\u6b64\u529f\u80fd\u5177\u6709\u55ae\u500b\u6a19\u8a8c,\u6307\u793a\u662f\u5426\u6216 \u4e0d\u662f\u4f7f\u7528\u8005\u53ef\u4ee5\u4f7f\u7528 API \u4f86\u66f4\u6539\u5176 \u5bc6\u78bc\u3002\u5982\u679c\u4e0d\u5b58\u5728,\u7528\u6236\u7aef\u61c9\u5047\u5b9a\u5bc6\u78bc\u66f4\u6539 \u53ef\u4ee5\u901a\u904e API \u5be6\u73fe\u3002\u5982\u679c\u5b58\u5728,\u5ba2\u6236\u61c9\u5c0a\u91cd \u529f\u80fd\u7684\u6a19\u8a8c,\u4e26\u5728\u7528\u6236\u7121\u6cd5\u6642\u5411\u4f7f\u7528\u8005\u6307\u793a \u4ee5\u66f4\u6539\u5176\u5bc6\u78bc\u3002enabled/account/passwordenabled</p> <p>\u529f\u80fd API \u5c0d\u6b64\u529f\u80fd\u7684\u56de\u61c9\u793a\u4f8b\u5982\u4e0b:</p> <pre><code>{\n  \"capabilities\": {\n    \"m.change_password\": {\n      \"enabled\": false\n    }\n  }\n}\n\n</code></pre>"},{"location":"chat/client_server/#52-mroom_versions","title":"5.2 m.room_versions\u80fd\u529b","text":"<p>\u6b64\u529f\u80fd\u63cf\u8ff0\u9810\u8a2d\u548c\u53ef\u7528\u7684\u623f\u9593\u7248\u672c a \u4f3a\u670d\u5668\u652f\u63f4,\u4ee5\u53ca\u7a69\u5b9a\u6027\u7d1a\u5225\u3002\u5ba2\u6236\u61c9\u4f7f\u7528 \u6b64\u529f\u80fd,\u4ee5\u78ba\u5b9a\u662f\u5426\u9700\u8981\u9f13\u52f5\u4f7f\u7528\u8005 \u5347\u7d1a\u4ed6\u5011\u7684\u623f\u9593\u3002</p> <p>\u529f\u80fd API \u5c0d\u6b64\u529f\u80fd\u7684\u56de\u61c9\u793a\u4f8b\u5982\u4e0b:</p> <pre><code>{\n  \"capabilities\": {\n    \"m.room_versions\": {\n      \"default\": \"1\",\n      \"available\": {\n        \"1\": \"stable\",\n        \"2\": \"stable\",\n        \"3\": \"unstable\",\n        \"custom-version\": \"unstable\"\n      }\n    }\n  }\n}\n</code></pre> <p>\u6b64\u529f\u80fd\u53cd\u6620\u4e86\u623f\u9593\u7684\u76f8\u540c\u9650\u5236 \u7528\u65bc\u63cf\u8ff0\u54ea\u4e9b\u7248\u672c\u7684\u7248\u672c \u7a69\u5b9a\u548c\u4e0d\u7a69\u5b9a\u3002\u7528\u6236\u7aef\u61c9\u5047\u5b9a\u7248\u672c\u70ba \u3002\u4efb\u4f55\u672a\u660e\u78ba\u6a19\u8a18\u70ba\u7248\u672c\u7684\u7248\u672c\u90fd\u5c07\u88ab\u8996\u70ba \u3002\u4f8b\u5982,\u4e00\u500b \u5217\u70ba\u7684\u7248\u672c\u61c9\u88ab\u8996\u70ba \u3002defaultstablestableavailableunstablefuture-stableunstable</p> <p>\u7248\u672c\u662f\u4f3a\u670d\u5668\u7528\u65bc\u5275\u5efa\u65b0\u7248\u672c\u7684\u7248\u672c \u623f\u9593\u3002\u7528\u6236\u7aef\u61c9\u9f13\u52f5\u5177\u6709\u8db3\u5920\u8a31\u53ef\u6b0a\u7684\u4f7f\u7528\u8005\u5728 \u623f\u9593\u5c07\u4ed6\u5011\u7684\u623f\u9593\u5347\u7d1a\u5230\u623f\u9593\u6642\u7684\u7248\u672c \u4f7f\u7528\u7248\u672c\u3002defaultdefaultunstable</p> <p>\u5982\u679c\u672a\u5217\u51fa\u6b64\u529f\u80fd,\u7528\u6236\u7aef\u61c9\u7528\u4f5c \u9ed8\u8a8d\u4e14\u552f\u4e00\u7a69\u5b9a\u7684\u623f\u9593\u7248\u672c\u3002\"1\"available</p>"},{"location":"chat/client_server/#53-mset_displayname","title":"5.3 m.set_displayname\u80fd\u529b","text":"<p>\u6b64\u529f\u80fd\u5177\u6709\u55ae\u500b\u6a19\u8a8c ,\u7528\u65bc\u6307\u793a\u4f7f\u7528\u8005\u662f\u5426 \u80fd\u5920\u901a\u904e\u914d\u7f6e\u6a94\u7d42\u7d50\u9ede\u66f4\u6539\u81ea\u5df1\u7684\u986f\u793a\u540d\u7a31\u3002\u6848\u4f8b \u7981\u7528\u53ef\u80fd\u5305\u62ec\u5f9e\u5916\u90e8\u6a19\u8b58/\u76ee\u9304\u6620\u5c04\u7684\u4f7f\u7528\u8005 \u670d\u52d9,\u4f8b\u5982LDAP\u3002enabled</p> <p>\u8acb\u6ce8\u610f,\u9019\u8207\u529f\u80fd\u5f88\u597d\u5730\u5339\u914d\u3002m.set_avatar_url</p> <p>\u5982\u679c\u672a\u5217\u51fa,\u7528\u6236\u7aef\u61c9\u5047\u5b9a\u7528\u6236\u80fd\u5920\u66f4\u6539\u5176 \u986f\u793a\u540d\u7a31\u3002</p> <p>\u529f\u80fd API \u5c0d\u6b64\u529f\u80fd\u7684\u56de\u61c9\u793a\u4f8b\u5982\u4e0b:</p> <pre><code>{\n  \"capabilities\": {\n    \"m.set_displayname\": {\n      \"enabled\": false\n    }\n  }\n}\n</code></pre>"},{"location":"chat/client_server/#54-mset_avatar_url","title":"5.4 m.set_avatar_url\u80fd\u529b","text":"<p>\u6b64\u529f\u80fd\u5177\u6709\u55ae\u500b\u6a19\u8a8c ,\u7528\u65bc\u6307\u793a\u4f7f\u7528\u8005\u662f\u5426 \u80fd\u5920\u901a\u904e\u914d\u7f6e\u6a94\u7aef\u9ede\u66f4\u6539\u81ea\u5df1\u7684\u982d\u50cf\u3002\u6848\u4f8b \u7981\u7528\u53ef\u80fd\u5305\u62ec\u5f9e\u5916\u90e8\u6a19\u8b58/\u76ee\u9304\u6620\u5c04\u7684\u4f7f\u7528\u8005 \u670d\u52d9,\u4f8b\u5982LDAP\u3002enabled</p> <p>\u8acb\u6ce8\u610f,\u9019\u8207\u529f\u80fd\u5f88\u597d\u5730\u5339\u914d\u3002m.set_displayname</p> <p>\u5982\u679c\u672a\u5217\u51fa,\u7528\u6236\u7aef\u61c9\u5047\u5b9a\u7528\u6236\u80fd\u5920\u66f4\u6539\u5176 \u5316\u8eab\u3002</p> <p>\u529f\u80fd API \u5c0d\u6b64\u529f\u80fd\u7684\u56de\u61c9\u793a\u4f8b\u5982\u4e0b:</p> <pre><code>{\n  \"capabilities\": {\n    \"m.set_avatar_url\": {\n      \"enabled\": false\n    }\n  }\n}\n</code></pre>"},{"location":"chat/client_server/#55-m3pid_changes","title":"5.5 m.3pid_changes\u80fd\u529b","text":"<p>\u6b64\u529f\u80fd\u5177\u6709\u55ae\u500b\u6a19\u8a8c ,\u7528\u65bc\u6307\u793a\u4f7f\u7528\u8005\u662f\u5426 \u80fd\u5920\u6dfb\u52a0,\u522a\u9664\u6216\u66f4\u6539\u5176\u5e33\u6236\u4e0a\u7684 3PID \u95dc\u806f\u3002\u6ce8\u610f \u9019\u50c5\u5f71\u97ff\u4f7f\u7528\u8005\u4f7f\u7528\u7ba1\u7406\u54e1\u806f\u7e6b\u8cc7\u8a0a API \u7684\u80fd\u529b,\u800c\u4e0d\u6703\u5f71\u97ff\u8eab\u4efd\u670d\u52d9\u516c\u958b\u7684\u7d42\u7d50\u9ede\u3002\u7981\u7528\u6848\u4f8b \u53ef\u80fd\u5305\u62ec\u5f9e\u5916\u90e8\u6a19\u8b58/\u76ee\u9304\u670d\u52d9\u6620\u5c04\u7684\u4f7f\u7528\u8005, \u4f8b\u5982LDAP\u3002enabled</p> <p>\u5982\u679c\u672a\u5217\u51fa,\u7528\u6236\u7aef\u61c9\u5047\u5b9a\u7528\u6236\u80fd\u5920\u4fee\u6539\u5176 3PID \u5354\u6703\u3002</p> <p>\u529f\u80fd API \u5c0d\u6b64\u529f\u80fd\u7684\u56de\u61c9\u793a\u4f8b\u5982\u4e0b:</p> <pre><code>{\n  \"capabilities\": {\n    \"m.3pid_changes\": {\n      \"enabled\": false\n    }\n  }\n}\n</code></pre>"},{"location":"chat/client_server/#6","title":"6 \u6ffe\u6ce2","text":"<p>\u904e\u6ffe\u5668\u53ef\u4ee5\u5728\u4f3a\u670d\u5668\u4e0a\u5275\u5efa,\u4e26\u53ef\u4ee5\u4f5c\u70ba\u53c3\u6578\u50b3\u905e\u7d66 \u8fd4\u56de\u4e8b\u4ef6\u7684 API\u3002\u9019\u4e9b\u7be9\u9078\u5668\u66f4\u6539\u5f9e\u8fd4\u56de\u7684\u6578\u64da \u90a3\u4e9b API\u3002\u4e26\u975e\u6240\u6709 API \u90fd\u63a5\u53d7\u7be9\u9078\u5668\u3002</p>"},{"location":"chat/client_server/#61","title":"6.1 \u61f6\u4eba\u88dd\u8f09\u5ba4\u6210\u54e1","text":"<p>\u6703\u54e1\u6d3b\u52d5\u901a\u5e38\u9700\u8981\u5927\u91cf\u8cc7\u6e90\u4f9b\u5ba2\u6236\u8ddf\u8e64\u3002 \u70ba\u4e86\u6e1b\u5c11\u4f7f\u7528\u7684\u8cc7\u6e90\u6578\u91cf,\u7528\u6236\u7aef\u53ef\u4ee5\u555f\u7528 \u623f\u9593\u6210\u54e1\u7684'\u5ef6\u9072\u8f09\u5165'\u3002\u3002\u901a\u904e\u9019\u6a23\u505a,\u4f3a\u670d\u5668\u5c07\u5617\u8a66 \u50c5\u767c\u9001\u8207\u5ba2\u6236\u76f8\u95dc\u7684\u6703\u54e1\u6d3b\u52d5\u3002</p> <p>\u91cd\u8981\u7684\u662f\u8981\u4e86\u89e3\u5ef6\u9072\u8f09\u5165\u4e26\u4e0d\u662f\u70ba\u4e86 \u5b8c\u7f8e\u7684\u512a\u5316,\u4e26\u4e14\u4f3a\u670d\u5668\u53ef\u80fd\u4e0d\u5207\u5be6\u969b \u7cbe\u78ba\u8a08\u7b97\u54ea\u4e9b\u6210\u54e1\u8cc7\u683c\u4e8b\u4ef6\u8207\u5ba2\u6236\u76f8\u95dc\u3002 \u56e0\u6b64,\u4f3a\u670d\u5668\u767c\u9001\u5197\u9918\u6210\u54e1\u8cc7\u683c\u662f\u6709\u6548\u7684 \u4e8b\u4ef6\u5411\u5ba2\u6236\u7aef\u7c21\u5316\u5be6\u73fe,\u5118\u7ba1\u9019\u7a2e\u5197\u9918 \u61c9\u76e1\u53ef\u80fd\u6e1b\u5c11\u4ee5\u7bc0\u7701\u983b\u5bec\u3002</p> <p>\u5728\u7be9\u6aa2\u7a0b\u5f0f\u65b9\u9762,\u5ef6\u9072\u8f09\u5165\u662f\u901a\u904e\u5728 \uff08\u6216 \u50c5\u5927\u5c0f\u5beb\uff09\u3002\u555f\u7528\u5f8c,\u5ef6\u9072\u8f09\u5165\u611f\u77e5\u7aef\u9ede\uff08\u8acb\u53c3\u95b1 \u4ee5\u4e0b\uff09\u5c07\u50c5\u5305\u62ec OF \u6d3b\u52d5\u7684\u6703\u54e1\u6d3b\u52d5 \u5305\u542b\u5728\u56de\u61c9\u4e2d\u3002\u4f8b\u5982,\u5982\u679c\u5ba2\u6236\u7aef\u767c\u51fa\u555f\u7528\u4e86\u5ef6\u9072\u8f09\u5165\u7684\u8acb\u6c42,\u5247\u4f3a\u670d\u5668\u5c07\u50c5\u8fd4\u56de \u6642\u9593\u7dda\u4e2d\u4e8b\u4ef6\u7684\u6210\u54e1\u8eab\u4efd\u4e8b\u4ef6,\u800c\u4e0d\u662f\u5168\u90e8 \u804a\u5929\u5ba4\u7684\u6210\u54e1\u3002lazy_load_membersRoomEventFilterStateFilter/syncsender/syncsender</p> <p>\u5728\u8655\u7406\u4e00\u7cfb\u5217\u4e8b\u4ef6\u6642\uff08\u4f8b\u5982,\u901a\u904e\u8ff4\u5708\u6216 \u5206\u9801 \uff09,\u5c0d\u65bc\u4e8b\u4ef6\u584a\u4f86\u8aaa\u5f88\u5e38\u898b \u5e8f\u5217\u4ee5\u5171\u7528\u4e00\u7d44\u985e\u4f3c\u7684\u5bc4\u4ef6\u8005\u3002\u800c\u4e0d\u662f\u56de\u61c9 \u5c07\u9019\u4e9b\u767c\u9001\u65b9\u7684\u91cd\u8907\u6210\u54e1\u8eab\u4efd\u4e8b\u4ef6\u767c\u9001\u5230 \u7528\u6236\u7aef,\u4f3a\u670d\u5668\u53ef\u80fd\u6703\u5047\u8a2d\u5ba2\u6236\u7aef\u6703\u8a18\u4f4f\u6210\u54e1\u8cc7\u683c \u5df2\u767c\u9001\u7684\u4e8b\u4ef6,\u4e26\u9078\u64c7\u8df3\u904e\u767c\u9001 \u6703\u54e1\u8cc7\u683c\u672a\u66f4\u6539\u7684\u6210\u54e1\u8cc7\u683c\u6d3b\u52d5\u3002\u9019\u4e9b \u7a31\u70ba'\u5197\u9918\u6210\u54e1\u8cc7\u683c\u4e8b\u4ef6'\u3002\u3002\u5ba2\u6236\u53ef\u4ee5\u8981\u6c42 \u5197\u9918\u6210\u54e1\u8eab\u4efd\u4e8b\u4ef6\u59cb\u7d42\u5305\u542b\u5728\u56de\u61c9\u4e2d,\u65b9\u6cd5\u662f\u5728\u7be9\u9078\u5668\u4e2d\u8a2d\u7f6e\u70ba true\u3002/sync/messagesinclude_redundant_members</p> <p>\u4f7f\u7528\u5ef6\u9072\u8f09\u5165\u7684\u9810\u671f\u6a21\u5f0f\u76ee\u524d\u70ba:</p> <ul> <li>\u7528\u6236\u7aef\u5728\u555f\u7528\u5ef6\u9072\u8f09\u5165\u7684\u60c5\u6cc1\u4e0b\u57f7\u884c\u521d\u59cb /sync,\u4e26\u4e14 \u50c5\u63a5\u6536\u8207\u7684\u767c\u9001\u65b9\u76f8\u95dc\u7684\u6210\u54e1\u8eab\u4efd\u4e8b\u4ef6 \u5b83\u63a5\u6536\u7684\u4e8b\u4ef6\u3002</li> <li>\u652f\u6301\u986f\u793a\u540d\u7a31\u5236\u8868\u5143\u88dc\u5168\u6216\u5176\u4ed6\u529f\u80fd\u7684\u7528\u6236\u7aef \u9700\u8981\u5feb\u901f\u8a2a\u554f\u623f\u9593\u5167\u6240\u6709\u6210\u54e1\u7684\u64cd\u4f5c \u61c9\u70ba\u7576\u524d\u9078\u5b9a\u7684\u804a\u5929\u5ba4\u8abf\u7528 /members,\u4e26\u5c07\u53c3\u6578\u8a2d\u7f6e\u70ba /sync \u56de\u61c9\u7684 from \u4ee4\u724c\u3002\u6210\u54e1\u6e05\u55ae \u56e0\u70ba\u623f\u9593\u7136\u5f8c\u7531\u570b\u5bb6\u5728\u96a8\u5f8c\u7dad\u8b77 \u589e\u91cf/\u540c\u6b65\u56de\u61c9\u3002?at</li> <li>\u4e0d\u652f\u63f4\u88fd\u8868\u7b26\u88dc\u5168\u7684\u7528\u6236\u7aef\u53ef\u80fd\u6703\u62c9\u5165 \u4efb\u610f\u4f7f\u7528\u8005\u7684\u914d\u7f6e\u6a94\uff08\u4f8b\u5982\u5df2\u8b80\u56de\u57f7,\u9375\u5165 \u901a\u77e5\uff09\u901a\u904e\u67e5\u8a62\u623f\u9593\u72c0\u614b\u6216 ./profile</li> </ul> <p>\u652f\u63f4\u5ef6\u9072\u8f09\u5165\u623f\u9593\u6210\u54e1\u7684\u7576\u524d\u7d42\u7d50\u9ede\u5305\u62ec:</p> <ul> <li>/sync</li> <li>/rooms//messages <li>/rooms//context/{eventId}"},{"location":"chat/client_server/#62","title":"6.2 \u4ecb\u9762\u9023\u63a5\u9ede","text":""},{"location":"chat/client_server/#post-_matrixclientv3useruseridfilter","title":"POST /_matrix/client/v3/user/{userId}/filter","text":"<p>\u5c07\u65b0\u7684\u7be9\u9078\u5668\u5b9a\u7fa9\u4e0a\u8f09\u5230\u4e3b\u4f3a\u670d\u5668\u3002 \u8fd4\u56de\u7be9\u9078\u5668ID,\u8a72ID\u53ef\u5728\u5c07\u4f86\u7684\u8acb\u6c42\u4e2d\u4f7f\u7528 \u9650\u5236\u5c07\u54ea\u4e9b\u4e8b\u4ef6\u8fd4\u56de\u5230\u7528\u6236\u7aef\u3002</p> <p>\u8acb\u6c42\u6b63\u6587\u793a\u4f8b</p> <pre><code>{\n  \"event_fields\": [\n    \"type\",\n    \"content\",\n    \"sender\"\n  ],\n  \"event_format\": \"client\",\n  \"presence\": {\n    \"not_senders\": [\n      \"@alice:example.com\"\n    ],\n    \"types\": [\n      \"m.presence\"\n    ]\n  },\n  \"room\": {\n    \"ephemeral\": {\n      \"not_rooms\": [\n        \"!726s6s6q:example.com\"\n      ],\n      \"not_senders\": [\n        \"@spam:example.com\"\n      ],\n      \"types\": [\n        \"m.receipt\",\n        \"m.typing\"\n      ]\n    },\n    \"state\": {\n      \"not_rooms\": [\n        \"!726s6s6q:example.com\"\n      ],\n      \"types\": [\n        \"m.room.*\"\n      ]\n    },\n    \"timeline\": {\n      \"limit\": 10,\n      \"not_rooms\": [\n        \"!726s6s6q:example.com\"\n      ],\n      \"not_senders\": [\n        \"@spam:example.com\"\n      ],\n      \"types\": [\n        \"m.room.message\"\n      ]\n    }\n  }\n}\n</code></pre> <p>200 \u56de\u61c9</p> <pre><code>{\n  \"filter_id\": \"66696p746572\"\n}\n</code></pre>"},{"location":"chat/client_server/#get-_matrixclientv3useruseridfilterfilterid","title":"GET /_matrix/client/v3/user/{userId}/filter/{filterId}","text":"<p>200 \u56de\u61c9</p> <pre><code>{\n  \"event_fields\": [\n    \"type\",\n    \"content\",\n    \"sender\"\n  ],\n  \"event_format\": \"client\",\n  \"presence\": {\n    \"not_senders\": [\n      \"@alice:example.com\"\n    ],\n    \"types\": [\n      \"m.presence\"\n    ]\n  },\n  \"room\": {\n    \"ephemeral\": {\n      \"not_rooms\": [\n        \"!726s6s6q:example.com\"\n      ],\n      \"not_senders\": [\n        \"@spam:example.com\"\n      ],\n      \"types\": [\n        \"m.receipt\",\n        \"m.typing\"\n      ]\n    },\n    \"state\": {\n      \"not_rooms\": [\n        \"!726s6s6q:example.com\"\n      ],\n      \"types\": [\n        \"m.room.*\"\n      ]\n    },\n    \"timeline\": {\n      \"limit\": 10,\n      \"not_rooms\": [\n        \"!726s6s6q:example.com\"\n      ],\n      \"not_senders\": [\n        \"@spam:example.com\"\n      ],\n      \"types\": [\n        \"m.room.message\"\n      ]\n    }\n  }\n}\n</code></pre>"},{"location":"chat/client_server/#7","title":"7 \u4e8b\u4ef6","text":"<p>\u7528\u6236\u7aef-\u4f3a\u670d\u5668 API \u516c\u958b\u7684\u5c0d\u8a71\u6b77\u53f2\u8a18\u9304\u6a21\u578b\u53ef\u4ee5 \u88ab\u8996\u70ba\u4e8b\u4ef6\u6e05\u55ae\u3002\u4f3a\u670d\u5668'\u884c\u5316'\u4e86 \u5c07\u4e8b\u4ef6\u7684\u6700\u7d42\u4e00\u81f4\u6027\u4e8b\u4ef6\u5716\u8f49\u63db\u70ba\"\u4e8b\u4ef6\u6d41\" \u4efb\u4f55\u7d66\u5b9a\u7684\u6642\u9593\u9ede:</p> <pre><code>[E0]-&gt;[E1]-&gt;[E2]-&gt;[E3]-&gt;[E4]-&gt;[E5]\n</code></pre>"},{"location":"chat/client_server/#71","title":"7.1 \u623f\u9593\u6d3b\u52d5\u7684\u985e\u578b","text":"<p>\u6703\u8b70\u5ba4\u6d3b\u52d5\u5206\u70ba\u5169\u985e:</p> <ul> <li>\u72c0\u614b\u4e8b\u4ef6:\u9019\u4e9b\u662f\u66f4\u65b0\u623f\u9593\uff08\u4f8b\u5982\u623f\u9593\uff09\u5143\u6578\u64da\u72c0\u614b\u7684\u4e8b\u4ef6 \u4e3b\u984c,\u623f\u9593\u6210\u54e1\u8cc7\u683c\u7b49\uff09\u3002\u72c0\u614b\u7531\u4e8b\u4ef6\u5143\u7d44\u548c .\u5177\u6709\u76f8\u540c\u9375\u5143\u7d44\u7684\u623f\u9593\u4e2d\u7684\u72c0\u614b\u5c07\u662f \u8986\u84cb\u3002typestate_key</li> <li>\u6d88\u606f\u4e8b\u4ef6:\u9019\u4e9b\u4e8b\u4ef6\u63cf\u8ff0\u4e86\u623f\u9593\u4e2d\u7684\u66ab\u6642\u6027'\u4e00\u6b21\u6027'\u6d3b\u52d5:\u901a\u5e38\u662f\u901a\u4fe1,\u4f8b\u5982\u767c\u9001\u5373\u6642\u6d88\u606f\u6216\u8a2d\u7f6e \u7db2\u8def\u96fb\u8a71\u547c\u53eb\u3002</li> </ul> <p>\u6b64\u898f\u7bc4\u6982\u8ff0\u4e86\u5e7e\u500b\u4e8b\u4ef6,\u6240\u6709\u4e8b\u4ef6\u90fd\u5177\u6709\u4e8b\u4ef6\u985e\u578b \u524d\u7db4\u3002\uff08\u6709\u95dc m. \u4e8b\u4ef6,\u8acb\u53c3\u95b1\u623f\u9593\u4e8b\u4ef6 \u898f\u7bc4\u3002\u4f46\u662f,\u61c9\u7528\u7a0b\u5f0f\u53ef\u80fd\u5e0c\u671b\u6dfb\u52a0\u81ea\u5df1\u7684\u985e\u578b \u4e8b\u4ef6,\u9019\u53ef\u4ee5\u4f7f\u7528 \u4ee5\u4e0b\u5404\u7bc0\u3002\u5982\u679c\u6dfb\u52a0\u4e86\u65b0\u4e8b\u4ef6,\u5247\u4e8b\u4ef6\u9375\u61c9 \u9075\u5faa Java \u5305\u547d\u540d\u7d04\u5b9a,\u4f8b\u5982 .\u9019\u53ef\u78ba\u4fdd\u4e8b\u4ef6\u985e\u578b\u5408\u9069 \u70ba\u6bcf\u500b\u61c9\u7528\u7a0b\u5f0f\u547d\u540d,\u4e26\u964d\u4f4e\u885d\u7a81\u98a8\u96aa\u3002m.typecom.example.myapp.event</p>"},{"location":"chat/client_server/#72","title":"7.2 \u6703\u8b70\u5ba4\u4e8b\u4ef6\u683c\u5f0f","text":"<p>\u804a\u5929\u5ba4\u4e8b\u4ef6\u7684'\u806f\u5408'\u683c\u5f0f,\u7531\u4e3b\u4f3a\u670d\u5668\u5728\u5167\u90e8\u4f7f\u7528 \u548c\u901a\u904e\u4f3a\u670d\u5668-\u4f3a\u670d\u5668API\u7684\u5bb6\u5ead\u4f3a\u670d\u5668\u4e4b\u9593,\u53d6\u6c7a\u65bc\"\u623f\u9593\" \u7248\u672c\"\u5728\u623f\u9593\u4f7f\u7528\u3002\u4f8b\u5982,\u8acb\u53c3\u95b1\u5b9a\u7fa9 \u623f\u9593\u7248\u672c 1 \u548c\u623f\u9593\u7248\u672c 3.</p> <p>\u4f46\u662f,\u77e9\u9663\u7528\u6236\u7aef\u9047\u5230\u6b64\u4e8b\u4ef6\u662f\u4e0d\u5c0b\u5e38\u7684 \u683c\u5f0f\u3002\u76f8\u53cd,\u4e3b\u4f3a\u670d\u5668\u8ca0\u8cac\u5c07\u4e8b\u4ef6\u8f49\u63db\u70ba \u683c\u5f0f\u5982\u4e0b\u6240\u793a,\u4ee5\u4fbf\u7528\u6236\u7aef\u53ef\u4ee5\u8f15\u9b06\u89e3\u6790\u5b83\u5011\u3002</p>"},{"location":"chat/client_server/#clientevent","title":"ClientEvent","text":"<p>\u4e8b\u4ef6\u5f9e\u4e3b\u4f3a\u670d\u5668\u8fd4\u56de\u5230\u7528\u6236\u7aef\u6642\u7528\u65bc\u4e8b\u4ef6\u7684\u683c\u5f0f \u901a\u904e\u7528\u6236\u7aef-\u4f3a\u670d\u5668 API,\u6216\u900f\u904e\u61c9\u7528\u7a0b\u5f0f\u670d\u52d9 API \u767c\u9001\u5230\u61c9\u7528\u7a0b\u5f0f\u670d\u52d9\u3002</p> <p>\u4f8b\u5b50</p> <pre><code>{\n  \"content\": {\n    \"membership\": \"join\"\n  },\n  \"event_id\": \"$26RqwJMLw-yds1GAH_QxjHRC1Da9oasK0e5VLnck_45\",\n  \"origin_server_ts\": 1632489532305,\n  \"room_id\": \"!jEsUZKDJdhlrceRyVU:example.org\",\n  \"sender\": \"@example:example.org\",\n  \"state_key\": \"@user:example.org\",\n  \"type\": \"m.room.member\",\n  \"unsigned\": {\n    \"age\": 1567437,\n    \"redacted_because\": {\n      \"content\": {\n        \"reason\": \"spam\"\n      },\n      \"event_id\": \"$Nhl3rsgHMjk-DjMJANawr9HHAhLg4GcoTYrSiYYGqEE\",\n      \"origin_server_ts\": 1632491098485,\n      \"redacts\": \"$26RqwJMLw-yds1GAH_QxjHRC1Da9oasK0e5VLnck_45\",\n      \"room_id\": \"!jEsUZKDJdhlrceRyVU:example.org\",\n      \"sender\": \"@moderator:example.org\",\n      \"type\": \"m.room.redaction\",\n      \"unsigned\": {\n        \"age\": 1257\n      }\n    }\n  }\n}\n</code></pre>"},{"location":"chat/client_server/#73","title":"7.3 \u525d\u96e2\u72c0\u614b","text":"<p>\u525d\u96e2\u72c0\u614b\u662f\u623f\u9593\u72c0\u614b\u7684\u7c21\u5316\u8996\u5716,\u65e8\u5728\u8aac\u660e \u6f5b\u5728\u7684\u7d30\u6728\u5de5\u8b58\u5225\u623f\u9593\u3002\u5b83\u7531\u4e00\u7d44\u6709\u9650\u7684\u72c0\u614b\u4e8b\u4ef6\u7d44\u6210 \u5b83\u5011\u672c\u8eab\u7d93\u904e\u7c21\u5316\u4ee5\u6e1b\u5c11\u6240\u9700\u7684\u6578\u64da\u91cf\u3002</p> <p>\u525d\u96e2\u7684\u72c0\u614b\u4e8b\u4ef6\u53ea\u80fd\u5b58\u5728, \u548c\u5c6c\u6027\u3002sendertypestate_keycontent</p> <p>\u525d\u96e2\u72c0\u614b\u901a\u5e38\u51fa\u73fe\u5728\u9080\u8acb,\u6572\u9580\u548c\u5176\u4ed6\u4f4d\u7f6e,\u5176\u4e2d \u7528\u6236\u53ef\u4ee5\u5728\u53ef\u7528\u689d\u4ef6\uff08\u4f8b\u5982\u53d7\u9650\u623f\u9593\uff09\u4e0b\u52a0\u5165\u804a\u5929\u5ba4\u3002</p> <p>\u7528\u6236\u7aef\u61c9\u50c5\u5728\u6c92\u6709 \u9032\u5165\u623f\u9593\u7684\u6b63\u5e38\u72c0\u614b\u3002\u4e00\u65e6\u623f\u9593\u7684\u72c0\u614b\u70ba \u53ef\u7528,\u61c9\u4e1f\u68c4\u6240\u6709\u525d\u96e2\u72c0\u614b\u3002\u5728\u4ee5\u4e0b\u60c5\u6cc1\u4e0b \u7528\u6236\u7aef\u5177\u6709\u623f\u9593\u7684\u5b58\u6a94\u72c0\u614b\uff08\u4f8b\u5982\u88ab\u8e22\u540e\uff09 \u4e26\u4e14\u7528\u6236\u7aef\u6b63\u5728\u63a5\u6536\u623f\u9593\u7684\u525d\u96e2\u72c0\u614b,\u4f8b\u5982\u4f86\u81ea \u9080\u8acb\u6216\u6572\u9580,\u5247\u525d\u96e2\u72c0\u614b\u61c9\u512a\u5148,\u76f4\u5230 \u53ef\u4ee5\u5f9e\u806f\u63a5\u4e2d\u7372\u53d6\u65b0\u72c0\u614b\u3002</p> <p>\u525d\u96e2\u72c0\u614b\u61c9\u5305\u542b\u4ee5\u4e0b\u90e8\u5206\u6216\u5168\u90e8\u72c0\u614b\u4e8b\u4ef6,\u9019\u4e9b\u4e8b\u4ef6 \u61c9\u76e1\u53ef\u80fd\u8868\u793a\u70ba\u525d\u96e2\u7684\u72c0\u614b\u4e8b\u4ef6:</p> <ul> <li>m.room.create</li> <li>m.room.name</li> <li>m.room.avatar</li> <li>m.room.topic</li> <li>m.room.join_rules</li> <li>m.room.canonical_alias</li> <li>m.room.encryption</li> </ul>"},{"location":"chat/client_server/#74","title":"7.4 \u5927\u5c0f\u9650\u5236","text":"<p>\u683c\u5f0f\u5316\u6642,\u5b8c\u6574\u4e8b\u4ef6\u4e0d\u5f97\u5927\u65bc65536\u4f4d\u5143\u7d44 \u4f7f\u7528\u806f\u5408\u4e8b\u4ef6\u683c\u5f0f,\u5305\u62ec\u4efb\u4f55 \u7c3d\u540d,\u4e26\u7de8\u78bc\u70ba\u898f\u7bc4 \u5091\u68ee\u3002</p> <p>\u6bcf\u500b\u91d1\u9470\u5927\u5c0f\u9084\u6709\u5176\u4ed6\u9650\u5236:</p> <ul> <li>sender\u4e0d\u5f97\u8d85\u904e255\u4f4d\u5143\u7d44\uff08\u5305\u62ec\u57df\uff09\u3002</li> <li>room_id\u4e0d\u5f97\u8d85\u904e 255 \u500b\u5b57\u7bc0\u3002</li> <li>state_key\u4e0d\u5f97\u8d85\u904e 255 \u500b\u5b57\u7bc0\u3002</li> <li>type\u4e0d\u5f97\u8d85\u904e 255 \u500b\u5b57\u7bc0\u3002</li> <li>event_id\u4e0d\u5f97\u8d85\u904e 255 \u500b\u5b57\u7bc0\u3002</li> </ul> <p>\u67d0\u4e9b\u4e8b\u4ef6\u985e\u578b\u5177\u6709\u6307\u5b9a\u7684\u5176\u4ed6\u5927\u5c0f\u9650\u5236 \u5728\u4e8b\u4ef6\u7684\u63cf\u8ff0\u4e2d\u3002\u9644\u52a0\u9375\u6c92\u6709\u9650\u5236\u5176\u4ed6 \u800c\u4e0d\u662f\u4e8b\u4ef6\u7684\u7e3d 64 KiB \u9650\u5236\u6240\u6697\u793a\u7684\u3002</p>"},{"location":"chat/client_server/#75","title":"7.5 \u6703\u8b70\u5ba4\u6d3b\u52d5","text":"<p>\u6b64\u898f\u7bc4\u6982\u8ff0\u4e86\u5e7e\u7a2e\u6a19\u6e96\u4e8b\u4ef6\u985e\u578b,\u6240\u6709\u9019\u4e9b\u4e8b\u4ef6\u985e\u578b\u90fd \u524d\u7db4\u70bam.</p>"},{"location":"chat/client_server/#mroomcanonical_alias","title":"m.room.canonical_alias","text":"<p>\u6b64\u4e8b\u4ef6\u7528\u65bc\u901a\u77e5\u804a\u5929\u5ba4\u61c9\u4f7f\u7528\u54ea\u500b\u5225\u540d \u88ab\u8a8d\u70ba\u662f\u898f\u7bc4\u7684,\u4ee5\u53ca\u5176\u4ed6\u54ea\u4e9b\u5225\u540d\u6307\u5411\u623f\u9593\u3002 \u9019\u53ef\u4ee5\u7528\u65bc\u986f\u793a\u76ee\u7684\u6216\u4f5c\u70ba\u5c0d\u5225\u540d\u7528\u6236\u7684\u5efa\u8b70 \u7528\u65bc\u5ba3\u50b3\u548c\u8a2a\u554f\u623f\u9593\u3002</p> <p>\u4f8b\u5b50</p> <pre><code>{\n  \"content\": {\n    \"alias\": \"#somewhere:localhost\",\n    \"alt_aliases\": [\n      \"#somewhere:example.org\",\n      \"#myroom:example.com\"\n    ]\n  },\n  \"event_id\": \"$143273582443PhrSn:example.org\",\n  \"origin_server_ts\": 1432735824653,\n  \"room_id\": \"!jEsUZKDJdhlrceRyVU:example.org\",\n  \"sender\": \"@example:example.org\",\n  \"state_key\": \"\",\n  \"type\": \"m.room.canonical_alias\",\n  \"unsigned\": {\n    \"age\": 1234\n  }\n}\n</code></pre>"},{"location":"chat/client_server/#mroomcreate","title":"m.room.create","text":"<p>\u9019\u662f\u6703\u8b70\u5ba4\u4e2d\u7684\u7b2c\u4e00\u500b\u4e8b\u4ef6,\u7121\u6cd5\u66f4\u6539\u3002\u5b83\u5145\u7576\u6240\u6709\u5176\u4ed6\u4e8b\u4ef6\u7684\u6839\u3002</p> <pre><code>{\n  \"content\": {\n    \"creator\": \"@example:example.org\",\n    \"m.federate\": true,\n    \"predecessor\": {\n      \"event_id\": \"$something:example.org\",\n      \"room_id\": \"!oldroom:example.org\"\n    },\n    \"room_version\": \"1\"\n  },\n  \"event_id\": \"$143273582443PhrSn:example.org\",\n  \"origin_server_ts\": 1432735824653,\n  \"room_id\": \"!jEsUZKDJdhlrceRyVU:example.org\",\n  \"sender\": \"@example:example.org\",\n  \"state_key\": \"\",\n  \"type\": \"m.room.create\",\n  \"unsigned\": {\n    \"age\": 1234\n  }\n}\n</code></pre>"},{"location":"chat/client_server/#mroomjoin_rules","title":"m.room.join_rules","text":"<p>\u623f\u9593\u53ef\u4ee5\u5177\u6709\u4ee5\u4e0b\u540d\u7a31\u4e4b\u4e00:</p> <ul> <li>public- \u4efb\u4f55\u4eba\u90fd\u53ef\u4ee5\u52a0\u5165\u623f\u9593,\u7121\u9700\u4e8b\u5148\u57f7\u884c\u4efb\u4f55\u64cd\u4f5c\u3002</li> <li>invite- \u7528\u6236\u5fc5\u9808\u9996\u5148\u6536\u5230\u6703\u8b70\u5ba4\u4e2d\u5df2\u6709\u4eba\u54e1\u7684\u9080\u8acb \u70ba\u4e86\u52a0\u5165\u3002</li> <li>knock- \u7528\u6236\u53ef\u4ee5\u8acb\u6c42\u9080\u8acb\u52a0\u5165\u623f\u9593\u3002\u4ed6\u5011\u53ef\u4ee5\u88ab\u5141\u8a31\uff08\u9080\u8acb\uff09 \u6216\u62d2\u7d55\uff08\u8e22/\u7981\u6b62\uff09\u8a2a\u554f\u3002\u5426\u5247,\u9700\u8981\u9080\u8acb\u4f7f\u7528\u8005\u52a0\u5165\u3002\u53ea \u53ef\u5728\u652f\u6301\u6572\u9580\u7684\u623f\u9593\u4f7f\u7528\u3002</li> <li>restricted- \u4efb\u4f55\u80fd\u5920\u6eff\u8db3\u81f3\u5c11\u4e00\u500b\u5141\u8a31\u689d\u4ef6\u7684\u4eba\u90fd\u662f \u7121\u9700\u4e8b\u5148\u64cd\u4f5c\u5373\u53ef\u52a0\u5165\u623f\u9593\u3002\u5426\u5247,\u9700\u8981\u9080\u8acb\u3002 \u50c5\u9069\u7528\u65bc\u652f\u63f4\u52a0\u5165\u898f\u5247\u7684\u623f\u9593\u3002</li> <li>knock_restricted- \u7528\u6236\u53ef\u4ee5\u4f7f\u7528\u63d0\u4f9b\u7684\u76f8\u540c\u529f\u80fd\u8acb\u6c42\u9080\u8acb \u901a\u904e\u52a0\u5165\u898f\u5247,\u6216\u8005\u53ef\u4ee5\u5728\u6eff\u8db3\u5141\u8a31\u689d\u4ef6\u7684\u60c5\u6cc1\u4e0b\u5617\u8a66\u52a0\u5165 \u6839\u64da\u806f\u63a5\u898f\u5247\u3002\u50c5\u9069\u7528\u65bc\u652f\u63f4\u52a0\u5165\u898f\u5247\u7684\u623f\u9593\u3002knockrestricted</li> <li>private- \u4fdd\u7559\u800c\u4e0d\u5be6\u65bd\u3002\u6c92\u6709\u91cd\u8981\u610f\u7fa9\u3002</li> </ul> <pre><code>{\n  \"content\": {\n    \"join_rule\": \"public\"\n  },\n  \"event_id\": \"$143273582443PhrSn:example.org\",\n  \"origin_server_ts\": 1432735824653,\n  \"room_id\": \"!jEsUZKDJdhlrceRyVU:example.org\",\n  \"sender\": \"@example:example.org\",\n  \"state_key\": \"\",\n  \"type\": \"m.room.join_rules\",\n  \"unsigned\": {\n    \"age\": 1234\n  }\n}\n</code></pre> <pre><code>{\n  \"content\": {\n    \"allow\": [\n      {\n        \"room_id\": \"!other:example.org\",\n        \"type\": \"m.room_membership\"\n      },\n      {\n        \"room_id\": \"!elsewhere:example.org\",\n        \"type\": \"m.room_membership\"\n      }\n    ],\n    \"join_rule\": \"restricted\"\n  },\n  \"event_id\": \"$143273582443PhrSn:example.org\",\n  \"origin_server_ts\": 1432735824653,\n  \"room_id\": \"!jEsUZKDJdhlrceRyVU:example.org\",\n  \"sender\": \"@example:example.org\",\n  \"state_key\": \"\",\n  \"type\": \"m.room.join_rules\",\n  \"unsigned\": {\n    \"age\": 1234\n  }\n}\n</code></pre>"},{"location":"chat/client_server/#mroommember","title":"m.room.member","text":"<p>\u8abf\u6574\u804a\u5929\u5ba4\u4e2d\u7528\u6236\u7684\u6210\u54e1\u8eab\u4efd\u72c0\u614b\u3002\u6700\u597d\u5728\u57f7\u884c\u6210\u54e1\u8cc7\u683c\u64cd\u4f5c\u6642\u4f7f\u7528\u6210\u54e1\u8cc7\u683c API\uff08 \u7b49\uff09,\u800c\u4e0d\u662f\u76f4\u63a5\u8abf\u6574\u72c0\u614b,\u56e0\u70ba\u5b58\u5728\u4e00\u7d44\u53d7\u9650\u5236\u7684\u6709\u6548\u8f49\u63db\u3002\u4f8b\u5982,\u4f7f\u7528\u8005 A \u7121\u6cd5\u5f37\u5236\u4f7f\u7528\u8005 B \u52a0\u5165\u804a\u5929\u5ba4,\u4e26\u4e14\u5617\u8a66\u76f4\u63a5\u5f37\u5236\u66f4\u6539\u6b64\u72c0\u614b\u5c07\u5931\u6557\u3002/rooms//invite <p>\u6307\u5b9a\u4e86\u4ee5\u4e0b\u6210\u54e1\u8cc7\u683c\u72c0\u614b:</p> <ul> <li>invite- \u4f7f\u7528\u8005\u5df2\u88ab\u9080\u8acb\u52a0\u5165\u804a\u5929\u5ba4,\u4f46\u5c1a\u672a\u52a0\u5165\u8a72\u804a\u5929\u5ba4\u3002\u5728\u52a0\u5165\u4e4b\u524d,\u4ed6\u5011\u4e0d\u5f97\u53c3\u52a0\u6703\u8b70\u5ba4\u3002</li> <li>join- \u4f7f\u7528\u8005\u5df2\u52a0\u5165\u804a\u5929\u5ba4\uff08\u53ef\u80fd\u5728\u63a5\u53d7\u9080\u8acb\u540e\uff09,\u4e26\u53ef\u80fd\u53c3\u8207\u5176\u4e2d\u3002</li> <li>leave- \u7528\u6236\u66fe\u7d93\u52a0\u5165\u623f\u9593,\u4f46\u5f8c\u4f86\u96e2\u958b\u4e86\uff08\u53ef\u80fd\u662f\u51fa\u65bc\u9078\u64c7,\u4e5f\u53ef\u80fd\u662f\u88ab\u8e22\uff09\u3002</li> <li>ban- \u4f7f\u7528\u8005\u5df2\u88ab\u7981\u6b62\u9032\u5165\u804a\u5929\u5ba4,\u4e26\u4e14\u4e0d\u518d\u88ab\u5141\u8a31\u52a0\u5165\u804a\u5929\u5ba4,\u76f4\u5230\u4ed6\u5011\u88ab\u53d6\u6d88\u7981\u6b62\u9032\u5165\u804a\u5929\u5ba4\uff08\u901a\u904e\u5c07\u5176\u6210\u54e1\u8eab\u4efd\u72c0\u614b\u8a2d\u7f6e\u70ba\u975e \u503c\uff09\u3002ban</li> <li>knock- \u4f7f\u7528\u8005\u5df2\u6572\u623f\u9593,\u8acb\u6c42\u5141\u8a31\u53c3\u8207\u3002\u5728\u52a0\u5165\u4e4b\u524d,\u4ed6\u5011\u4e0d\u5f97\u53c3\u52a0\u6703\u8b70\u5ba4\u3002</li> </ul> <p>\u5982\u679c\u6b64\u9080\u8acb\u662f\u4e8b\u4ef6\u4e26\u4e14\u662f\u4e8b\u4ef6\u7684\u5f8c\u7e8c\u4e8b\u4ef6,\u5247\u8a2d\u7f6e\u8a72\u5c6c\u6027,\u5426\u5247\u4e0d\u5b58\u5728\u3002third_party_inviteinvitem.room.third_party_invite</p> <p>\u6b64\u4e8b\u4ef6\u9084\u53ef\u80fd\u5305\u542b\u4e8b\u4ef6\u6578\u64da\u4e2d\u7684\u9375\u3002 \u5982\u679c\u5b58\u5728,\u5247\u5305\u542b\u4e00\u7d44\u525d\u96e2\u72c0\u614b\u4e8b\u4ef6,\u4ee5\u8aac\u660e\u63a5\u6536\u5668\u8b58\u5225\u623f\u9593\u3002invite_room_stateunsigned</p> <p>\u5957\u7528\u6210\u54e1\u8cc7\u683c\u7684\u4f7f\u7528\u8005\u7531 .\u5728\u67d0\u4e9b\u60c5\u6cc1\u4e0b, \u548c\u53ef\u80fd\u4e0d\u5339\u914d - \u9019\u53ef\u80fd\u88ab\u89e3\u91cb\u70ba\u5f71\u97ff \u7528\u6236\u7684\u6210\u54e1\u8eab\u4efd\u72c0\u614b\u3002state_keysenderstate_keysenderstate_key</p> <p>\u7d66\u5b9a\u4f7f\u7528\u8005\u7684 TO \u53ef\u80fd\u6703\u96a8\u6642\u9593\u800c\u8b8a\u5316\u3002\u4e0b\u8868\u5217\u51fa\u4e86\u5404\u7a2e\u66f4\u6539 \u96a8\u6642\u9593\u63a8\u79fb\u4ee5\u53ca\u5ba2\u6236\u7aef\u548c\u4f3a\u670d\u5668\u5fc5\u9808\u5982\u4f55\u89e3\u91cb\u9019\u4e9b\u66f4\u6539\u3002\u53ef\u4ee5\u6aa2\u7d22\u4ee5\u524d\u7684\u6703\u54e1\u8cc7\u683c \u5f9e\u4e8b\u4ef6\u4e0a\u7684\u7269\u4ef6\u3002\u5982\u679c\u4e0d\u5b58\u5728,\u5247\u5fc5\u9808\u5047\u5b9a\u4f7f\u7528\u8005\u4ee5\u524d\u7684\u6210\u54e1\u8eab\u4efd \u5982\u3002membershipprev_contentleave</p> <pre><code>{\n  \"content\": {\n    \"avatar_url\": \"mxc://example.org/SEsfnsuifSDFSSEF\",\n    \"displayname\": \"Alice Margatroid\",\n    \"membership\": \"join\",\n    \"reason\": \"Looking for support\"\n  },\n  \"event_id\": \"$143273582443PhrSn:example.org\",\n  \"origin_server_ts\": 1432735824653,\n  \"room_id\": \"!jEsUZKDJdhlrceRyVU:example.org\",\n  \"sender\": \"@example:example.org\",\n  \"state_key\": \"@alice:example.org\",\n  \"type\": \"m.room.member\",\n  \"unsigned\": {\n    \"age\": 1234\n  }\n}\n</code></pre> <pre><code>{\n  \"content\": {\n    \"avatar_url\": \"mxc://example.org/SEsfnsuifSDFSSEF\",\n    \"displayname\": \"Alice Margatroid\",\n    \"membership\": \"invite\",\n    \"reason\": \"Looking for support\"\n  },\n  \"event_id\": \"$143273582443PhrSn:example.org\",\n  \"origin_server_ts\": 1432735824653,\n  \"room_id\": \"!jEsUZKDJdhlrceRyVU:example.org\",\n  \"sender\": \"@example:example.org\",\n  \"state_key\": \"@alice:example.org\",\n  \"type\": \"m.room.member\",\n  \"unsigned\": {\n    \"age\": 1234,\n    \"invite_room_state\": [\n      {\n        \"content\": {\n          \"name\": \"Example Room\"\n        },\n        \"sender\": \"@bob:example.org\",\n        \"state_key\": \"\",\n        \"type\": \"m.room.name\"\n      },\n      {\n        \"content\": {\n          \"join_rule\": \"invite\"\n        },\n        \"sender\": \"@bob:example.org\",\n        \"state_key\": \"\",\n        \"type\": \"m.room.join_rules\"\n      }\n    ]\n  }\n}\n</code></pre> <pre><code>{\n  \"content\": {\n    \"avatar_url\": \"mxc://example.org/SEsfnsuifSDFSSEF\",\n    \"displayname\": \"Alice Margatroid\",\n    \"join_authorised_via_users_server\": \"@bob:other.example.org\",\n    \"membership\": \"join\"\n  },\n  \"event_id\": \"$143273582443PhrSn:example.org\",\n  \"origin_server_ts\": 1432735824653,\n  \"room_id\": \"!jEsUZKDJdhlrceRyVU:example.org\",\n  \"sender\": \"@example:example.org\",\n  \"state_key\": \"@alice:example.org\",\n  \"type\": \"m.room.member\",\n  \"unsigned\": {\n    \"age\": 1234\n  }\n}\n</code></pre> <pre><code>{\n  \"content\": {\n    \"avatar_url\": \"mxc://example.org/SEsfnsuifSDFSSEF\",\n    \"displayname\": \"Alice Margatroid\",\n    \"membership\": \"knock\",\n    \"reason\": \"Looking for support\"\n  },\n  \"event_id\": \"$143273582443PhrSn:example.org\",\n  \"origin_server_ts\": 1432735824653,\n  \"room_id\": \"!jEsUZKDJdhlrceRyVU:example.org\",\n  \"sender\": \"@example:example.org\",\n  \"state_key\": \"@alice:example.org\",\n  \"type\": \"m.room.member\",\n  \"unsigned\": {\n    \"age\": 1234,\n    \"knock_room_state\": [\n      {\n        \"content\": {\n          \"name\": \"Example Room\"\n        },\n        \"sender\": \"@bob:example.org\",\n        \"state_key\": \"\",\n        \"type\": \"m.room.name\"\n      },\n      {\n        \"content\": {\n          \"join_rule\": \"knock\"\n        },\n        \"sender\": \"@bob:example.org\",\n        \"state_key\": \"\",\n        \"type\": \"m.room.join_rules\"\n      }\n    ]\n  }\n}\n</code></pre> <pre><code>{\n  \"content\": {\n    \"avatar_url\": \"mxc://example.org/SEsfnsuifSDFSSEF\",\n    \"displayname\": \"Alice Margatroid\",\n    \"membership\": \"invite\",\n    \"third_party_invite\": {\n      \"display_name\": \"alice\",\n      \"signed\": {\n        \"mxid\": \"@alice:example.org\",\n        \"signatures\": {\n          \"magic.forest\": {\n            \"ed25519:3\": \"fQpGIW1Snz+pwLZu6sTy2aHy/DYWWTspTJRPyNp0PKkymfIsNffysMl6ObMMFdIJhk6g6pwlIqZ54rxo8SLmAg\"\n          }\n        },\n        \"token\": \"abc123\"\n      }\n    }\n  },\n  \"event_id\": \"$143273582443PhrSn:example.org\",\n  \"origin_server_ts\": 1432735824653,\n  \"room_id\": \"!jEsUZKDJdhlrceRyVU:example.org\",\n  \"sender\": \"@example:example.org\",\n  \"state_key\": \"@alice:example.org\",\n  \"type\": \"m.room.member\",\n  \"unsigned\": {\n    \"age\": 1234\n  }\n}\n</code></pre>"},{"location":"chat/client_server/#mroompower_levels","title":"m.room.power_levels","text":"<p>\u6b64\u4e8b\u4ef6\u6307\u5b9a\u7528\u6236\u5fc5\u9808\u5177\u6709\u7684\u6700\u4f4e\u7d1a\u5225\u624d\u80fd\u57f7\u884c \u67d0\u4e9b\u52d5\u4f5c\u3002\u5b83\u9084\u6307\u5b9a\u6a94\u5ba4\u4e2d\u6bcf\u500b\u7528\u6236\u7684\u7d1a\u5225\u3002</p> <p>\u5982\u679c a \u5728\u6e05\u55ae\u4e2d,\u5247\u5177\u6709 \u76f8\u95dc\u7684\u529f\u7387\u7d1a\u5225\u3002\u5426\u5247,\u5b83\u5011\u5177\u6709\u9ed8\u8a8d\u7d1a\u5225\u3002\u5982\u679c\u672a\u63d0\u4f9b,\u5247\u5047\u5b9a\u70ba 0. \u5982\u679c\u804a\u5929\u5ba4\u4e0d\u5305\u542b\u4efb\u4f55\u4e8b\u4ef6,\u5247\u804a\u5929\u5ba4\u7684\u5efa\u7acb\u8005\u5177\u6709 \u529f\u7387\u7d1a\u5225\u70ba 100,\u6240\u6709\u5176\u4ed6\u4f7f\u7528\u8005\u7684\u529f\u7387\u7d1a\u5225\u70ba 0\u3002user_idusersuser_idusers_defaultusers_defaultm.room.power_levels</p> <p>\u767c\u9001\u7279\u5b9a\u4e8b\u4ef6\u6240\u9700\u7684\u7d1a\u5225\u7531\u548c\u63a7\u5236\u3002\u5982\u679c\u5728 \u4e2d\u6307\u5b9a\u4e86\u4e8b\u4ef6\u985e\u578b,\u5247\u7528\u6236\u5fc5\u9808\u81f3\u5c11\u5177\u6709\u6307\u5b9a\u7684\u7d1a\u5225,\u4ee5\u4fbf \u767c\u9001\u8a72\u4e8b\u4ef6\u3002\u5982\u679c\u672a\u63d0\u4f9b\u4e8b\u4ef6\u985e\u578b,\u5247\u9810\u8a2d\u70ba for \u6d88\u606f\u4e8b\u4ef6\u548c state \u4e8b\u4ef6\u3002eventsstate_defaultevents_defaulteventsevents_defaultstate_default</p> <p>\u5982\u679c\u4e8b\u4ef6\u4e2d\u6c92\u6709state_default,\u6216\u8005 m.room.power_levels\u6c92\u6709\u4e8b\u4ef6,\u662f m.room.power_levels 50\u3002 \u5982\u679c\u4e8b\u4ef6\u4e2d\u6c92\u6709state_default, \u6216\u8005\u6c92\u6709\u4e8b\u4ef6events_default,\u5247\u70ba 0\u3002</p> <p>\u9080\u8acb\u4f7f\u7528\u8005\u52a0\u5165\u804a\u5929\u5ba4\u6240\u9700\u7684\u529f\u7387\u7d1a\u5225,\u5c07\u4f7f\u7528\u8005\u8e22\u51fa \u804a\u5929\u5ba4,\u7981\u6b62\u4f7f\u7528\u8005\u9032\u5165\u804a\u5929\u5ba4\u6216\u7de8\u8f2f\u5176\u4ed6\u7528\u6236\u767c\u9001\u7684\u4e8b\u4ef6\u662f \u5206\u5225\u7531, , \u548c\u5b9a\u7fa9\u3002\u95dc\u5361 ,\u5982\u679c\u672a\u5728\u4e8b\u4ef6\u4e2d\u6307\u5b9a,\u6216\u8005\u6a94\u5ba4\u4e0d\u5305\u542b\u4efb\u4f55\u4e8b\u4ef6,\u5247\u9810\u8a2d\u70ba 50\u3002 \u5728\u4efb\u4e00\u60c5\u6cc1\u4e0b\u5747\u9810\u8a2d\u70ba 0\u3002invite kick ban redact kick ban redact m.room.power_levels m.room.power_levels invite</p> <p>\u8afe\u7dad\u514b\u65af</p> <p>\u529f\u7387\u96fb\u5e73\u503c\u7684\u5141\u8a31\u7bc4\u570d\u70ba , \u6309\u7167\u898f\u7bc4 JSON \u898f\u7bc4\u7684\u8981\u6c42\u3002[-(253)+1, (253)-1]</p> <pre><code>{\n  \"content\": {\n    \"ban\": 50,\n    \"events\": {\n      \"m.room.name\": 100,\n      \"m.room.power_levels\": 100\n    },\n    \"events_default\": 0,\n    \"invite\": 50,\n    \"kick\": 50,\n    \"notifications\": {\n      \"room\": 20\n    },\n    \"redact\": 50,\n    \"state_default\": 50,\n    \"users\": {\n      \"@example:localhost\": 100\n    },\n    \"users_default\": 0\n  },\n  \"event_id\": \"$143273582443PhrSn:example.org\",\n  \"origin_server_ts\": 1432735824653,\n  \"room_id\": \"!jEsUZKDJdhlrceRyVU:example.org\",\n  \"sender\": \"@example:example.org\",\n  \"state_key\": \"\",\n  \"type\": \"m.room.power_levels\",\n  \"unsigned\": {\n    \"age\": 1234\n  }\n}\n</code></pre>"},{"location":"chat/client_server/#751","title":"7.5.1 \u6b77\u53f2\u4e8b\u4ef6","text":"<p>\u4f46\u662f,\u547d\u540d\u7a7a\u9593\u4e2d\u7684\u67d0\u4e9b\u4e8b\u4ef6\u53ef\u80fd\u6703\u51fa\u73fe\u5728\u804a\u5929\u5ba4\u4e2d \u5b83\u5011\u5728\u6b64\u7248\u672c\u7684\u898f\u7bc4\u4e2d\u6c92\u6709\u91cd\u8981\u610f\u7fa9\u3002 \u5b83\u5011\u662f:m.</p> <ul> <li>m.room.aliases</li> </ul> <p>\u8a72\u898f\u7bc4\u7684\u5148\u524d\u7248\u672c\u63d0\u4f9b\u4e86\u6709\u95dc\u9019\u4e9b\u7684\u66f4\u591a\u8cc7\u8a0a \u4e8b\u4ef6\u3002</p>"},{"location":"chat/client_server/#76","title":"7.6 \u540c\u6b65","text":"<p>\u82e5\u8981\u8b80\u53d6\u4e8b\u4ef6,\u9810\u671f\u7684\u64cd\u4f5c\u6d41\u662f\u7528\u6236\u7aef\u9996\u5148 \u8abf\u7528\u4e0d\u5e36\u53c3\u6578\u7684 /sync API\u3002\u9019\u5c07\u8fd4\u56de \u6bcf\u500b\u804a\u5929\u5ba4\u7684\u6700\u65b0\u6d88\u606f\u4e8b\u4ef6,\u4ee5\u53ca \u8fd4\u56de\u6642\u9593\u7dda\u958b\u982d\u7684\u623f\u9593\u3002\u56de\u61c9\u9084\u5305\u62ec\u4e00\u500b\u5b57\u6bb5,\u8a72\u5b57\u6bb5\u61c9\u5728\u4e0b\u6b21\u8abf\u7528 \u6642\u7528\u4f5c\u53c3\u6578\u7684\u503c\u3002\u6700\u5f8c,\u56de\u61c9\u5305\u62ec: \u5c0d\u65bc\u6bcf\u500b\u623f\u9593,\u4e00\u500b\u5b57\u6bb5,\u8a72\u5b57\u6bb5\u53ef\u4ee5\u4f5c\u70ba\u53c3\u6578\u50b3\u905e\u7d66 /rooms//messages API \u4ee5\u63d0\u524d\u6aa2\u7d22 \u6d88\u606f\u3002sincenext_batchsince/syncprev_batchstart <p>\u4f8b\u5982,\u4e00\u500b\u8acb\u6c42\u53ef\u80fd\u6703\u8fd4\u56de\u4e00\u500b\u7531\u56db\u500b\u4e8b\u4ef6\u7d44\u6210\u7684\u7bc4\u570d,\u4e26\u5728\u7d66\u5b9a\u7684\u623f\u9593\u5167,\u7701\u7565\u5169\u500b\u5148\u524d\u7684\u4e8b\u4ef6\u548c \u3002\u9019\u53ef\u4ee5\u53ef\u8996\u5316\u5982\u4e0b:/syncE2E3E4E5E0E1</p> <pre><code>    [E0]-&gt;[E1]-&gt;[E2]-&gt;[E3]-&gt;[E4]-&gt;[E5]\n               ^                      ^\n               |                      |\n         prev_batch: '1-2-3'        next_batch: 'a-b-c'\n</code></pre> <p>\u901a\u5e38,\u5ba2\u6236\u7aef\u53ef\u898b\u7684\u6240\u6709\u65b0\u4e8b\u4ef6\u90fd\u5c07\u51fa\u73fe\u5728 \u5c0d API \u7684\u56de\u61c9\u3002\u4f46\u662f,\u5982\u679c\u5927\u91cf\u4e8b\u4ef6 \u5728\u8abf\u7528 \u4e4b\u9593\u5230\u9054,\u8fd4\u56de'\u6709\u9650'\u6642\u9593\u7dda, \u50c5\u5305\u542b\u6700\u65b0\u7684\u6d88\u606f\u4e8b\u4ef6\u3002\u72c0\u614b\"delta\"\u4e5f\u662f \u8fd4\u56de,\u7e3d\u7d50\u7701\u7565\u90e8\u5206\u7684\u4efb\u4f55\u72c0\u614b\u66f4\u6539 \u6642\u9593\u8ef8\u3002\u56e0\u6b64,\u5ba2\u6236\u6700\u7d42\u53ef\u80fd\u6703\u5728\u5176\u77e5\u8b58\u4e0a\u51fa\u73fe\"\u5dee\u8ddd\" \u7684\u6d88\u606f\u6642\u9593\u7dda\u3002\u7528\u6236\u7aef\u53ef\u4ee5\u4f7f\u7528 /rooms//messages API \u586b\u5145\u9019\u4e9b\u7a7a\u767d\u3002/sync/sync <p>\u7e7c\u7e8c\u6211\u5011\u7684\u793a\u4f8b,\u5047\u8a2d\u6211\u5011\u767c\u51fa\u7b2c\u4e09\u500b\u8acb\u6c42,\u8981\u6c42 \u81ea\u4e0a\u6b21\u540c\u6b65\u4ee5\u4f86\u7684\u4e8b\u4ef6,\u901a\u904e\u5c07\u4ee4\u724c\u4f5c\u70ba \u53c3\u6578\u3002\u4f3a\u670d\u5668\u77e5\u9053\u56db\u500b\u65b0\u4e8b\u4ef6,, \u548c ,\u4f46\u8a8d\u70ba\u9019\u592a\u591a\u4e86,\u7121\u6cd5\u4e00\u6b21\u5831\u544a\u3002\u76f8\u53cd \u4f3a\u670d\u5668\u767c\u9001\u5305\u542b\u7684\u56de\u61c9,\u4e26\u4e14 \u7701\u7565\u3002\u9019\u5f62\u6210\u4e86\u4e00\u500b\u7f3a\u53e3,\u6211\u5011\u53ef\u4ee5\u5728\u53ef\u8996\u5316\u4e2d\u770b\u5230:/syncnext_batchx-y-zsinceE7E8E9E10limitedE8E9E10E7</p> <pre><code>                                            | gap |\n                                            | &lt;-&gt; |\n    [E0]-&gt;[E1]-&gt;[E2]-&gt;[E3]-&gt;[E4]-&gt;[E5]-&gt;[E6]-&gt;[E7]-&gt;[E8]-&gt;[E9]-&gt;[E10]\n                                            ^     ^                  ^\n                                            |     |                  |\n                                 since: 'x-y-z'   |                  |\n                                       prev_batch: 'd-e-f'       next_batch: 'u-v-w'\n</code></pre> <p>\u6709\u9650\u7684\u56de\u61c9\u5305\u62ec\u4e00\u500b\u72c0\u614b\u589e\u91cf,\u5b83\u63cf\u8ff0\u4e86\u72c0\u614b \u7684\u623f\u9593\u5728\u9593\u9699\u4e0a\u8b8a\u5316\u3002\u6b64\u589e\u91cf\u8aaa\u660e\u5982\u4f55\u69cb\u5efa\u72c0\u614b \u5728\u5f9e\u7528\u6236\u7aef\u77e5\u9053\u7684\u72c0\u614b\u8fd4\u56de\u6642\u9593\u7dda\uff08\u5373\u5728\uff09\u4e4b\u524d \uff08\u5373\u5728 \uff09\u3002\u70ba\u4e86\u7e2e\u5c0f\u5dee\u8ddd,\u5ba2\u6236\u7aef\u61c9\u8a72\u4f7f\u7528\u67e5\u8a62\u53c3\u6578\u548c \u5411 /rooms//messages \u767c\u51fa\u8acb\u6c42\u3002E7E6from=x-y-zto=d-e-f"},{"location":"chat/client_server/#get-_matrixclientv3sync","title":"GET /_matrix/client/v3/sync","text":"<p>\u5c07\u5ba2\u6236\u7aef\u7684\u72c0\u614b\u8207\u4f3a\u670d\u5668\u4e0a\u7684\u6700\u65b0\u72c0\u614b\u540c\u6b65\u3002 \u7528\u6236\u7aef\u5728\u9996\u6b21\u767b\u9304\u6642\u4f7f\u7528\u6b64 API \u4ee5\u7372\u53d6\u521d\u59cb\u5feb\u7167 \u7684\u72c0\u614b,\u7136\u5f8c\u7e7c\u7e8c\u8abf\u7528\u6b64 API \u7372\u53d6 \u589e\u91cf\u589e\u91cf\u5230\u72c0\u614b,\u4e26\u63a5\u6536\u65b0\u6d88\u606f\u3002</p> <p>\u6ce8\u610f:\u6b64\u7aef\u9ede\u652f\u63f4\u5ef6\u9072\u8f09\u5165\u3002\u6709\u95dc\u8a73\u7d30\u8cc7\u8a0a,\u8acb\u53c3\u95b1\u7be9\u9078\u3002\u5ef6\u9072\u8f09\u5165\u6210\u54e1\u50c5\u5728\u6b64\u7aef\u9ede\u4e0a\u53d7\u652f\u63f4\u3002\u555f\u7528\u5ef6\u9072\u8f09\u5165\u5f8c,\u4f3a\u670d\u5668\u5fc5\u9808\u5305\u62ec \u7576\u4f7f\u7528\u8005\u52a0\u5165\u804a\u5929\u5ba4\u6642\u540c\u6b65\u81ea\u5df1\u7684\u6210\u54e1\u8cc7\u683c\u4e8b\u4ef6,\u6216\u8005\u7576\u4f7f\u7528\u8005 \u8acb\u6c42\u623f\u9593\u7684\u5b8c\u6574\u72c0\u614b,\u4ee5\u5e6b\u52a9\u767c\u73fe\u7528\u6236\u7684\u982d\u50cf\u548c \u986f\u793a\u540d\u7a31\u3002StateFilter</p> <p>\u6b64\u5916,\u8207\u5176\u4ed6\u6703\u54e1\u4e00\u6a23,\u4f7f\u7528\u8005\u81ea\u5df1\u7684\u6703\u54e1\u6d3b\u52d5\u4e5f\u7b26\u5408\u689d\u4ef6 \u88ab\u4f3a\u670d\u5668\u8996\u70ba\u5197\u9918\u3002\u7576\u540c\u6b65\u70ba \u6642 , \u4f3a\u670d\u5668\u5fc5\u9808\u8fd4\u56de\u9593\u9699\u4e2d\u4e8b\u4ef6\u7684\u6210\u54e1\u8eab\u4efd\u4e8b\u4ef6 \uff08\u5728\u8fd4\u56de\u7684\u6642\u9593\u7dda\u4e4b\u9593\u548c\u958b\u59cb\u4e4b\u9593\uff09,\u7121\u8ad6 \u81f3\u65bc\u5b83\u5011\u662f\u5426\u662f\u591a\u9918\u7684\u3002\u9019\u53ef\u78ba\u4fdd\u9023\u63a5/\u96e2\u958b \u4e26\u4e14\u5728\u9593\u9699\u671f\u9593\u767c\u751f\u7684\u8f2a\u5ed3\u8b8a\u5316\u4e0d\u6703\u4e1f\u5931\u3002limitedsince</p> <p>\u8acb\u6ce8\u610f,\u7684\u9810\u8a2d\u884c\u70ba\u662f\u5305\u62ec\u6240\u6709\u6210\u54e1\u8cc7\u683c \u4e8b\u4ef6\u4ee5\u53ca\u5176\u4ed6\u72c0\u614b,\u7576\u672a\u555f\u7528\u5ef6\u9072\u8f09\u5165\u6642\u3002state</p> <p>200\u56de\u61c9</p> <pre><code>{\n  \"account_data\": {\n    \"events\": [\n      {\n        \"content\": {\n          \"custom_config_key\": \"custom_config_value\"\n        },\n        \"type\": \"org.example.custom.config\"\n      }\n    ]\n  },\n  \"next_batch\": \"s72595_4483_1934\",\n  \"presence\": {\n    \"events\": [\n      {\n        \"content\": {\n          \"avatar_url\": \"mxc://localhost/wefuiwegh8742w\",\n          \"currently_active\": false,\n          \"last_active_ago\": 2478593,\n          \"presence\": \"online\",\n          \"status_msg\": \"Making cupcakes\"\n        },\n        \"sender\": \"@example:localhost\",\n        \"type\": \"m.presence\"\n      }\n    ]\n  },\n  \"rooms\": {\n    \"invite\": {\n      \"!696r7674:example.com\": {\n        \"invite_state\": {\n          \"events\": [\n            {\n              \"content\": {\n                \"name\": \"My Room Name\"\n              },\n              \"sender\": \"@alice:example.com\",\n              \"state_key\": \"\",\n              \"type\": \"m.room.name\"\n            },\n            {\n              \"content\": {\n                \"membership\": \"invite\"\n              },\n              \"sender\": \"@alice:example.com\",\n              \"state_key\": \"@bob:example.com\",\n              \"type\": \"m.room.member\"\n            }\n          ]\n        }\n      }\n    },\n    \"join\": {\n      \"!726s6s6q:example.com\": {\n        \"account_data\": {\n          \"events\": [\n            {\n              \"content\": {\n                \"tags\": {\n                  \"u.work\": {\n                    \"order\": 0.9\n                  }\n                }\n              },\n              \"type\": \"m.tag\"\n            },\n            {\n              \"content\": {\n                \"custom_config_key\": \"custom_config_value\"\n              },\n              \"type\": \"org.example.custom.room.config\"\n            }\n          ]\n        },\n        \"ephemeral\": {\n          \"events\": [\n            {\n              \"content\": {\n                \"user_ids\": [\n                  \"@alice:matrix.org\",\n                  \"@bob:example.com\"\n                ]\n              },\n              \"type\": \"m.typing\"\n            },\n            {\n              \"content\": {\n                \"$1435641916114394fHBLK:matrix.org\": {\n                  \"m.read\": {\n                    \"@rikj:jki.re\": {\n                      \"ts\": 1436451550453\n                    }\n                  },\n                  \"m.read.private\": {\n                    \"@self:example.org\": {\n                      \"ts\": 1661384801651\n                    }\n                  }\n                }\n              },\n              \"type\": \"m.receipt\"\n            }\n          ]\n        },\n        \"state\": {\n          \"events\": [\n            {\n              \"content\": {\n                \"avatar_url\": \"mxc://example.org/SEsfnsuifSDFSSEF\",\n                \"displayname\": \"Alice Margatroid\",\n                \"membership\": \"join\",\n                \"reason\": \"Looking for support\"\n              },\n              \"event_id\": \"$143273582443PhrSn:example.org\",\n              \"origin_server_ts\": 1432735824653,\n              \"room_id\": \"!jEsUZKDJdhlrceRyVU:example.org\",\n              \"sender\": \"@example:example.org\",\n              \"state_key\": \"@alice:example.org\",\n              \"type\": \"m.room.member\",\n              \"unsigned\": {\n                \"age\": 1234\n              }\n            }\n          ]\n        },\n        \"summary\": {\n          \"m.heroes\": [\n            \"@alice:example.com\",\n            \"@bob:example.com\"\n          ],\n          \"m.invited_member_count\": 0,\n          \"m.joined_member_count\": 2\n        },\n        \"timeline\": {\n          \"events\": [\n            {\n              \"content\": {\n                \"avatar_url\": \"mxc://example.org/SEsfnsuifSDFSSEF\",\n                \"displayname\": \"Alice Margatroid\",\n                \"membership\": \"join\",\n                \"reason\": \"Looking for support\"\n              },\n              \"event_id\": \"$143273582443PhrSn:example.org\",\n              \"origin_server_ts\": 1432735824653,\n              \"room_id\": \"!jEsUZKDJdhlrceRyVU:example.org\",\n              \"sender\": \"@example:example.org\",\n              \"state_key\": \"@alice:example.org\",\n              \"type\": \"m.room.member\",\n              \"unsigned\": {\n                \"age\": 1234\n              }\n            },\n            {\n              \"content\": {\n                \"body\": \"This is an example text message\",\n                \"format\": \"org.matrix.custom.html\",\n                \"formatted_body\": \"&lt;b&gt;This is an example text message&lt;/b&gt;\",\n                \"msgtype\": \"m.text\"\n              },\n              \"event_id\": \"$143273582443PhrSn:example.org\",\n              \"origin_server_ts\": 1432735824653,\n              \"room_id\": \"!jEsUZKDJdhlrceRyVU:example.org\",\n              \"sender\": \"@example:example.org\",\n              \"type\": \"m.room.message\",\n              \"unsigned\": {\n                \"age\": 1234\n              }\n            }\n          ],\n          \"limited\": true,\n          \"prev_batch\": \"t34-23535_0_0\"\n        },\n        \"unread_notifications\": {\n          \"highlight_count\": 1,\n          \"notification_count\": 5\n        },\n        \"unread_thread_notifications\": {\n          \"$threadroot\": {\n            \"highlight_count\": 3,\n            \"notification_count\": 6\n          }\n        }\n      }\n    },\n    \"knock\": {\n      \"!223asd456:example.com\": {\n        \"knock_state\": {\n          \"events\": [\n            {\n              \"content\": {\n                \"name\": \"My Room Name\"\n              },\n              \"sender\": \"@alice:example.com\",\n              \"state_key\": \"\",\n              \"type\": \"m.room.name\"\n            },\n            {\n              \"content\": {\n                \"membership\": \"knock\"\n              },\n              \"sender\": \"@bob:example.com\",\n              \"state_key\": \"@bob:example.com\",\n              \"type\": \"m.room.member\"\n            }\n          ]\n        }\n      }\n    },\n    \"leave\": {}\n  }\n}\n</code></pre>"},{"location":"chat/client_server/#77","title":"7.7 \u7372\u53d6\u804a\u5929\u5ba4\u7684\u4e8b\u4ef6","text":"<p>\u70ba\u804a\u5929\u5ba4\u7684\u4e8b\u4ef6\u63d0\u4f9b\u4e86\u591a\u500b API:</p>"},{"location":"chat/client_server/#get-_matrixclientv3roomsroomideventeventid","title":"GET /_matrix/client/v3/rooms/{roomId}/event/{eventId}","text":"<p>\u7372\u53d6\u57fa\u65bc\u7684\u55ae\u500b\u4e8b\u4ef6\u3002\u60a8\u5fc5\u9808\u5177\u6709\u4ee5\u4e0b\u6b0a\u9650:\u6aa2\u7d22\u6b64\u4e8b\u4ef6,\u4f8b\u5982,\u901a\u904e\u6210\u70ba\u6b64\u4e8b\u4ef6\u623f\u9593\u4e2d\u7684\u6210\u54e1\u3002roomId/eventId</p> <pre><code>{\n  \"content\": {\n    \"body\": \"This is an example text message\",\n    \"format\": \"org.matrix.custom.html\",\n    \"formatted_body\": \"&lt;b&gt;This is an example text message&lt;/b&gt;\",\n    \"msgtype\": \"m.text\"\n  },\n  \"event_id\": \"$143273582443PhrSn:example.org\",\n  \"origin_server_ts\": 1432735824653,\n  \"room_id\": \"!636q39766251:matrix.org\",\n  \"sender\": \"@example:example.org\",\n  \"type\": \"m.room.message\",\n  \"unsigned\": {\n    \"age\": 1234\n  }\n}\n</code></pre>"},{"location":"chat/client_server/#get-_matrixclientv3roomsroomidjoined_members","title":"GET /_matrix/client/v3/rooms/{roomId}/joined_members","text":"<p>\u6b64 API \u5c07 MXID \u7684\u6620\u5c04\u8fd4\u56de\u5230\u804a\u5929\u5ba4\u6210\u54e1\u7684\u6210\u54e1\u4fe1\u606f\u7269\u4ef6\u3002\u7576\u524d\u7528\u6236\u5fc5\u9808\u5728\u804a\u5929\u5ba4\u4e2d\u624d\u80fd\u5de5\u4f5c,\u9664\u975e\u5b83\u662f\u61c9\u7528\u7a0b\u5f0f\u670d\u52d9,\u5728\u9019\u7a2e\u60c5\u6cc1\u4e0b,\u4efb\u4f55 AS \u7684\u4f7f\u7528\u8005\u90fd\u5fc5\u9808\u5728\u804a\u5929\u5ba4\u4e2d\u3002\u6b64 API \u4e3b\u8981\u7528\u65bc\u61c9\u7528\u7a0b\u5f0f\u670d\u52d9,\u56de\u61c9\u901f\u5ea6\u61c9\u5feb\u65bc\u5728\u4f3a\u670d\u5668\u4e0a\u66f4\u9ad8\u6548\u5730\u5be6\u73fe\u3002/members</p> <pre><code>{\n  \"joined\": {\n    \"@bar:example.com\": {\n      \"avatar_url\": \"mxc://riot.ovh/printErCATzZijQsSDWorRaK\",\n      \"display_name\": \"Bar\"\n    }\n  }\n}\n</code></pre>"},{"location":"chat/client_server/#get-_matrixclientv3roomsroomidmembers","title":"GET /_matrix/client/v3/rooms/{roomId}/members","text":"<p>\u7372\u53d6\u6b64\u6703\u8b70\u5ba4\u7684\u6210\u54e1\u6e05\u55ae\u3002</p> <pre><code>{\n  \"chunk\": [\n    {\n      \"content\": {\n        \"avatar_url\": \"mxc://example.org/SEsfnsuifSDFSSEF\",\n        \"displayname\": \"Alice Margatroid\",\n        \"membership\": \"join\",\n        \"reason\": \"Looking for support\"\n      },\n      \"event_id\": \"$143273582443PhrSn:example.org\",\n      \"origin_server_ts\": 1432735824653,\n      \"room_id\": \"!636q39766251:example.com\",\n      \"sender\": \"@example:example.org\",\n      \"state_key\": \"@alice:example.org\",\n      \"type\": \"m.room.member\",\n      \"unsigned\": {\n        \"age\": 1234\n      }\n    }\n  ]\n}\n</code></pre>"},{"location":"chat/client_server/#get-_matrixclientv3roomsroomidstate","title":"GET /_matrix/client/v3/rooms/{roomId}/state","text":"<p>\u7372\u53d6\u804a\u5929\u5ba4\u7576\u524d\u72c0\u614b\u7684\u72c0\u614b\u4e8b\u4ef6\u3002</p> <pre><code>[\n  {\n    \"content\": {\n      \"join_rule\": \"public\"\n    },\n    \"event_id\": \"$143273582443PhrSn:example.org\",\n    \"origin_server_ts\": 1432735824653,\n    \"room_id\": \"!636q39766251:example.com\",\n    \"sender\": \"@example:example.org\",\n    \"state_key\": \"\",\n    \"type\": \"m.room.join_rules\",\n    \"unsigned\": {\n      \"age\": 1234\n    }\n  },\n  {\n    \"content\": {\n      \"avatar_url\": \"mxc://example.org/SEsfnsuifSDFSSEF\",\n      \"displayname\": \"Alice Margatroid\",\n      \"membership\": \"join\",\n      \"reason\": \"Looking for support\"\n    },\n    \"event_id\": \"$143273582443PhrSn:example.org\",\n    \"origin_server_ts\": 1432735824653,\n    \"room_id\": \"!636q39766251:example.com\",\n    \"sender\": \"@example:example.org\",\n    \"state_key\": \"@alice:example.org\",\n    \"type\": \"m.room.member\",\n    \"unsigned\": {\n      \"age\": 1234\n    }\n  },\n  {\n    \"content\": {\n      \"creator\": \"@example:example.org\",\n      \"m.federate\": true,\n      \"predecessor\": {\n        \"event_id\": \"$something:example.org\",\n        \"room_id\": \"!oldroom:example.org\"\n      },\n      \"room_version\": \"1\"\n    },\n    \"event_id\": \"$143273582443PhrSn:example.org\",\n    \"origin_server_ts\": 1432735824653,\n    \"room_id\": \"!636q39766251:example.com\",\n    \"sender\": \"@example:example.org\",\n    \"state_key\": \"\",\n    \"type\": \"m.room.create\",\n    \"unsigned\": {\n      \"age\": 1234\n    }\n  },\n  {\n    \"content\": {\n      \"ban\": 50,\n      \"events\": {\n        \"m.room.name\": 100,\n        \"m.room.power_levels\": 100\n      },\n      \"events_default\": 0,\n      \"invite\": 50,\n      \"kick\": 50,\n      \"notifications\": {\n        \"room\": 20\n      },\n      \"redact\": 50,\n      \"state_default\": 50,\n      \"users\": {\n        \"@example:localhost\": 100\n      },\n      \"users_default\": 0\n    },\n    \"event_id\": \"$143273582443PhrSn:example.org\",\n    \"origin_server_ts\": 1432735824653,\n    \"room_id\": \"!636q39766251:example.com\",\n    \"sender\": \"@example:example.org\",\n    \"state_key\": \"\",\n    \"type\": \"m.room.power_levels\",\n    \"unsigned\": {\n      \"age\": 1234\n    }\n  }\n]\n</code></pre>"},{"location":"chat/client_server/#get-_matrixclientv3roomsroomidstateeventtypestatekey","title":"GET /_matrix/client/v3/rooms/{roomId}/state/{eventType}/{stateKey}","text":"<p>\u67e5\u627e\u6a94\u5ba4\u4e2d\u72c0\u614b\u4e8b\u4ef6\u7684\u5167\u5bb9\u3002\u5982\u679c\u4f7f\u7528\u8005\u662f \u52a0\u5165\u5230\u623f\u9593,\u7136\u5f8c\u72c0\u614b\u5f9e\u7576\u524d\u7372\u53d6 \u623f\u9593\u7684\u72c0\u614b\u3002\u5982\u679c\u7528\u6236\u5df2\u96e2\u958b\u623f\u9593,\u5247\u72c0\u614b\u70ba \u53d6\u81ea\u4ed6\u5011\u96e2\u958b\u6642\u7684\u623f\u9593\u72c0\u614b\u3002</p> <p>200 \u56de\u61c9</p> <pre><code>{\n  \"name\": \"Example room name\"\n}\n</code></pre>"},{"location":"chat/client_server/#get-_matrixclientv3roomsroomidmessages","title":"GET /_matrix/client/v3/rooms/{roomId}/messages","text":"<p>\u6b64 API \u8fd4\u56de\u804a\u5929\u5ba4\u7684\u6d88\u606f\u548c\u72c0\u614b\u4e8b\u4ef6\u6e05\u55ae\u3002\u5b83\u4f7f\u7528 \u5206\u9801\u67e5\u8a62\u53c3\u6578,\u7528\u65bc\u5c0d\u623f\u9593\u4e2d\u7684\u6b77\u53f2\u8a18\u9304\u9032\u884c\u5206\u9801\u3002</p> <p>\u6ce8:\u6b64\u7aef\u9ede\u652f\u63f4\u5ef6\u9072\u8f09\u5165\u6a94\u6848\u5ba4\u6210\u54e1\u4e8b\u4ef6\u3002\u6709\u95dc\u8a73\u7d30\u8cc7\u8a0a,\u8acb\u53c3\u95b1\u61f6\u60f0\u8f09\u5165\u5ba4\u6210\u54e1\u3002</p> <pre><code>{\n  \"chunk\": [\n    {\n      \"content\": {\n        \"body\": \"This is an example text message\",\n        \"format\": \"org.matrix.custom.html\",\n        \"formatted_body\": \"&lt;b&gt;This is an example text message&lt;/b&gt;\",\n        \"msgtype\": \"m.text\"\n      },\n      \"event_id\": \"$143273582443PhrSn:example.org\",\n      \"origin_server_ts\": 1432735824653,\n      \"room_id\": \"!636q39766251:example.com\",\n      \"sender\": \"@example:example.org\",\n      \"type\": \"m.room.message\",\n      \"unsigned\": {\n        \"age\": 1234\n      }\n    },\n    {\n      \"content\": {\n        \"name\": \"The room name\"\n      },\n      \"event_id\": \"$143273582443PhrSn:example.org\",\n      \"origin_server_ts\": 1432735824653,\n      \"room_id\": \"!636q39766251:example.com\",\n      \"sender\": \"@example:example.org\",\n      \"state_key\": \"\",\n      \"type\": \"m.room.name\",\n      \"unsigned\": {\n        \"age\": 1234\n      }\n    },\n    {\n      \"content\": {\n        \"body\": \"Gangnam Style\",\n        \"info\": {\n          \"duration\": 2140786,\n          \"h\": 320,\n          \"mimetype\": \"video/mp4\",\n          \"size\": 1563685,\n          \"thumbnail_info\": {\n            \"h\": 300,\n            \"mimetype\": \"image/jpeg\",\n            \"size\": 46144,\n            \"w\": 300\n          },\n          \"thumbnail_url\": \"mxc://example.org/FHyPlCeYUSFFxlgbQYZmoEoe\",\n          \"w\": 480\n        },\n        \"msgtype\": \"m.video\",\n        \"url\": \"mxc://example.org/a526eYUSFFxlgbQYZmo442\"\n      },\n      \"event_id\": \"$143273582443PhrSn:example.org\",\n      \"origin_server_ts\": 1432735824653,\n      \"room_id\": \"!636q39766251:example.com\",\n      \"sender\": \"@example:example.org\",\n      \"type\": \"m.room.message\",\n      \"unsigned\": {\n        \"age\": 1234\n      }\n    }\n  ],\n  \"end\": \"t47409-4357353_219380_26003_2265\",\n  \"start\": \"t47429-4392820_219380_26003_2265\"\n}\n</code></pre>"},{"location":"chat/client_server/#get-_matrixclientv1roomsroomidtimestamp_to_event","title":"GET /_matrix/client/v1/rooms/{roomId}/timestamp_to_event","text":"<p>v1.6 \u4e2d\u65b0\u589e</p> <p>\u7372\u53d6\u6700\u63a5\u8fd1\u7d66\u5b9a\u6642\u9593\u6233\u7684\u4e8b\u4ef6\u7684ID,\u5728 \u53c3\u6578\u6307\u5b9a\u7684\u65b9\u5411\u3002dir</p> <p>\u5982\u679c\u4f3a\u670d\u5668\u6c92\u6709\u6240\u6709\u623f\u9593\u6b77\u53f2\u8a18\u9304,\u4e26\u4e14\u6c92\u6709 \u9069\u7576\u63a5\u8fd1\u8acb\u6c42\u6642\u9593\u6233\u7684\u4e8b\u4ef6,\u5b83\u53ef\u4ee5\u4f7f\u7528 \u76f8\u61c9\u7684\u806f\u5408\u7d42\u7d50\u9ede,\u7528\u65bc\u5411\u5176\u4ed6\u4f3a\u670d\u5668\u8acb\u6c42\u5408\u9069\u7684\u4e8b\u4ef6\u3002</p> <p>\u8abf\u7528\u6b64\u7d42\u7d50\u9ede\u540e,\u7528\u6236\u7aef\u53ef\u4ee5\u8abf\u7528 /rooms/{roomId}/context/{eventId} \u4f86\u7372\u53d6\u5206\u9801\u4ee4\u724c,\u4ee5\u6aa2\u7d22\u8fd4\u56de\u4e8b\u4ef6\u5468\u570d\u7684\u4e8b\u4ef6\u3002</p> <p>\u6b64\u7d42\u7d50\u9ede\u8fd4\u56de\u7684\u4e8b\u4ef6\u53ef\u80fd\u662f\u7528\u6236\u7aef\u8fd4\u56de\u7684\u4e8b\u4ef6 \u7121\u6cd5\u5448\u73fe,\u56e0\u6b64\u53ef\u80fd\u9700\u8981\u5206\u9801\u624d\u80fd\u627e\u5230\u4e8b\u4ef6 \u5b83\u53ef\u4ee5\u986f\u793a,\u6700\u7d42\u53ef\u80fd\u6703\u8d85\u51fa\u7528\u6236\u7aef\u7684 \u5408\u9069\u7684\u7bc4\u570d\u3002\u5ba2\u6236\u53ef\u4ee5\u63a1\u7528\u4e0d\u540c\u7684\u7b56\u7565\u4f86\u5c55\u793a \u5c0d\u7528\u6236\u4f86\u8aaa\u5408\u7406\u7684\u6771\u897f\u3002\u4f8b\u5982,\u7528\u6236\u7aef\u53ef\u4ee5\u5617\u8a66 \u671d\u4e00\u500b\u65b9\u5411\u5206\u9801\u4e00\u6703\u5152,\u540c\u6642\u770b\u8457 \u5b83\u6b63\u5728\u5206\u9801\u7684\u4e8b\u4ef6\u7684\u6642\u9593\u6233,\u4ee5\u53ca\u5b83\u662f\u5426 \u8d85\u904e\u8207\u76ee\u6a19\u6642\u9593\u6233\u7684\u4e00\u5b9a\u5dee\u7570,\u53ef\u4ee5\u5617\u8a66 \u4ee5\u76f8\u53cd\u7684\u65b9\u5411\u5206\u9801\u3002\u5ba2\u6236\u4e5f\u53ef\u4ee5\u7c21\u55ae\u5730 \u5728\u4e00\u500b\u65b9\u5411\u4e0a\u5206\u9801,\u4e26\u901a\u77e5\u4f7f\u7528\u8005\u6700\u8fd1\u7684\u4e8b\u4ef6 \u5728\u8a72\u65b9\u5411\u4e0a\u767c\u73fe\u8d85\u51fa\u4e86\u9810\u671f\u7bc4\u570d\u3002</p> <pre><code>{\n  \"event_id\": \"$143273582443PhrSn:example.org\",\n  \"origin_server_ts\": 1432735824653\n}\n</code></pre>"},{"location":"chat/client_server/#78","title":"7.8 \u5c07\u4e8b\u4ef6\u767c\u9001\u5230\u804a\u5929\u5ba4","text":"<p>\u5982\u679c\u67d0\u4e9b\u4e8b\u4ef6\u8207\u53e6\u4e00\u500b\u4e8b\u4ef6\u76f8\u95dc,\u5247\u4f3a\u670d\u5668\u53ef\u80fd\u9700\u8981\u5c0d\u5176\u9032\u884c\u5f8c\u8655\u7406\u3002\u8a72\u6d3b\u52d5\u7684 \u95dc\u4fc2\u985e\u578b \uff08\uff09 \u78ba\u5b9a\u53ef\u80fd\u9069\u7528\u7684\u4efb\u4f55\u9650\u5236, \u4f8b\u5982,\u4f7f\u7528\u8005\u53ea\u80fd\u767c\u9001\u4e00\u500b\u7d66\u5b9a\u985e\u578b\u7684\u4e8b\u4ef6 \u5230\u53e6\u4e00\u500b\u3002rel_type</p>"},{"location":"chat/client_server/#put-_matrixclientv3roomsroomidstateeventtypestatekey","title":"PUT /_matrix/client/v3/rooms/{roomId}/state/{eventType}/{stateKey}","text":"<p>\u53ef\u4ee5\u4f7f\u7528\u6b64\u7d42\u7d50\u9ede\u767c\u9001\u72c0\u614b\u4e8b\u4ef6\u3002\u9019\u4e9b\u4e8b\u4ef6\u5c07\u662f \u8986\u84cb if \u548c\u6240\u6709 \u706b\u67f4\u3002 <p>\u5c0d\u6b64\u7aef\u9ede\u7684\u8acb\u6c42\u4e0d\u80fd\u50cf\u5176\u4ed6\u8def\u5f91\u4e00\u6a23\u4f7f\u7528\u4e8b\u52d9 ID,\u56e0\u70ba\u5b83\u5011\u7121\u6cd5\u8207 .\u6b64\u5916,\u5728\u72c0\u614b\u8def\u5f91\u4e0a\u4e0d\u53d7\u652f\u63f4\u3002PUTstate_keyPOST</p> <p>\u8acb\u6c42\u7684\u6b63\u6587\u61c9\u8a72\u662f\u4e8b\u4ef6\u7684\u5167\u5bb9\u7269\u4ef6;\u9019 \u6b64\u7269\u4ef6\u4e2d\u7684\u6b04\u4f4d\u5c07\u6839\u64da\u4e8b\u4ef6\u985e\u578b\u800c\u6709\u6240\u4e0d\u540c\u3002\u6709\u95dc\u6d3b\u52d5\u898f\u7bc4,\u8acb\u53c3\u95b1\u6703\u8b70\u5ba4\u6d3b\u52d5\u3002m.</p> <p>\u5982\u679c\u8981\u767c\u9001\u7684\u4e8b\u4ef6\u985e\u578b\u662f\u4f3a\u670d\u5668 \u61c9\u78ba\u4fdd\u4e8b\u4ef6\u4e2d\u5217\u51fa\u7684\u4efb\u4f55\u65b0\u5225\u540d\u90fd\u6709\u6548 \u6839\u64da\u4ed6\u5011\u7684\u8a9e\u6cd5/\u53e5\u6cd5,\u4e26\u4e14\u4ed6\u5011\u6307\u5411\u623f\u9593ID\u5176\u4e2d \u5c07\u767c\u9001\u72c0\u614b\u4e8b\u4ef6\u3002\u4f3a\u670d\u5668\u4e0d\u9a57\u8b49\u5225\u540d \u6b63\u5728\u522a\u9664\u6216\u5df2\u5b58\u5728\u65bc\u72c0\u614b\u4e8b\u4ef6\u4e2d\u3002m.room.canonical_alias</p> <p>\u8acb\u6c42\u6b63\u6587\u793a\u4f8b</p> <pre><code>{\n  \"avatar_url\": \"mxc://localhost/SEsfnsuifSDFSSEF\",\n  \"displayname\": \"Alice Margatroid\",\n  \"membership\": \"join\"\n}\n</code></pre> <p>200\u56de\u61c9</p> <pre><code>{\n  \"event_id\": \"$YUwRidLecu:example.com\"\n}\n</code></pre>"},{"location":"chat/client_server/#put-_matrixclientv3roomsroomidsendeventtypetxnid","title":"PUT /_matrix/client/v3/rooms/{roomId}/send/{eventType}/{txnId}","text":"<p>\u6b64\u7d42\u7d50\u9ede\u7528\u65bc\u5c07\u6d88\u606f\u4e8b\u4ef6\u767c\u9001\u5230\u804a\u5929\u5ba4\u3002\u6d88\u606f\u4e8b\u4ef6 \u5141\u8a31\u8a2a\u554f\u6b77\u53f2\u4e8b\u4ef6\u548c\u5206\u9801,\u4f7f\u5176\u9069\u5408 \u7528\u65bc\u623f\u9593\u5167\u7684'\u4e00\u6b21\u6027'\u6d3b\u52d5\u3002</p> <p>\u8acb\u6c42\u7684\u6b63\u6587\u61c9\u8a72\u662f\u4e8b\u4ef6\u7684\u5167\u5bb9\u7269\u4ef6;\u9019 \u6b64\u7269\u4ef6\u4e2d\u7684\u6b04\u4f4d\u5c07\u6839\u64da\u4e8b\u4ef6\u985e\u578b\u800c\u6709\u6240\u4e0d\u540c\u3002\u6709\u95dc m. \u4e8b\u4ef6\u898f\u7bc4,\u8acb\u53c3\u95b1\u6703\u8b70\u5ba4\u4e8b\u4ef6\u3002</p> <p>\u8acb\u6c42\u6b63\u6587\u793a\u4f8b</p> <pre><code>{\n  \"body\": \"hello\",\n  \"msgtype\": \"m.text\"\n}\n</code></pre> <p>200 \u56de\u61c9</p> <pre><code>{\n  \"event_id\": \"$YUwRidLecu:example.com\"\n}\n</code></pre>"},{"location":"chat/client_server/#79","title":"7.9 \u5bc6\u6587","text":"<p>\u7531\u65bc\u4e8b\u4ef6\u662f\u53ef\u64f4\u5c55\u7684,\u56e0\u6b64\u60e1\u610f\u4f7f\u7528\u8005\u548c/\u6216 \u4f3a\u670d\u5668,\u7528\u65bc\u6dfb\u52a0\u8af8\u5982\u653b\u64ca\u6027\u6216\u975e\u6cd5\u7684\u5bc6\u9470\u3002\u56e0\u70ba \u6709\u4e9b\u4e8b\u4ef6\u4e0d\u80fd\u7c21\u55ae\u5730\u522a\u9664,\u4f8b\u5982\u6703\u54e1\u6d3b\u52d5,\u6211\u5011\u53d6\u800c\u4ee3\u4e4b\u7684\u662f \"\u7de8\u8f2f\"\u4e8b\u4ef6\u3002\u9019\u6d89\u53ca\u5f9e\u4e8b\u4ef6\u4e2d\u522a\u9664\u6240\u6709\u9375 \u5354\u5b9a\u4e0d\u9700\u8981\u3002\u6b64\u5f8c,\u6b64\u7cbe\u7c21\u4e8b\u4ef6 \u6bcf\u7576\u5ba2\u6236\u7aef\u6216\u9060\u7aef\u4f3a\u670d\u5668\u8acb\u6c42\u5b83\u6642\u8fd4\u56de\u3002\u7de8\u8f2f\u4e00\u500b \u4e8b\u4ef6\u7121\u6cd5\u64a4\u92b7,\u5141\u8a31\u4f3a\u670d\u5668\u64c1\u6709\u8005\u522a\u9664\u6709\u554f\u984c\u7684 \u8cc7\u6599\u5eab\u4e2d\u7684\u5167\u5bb9\u3002\u4f3a\u670d\u5668\u61c9\u5728\u5411\u7528\u6236\u7aef\u63d0\u4f9b\u7d93\u904e\u7de8\u8f2f\u7684\u4e8b\u4ef6\u6642\u5728 as \u4e0b\u5305\u542b\u4e8b\u4ef6\u7684\u526f\u672c\u3002m.room.redactionunsignedredacted_because</p> <p>\u5728\u623f\u9593\u4e2d\u5b9a\u7fa9\u8981\u61c9\u7528\u65bc\u4e8b\u4ef6\u7684\u78ba\u5207\u6f14\u7b97\u6cd5 \u7248\u672c\u898f\u7bc4,\u4ee5\u53ca\u4e3b\u4f3a\u670d\u5668\u61c9\u9075\u5faa\u7684\u6a19\u6e96 \u5728\u6c7a\u5b9a\u662f\u5426\u63a5\u53d7\u4f86\u81ea\u9060\u7aef\u7684\u7de8\u6821\u4e8b\u4ef6\u6642\u4f7f\u7528 \u4e3b\u4f3a\u670d\u5668\u3002</p> <p>\u7576\u7528\u6236\u7aef\u6536\u5230\u4e8b\u4ef6\u6642,\u5b83\u61c9\u8a72\u66f4\u6539 \u53d7\u5f71\u97ff\u7684\u4e8b\u4ef6\u8207\u4f3a\u670d\u5668\u76f8\u540c\u3002m.room.redaction</p>"},{"location":"chat/client_server/#791","title":"7.9.1 \u4e8b\u4ef6","text":""},{"location":"chat/client_server/#mroomredaction","title":"m.room.redaction","text":"<p>\u6b64\u4e8b\u4ef6\u7531\u4f3a\u670d\u5668\u5275\u5efa,\u7528\u65bc\u63cf\u8ff0\u5df2\u7de8\u8f2f\u7684\u4e8b\u4ef6,\u7531\u8ab0\u7de8\u8f2f\u4ee5\u53ca\uff08\u53ef\u9078\uff09\u539f\u56e0\u3002\u5df2\u7de8\u8f2f\u7684\u4e8b\u4ef6\u5728\u4e8b\u4ef6\u7d1a\u5225\u9375\u4e2d\u6307\u5b9a\u3002\u7de8\u8f2f\u4e8b\u4ef6\u610f\u5473\u8457\u5354\u5b9a\u4e0d\u9700\u8981\u7684\u6240\u6709\u5bc6\u9470\u90fd\u6703\u88ab\u525d\u96e2,\u5f9e\u800c\u5141\u8a31\u96b1\u85cf\u6d88\u606f\u6216\u5141\u8a31\u7ba1\u7406\u54e1\u522a\u9664\u5192\u72af\u6027\u6216\u975e\u6cd5\u5167\u5bb9\u3002redacts</p> <pre><code>{\n  \"content\": {\n    \"reason\": \"Spamming\"\n  },\n  \"event_id\": \"$143273582443PhrSn:example.org\",\n  \"origin_server_ts\": 1432735824653,\n  \"redacts\": \"$fukweghifu23:localhost\",\n  \"room_id\": \"!jEsUZKDJdhlrceRyVU:example.org\",\n  \"sender\": \"@example:example.org\",\n  \"type\": \"m.room.redaction\",\n  \"unsigned\": {\n    \"age\": 1234\n  }\n}\n</code></pre>"},{"location":"chat/client_server/#792","title":"7.9.2 \u5ba2\u6236\u7aef\u884c\u70ba","text":""},{"location":"chat/client_server/#put-_matrixclientv3roomsroomidredacteventidtxnid","title":"PUT /_matrix/client/v3/rooms/{roomId}/redact/{eventId}/{txnId}","text":"<p>\u5f9e\u5c0d \u804a\u5929\u5ba4\u7684\u4f3a\u670d\u5668\u7aef\u8868\u793a\u5f62\u5f0f\u7684\u5b8c\u6574\u6027\u3002</p> <p>\u9019\u662f\u7121\u6cd5\u64a4\u92b7\u7684\u3002</p> <p>\u4efb\u4f55\u529f\u7387\u7d1a\u5225\u5927\u65bc\u6216\u7b49\u65bc\u4e8b\u4ef6\u529f\u7387\u7d1a\u5225\u7684\u4f7f\u7528\u8005\u90fd\u53ef\u4ee5\u5728\u804a\u5929\u5ba4\u4e2d\u767c\u9001\u5bc6\u6587\u4e8b\u4ef6\u3002\u5982\u679c\u7528\u6236\u7684\u96fb\u6e90 \u96fb\u5e73\u5927\u65bc\u4e5f\u5927\u65bc\u6216\u7b49\u65bc\u529f\u7387\u96fb\u5e73 ,\u7528\u6236\u53ef\u4ee5\u7de8\u8f2f\u5176\u4ed6\u7528\u6236\u767c\u9001\u7684\u4e8b\u4ef6\u3002m.room.redactionredact</p> <p>\u4f3a\u670d\u5668\u7ba1\u7406\u54e1\u53ef\u4ee5\u7de8\u8f2f\u4f7f\u7528\u8005\u5728\u5176\u4f3a\u670d\u5668\u4e0a\u767c\u9001\u7684\u4e8b\u4ef6\u3002</p> <p>\u8acb\u6c42\u6b63\u6587\u793a\u4f8b</p> <pre><code>{\n  \"reason\": \"Indecent material\"\n}\n</code></pre> <p>200 \u56de\u61c9</p> <pre><code>{\n  \"event_id\": \"$YUwQidLecu:example.com\"\n}\n</code></pre>"},{"location":"chat/client_server/#710","title":"7.10 \u5728\u4e8b\u4ef6\u4e4b\u9593\u5f62\u6210\u95dc\u4fc2","text":"<p>\u5728\u67d0\u4e9b\u60c5\u6cc1\u4e0b,\u6700\u597d\u5728\u908f\u8f2f\u4e0a\u5c07\u4e00\u500b\u4e8b\u4ef6\u7684\u5167\u5bb9\u8207 \u53e6\u4e00\u500b\u4e8b\u4ef6\u7684\u5167\u5bb9 \u2014 \u4f8b\u5982,\u5728\u56de\u5fa9\u6d88\u606f\u6642,\u7de8\u8f2f \u4e8b\u4ef6,\u6216\u8005\u53ea\u662f\u5e0c\u671b\u70ba\u4e8b\u4ef6\u7684\u76ee\u7684\u6dfb\u52a0\u4e0a\u4e0b\u6587\u3002</p> <p>\u4e8b\u4ef6\u5728\u7236/\u5b50\u7d50\u69cb\u4e2d\u76f8\u4e92\u95dc\u806f,\u5176\u4e2d\u4efb\u4f55\u4e8b\u4ef6\u90fd\u53ef\u4ee5 \u901a\u904e\u7c21\u55ae\u5730\u8b93\u4e00\u500b\u5b69\u5b50\u4e8b\u4ef6\u9ede\u6210\u70ba\u7236\u6bcd\u3002\u7236\u4e8b\u4ef6\u4e0d \u5b9a\u7fa9\u4ed6\u5011\u7684\u5b69\u5b50,\u800c\u4e0d\u662f\u4f9d\u9760\u5b69\u5b50\u4f86\u63cf\u8ff0\u4ed6\u5011\u7684\u7236\u6bcd\u3002</p> <p>\u5b50\u4e8b\u4ef6\u8207\u5176\u7236\u4e8b\u4ef6\u4e4b\u9593\u7684\u95dc\u4fc2\u5728\u5b50\u4e8b\u4ef6\u4e2d\u63cf\u8ff0 \u4e8b\u4ef6\u70ba\uff08\u5b9a\u7fa9\u5982\u4e0b\uff09\u3002\u5b50\u4e8b\u4ef6\u53ef\u4ee5\u6307\u5411 \u4efb\u4f55\u5176\u4ed6\u4e8b\u4ef6,\u5305\u62ec\u53e6\u4e00\u500b\u5b50\u4e8b\u4ef6,\u4ee5\u5efa\u7acb\u5982\u6b64\u9577\u6642\u9593\u7684\u95dc\u4fc2 \u7531\u65bc\u5169\u500b\u6d3b\u52d5\u90fd\u5728\u540c\u4e00\u500b\u623f\u9593\u5167,\u4f46\u662f\u53ef\u80fd\u6703\u65bd\u52a0\u984d\u5916\u7684\u9650\u5236 \u6309\u95dc\u4fc2\u7684\u985e\u578b \uff08\uff09\u3002contentm.relates_torel_type</p> <p>\u82e5\u8981\u5141\u8a31\u4f3a\u670d\u5668\u805a\u5408\u548c\u67e5\u627e\u7236\u4e8b\u4ef6\u7684\u5b50\u4e8b\u4ef6,\u4e8b\u4ef6\u7684\u9375\u5fc5\u9808\u5305\u542b\u5728\u4e8b\u4ef6\u7684\u660e\u6587\u90e8\u5206\u4e2d\u3002\u5b83\u4e0d\u53ef\u80fd \u4ee5\u7368\u4f54\u65b9\u5f0f\u8a18\u9304\u5728\u52a0\u5bc6\u7684\u6709\u6548\u8ca0\u8f09\u4e2d,\u56e0\u70ba\u4f3a\u670d\u5668\u7121\u6cd5\u89e3\u5bc6\u4e8b\u4ef6 \u7528\u65bc\u8655\u7406\u3002m.relates_to</p> <p>\u8207\u67b6\u69cb\u4e0d\u5339\u914d\u6216\u9055\u53cd\u95dc\u4fc2\u898f\u5247\u7684\u95dc\u4fc2, \u53ea\u662f\u88ab\u5ffd\u7565\u4e86\u3002\u4e00\u500b\u4f8b\u5b50\u53ef\u80fd\u662f\u7236\u9805\u548c\u5b50\u9805\u8655\u65bc\u4e0d\u540c\u7684\u4f4d\u7f6e \u623f\u9593,\u6216\u4ee5\u4e0b\u67b6\u69cb\u6240\u9700\u7684\u7f3a\u5c11\u5c6c\u6027\u7684\u95dc\u4fc2\u3002\u5ba2\u6236 \u8655\u7406\u6b64\u985e\u7121\u6548\u95dc\u4fc2\u61c9\u7368\u7acb\u65bc\u6bcf\u500b\u4e8b\u4ef6\u986f\u793a\u4e8b\u4ef6 \u5176\u4ed6,\u53ef\u9078\u53d6\u7684\u986f\u793a\u932f\u8aa4\u8a0a\u606f\u3002</p>"},{"location":"chat/client_server/#mrelates_to","title":"m.relates_to","text":"<pre><code>{\n  \"m.relates_to\": {\n    \"event_id\": \"$an_event\",\n    \"rel_type\": \"org.example.relationship\"\n  }\n}\n</code></pre>"},{"location":"chat/client_server/#7101","title":"7.10.1 \u95dc\u4fc2\u985e\u578b","text":"<p>\u9019\u500b\u898f\u7bc4\u63cf\u8ff0\u4ee5\u4e0b\u95dc\u4fc2\u985e\u578b:</p> <ul> <li>Event replacements.</li> <li>Event annotations.</li> <li>Threads.</li> <li>References</li> </ul>"},{"location":"chat/client_server/#7102","title":"7.10.2 \u5b50\u4e8b\u4ef6\u7684\u805a\u5408","text":"<p>\u67d0\u4e9b\u5b50\u4e8b\u4ef6\u53ef\u4ee5\u7531\u4f3a\u670d\u5668'\u805a\u5408',\u5177\u9ad4\u53d6\u6c7a\u65bc\u5b83\u5011\u7684 .\u9019\u53ef\u4ee5\u5141\u8a31\u5c07\u4e00\u7d44\u5b50\u4e8b\u4ef6\u532f\u7e3d\u5230\u7528\u6236\u7aef,\u800c\u7121\u9700 \u9700\u8981\u5b50\u4e8b\u4ef6\u672c\u8eab\u7684\u7528\u6236\u7aef\u3002rel_type</p> <p>\u9019\u65b9\u9762\u7684\u4e00\u500b\u4f8b\u5b50\u53ef\u80fd\u662f a \u9700\u8981\u4e00\u500b\u984d\u5916\u7684\u6b04\u4f4d,\u7576 \u9069\u7576\u6307\u5b9a,\u5c07\u610f\u5473\u8457\u7528\u6236\u7aef\u6536\u5230\u8a72\u6578\u5b57\u7684\u7e3d\u6578 \u5b50\u4e8b\u4ef6\u4f7f\u7528\u7684\u6b21\u6578\u3002rel_typekeykey</p> <p>\u5be6\u969b\u7684\u805a\u5408\u683c\u5f0f\u53d6\u6c7a\u65bc .rel_type</p> <p>\u7576\u901a\u904e\u4e0b\u9762\u5217\u51fa\u7684 API \u5c07\u4e8b\u4ef6\u63d0\u4f9b\u7d66\u7528\u6236\u7aef\u6642,\u5982\u679c\u4e8b\u4ef6\u5177\u6709\u5b50\u7d1a,\u5247\u5728'\u5982\u679c\u4e8b\u4ef6\u5177\u6709\u5b50\u9805'\u4e0b\u5c07\u5305\u542b\u4e00\u500b\u5c6c\u6027 \u53ef\u4ee5\u805a\u5408\u4f75\u6307\u5411\u5b83\u7684\u4e8b\u4ef6\u3002\u8a72\u7269\u696d\u662f \u7531\u548c\u503c\u70ba\u9375\u7684\u7269\u4ef6\u662f\u7279\u5b9a\u65bc\u985e\u578b\u7684\u805a\u5408 \u683c\u5f0f.\u6b64\u5c6c\u6027\u7a31\u70ba'\u6346\u7d81'\u3002 \u805a\u5408\" \u3002m.relationsunsignedm.relationsrel_typerel_typem.relations</p> <p>\u4f8b\u5982\uff08\u4e0d\u5305\u62ec\u4e0d\u91cd\u8981\u7684\u6b04\u4f4d\uff09:</p> <pre><code>{\n  \"event_id\": \"$my_event\",\n  \"unsigned\": {\n    \"m.relations\": {\n      \"org.example.possible_annotations\": [\n        {\n          \"key\": \"\ud83d\udc4d\",\n          \"origin_server_ts\": 1562763768320,\n          \"count\": 3\n        },\n        {\n          \"key\": \"\ud83d\udc4e\",\n          \"origin_server_ts\": 1562763768320,\n          \"count\": 1\n        }\n      ],\n      \"org.example.possible_thread\": {\n        \"current_server_participated\": true,\n        \"count\": 7,\n        \"latest_event\": {\n          \"event_id\": \"$another_event\",\n          \"content\": {\n            \"body\": \"Hello world\"\n          }\n        }\n      }\n    }\n  }\n}\n</code></pre>"},{"location":"chat/client_server/#7103","title":"7.10.3 \u95dc\u4fc2\u4ecb\u9762","text":"<p>\u82e5\u8981\u5f9e\u4f3a\u670d\u5668\u6aa2\u7d22\u7236\u9805\u7684\u5b50\u4e8b\u4ef6,\u7528\u6236\u7aef\u53ef\u4ee5\u8abf\u7528 \u4ee5\u4e0b\u7aef\u9ede\u3002</p> <p>\u5982\u679c\u5ba2\u6236\u7aef\u4e1f\u5931\u4e86\u805a\u5408\u4e0a\u7684\u4e0a\u4e0b\u6587,\u5247\u6b64\u7d42\u7d50\u9ede\u7279\u5225\u6709\u7528 \u7236\u4e8b\u4ef6,\u9700\u8981\u91cd\u65b0\u751f\u6210/\u9a57\u8b49\u5b83\u3002</p>"},{"location":"chat/client_server/#get-_matrixclientv1roomsroomidrelationseventid","title":"GET /_matrix/client/v1/rooms/{roomId}/relations/{eventId}","text":"<p>\u6aa2\u7d22\u7d66\u5b9a\u7236\u4e8b\u4ef6\u7684\u6240\u6709\u5b50\u4e8b\u4ef6\u3002</p> <p>\u8acb\u6ce8\u610f,\u5206\u9801\u6642,\u4ee4\u724c\u61c9\"\u5728\"\u4ee4\u724c\u4e4b\u5f8c \u62d3\u64b2\u6392\u5e8f\u8853\u8a9e,\u56e0\u70ba\u53ea\u80fd'\u5411\u5f8c'\u5206\u9801 \u901a\u904e\u4e8b\u4ef6,\u5f9e \u958b\u59cb\u3002fromtofrom</p> <p>\u4f8b\u5982,\u5f9e\u7d50\u679c\u7684\u7b2c 2 \u9801\u50b3\u905e\u4ee4\u724c,\u4ee5\u53ca\u4e00\u500b\u4ee4\u724c \u5f9e\u7b2c 1 \u9801\u958b\u59cb,\u5c07\u8fd4\u56de\u7a7a\u96c6\u3002\u8abf\u7528\u65b9\u53ef\u4ee5\u4f7f\u7528\u4f86\u81ea \u4f46\u662f,\u7b2c 1 \u9801\u548c\u7b2c 2 \u9801\u4e2d\u7684\u6a19\u8a18\u5c07\u5728\u540c\u4e00\u7bc4\u570d\u5167\u9032\u884c\u5206\u9801\u3002fromtofromto</p> <pre><code>{\n  \"chunk\": [\n    {\n      \"content\": {\n        \"m.relates_to\": {\n          \"event_id\": \"$asfDuShaf7Gafaw\",\n          \"rel_type\": \"org.example.my_relation\"\n        }\n      },\n      \"event_id\": \"$143273582443PhrSn:example.org\",\n      \"origin_server_ts\": 1432735824653,\n      \"room_id\": \"!636q39766251:matrix.org\",\n      \"sender\": \"@example:example.org\",\n      \"type\": \"m.room.message\",\n      \"unsigned\": {\n        \"age\": 1234\n      }\n    }\n  ],\n  \"next_batch\": \"page2_token\",\n  \"prev_batch\": \"page1_token\"\n}\n</code></pre>"},{"location":"chat/client_server/#get-_matrixclientv1roomsroomidrelationseventidreltype","title":"GET /_matrix/client/v1/rooms/{roomId}/relations/{eventId}/{relType}","text":"<p>\u6aa2\u7d22\u7d66\u5b9a\u7236\u4e8b\u4ef6\u8207\u7236\u4e8b\u4ef6\u76f8\u95dc\u7684\u6240\u6709\u5b50\u4e8b\u4ef6 \u4f7f\u7528\u7d66\u5b9a\u7684 .relType</p> <p>\u8acb\u6ce8\u610f,\u5206\u9801\u6642,\u4ee4\u724c\u61c9\"\u5728\"\u4ee4\u724c\u4e4b\u5f8c \u62d3\u64b2\u6392\u5e8f\u8853\u8a9e,\u56e0\u70ba\u53ea\u80fd'\u5411\u5f8c'\u5206\u9801 \u901a\u904e\u4e8b\u4ef6,\u5f9e \u958b\u59cb\u3002fromtofrom</p> <p>\u4f8b\u5982,\u5f9e\u7d50\u679c\u7684\u7b2c 2 \u9801\u50b3\u905e\u4ee4\u724c,\u4ee5\u53ca\u4e00\u500b\u4ee4\u724c \u5f9e\u7b2c 1 \u9801\u958b\u59cb,\u5c07\u8fd4\u56de\u7a7a\u96c6\u3002\u8abf\u7528\u65b9\u53ef\u4ee5\u4f7f\u7528\u4f86\u81ea \u4f46\u662f,\u7b2c 1 \u9801\u548c\u7b2c 2 \u9801\u4e2d\u7684\u6a19\u8a18\u5c07\u5728\u540c\u4e00\u7bc4\u570d\u5167\u9032\u884c\u5206\u9801\u3002fromtofromto</p> <pre><code>{\n  \"chunk\": [\n    {\n      \"content\": {\n        \"m.relates_to\": {\n          \"event_id\": \"$asfDuShaf7Gafaw\",\n          \"rel_type\": \"org.example.my_relation\"\n        }\n      },\n      \"event_id\": \"$143273582443PhrSn:example.org\",\n      \"origin_server_ts\": 1432735824653,\n      \"room_id\": \"!636q39766251:matrix.org\",\n      \"sender\": \"@example:example.org\",\n      \"type\": \"m.room.message\",\n      \"unsigned\": {\n        \"age\": 1234\n      }\n    }\n  ],\n  \"next_batch\": \"page2_token\",\n  \"prev_batch\": \"page1_token\"\n}\n</code></pre>"},{"location":"chat/client_server/#get-_matrixclientv1roomsroomidrelationseventidreltypeeventtype","title":"GET /_matrix/client/v1/rooms/{roomId}/relations/{eventId}/{relType}/{eventType}","text":"<p>\u6aa2\u7d22\u7d66\u5b9a\u7236\u4e8b\u4ef6\u8207\u7236\u4e8b\u4ef6\u76f8\u95dc\u7684\u6240\u6709\u5b50\u4e8b\u4ef6 \u4f7f\u7528\u7d66\u5b9a\u7684\u4e26\u64c1\u6709\u7d66\u5b9a\u7684.relTypeeventType</p> <p>\u8acb\u6ce8\u610f,\u5206\u9801\u6642,\u4ee4\u724c\u61c9\"\u5728\"\u4ee4\u724c\u4e4b\u5f8c \u62d3\u64b2\u6392\u5e8f\u8853\u8a9e,\u56e0\u70ba\u53ea\u80fd'\u5411\u5f8c'\u5206\u9801 \u901a\u904e\u4e8b\u4ef6,\u5f9e \u958b\u59cb\u3002fromtofrom</p> <p>\u4f8b\u5982,\u5f9e\u7d50\u679c\u7684\u7b2c 2 \u9801\u50b3\u905e\u4ee4\u724c,\u4ee5\u53ca\u4e00\u500b\u4ee4\u724c \u5f9e\u7b2c 1 \u9801\u958b\u59cb,\u5c07\u8fd4\u56de\u7a7a\u96c6\u3002\u8abf\u7528\u65b9\u53ef\u4ee5\u4f7f\u7528\u4f86\u81ea \u4f46\u662f,\u7b2c 1 \u9801\u548c\u7b2c 2 \u9801\u4e2d\u7684\u6a19\u8a18\u5c07\u5728\u540c\u4e00\u7bc4\u570d\u5167\u9032\u884c\u5206\u9801\u3002fromtofromto</p> <pre><code>{\n  \"chunk\": [\n    {\n      \"content\": {\n        \"m.relates_to\": {\n          \"event_id\": \"$asfDuShaf7Gafaw\",\n          \"rel_type\": \"org.example.my_relation\"\n        }\n      },\n      \"event_id\": \"$143273582443PhrSn:example.org\",\n      \"origin_server_ts\": 1432735824653,\n      \"room_id\": \"!636q39766251:matrix.org\",\n      \"sender\": \"@example:example.org\",\n      \"type\": \"m.room.message\",\n      \"unsigned\": {\n        \"age\": 1234\n      }\n    }\n  ],\n  \"next_batch\": \"page2_token\",\n  \"prev_batch\": \"page1_token\"\n}\n</code></pre>"},{"location":"chat/client_server/#8","title":"8 \u623f\u9593","text":""},{"location":"chat/client_server/#81","title":"8.1 \u985e\u578b","text":"<p>\uff08\u53ef\u9078\uff09\u623f\u9593\u53ef\u4ee5\u5177\u6709\u8868\u793a\u5176\u9810\u671f\u529f\u80fd\u7684\u985e\u578b\u3002\u4e00\u500b\u623f\u9593 \u6c92\u6709\u985e\u578b\u4e26\u4e0d\u4e00\u5b9a\u610f\u5473\u8457\u5b83\u5177\u6709\u7279\u5b9a\u7684\u9810\u8a2d\u51fd\u6578, \u5118\u7ba1\u901a\u5e38\u9019\u4e9b\u623f\u9593\u5c07\u7528\u65bc\u5c0d\u8a71\u76ee\u7684\u3002</p> <p>\u7576\u5ba2\u6236\u53ef\u80fd\u9700\u8981\u5340\u5206 \u5169\u500b\u4e0d\u540c\u7684\u623f\u9593,\u4f8b\u5982\u5c0d\u8a71\u4fdd\u6301\u548c\u6578\u64da\u4fdd\u6301\u3002\u5982\u679c\u623f\u9593 \u6709\u4e00\u500b\u985e\u578b,\u5b83\u5728 m.room.create \u4e8b\u4ef6\u7684\u9375\u4e2d\u6307\u5b9a\u3002\u8981\u6307\u5b9a\u623f\u9593\u7684\u985e\u578b,\u8acb\u5c07\u5176\u4f5c\u70ba on \u7684\u4e00\u90e8\u5206\u63d0\u4f9b \u5275\u5efa\u6a94\u6848\u5ba4\u8acb\u6c42\u3002typecreation_content</p> <p>\u5728\u6b64\u898f\u7bc4\u4e2d,\u6307\u5b9a\u4e86\u4ee5\u4e0b\u623f\u578b:</p> <ul> <li>m.space</li> </ul> <p>\u901a\u904e\u4f7f\u7528\u547d\u540d\u7a7a\u9593\u6a19\u8b58\u78bc,\u5141\u8a31\u672a\u6307\u5b9a\u7684\u623f\u9593\u985e\u578b\u3002</p>"},{"location":"chat/client_server/#82","title":"8.2 \u5275\u9020","text":"<p>\u7576\u623f\u9593 \u5df2\u5275\u5efa,\u7528\u4f5c\u6b64\u804a\u5929\u5ba4\u7684\u4e8b\u4ef6\u5716\u7684\u6839\u3002\u9019 \u4e8b\u4ef6\u9084\u6709\u4e00\u500b\u91d1\u9470,\u5176\u4e2d\u5305\u542b\u804a\u5929\u5ba4\u7684\u4f7f\u7528\u8005 ID \u9020\u7269\u4e3b\u3002\u5b83\u9084\u5c07\u751f\u6210\u5176\u4ed6\u5e7e\u500b\u4e8b\u4ef6\u4ee5\u7ba1\u7406 \u6b64\u623f\u9593\u7684\u8a31\u53ef\u6b0a\u3002\u9019\u5305\u62ec:m.room.createcreator</p> <ul> <li>m.room.power_levels:\u8a2d\u7f6e\u4f7f\u7528\u8005\u7684\u529f\u7387\u7d1a\u5225\u548c\u6240\u9700\u529f\u7387 \u623f\u9593\u5167\u5404\u7a2e\u64cd\u4f5c\u7684\u7d1a\u5225,\u4f8b\u5982\u767c\u9001\u4e8b\u4ef6\u3002</li> <li>m.room.join_rules:\u623f\u9593\u662f\u5426\"\u50c5\u9650\u9080\u8acb\"\u3002</li> </ul> <p>\u6709\u95dc\u9019\u4e9b\u6d3b\u52d5\u7684\u66f4\u591a\u8cc7\u8a0a,\u8acb\u53c3\u95b1\u6703\u8b70\u5ba4\u6d3b\u52d5\u3002\u81ea \u5275\u5efa\u623f\u9593\u6642,\u5ba2\u6236\u7aef\u5fc5\u9808\u4f7f\u7528\u4ee5\u4e0b API\u3002</p>"},{"location":"chat/client_server/#post-_matrixclientv3createroom","title":"POST /_matrix/client/v3/createRoom","text":"<p>\u5275\u5efa\u5177\u6709\u5404\u7a2e\u914d\u7f6e\u9078\u9805\u7684\u65b0\u623f\u9593\u3002</p> <p>\u4f3a\u670d\u5668\u5fc5\u9808\u5728\u5275\u5efa\u6642\u61c9\u7528\u6b63\u5e38\u72c0\u614b\u89e3\u6790\u898f\u5247 \u65b0\u623f\u9593,\u5305\u62ec\u6aa2\u67e5\u6bcf\u500b\u4e8b\u4ef6\u7684\u529f\u7387\u7d1a\u5225\u3002\u5b83\u5fc5\u9808 \u4f9d\u4ee5\u4e0b\u9806\u5e8f\u61c9\u7528\u8acb\u6c42\u96b1\u542b\u7684\u4e8b\u4ef6:</p> <ol> <li> <p>\u4e8b\u4ef6\u672c\u8eab\u3002\u5fc5\u9808\u662f \u623f\u9593\u3002m.room.create</p> </li> <li> <p>\u5efa\u7acb\u8005\u52a0\u5165\u804a\u5929\u5ba4\u7684\u4e8b\u4ef6\u3002\u9019\u662f \u9700\u8981,\u4ee5\u4fbf\u53ef\u4ee5\u767c\u9001\u5176\u9918\u4e8b\u4ef6\u3002m.room.member</p> </li> <li> <p>\u9ed8\u8a8d\u4e8b\u4ef6,\u70ba\u623f\u9593\u5efa\u7acb\u8005\u63d0\u4f9b \uff08\u800c\u4e0d\u662f\u5176\u4ed6\u6210\u54e1\uff09\u767c\u9001\u72c0\u614b\u4e8b\u4ef6\u7684\u8a31\u53ef\u6b0a\u3002\u91cd\u5beb \u6309\u53c3\u6578\u3002m.room.power_levelspower_level_content_override</p> </li> <li> <p>\u5982\u679c\u7d66\u5b9a,\u5247\u70ba\u4e8b\u4ef6\u3002m.room.canonical_aliasroom_alias_name</p> </li> <li> <p>\u7531\u8a2d\u7f6e\u7684\u4e8b\u4ef6\u3002\u76ee\u524d,\u9019\u4e9b\u662f , \u548c\u72c0\u614b\u4e8b\u4ef6\u3002presetm.room.join_rulesm.room.history_visibilitym.room.guest_access</p> </li> <li> <p>\u4e2d\u5217\u51fa\u7684\u4e8b\u4ef6,\u6309\u5176\u9806\u5e8f\u6392\u5217 \u4e0a\u5e02\u3002initial_state</p> </li> <li> <p>\u548c \uff08 \u548c\u72c0\u614b\u4e8b\u4ef6\uff09\u6240\u96b1\u542b\u7684\u4e8b\u4ef6\u3002nametopicm.room.namem.room.topic</p> </li> <li> <p>\u9080\u8acb\u548c \uff08 with and \uff09 \u6240\u96b1\u542b\u7684\u4e8b\u4ef6\u3002inviteinvite_3pidm.room.membermembership: invitem.room.third_party_invite</p> </li> </ol> <p>\u4f3a\u670d\u5668\u5c07\u5728\u623f\u9593\u5167\u5275\u5efa\u4e00\u500b\u4e8b\u4ef6,\u5176\u4e2d\u5305\u542b \u8acb\u6c42\u4f7f\u7528\u8005\u4f5c\u70ba\u5efa\u7acb\u8005,\u4ee5\u53ca\u4e2d\u63d0\u4f9b\u7684\u5176\u4ed6\u5bc6\u9470\u3002m.room.createcreation_content</p> <p>\u8acb\u6c42\u6b63\u6587\u793a\u4f8b</p> <pre><code>{\n  \"creation_content\": {\n    \"m.federate\": false\n  },\n  \"name\": \"The Grand Duke Pub\",\n  \"preset\": \"public_chat\",\n  \"room_alias_name\": \"thepub\",\n  \"topic\": \"All about happy hour\"\n}\n</code></pre> <p>200 \u56de\u61c9</p> <pre><code>{\n  \"room_id\": \"!sefiuhWgwghwWgh:example.com\"\n}\n</code></pre> <p>8.3 \u623f\u9593\u5225\u540d \u4f3a\u670d\u5668\u53ef\u4ee5\u8a17\u7ba1\u5177\u6709\u4eba\u985e\u53cb\u597d\u540d\u7a31\u7684\u623f\u9593\u7684\u5225\u540d\u3002\u5225\u540d \u63a1\u53d6\u5f62\u5f0f.#friendlyname:server.name</p> <p>\u7531\u65bc\u623f\u9593\u5225\u540d\u7684\u7bc4\u570d\u9650\u5b9a\u70ba\u7279\u5b9a\u7684\u4e3b\u4f3a\u670d\u5668\u529f\u80fd\u8b8a\u6578\u540d\u7a31,\u56e0\u6b64\u5b83\u662f \u4e3b\u4f3a\u670d\u5668\u53ef\u80fd\u6703\u62d2\u7d55\u5728 \u4e0a\u7dad\u8b77\u5225\u540d\u7684\u5617\u8a66 \u5176\u4ed6\u529f\u80fd\u8b8a\u6578\u540d\u7a31\u3002\u6b64\u898f\u7bc4\u4e0d\u63d0\u4f9b \u4e3b\u4f3a\u670d\u5668,\u7528\u65bc\u5411\u5176\u4ed6\u4f3a\u670d\u5668\u767c\u9001\u66f4\u65b0\u8acb\u6c42\u3002\u7136\u800c \u4e3b\u4f3a\u670d\u5668\u5fc5\u9808\u8655\u7406\u89e3\u6790\u5176\u4ed6\u5225\u540d\u7684\u8acb\u6c42 \u4f3a\u670d\u5668;\u5982\u6709\u5fc5\u8981,\u4ed6\u5011\u61c9\u4f7f\u7528\u806f\u5408\u8eab\u4efd\u9a57\u8b49 API \u57f7\u884c\u6b64\u64cd\u4f5c\u3002GET</p> <p>\u4f46\u662f,\u6a94\u5ba4\u4e0d\u6703\u5132\u5b58\u6a94\u5ba4\u4e2d\u5b58\u5728\u7684\u6240\u6709\u5225\u540d\u7684\u6e05\u55ae \u5177\u6709\u76f8\u95dc\u8a31\u53ef\u6b0a\u7684\u804a\u5929\u5ba4\u6210\u54e1\u53ef\u4ee5\u767c\u4f48\u9996\u9078 \u901a\u904e\u72c0\u614b\u4e8b\u4ef6\u7684\u5225\u540d\u3002\u4e2d\u7684\u5225\u540d \u72c0\u614b\u4e8b\u4ef6\u61c9\u6307\u5411\u5728\u5176\u4e2d\u767c\u4f48\u5b83\u5011\u7684\u623f\u9593ID, \u4f46\u662f,\u96a8\u8457\u6642\u9593\u7684\u63a8\u79fb,\u623f\u9593\u5225\u540d\u53ef\u80fd\u6703\u6f02\u79fb\u5230\u5176\u4ed6\u623f\u9593 ID\u3002 \u7528\u6236\u7aef\u4e0d\u61c9\u5c07\u5225\u540d\u8996\u70ba\u6e96\u78ba\u3002\u4ed6\u5011\u61c9\u8a72\u88ab\u6aa2\u67e5 \u5728\u4f7f\u7528\u5b83\u5011\u6216\u8207\u5176\u4ed6\u7528\u6236\u5171\u7528\u4e4b\u524d\u3002\u5982\u679c\u623f\u9593\u770b\u8d77\u4f86 \u5177\u6709\u7684\u623f\u9593\u5225\u540d,\u9019\u61c9\u8a72\u88ab\u6aa2\u67e5\u5230 \u78ba\u4fdd\u623f\u9593\u7684ID\u8207\u5f9e \u8acb\u6c42\u3002m.room.canonical_alias#alias: example.comroom_id</p>"},{"location":"chat/client_server/#get-_matrixclientv3directoryroomroomalias","title":"GET /_matrix/client/v3/directory/room/{roomAlias}","text":"<p>\u8acb\u6c42\u4f3a\u670d\u5668\u5c07\u6703\u8b70\u5ba4\u5225\u540d\u89e3\u6790\u70ba\u6703\u8b70\u5ba4ID\u3002</p> <p>\u4f3a\u670d\u5668\u5c07\u4f7f\u7528\u806f\u5408 API \u89e3\u6790\u5225\u540d,\u5982\u679c \u5225\u540d\u7684\u57df\u90e8\u5206\u8207\u4f3a\u670d\u5668\u81ea\u5df1\u7684\u4e0d\u5c0d\u61c9 \u57df\u3002</p> <p>200 \u56de\u61c9</p> <pre><code>{\n  \"room_id\": \"!abnjk1jdasj98:capuchins.com\",\n  \"servers\": [\n    \"capuchins.com\",\n    \"matrix.org\",\n    \"another.com\"\n  ]\n}\n</code></pre>"},{"location":"chat/client_server/#put-_matrixclientv3directoryroomroomalias","title":"PUT /_matrix/client/v3/directory/room/{roomAlias}","text":"<p>\u8acb\u6c42\u6b63\u6587\u793a\u4f8b</p> <pre><code>{\n  \"room_id\": \"!abnjk1jdasj98:capuchins.com\"\n}\n</code></pre> <p>200 \u56de\u61c9</p> <pre><code>{}\n</code></pre>"},{"location":"chat/client_server/#delete-_matrixclientv3directoryroomroomalias","title":"DELETE /_matrix/client/v3/directory/room/{roomAlias}","text":"<p>\u522a\u9664\u623f\u9593\u5225\u540d\u5230\u623f\u9593ID\u7684\u6620\u5c04\u3002</p> <p>\u4f3a\u670d\u5668\u53ef\u4ee5\u9078\u64c7\u5728\u6b64\u8655\u5be6\u65bd\u984d\u5916\u7684\u8a2a\u554f\u63a7\u5236\u6aa2\u67e5,\u4f8b\u5982 \u804a\u5929\u5ba4\u5225\u540d\u53ea\u80fd\u7531\u5176\u5efa\u7acb\u8005\u6216\u4f3a\u670d\u5668\u7ba1\u7406\u54e1\u522a\u9664\u3002</p> <p>\u6ce8\u610f:\u4f3a\u670d\u5668\u53ef\u4ee5\u9078\u64c7\u5728\u522a\u9664\u5225\u540d\u6642\u66f4\u65b0\u804a\u5929\u5ba4\u4e2d\u7684\u72c0\u614b\u4e8b\u4ef6\u3002\u9078\u64c7\u66f4\u65b0 \u5efa\u8b70\u4f7f\u7528\u898f\u7bc4\u5225\u540d\u4e8b\u4ef6,\u9664\u4e86\u5176\u5176\u4ed6\u76f8\u95dc\u8a31\u53ef\u6b0a\u5916 \u6aa2\u67e5,\u522a\u9664\u5225\u540d\u4e26\u8fd4\u56de\u6210\u529f\u56de\u61c9,\u5373\u4f7f\u7528\u6236\u6c92\u6709 \u6709\u6b0a\u66f4\u65b0\u4e8b\u4ef6\u3002alt_aliasesm.room.canonical_aliasm.room.canonical_alias</p> <p>200 \u56de\u61c9</p> <pre><code>{}\n</code></pre>"},{"location":"chat/client_server/#get-_matrixclientv3roomsroomidaliases","title":"GET /_matrix/client/v3/rooms/{roomId}/aliases","text":"<p>\u7372\u53d6\u7531\u672c\u5730\u4f3a\u670d\u5668\u7dad\u8b77\u7684\u5225\u540d\u6e05\u55ae \u7d66\u4e86\u7a7a\u9593\u3002</p> <p>\u6b64\u7d42\u7d50\u9ede\u53ef\u7531\u6703\u8b70\u5ba4\uff08\u5916\u90e8\uff09\u4e2d\u7684\u7528\u6236\u8abf\u7528 \u4f7f\u7528\u8005\u6703\u6536\u5230\u932f\u8aa4\u56de\u61c9\uff09\u3002\u5982\u679c\u623f\u9593\u6620\u5c04\u5230 ,\u5247\u4efb\u610f \u7528\u6236\u53ef\u4ee5\u8abf\u7528\u6b64\u7d42\u7d50\u9ede\u3002M_FORBIDDENm.room.history_visibilityworld_readable</p> <p>\u4f3a\u670d\u5668\u53ef\u4ee5\u9078\u64c7\u5728\u6b64\u8655\u5be6\u65bd\u984d\u5916\u7684\u8a2a\u554f\u63a7\u5236\u6aa2\u67e5, \u4f8b\u5982,\u5141\u8a31\u4f3a\u670d\u5668\u7ba1\u7406\u54e1\u67e5\u770b\u5225\u540d,\u800c\u4e0d\u7ba1 \u6703\u54e1\u3002</p> <p>\u6ce8\u610f:\u5efa\u8b70\u7528\u6236\u7aef\u4e0d\u8981\u7a81\u51fa\u986f\u793a\u6b64\u5225\u540d\u6e05\u55ae \u56e0\u70ba\u5b83\u5011\u4e0d\u662f\u7b56\u5283\u7684,\u4e0d\u50cf\u72c0\u614b\u4e8b\u4ef6\u4e2d\u5217\u51fa\u7684\u90a3\u4e9b\u3002m.room.canonical_alias</p> <p>200 \u56de\u61c9</p> <pre><code>{\n  \"aliases\": [\n    \"#somewhere:example.com\",\n    \"#another:example.com\",\n    \"#hat_trick:example.com\"\n  ]\n}\n</code></pre>"},{"location":"chat/client_server/#84","title":"8.4 \u8a31\u53ef\u6b0a","text":"<p>\u623f\u9593\u7684\u8a31\u53ef\u6b0a\u662f\u901a\u904e\u529f\u7387\u7d1a\u5225\u7684\u6982\u5ff5\u5b8c\u6210\u7684 - \u5f85\u8fa6\u4e8b\u9805 \u7528\u6236\u5728\u623f\u9593\u5167\u7684\u4efb\u4f55\u64cd\u4f5c\u90fd\u5fc5\u9808\u5177\u6709\u5408\u9069\u7684\u529f\u7387\u7d1a\u5225\u3002\u6b0a\u529b \u95dc\u5361\u4f5c\u70ba\u72c0\u614b\u4e8b\u4ef6\u5b58\u5132\u5728\u7d66\u5b9a\u623f\u9593\u4e2d\u3002\u529f\u7387\u6c34\u6e96 \u64cd\u4f5c\u6240\u9700\u7684\u548c\u4f7f\u7528\u8005\u7684\u529f\u7387\u7d1a\u5225\u5728 \u4e2d\u5b9a\u7fa9,\u5176\u4e2d\u9810\u8a2d\u4f7f\u7528\u8005\u548c\u7279\u5b9a\u4f7f\u7528\u8005\u7684\u529f\u7387 \u53ef\u4ee5\u8a2d\u7f6e\u7d1a\u5225\u3002\u9ed8\u8a8d\u60c5\u6cc1\u4e0b,\u6240\u6709\u4f7f\u7528\u8005\u7684\u529f\u7387\u7d1a\u5225\u70ba 0,\u5176\u4ed6 \u6bd4\u96fb\u6e90\u7d1a\u5225\u9810\u8a2d\u70ba 100 \u7684\u804a\u5929\u5ba4\u5efa\u7acb\u8005\u3002\u7528\u6236\u53ef\u4ee5\u6388\u4e88 \u5176\u4ed6\u4f7f\u7528\u8005\u5c07\u529f\u7387\u7d1a\u5225\u63d0\u9ad8\u5230\u81ea\u5df1\u7684\u529f\u7387\u7d1a\u5225\u3002\u70ba \u4f8b\u5982,\u529f\u7387\u7d1a\u5225\u70ba50\u7684\u4f7f\u7528\u8005 A \u53ef\u4ee5\u63d0\u9ad8\u529f\u7387\u7d1a\u5225 \u4f7f\u7528\u8005 B \u7684\u6700\u9ad8\u7b49\u7d1a\u70ba 50\u3002\u8ddf\u8e64\u4f7f\u7528\u8005\u7684\u529f\u7387\u6c34\u6e96 \u6bcf\u500b\u623f\u9593,\u5373\u4f7f\u4f7f\u7528\u8005\u4e0d\u5728\u623f\u9593\u4e2d\u3002\u5305\u542b\u7684\u91d1\u9470 \u5728\u78ba\u5b9a\u67d0\u4e9b\u6240\u9700\u7684\u6c34\u6e96 \u8e22,\u7981\u6b62\u548c\u767c\u9001\u570b\u5bb6\u4e8b\u4ef6\u7b49\u64cd\u4f5c\u3002\u6709\u95dc\u8a73\u7d30\u8cc7\u8a0a,\u8acb\u53c3\u95b1m.room.power_levels\u3002m.room.power_levelsm.room.power_levels</p> <p>\u7528\u6236\u7aef\u53ef\u80fd\u5e0c\u671b\u70ba\u7279\u5b9a\u529f\u7387\u7d1a\u5225\u5206\u914d\u540d\u7a31\u3002\u4e00\u5efa\u8b70 \u6620\u5c04\u5982\u4e0b:- 0 \u4f7f\u7528\u8005 - 50 \u7248\u4e3b - 100 \u7ba1\u7406\u54e1</p>"},{"location":"chat/client_server/#85","title":"8.5 \u6a94\u5ba4\u6210\u54e1\u8cc7\u683c","text":"<p>\u4f7f\u7528\u8005\u9700\u8981\u662f\u804a\u5929\u5ba4\u7684\u6210\u54e1\u624d\u80fd\u767c\u9001\u548c\u63a5\u6536\u4e8b\u4ef6 \u5728\u90a3\u500b\u623f\u9593\u91cc\u3002\u4f7f\u7528\u8005\u53ef\u80fd\u8655\u65bc\u591a\u7a2e\u72c0\u614b,\u5728 \u8207\u623f\u9593\u7684\u95dc\u4fc2:</p> <ul> <li>\u4e0d\u76f8\u95dc\uff08\u4f7f\u7528\u8005\u7121\u6cd5\u5728\u804a\u5929\u5ba4\u4e2d\u50b3\u9001\u6216\u63a5\u6536\u4e8b\u4ef6\uff09</li> <li>\u6572\u9580\uff08\u4f7f\u7528\u8005\u5df2\u8acb\u6c42\u53c3\u8207\u623f\u9593,\u4f46 \u5c1a\u4e0d\u88ab\u5141\u8a31 \uff09</li> <li>\u5df2\u9080\u8acb\uff08\u4f7f\u7528\u8005\u5df2\u88ab\u9080\u8acb\u53c3\u8207\u804a\u5929\u5ba4,\u4f46 \u5c1a\u672a\u53c3\u8207\uff09</li> <li>\u5df2\u52a0\u5165\uff08\u4f7f\u7528\u8005\u53ef\u4ee5\u5728\u804a\u5929\u5ba4\u4e2d\u50b3\u9001\u8207\u63a5\u6536\u4e8b\u4ef6\uff09</li> <li>\u7981\u6b62\uff08\u4e0d\u5141\u8a31\u4f7f\u7528\u8005\u52a0\u5165\u804a\u5929\u5ba4\uff09</li> </ul> <p>\u6709\u4e00\u4e9b\u503c\u5f97\u6ce8\u610f\u7684\u4f8b\u5916\u60c5\u6cc1\u5141\u8a31\u672a\u52a0\u5165\u7684\u6210\u54e1 \u5728\u804a\u5929\u5ba4\u4e2d\u50b3\u9001\u4e8b\u4ef6\u7684\u623f\u9593:</p> <ul> <li> <p>\u5e0c\u671b\u62d2\u7d55\u9080\u8acb\u7684\u4f7f\u7528\u8005\u5c07\u4f7f\u7528 \u767c\u9001\u5e36\u6709\u7684\u4e8b\u4ef6\u3002\u4ed6\u5011\u4e00\u5b9a\u662f\u5148\u88ab\u9080\u8acb\u7684\u3002m.room.membercontent.membershipleave</p> </li> <li> <p>\u5982\u679c\u623f\u9593\u5141\u8a31,\u7528\u6236\u53ef\u4ee5\u767c\u9001\u5e36\u6709 of \u7684\u4e8b\u4ef6\u4f86\u6572\u623f\u9593\u3002\u9019\u662f\u4f7f\u7528\u8005\u767c\u51fa\u7684\u9080\u8acb\u8acb\u6c42\u3002m.room.membercontent.membershipknock</p> </li> <li> <p>\u8981\u6536\u56de\u4e4b\u524d\u7684\u6572\u9580\u8072,\u7528\u6236\u5c07\u767c\u9001\u985e\u4f3c\u65bc \u62d2\u7d55\u9080\u8acb\u3002leave</p> </li> </ul> <p>\u6709\u4e9b\u804a\u5929\u5ba4\u8981\u6c42\u4f7f\u7528\u8005\u5728\u52a0\u5165\u4e4b\u524d\u5148\u53d7\u9080\u52a0\u5165; \u5176\u4ed6\u4eba\u5141\u8a31\u4efb\u4f55\u4eba\u52a0\u5165\u3002\u7d66\u5b9a\u7684\u804a\u5929\u5ba4\u662f\u5426\u70ba\"\u50c5\u9650\u53d7\u9080\u8005\" \u623f\u9593\u7531\u623f\u9593\u914d\u7f6e\u9375\u78ba\u5b9a\u3002\u5b83\u53ef\u4ee5 \u5177\u6709\u4ee5\u4e0b\u503c\u4e4b\u4e00:m.room.join_rules</p> <p>public\u9019\u500b\u623f\u9593\u53ef\u4f9b\u4efb\u4f55\u4eba\u514d\u8cbb\u52a0\u5165,\u7121\u9700\u9080\u8acb\u3002</p> <p>invite\u53ea\u6709\u5728\u60a8\u88ab\u9080\u8acb\u7684\u60c5\u6cc1\u4e0b\u624d\u80fd\u52a0\u5165\u6b64\u623f\u9593\u3002</p> <p>knock\u6b64\u623f\u9593\u53ea\u6709\u5728\u60a8\u88ab\u9080\u8acb\u7684\u60c5\u6cc1\u4e0b\u624d\u80fd\u52a0\u5165,\u4e26\u5141\u8a31\u4efb\u4f55\u4eba \u8acb\u6c42\u9080\u8acb\u52a0\u5165\u6703\u8b70\u5ba4\u3002\u8acb\u6ce8\u610f,\u6b64\u806f\u63a5\u898f\u5247\u50c5\u53ef\u7528 \u5728\u652f\u63f4\u6572\u9580\u7684\u623f\u9593\u7248\u672c\u4e2d\u3002</p> <p>[v1.2 \u4e2d\u65b0\u589e]</p> <p>restricted\u5982\u679c\u60a8\u88ab\u9080\u8acb\u6216\u60a8\u662f\u53e6\u4e00\u500b\u623f\u9593\u7684\u6210\u54e1,\u5247\u53ef\u4ee5\u52a0\u5165\u6b64\u623f\u9593 \u52a0\u5165\u898f\u5247\u4e2d\u5217\u51fa\u7684\u623f\u9593\u3002\u5982\u679c\u4f3a\u670d\u5668\u7121\u6cd5\u9a57\u8b49\u4efb\u4f55\u6210\u54e1\u8eab\u4efd \u5217\u51fa\u7684\u623f\u9593,\u90a3\u9ebc\u60a8\u53ea\u80fd\u901a\u904e\u9080\u8acb\u52a0\u5165\u3002\u8acb\u6ce8\u610f,\u6b64\u898f\u5247 \u53ea\u61c9\u5728\u652f\u63f4\u5b83\u7684\u623f\u9593\u7248\u672c\u4e2d\u5de5\u4f5c\u3002</p> <p>[v1.3 \u4e2d\u65b0\u589e]</p> <p>knock_restricted\u9019\u500b\u623f\u9593\u53ef\u4ee5\u50cf\u4ee5\u524d\u4e00\u6a23\u9023\u63a5\u3002\u5982\u679c\u4f60 \u4f7f\u7528\u6572\u9580\u8207\u623f\u9593\u4ea4\u4e92,\u898f\u5247\u751f\u6548,\u800c \u5617\u8a66\u5728\u6c92\u6709\u9080\u8acb\u7684\u60c5\u6cc1\u4e0b\u52a0\u5165\u804a\u5929\u5ba4\u5c07\u61c9\u7528\u52a0\u5165\u898f\u5247\u3002 \u8acb\u6ce8\u610f,\u6b64\u898f\u5247\u50c5\u9069\u7528\u65bc\u652f\u63f4\u5b83\u7684\u623f\u9593\u7248\u672c\u3002restrictedknockknockrestricted</p> <p>\u6210\u54e1\u8cc7\u683c\u5141\u8a31\u7684\u72c0\u614b\u8f49\u63db\u70ba: </p>"},{"location":"chat/client_server/#get-_matrixclientv3joined_rooms","title":"GET /_matrix/client/v3/joined_rooms","text":"<p>\u6b64 API \u50b3\u56de\u4f7f\u7528\u8005\u76ee\u524d\u804a\u5929\u5ba4\u7684\u6e05\u55ae\u3002</p> <pre><code>{\n  \"joined_rooms\": [\n    \"!foo:example.com\"\n  ]\n}\n</code></pre>"},{"location":"chat/client_server/#851","title":"8.5.1 \u9023\u63a5\u623f\u9593","text":""},{"location":"chat/client_server/#post-_matrixclientv3roomsroomidinvite","title":"POST /_matrix/client/v3/rooms/{roomId}/invite","text":"<p>\u8acb\u6ce8\u610f,\u6b64 API \u6709\u5169\u7a2e\u5f62\u5f0f,\u5206\u5225\u8a18\u9304\u3002 \u6b64\u7248\u672c\u7684 API \u8981\u6c42\u9080\u8acb\u8005\u77e5\u9053\u77e9\u9663 \u88ab\u9080\u8acb\u8005\u7684\u6a19\u8b58\u78bc\u3002\u53e6\u4e00\u500b\u8a18\u9304\u5728\u7b2c\u4e09\u65b9\u9080\u8acb\u90e8\u5206\u4e2d\u3002</p> <p>\u6b64 API \u9080\u8acb\u7528\u6236\u53c3\u8207\u7279\u5b9a\u804a\u5929\u5ba4\u3002 \u5728\u4ed6\u5011\u5be6\u969b\u52a0\u5165 \u623f\u9593\u3002</p> <p>\u53ea\u6709\u7576\u524d\u4f4d\u65bc\u7279\u5b9a\u804a\u5929\u5ba4\u4e2d\u7684\u4f7f\u7528\u8005\u624d\u80fd\u9080\u8acb\u5176\u4ed6\u4f7f\u7528\u8005 \u52a0\u5165\u90a3\u500b\u623f\u9593\u3002</p> <p>\u5982\u679c\u4f7f\u7528\u8005\u88ab\u9080\u8acb\u5230\u804a\u5929\u5ba4,\u4e3b\u4f3a\u670d\u5668\u6703\u5c07\u4e8b\u4ef6\u8ffd\u52a0\u5230\u804a\u5929\u5ba4\u3002m.room.member</p> <p>\u8acb\u6c42\u6b63\u6587\u793a\u4f8b</p> <pre><code>{\n  \"reason\": \"Welcome to the team!\",\n  \"user_id\": \"@cheeky_monkey:matrix.org\"\n}\n</code></pre> <p>200 \u56de\u61c9</p> <pre><code>{}\n</code></pre>"},{"location":"chat/client_server/#post-_matrixclientv3joinroomidoralias","title":"POST /_matrix/client/v3/join/{roomIdOrAlias}","text":"<p>\u8acb\u6ce8\u610f,\u6b64 API \u63a1\u7528\u623f\u9593 ID \u6216\u5225\u540d,\u9019\u8207 ./rooms/{roomId}/join</p> <p>\u6b64 API \u555f\u52d5\u53c3\u8207\u7279\u5b9a\u804a\u5929\u5ba4\u7684\u4f7f\u7528\u8005\uff08\u5982\u679c\u8a72\u4f7f\u7528\u8005\uff09 \u88ab\u5141\u8a31\u53c3\u52a0\u8a72\u623f\u9593\u3002\u5728\u6b64\u8abf\u7528\u4e4b\u5f8c,\u7528\u6236\u7aef\u662f \u5141\u8a31\u67e5\u770b\u623f\u9593\u4e2d\u7684\u6240\u6709\u7576\u524d\u72c0\u614b\u4e8b\u4ef6,\u4ee5\u53ca\u6240\u6709\u5f8c\u7e8c\u4e8b\u4ef6 \u8207\u804a\u5929\u5ba4\u95dc\u806f\u7684\u4e8b\u4ef6,\u76f4\u5230\u4f7f\u7528\u8005\u96e2\u958b\u804a\u5929\u5ba4\u3002</p> <p>\u4f7f\u7528\u8005\u52a0\u5165\u6a94\u5ba4\u540e,\u8a72\u804a\u5929\u5ba4\u5c07\u4f5c\u70ba\u689d\u76ee\u986f\u793a\u5728 /initialSync \u548c /sync API \u7684\u56de\u61c9\u3002</p> <p>\u8acb\u6c42\u6b63\u6587\u793a\u4f8b</p> <pre><code>{\n  \"reason\": \"Looking for support\",\n  \"third_party_signed\": {\n    \"mxid\": \"@bob:example.org\",\n    \"sender\": \"@alice:example.org\",\n    \"signatures\": {\n      \"example.org\": {\n        \"ed25519:0\": \"some9signature\"\n      }\n    },\n    \"token\": \"random8nonce\"\n  }\n}\n</code></pre> <p>200 \u56de\u61c9</p> <pre><code>{\n  \"room_id\": \"!d41d8cd:matrix.org\"\n}\n</code></pre>"},{"location":"chat/client_server/#post-_matrixclientv3roomsroomidjoin","title":"POST /_matrix/client/v3/rooms/{roomId}/join","text":"<p>\u8acb\u6ce8\u610f,\u6b64 API \u9700\u8981\u6703\u8b70\u5ba4 ID,\u800c\u4e0d\u662f\u5225\u540d\u3002 \u5982\u679c\u60a8\u6709\u6a94\u5ba4\u5225\u540d,\u5247\u5b58\u5728\u3002/join/{roomIdOrAlias}</p> <p>\u6b64 API \u555f\u52d5\u53c3\u8207\u7279\u5b9a\u804a\u5929\u5ba4\u7684\u4f7f\u7528\u8005\uff08\u5982\u679c\u8a72\u4f7f\u7528\u8005\uff09 \u88ab\u5141\u8a31\u53c3\u52a0\u8a72\u623f\u9593\u3002\u5728\u6b64\u8abf\u7528\u4e4b\u5f8c,\u7528\u6236\u7aef\u662f \u5141\u8a31\u67e5\u770b\u623f\u9593\u4e2d\u7684\u6240\u6709\u7576\u524d\u72c0\u614b\u4e8b\u4ef6,\u4ee5\u53ca\u6240\u6709\u5f8c\u7e8c\u4e8b\u4ef6 \u8207\u804a\u5929\u5ba4\u95dc\u806f\u7684\u4e8b\u4ef6,\u76f4\u5230\u4f7f\u7528\u8005\u96e2\u958b\u804a\u5929\u5ba4\u3002</p> <p>\u4f7f\u7528\u8005\u52a0\u5165\u6a94\u5ba4\u540e,\u8a72\u804a\u5929\u5ba4\u5c07\u4f5c\u70ba\u689d\u76ee\u986f\u793a\u5728 /initialSync \u548c /sync API \u7684\u56de\u61c9\u3002</p> <p>\u8acb\u6c42\u6b63\u6587\u793a\u4f8b</p> <pre><code>{\n  \"reason\": \"Looking for support\",\n  \"third_party_signed\": {\n    \"mxid\": \"@bob:example.org\",\n    \"sender\": \"@alice:example.org\",\n    \"signatures\": {\n      \"example.org\": {\n        \"ed25519:0\": \"some9signature\"\n      }\n    },\n    \"token\": \"random8nonce\"\n  }\n}\n</code></pre> <p>200 \u56de\u61c9</p> <pre><code>{\n  \"room_id\": \"!d41d8cd:matrix.org\"\n}\n</code></pre>"},{"location":"chat/client_server/#852","title":"8.5.2 \u96e2\u958b\u623f\u9593","text":"<p>\u7528\u6236\u53ef\u4ee5\u96e2\u958b\u804a\u5929\u5ba4\u4ee5\u505c\u6b62\u63a5\u6536\u8a72\u804a\u5929\u5ba4\u7684\u4e8b\u4ef6\u3002\u4e00\u500b\u4f7f\u7528\u8005 \u5fc5\u9808\u5728\u4ed6\u5011\u88ab\u9080\u8acb\u6216\u52a0\u5165\u623f\u9593\u4e4b\u524d \u6709\u8cc7\u683c\u96e2\u958b\u623f\u9593\u3002\u96e2\u958b\u4f7f\u7528\u8005\u6240\u5728\u7684\u623f\u9593 \u9080\u8acb\u62d2\u7d55\u9080\u8acb,\u4e26\u4e14\u53ef\u4ee5\u6536\u56de\u6572\u9580\u8072\u3002\u7528\u6236\u96e2\u958b\u540e \u4e00\u500b\u623f\u9593,\u5b83\u5c07\u4e0d\u518d\u51fa\u73fe\u5728\u5c0d /sync API \u7684\u56de\u61c9\u4e2d,\u9664\u975e\u5b83\u662f \u901a\u904e\u5177\u6709\u6b04\u4f4d\u96c6\u7684\u904e\u6ffe\u5668\u986f\u5f0f\u8acb\u6c42 \u81ea\u3002include_leavetrue</p> <p>\u7121\u8ad6\u4ed6\u5011\u662f\u5426\u771f\u7684\u52a0\u5165\u4e86\u623f\u9593,\u5982\u679c\u623f\u9593\u662f\u4e00\u500b \"\u50c5\u9650\u9080\u8acb\"\u804a\u5929\u5ba4 \u4f7f\u7528\u8005\u9700\u8981\u91cd\u65b0\u9080\u8acb\u624d\u80fd \u91cd\u65b0\u52a0\u5165\u623f\u9593\u3002</p> <p>\u4f7f\u7528\u8005\u9084\u53ef\u4ee5\u5fd8\u8a18\u4ed6\u5011\u96e2\u958b\u7684\u623f\u9593\u3002\u5ba2\u623f\u6709 \u88ab\u907a\u5fd8\u6c38\u9060\u4e0d\u6703\u51fa\u73fe\u5c0d /sync API \u7684\u56de\u61c9, \u76f4\u5230\u4f7f\u7528\u8005\u91cd\u65b0\u52a0\u5165,\u91cd\u65b0\u9080\u8acb\u6216\u6572\u9580\u3002</p> <p>\u4f7f\u7528\u8005\u53ef\u80fd\u5e0c\u671b\u5f37\u5236\u5176\u4ed6\u4f7f\u7528\u8005\u96e2\u958b\u623f\u9593\u3002\u9019\u662f\u53ef\u4ee5\u505a\u5230\u7684 \u901a\u904e'\u8e22'\u5176\u4ed6\u4f7f\u7528\u8005\u3002\u70ba\u6b64,\u57f7\u884c\u8e22\u7403\u7684\u7528\u6236\u5fc5\u9808 \u5177\u6709\u6240\u9700\u7684\u529f\u7387\u6c34\u6e96\u3002\u4e00\u65e6\u4f7f\u7528\u8005\u88ab\u8e22\u51fa,\u5247 \u884c\u70ba\u8207\u81ea\u9858\u96e2\u958b\u662f\u4e00\u6a23\u7684\u3002\u5728 \u7279\u5225\u662f,\u5982\u679c\u623f\u9593\u4e0d\u662f,\u7528\u6236\u53ef\u4ee5\u81ea\u7531\u91cd\u65b0\u52a0\u5165 \"\u50c5\u9650\u9080\u8acb\"\u3002</p>"},{"location":"chat/client_server/#post-_matrixclientv3roomsroomidforget","title":"POST /_matrix/client/v3/rooms/{roomId}/forget","text":"<p>\u6b64 API \u963b\u6b62\u4f7f\u7528\u8005\u8a18\u4f4f\u7279\u5b9a\u623f\u9593\u3002</p> <p>\u4e00\u822c\u4f86\u8aaa,\u6b77\u53f2\u662f\u99ed\u5ba2\u5e1d\u570b\u7684\u4e00\u7b49\u516c\u6c11\u3002\u5728\u6b64 API \u4e4b\u5f8c \u88ab\u8abf\u7528,\u4f46\u662f,\u4f7f\u7528\u8005\u5c07\u7121\u6cd5\u518d\u6aa2\u7d22\u6b77\u53f2\u8a18\u9304 \u5c0d\u65bc\u9019\u500b\u623f\u9593\u3002\u5982\u679c\u4e3b\u4f3a\u670d\u5668\u4e0a\u7684\u6240\u6709\u7528\u6236\u90fd\u5fd8\u8a18\u4e86\u4e00\u500b\u623f\u9593,\u5247\u8a72\u623f\u9593\u662f \u7b26\u5408\u5f9e\u8a72\u4e3b\u4f3a\u670d\u5668\u522a\u9664\u7684\u689d\u4ef6\u3002</p> <p>\u5982\u679c\u4f7f\u7528\u8005\u7576\u524d\u5df2\u52a0\u5165\u804a\u5929\u5ba4,\u5247\u4ed6\u5011\u5fc5\u9808\u96e2\u958b\u804a\u5929\u5ba4 \u5728\u8abf\u7528\u6b64 API \u4e4b\u524d\u3002</p> <p>200 \u56de\u61c9</p> <pre><code>{}\n</code></pre>"},{"location":"chat/client_server/#post-_matrixclientv3roomsroomidleave","title":"POST /_matrix/client/v3/rooms/{roomId}/leave","text":"<p>\u6b64 API \u963b\u6b62\u7528\u6236\u53c3\u8207\u7279\u5b9a\u804a\u5929\u5ba4\u3002</p> <p>\u5982\u679c\u7528\u6236\u5df2\u7d93\u5728\u623f\u9593\u4e2d,\u4ed6\u5011\u5c07\u7121\u6cd5\u518d\u770b\u5230 \u623f\u9593\u91cc\u6709\u65b0\u4e8b\u4ef6\u3002\u5982\u679c\u804a\u5929\u5ba4\u9700\u8981\u9080\u8acb\u624d\u80fd\u52a0\u5165,\u5247 \u9700\u8981\u91cd\u65b0\u9080\u8acb\u624d\u80fd\u91cd\u65b0\u52a0\u5165\u3002</p> <p>\u5982\u679c\u4f7f\u7528\u8005\u88ab\u9080\u8acb\u52a0\u5165\u804a\u5929\u5ba4,\u4f46\u5c1a\u672a\u52a0\u5165,\u5247\u6b64\u547c\u53eb \u7528\u65bc\u62d2\u7d55\u9080\u8acb\u3002</p> <p>\u4f7f\u7528\u8005\u4ecd\u88ab\u5141\u8a31\u5f9e\u623f\u9593\u4e2d\u6aa2\u7d22\u6b77\u53f2\u8a18\u9304 \u4ed6\u5011\u4ee5\u524d\u88ab\u5141\u8a31\u770b\u5230\u3002</p> <p>\u8acb\u6c42\u6b63\u6587\u793a\u4f8b</p> <pre><code>{\n  \"reason\": \"Saying farewell - thanks for the support!\"\n}\n</code></pre> <p>200 \u56de\u61c9</p> <pre><code>{}\n</code></pre>"},{"location":"chat/client_server/#post-_matrixclientv3roomsroomidkick","title":"POST /_matrix/client/v3/rooms/{roomId}/kick","text":"<p>\u5c07\u4f7f\u7528\u8005\u8e22\u51fa\u623f\u9593\u3002</p> <p>\u8abf\u7528\u65b9\u5fc5\u9808\u5177\u6709\u6240\u9700\u7684\u529f\u7387\u7d1a\u5225\u624d\u80fd\u57f7\u884c\u6b64\u64cd\u4f5c\u3002</p> <p>\u8e22\u51fa\u4f7f\u7528\u8005\u6703\u5c07\u76ee\u6a19\u6210\u54e1\u7684\u6210\u54e1\u8cc7\u683c\u72c0\u614b\u8abf\u6574\u70ba \u81ea\u9078\u3002\u8207\u5176\u4ed6\u6210\u54e1\u8cc7\u683c\u66f4\u6539\u4e00\u6a23,\u7528\u6236\u53ef\u4ee5\u76f4\u63a5\u8abf\u6574 \u901a\u904e\u5411\u767c\u51fa\u8acb\u6c42\u4f86\u986f\u793a\u76ee\u6a19\u6210\u54e1\u7684\u72c0\u614b\u3002leavereason/rooms/ /state/m.room.member/ <p>\u8acb\u6c42\u6b63\u6587\u793a\u4f8b</p> <pre><code>{\n  \"reason\": \"Telling unfunny jokes\",\n  \"user_id\": \"@cheeky_monkey:matrix.org\"\n}\n</code></pre> <p>200 \u56de\u61c9</p> <pre><code>{}\n</code></pre>"},{"location":"chat/client_server/#86","title":"8.6 \u5217\u51fa\u623f\u9593","text":""},{"location":"chat/client_server/#get-_matrixclientv3directorylistroomroomid","title":"GET /_matrix/client/v3/directory/list/room/{roomId}","text":"<p>\u7372\u53d6\u7d66\u5b9a\u6a94\u5ba4\u5728\u4f3a\u670d\u5668\u7684\u516c\u5171\u6703\u8b70\u5ba4\u76ee\u9304\u4e2d\u7684\u53ef\u898b\u6027\u3002</p> <p>200 \u56de\u61c9</p> <pre><code>{\n  \"visibility\": \"public\"\n}\n</code></pre>"},{"location":"chat/client_server/#put-_matrixclientv3directorylistroomroomid","title":"PUT /_matrix/client/v3/directory/list/room/{roomId}","text":"<p>\u8a2d\u7f6e\u7d66\u5b9a\u804a\u5929\u5ba4\u5728\u4f3a\u670d\u5668\u516c\u5171\u804a\u5929\u5ba4\u4e2d\u7684\u53ef\u898b\u6027 \u76ee\u9304\u3002</p> <p>\u4f3a\u670d\u5668\u53ef\u4ee5\u9078\u64c7\u5be6\u65bd\u984d\u5916\u7684\u8a2a\u554f\u63a7\u5236\u6aa2\u67e5 \u4f8b\u5982,\u5728\u9019\u88e1,\u623f\u9593\u7684\u53ef\u898b\u6027\u53ea\u80fd\u901a\u904e\u4ee5\u4e0b\u65b9\u5f0f\u66f4\u6539 \u804a\u5929\u5ba4\u5efa\u7acb\u8005\u6216\u4f3a\u670d\u5668\u7ba1\u7406\u54e1\u3002</p> <p>\u8acb\u6c42\u6b63\u6587\u793a\u4f8b</p> <pre><code>{\n  \"visibility\": \"public\"\n}\n</code></pre> <p>200 \u56de\u61c9</p> <pre><code>{}\n</code></pre>"},{"location":"chat/client_server/#get-_matrixclientv3publicrooms","title":"GET /_matrix/client/v3/publicRooms","text":"<p>\u5217\u51fa\u4f3a\u670d\u5668\u4e0a\u7684\u516c\u5171\u6703\u8b70\u5ba4\u3002</p> <p>\u6b64 API \u8fd4\u56de\u5206\u9801\u56de\u61c9\u3002\u623f\u9593\u6309\u7de8\u865f\u6392\u5e8f \u52a0\u5165\u7684\u6210\u54e1,\u6700\u5927\u7684\u623f\u9593\u6392\u5728\u7b2c\u4e00\u4f4d\u3002</p> <p>200 \u56de\u61c9</p> <pre><code>{\n  \"chunk\": [\n    {\n      \"avatar_url\": \"mxc://bleecker.street/CHEDDARandBRIE\",\n      \"guest_can_join\": false,\n      \"join_rule\": \"public\",\n      \"name\": \"CHEESE\",\n      \"num_joined_members\": 37,\n      \"room_id\": \"!ol19s:bleecker.street\",\n      \"room_type\": \"m.space\",\n      \"topic\": \"Tasty tasty cheese\",\n      \"world_readable\": true\n    }\n  ],\n  \"next_batch\": \"p190q\",\n  \"prev_batch\": \"p1902\",\n  \"total_room_count_estimate\": 115\n}\n</code></pre>"},{"location":"chat/client_server/#9","title":"9 \u7528\u6236\u6578\u64da","text":""},{"location":"chat/client_server/#91","title":"9.1 \u7528\u6236\u76ee\u9304","text":""},{"location":"chat/client_server/#post-_matrixclientv3user_directorysearch","title":"POST /_matrix/client/v3/user_directory/search","text":"<p>\u5c0d\u4f7f\u7528\u8005\u57f7\u884c\u641c\u7d22\u3002\u4e3b\u4f3a\u670d\u5668\u53ef\u80fd \u78ba\u5b9a\u641c\u7d22\u54ea\u4e9b\u7528\u6236\u5b50\u96c6,\u4f46\u4e3b\u4f3a\u670d\u5668 \u5fc5\u9808\u81f3\u5c11\u8003\u616e\u8acb\u6c42\u4f7f\u7528\u8005\u5171\u4eab\u7684\u4f7f\u7528\u8005 \u8207\u5c45\u4f4f\u5728\u516c\u5171\u623f\u9593\uff08\u5bb6\u5ead\u4f3a\u670d\u5668\u5df2\u77e5\uff09\u7684\u4eba\u7684\u623f\u9593\u3002 \u641c\u7d22\u5fc5\u9808\u8003\u616e\u672c\u5730\u4f7f\u7528\u8005\u5230\u4e3b\u4f3a\u670d\u5668,\u4e26\u4e14\u61c9\u8a72 \u5728\u641c\u7d22\u904e\u7a0b\u4e2d\u67e5\u8a62\u9060\u7aef\u4f7f\u7528\u8005\u3002</p> <p>\u641c\u7d22\u5c0d\u4f7f\u7528\u8005 ID \u548c\u986f\u793a\u4e0d\u5340\u5206\u5927\u5c0f\u5beb \u540d\u7a31\u6700\u597d\u4f7f\u7528\u57fa\u65bc\u8acb\u6c42\u4e2d\u63d0\u4f9b\u7684\u6a19\u982d\uff08\u5982\u679c\u5b58\u5728\uff09\u78ba\u5b9a\u7684\u6392\u5e8f\u898f\u5247\u3002Accept-Language</p> <p>\u8acb\u6c42\u6b63\u6587\u793a\u4f8b</p> <pre><code>{\n  \"limit\": 10,\n  \"search_term\": \"foo\"\n}\n</code></pre> <p>200 \u56de\u61c9</p> <pre><code>{\n  \"limited\": false,\n  \"results\": [\n    {\n      \"avatar_url\": \"mxc://bar.com/foo\",\n      \"display_name\": \"Foo\",\n      \"user_id\": \"@foo:bar.com\"\n    }\n  ]\n}\n</code></pre>"},{"location":"chat/client_server/#92","title":"9.2 \u914d\u7f6e \u6a94","text":""},{"location":"chat/client_server/#get-_matrixclientv3profileuserid","title":"GET /_matrix/client/v3/profile/{userId}","text":"<p>\u7372\u53d6\u6b64\u4f7f\u7528\u8005\u7684\u7d44\u5408\u914d\u7f6e\u6a94\u8cc7\u8a0a\u3002\u53ef\u4ee5\u4f7f\u7528\u6b64\u4ecb\u9762 \u7372\u53d6\u4f7f\u7528\u8005\u81ea\u5df1\u7684\u500b\u4eba\u8cc7\u6599\u8cc7\u8a0a\u6216\u5176\u4ed6\u4f7f\u7528\u8005;\u4e5f \u672c\u5730\u6216\u9060\u7aef\u5bb6\u5ead\u4f3a\u670d\u5668\u4e0a\u3002\u6b64 API \u53ef\u80fd\u6703\u8fd4\u56de\u4e0d\u662f \u53ea\u9650\u65bc\u6216 \u3002displaynameavatar_url</p> <p>200 \u56de\u61c9</p> <pre><code>{\n  \"avatar_url\": \"mxc://matrix.org/SDGdghriugerRg\",\n  \"displayname\": \"Alice Margatroid\"\n}\n</code></pre>"},{"location":"chat/client_server/#get-_matrixclientv3profileuseridavatar_url","title":"GET /_matrix/client/v3/profile/{userId}/avatar_url","text":"<p>\u7372\u53d6\u7528\u6236\u7684\u982d\u50cf\u7db2\u5740\u3002\u6b64 API \u53ef\u7528\u65bc\u7372\u53d6\u4f7f\u7528\u8005\u7684 \u64c1\u6709\u982d\u50cf\u7db2\u5740\u6216\u67e5\u8a62\u5176\u4ed6\u4f7f\u7528\u8005\u7684\u7db2\u5740;\u672c\u5730\u6216 \u5728\u9060\u7aef\u5bb6\u5ead\u4f3a\u670d\u5668\u4e0a\u3002</p> <p>200 \u56de\u61c9</p> <pre><code>{\n  \"avatar_url\": \"mxc://matrix.org/SDGdghriugerRg\"\n}\n</code></pre>"},{"location":"chat/client_server/#put-_matrixclientv3profileuseridavatar_url","title":"PUT /_matrix/client/v3/profile/{userId}/avatar_url","text":"<p>\u6b64 API \u8a2d\u5b9a\u7d66\u5b9a\u4f7f\u7528\u8005\u7684\u982d\u50cf URL\u3002\u60a8\u5fc5\u9808\u5177\u6709\u4ee5\u4e0b\u6b0a\u9650:\u8a2d\u5b9a\u6b64\u4f7f\u7528\u8005\u7684\u982d\u50cf URL,\u4f8b\u5982,\u60a8\u9700\u8981\u64c1\u6709\u4ed6\u5011\u7684 .access_token</p> <p>\u8acb\u6c42\u6b63\u6587\u793a\u4f8b</p> <pre><code>{\n  \"avatar_url\": \"mxc://matrix.org/wefh34uihSDRGhw34\"\n}\n</code></pre> <p>200 \u56de\u61c9</p> <pre><code>{}\n</code></pre>"},{"location":"chat/client_server/#get-_matrixclientv3profileuseriddisplayname","title":"GET /_matrix/client/v3/profile/{userId}/displayname","text":"<p>\u7372\u53d6\u4f7f\u7528\u8005\u7684\u986f\u793a\u540d\u7a31\u3002\u6b64 API \u53ef\u7528\u65bc\u7372\u53d6\u4f7f\u7528\u8005\u7684 \u81ea\u5df1\u7684\u986f\u793a\u540d\u7a31\u6216\u67e5\u8a62\u5176\u4ed6\u7528\u6236\u7684\u540d\u7a31;\u672c\u5730\u6216 \u5728\u9060\u7aef\u5bb6\u5ead\u4f3a\u670d\u5668\u4e0a\u3002</p> <pre><code>{\n  \"displayname\": \"Alice Margatroid\"\n}\n</code></pre>"},{"location":"chat/client_server/#put-_matrixclientv3profileuseriddisplayname","title":"PUT /_matrix/client/v3/profile/{userId}/displayname","text":"<p>\u6b64 API \u8a2d\u5b9a\u7d66\u5b9a\u4f7f\u7528\u8005\u7684\u986f\u793a\u540d\u7a31\u3002\u60a8\u5fc5\u9808\u5177\u6709\u4ee5\u4e0b\u6b0a\u9650:\u8a2d\u5b9a\u6b64\u4f7f\u7528\u8005\u7684\u986f\u793a\u540d\u7a31,\u4f8b\u5982,\u60a8\u9700\u8981\u5177\u6709\u4ed6\u5011\u7684 .access_token</p> <p>\u8acb\u6c42\u6b63\u6587\u793a\u4f8b</p> <pre><code>{\n  \"displayname\": \"Alice Margatroid\"\n}\n</code></pre> <p>200 \u56de\u61c9</p> <pre><code>{}\n</code></pre>"},{"location":"chat/client_server/#921","title":"9.2.1 \u500b\u4eba\u8cc7\u6599\u8cc7\u8a0a\u8b8a\u66f4\u4e8b\u4ef6","text":"<p>\u56e0\u70ba\u914d\u7f6e\u6587\u4ef6\u986f\u793a\u540d\u7a31\u548c\u982d\u50cf\u8cc7\u8a0a\u5f88\u53ef\u80fd\u662f \u5728\u5ba2\u6236\u7aef\u986f\u793a\u7684\u8a31\u591a\u4f4d\u7f6e\u4f7f\u7528,\u5c0d\u9019\u4e9b\u6b04\u4f4d\u7684\u66f4\u6539\u6703\u5c0e\u81f4 \u767c\u751f\u81ea\u52d5\u50b3\u64ad\u4e8b\u4ef6,\u901a\u77e5\u53ef\u80fd\u611f\u8208\u8da3\u7684\u4eba \u65b0\u50f9\u503c\u89c0\u7684\u5404\u65b9\u3002\u6b64\u66f4\u6539\u4f7f\u7528\u5169\u500b\u55ae\u7368\u7684 \u6a5f\u5236:</p> <ul> <li>\u4e00\u500b\u4e8b\u4ef6\uff08\u5177\u6709\u6210\u54e1\u8cc7\u683c\uff09\u88ab\u767c\u9001\u5230\u6bcf\u500b \u4f7f\u7528\u8005\u6240\u5c6c\u7684\u804a\u5929\u5ba4,\u4ee5\u66f4\u65b0 \u548c \u3002m.room.memberjoindisplaynameavatar_url</li> <li>\u767c\u9001\u72c0\u614b\u66f4\u65b0,\u518d\u6b21\u5305\u542b \u548c\u9375\u7684\u65b0\u503c,\u6b64\u5916 \u5230\u5305\u542b\u7576\u524d\u72c0\u614b\u7684\u5fc5\u9700\u9375 \u7684\u4f7f\u7528\u8005\u3002m.presencedisplaynameavatar_urlpresence   \u7576\u4f7f\u7528\u8005\u4f7f\u7528\u6642,\u9019\u5169\u8005\u90fd\u61c9\u7531\u4e3b\u4f3a\u670d\u5668\u81ea\u52d5\u5b8c\u6210 \u6210\u529f\u66f4\u6539\u5176\u986f\u793a\u540d\u7a31\u6216\u982d\u50cf URL \u6b04\u4f4d\u3002</li> </ul> <p>\u6b64\u5916,\u7576\u4e3b\u4f3a\u670d\u5668\u70ba\u81ea\u5df1\u767c\u51fa\u623f\u9593\u6210\u54e1\u8eab\u4efd\u4e8b\u4ef6\u6642 \u7528\u6236,\u4ed6\u5011\u61c9\u8a72\u5728 \u9019\u4e9b\u4e8b\u4ef6\u4f7f\u5ba2\u6236\u5df2\u7d93\u638c\u63e1\u4e86\u9019\u4e9b\u8a73\u7d30\u8cc7\u8a0a,\u4e26\u4e14 \u4e0d\u5fc5\u57f7\u884c\u984d\u5916\u7684\u5f80\u8fd4\u4f86\u67e5\u8a62\u5b83\u3002</p>"},{"location":"chat/client_server/#10","title":"10 \u5b89\u5168","text":""},{"location":"chat/client_server/#101","title":"10.1 \u901f\u7387\u9650\u5236","text":"<p>\u5bb6\u5ead\u4f3a\u670d\u5668\u61c9\u5be6\u65bd\u901f\u7387\u9650\u5236\u4ee5\u964d\u4f4e\u98a8\u96aa \u91cd\u8f09\u3002\u5982\u679c\u8acb\u6c42\u56e0\u901f\u7387\u9650\u5236\u800c\u88ab\u62d2\u7d55,\u5247\u61c9 \u50b3\u56de\u4ee5\u4e0b\u5f62\u5f0f\u7684\u6a19\u6e96\u932f\u8aa4\u56de\u61c9:</p> <pre><code>{\n  \"errcode\": \"M_LIMIT_EXCEEDED\",\n  \"error\": \"string\",\n  \"retry_after_ms\": integer (optional)\n}\n</code></pre> <p>\u61c9\u5305\u542b\u91d1\u9470\u4ee5\u544a\u8a34\u5ba2\u6236\u7aef\u591a\u9577\u6642\u9593 \u4ed6\u5011\u5fc5\u9808\u5728\u5e7e\u6beb\u79d2\u5167\u7b49\u5f85,\u7136\u5f8c\u624d\u80fd\u91cd\u8a66\u3002retry_after_ms</p>"},{"location":"chat/client_server/#11_1","title":"11 \u6a21\u7d44","text":"<p>\u6a21\u7d44\u662f\u7528\u6236\u7aef-\u4f3a\u670d\u5668 API \u7684\u4e00\u90e8\u5206,\u4e26\u975e\u901a\u7528 \u6240\u6709\u7d42\u7d50\u9ede\u3002\u6a21\u7d44\u5728\u6b64\u898f\u7bc4\u4e2d\u56b4\u683c\u5b9a\u7fa9 \u4e26\u4e14\u4e0d\u61c9\u88ab\u8aa4\u8a8d\u70ba\u662f\u5be6\u9a57\u6027\u64f4\u5c55\u6216\u53ef\u9078\u64f4\u5c55 \u7279\u5fb5\u3002\u76f8\u5bb9\u7684\u4f3a\u670d\u5668\u5be6\u73fe\u5fc5\u9808\u652f\u63f4\u6240\u6709\u6a21\u7d44\u548c \u652f\u63f4\u898f\u7bc4\uff08\u9664\u975e\u5be6\u73fe\u50c5\u91dd\u5c0d\u7528\u6236\u7aef \u67d0\u4e9b\u914d\u7f6e\u6a94,\u5728\u9019\u7a2e\u60c5\u6cc1\u4e0b,\u53ea\u6709\u90a3\u4e9b\u914d\u7f6e\u6a94\u6240\u9700\u7684\u6a21\u7d44 \u5fc5\u9808\u5be6\u73fe\u529f\u80fd\u914d\u7f6e\u6a94\uff09\u3002\u5408\u898f\u7684\u5ba2\u6236\u7aef\u5be6\u73fe \u5fc5\u9808\u652f\u63f4\u6240\u6709\u5fc5\u9700\u7684\u6a21\u7d44\u548c\u652f\u6301\u898f\u7bc4 \u5b83\u6240\u91dd\u5c0d\u7684\u529f\u80fd\u914d\u7f6e\u6a94\u3002</p>"},{"location":"chat/client_server/#111_1","title":"11.1 \u529f\u80fd\u914d\u7f6e\u6a94","text":"<p>\u77e9\u9663\u652f\u63f4\u8a31\u591a\u4e0d\u540c\u985e\u578b\u7684\u7528\u6236\u7aef:\u4f86\u81ea\u5d4c\u5165\u5f0f\u7269\u806f\u7db2 \u8a2d\u5099\u5230\u684c\u9762\u7528\u6236\u7aef\u3002\u4e26\u975e\u6240\u6709\u7528\u6236\u7aef\u90fd\u53ef\u4ee5\u63d0\u4f9b\u76f8\u540c\u7684\u529f\u80fd \u8a2d\u7f6e\u70ba\u5176\u4ed6\u7528\u6236\u7aef,\u4f8b\u5982\u7531\u65bc\u7f3a\u5c11\u7269\u7406\u786c\u9ad4,\u4f8b\u5982 \u6709\u4e00\u500b\u87a2\u5e55\u3002\u7528\u6236\u7aef\u53ef\u4ee5\u5c6c\u65bc\u591a\u500b\u914d\u7f6e\u6a94\u4e4b\u4e00,\u6bcf\u500b\u914d\u7f6e\u6a94 \u914d\u7f6e\u6a94\u5305\u542b\u5ba2\u6236\u7aef\u5fc5\u9808\u652f\u63f4\u7684\u4e00\u7d44\u529f\u80fd\u3002\u9019 \u90e8\u5206\u8a73\u7d30\u4ecb\u7d39\u4e86\u4e00\u7d44'\u529f\u80fd\u914d\u7f6e\u6a94'\u3002\u5ba2\u6236\u61c9 \u5b8c\u6574\u5730\u5be6\u73fe\u914d\u7f6e\u6a94,\u4ee5\u4fbf\u5c07\u5176\u5206\u985e\u70ba \u8a72\u914d\u7f6e\u6a94\u3002</p>"},{"location":"chat/client_server/#112_1","title":"11.2 \u5373\u6642\u901a\u8a0a","text":"<p>\u6b64\u6a21\u7d44\u589e\u52a0\u4e86\u5c0d\u5411\u623f\u9593\u767c\u9001\u4eba\u985e\u53ef\u8b80\u6d88\u606f\u7684\u652f\u63f4\u3002 \u5b83\u9084\u589e\u52a0\u4e86\u5c0d\u5c07\u4eba\u985e\u53ef\u8b80\u8cc7\u8a0a\u8207 \u623f\u9593\u672c\u8eab,\u4f8b\u5982\u623f\u9593\u540d\u7a31\u548c\u4e3b\u984c\u3002</p>"},{"location":"chat/client_server/#1121","title":"11.2.1 \u4e8b\u4ef6","text":""},{"location":"chat/client_server/#mroommessage","title":"m.room.message","text":"<p>\u5728\u804a\u5929\u5ba4\u4e2d\u767c\u9001\u6d88\u606f\u6642\u4f7f\u7528\u6b64\u4e8b\u4ef6\u3002\u6d88\u606f\u4e0d\u9650\u65bc\u6587\u672c\u3002\u9375\u6982\u8ff0\u4e86\u6d88\u606f\u7684\u985e\u578b,\u4f8b\u5982\u6587\u672c,\u97f3\u8a0a,\u5716\u50cf,\u8996\u983b\u7b49\u3002\u5bc6\u9470\u662f\u6587\u672c,\u5fc5\u9808\u8207\u5404\u7a2e\u4e00\u8d77\u4f7f\u7528,\u4f5c\u70ba\u5ba2\u6236\u7aef\u7121\u6cd5\u5448\u73fe\u6d88\u606f\u6642\u7684\u56de\u9000\u6a5f\u5236\u3002\u9019\u5141\u8a31\u5ba2\u6236\u7aef\u986f\u793a\u67d0\u4e9b\u5167\u5bb9,\u5373\u4f7f\u5b83\u53ea\u662f\u7d14\u6587\u5b57\u3002msgtypebodymsgtype</p> <pre><code>{\n  \"content\": {\n    \"body\": \"This is an example text message\",\n    \"format\": \"org.matrix.custom.html\",\n    \"formatted_body\": \"&lt;b&gt;This is an example text message&lt;/b&gt;\",\n    \"msgtype\": \"m.text\"\n  },\n  \"event_id\": \"$143273582443PhrSn:example.org\",\n  \"origin_server_ts\": 1432735824653,\n  \"room_id\": \"!jEsUZKDJdhlrceRyVU:example.org\",\n  \"sender\": \"@example:example.org\",\n  \"type\": \"m.room.message\",\n  \"unsigned\": {\n    \"age\": 1234\n  }\n}\n</code></pre>"},{"location":"chat/client_server/#1122","title":"11.2.2 \u5ba2\u6236\u7aef\u884c\u70ba","text":"<p>\u7528\u6236\u7aef\u61c9\u9a57\u8b49\u50b3\u5165\u4e8b\u4ef6\u7684\u7d50\u69cb,\u4ee5\u78ba\u4fdd \u9810\u671f\u7684\u9375\u5b58\u5728,\u4e26\u4e14\u5b83\u5011\u5c6c\u65bc\u6b63\u78ba\u7684\u985e\u578b\u3002\u5ba2\u6236\u53ef\u4ee5 \u653e\u68c4\u683c\u5f0f\u932f\u8aa4\u7684\u4e8b\u4ef6\u6216\u5411\u7528\u6236\u986f\u793a\u4f54\u4f4d\u5143\u6d88\u606f\u3002 \u5fc5\u9808\u5f9e\u7528\u6236\u7aef\u4e2d\u522a\u9664\u5df2\u7de8\u8f2f\u7684'm.room.message'\u4e8b\u4ef6\u3002\u9019 \u53ef\u4ee5\u7528\u4f54\u4f4d\u5143\u6587\u672c\u66ff\u63db\uff08\u4f8b\u5982\"[\u5df2\u7de8\u8f2f]\"\uff09\u6216 \u53ef\u4ee5\u5f9e\u90f5\u4ef6\u6aa2\u8996\u4e2d\u5b8c\u5168\u522a\u9664\u5df2\u7de8\u8f2f\u7684\u90f5\u4ef6\u3002</p> <p>\u5305\u542b\u9644\u4ef6\u7684\u4e8b\u4ef6\uff08\u4f8b\u5982\"m.image\",\"m.file\"\uff09\u61c9\u8a72\u662f \u4f7f\u7528 [\u5167\u5bb9\u5b58\u5132\u5eab\u6a21\u7d44]\uff08#content\u5b58\u50a8\u5e93\uff09\u4e0a\u50b3 \u5982\u679c\u53ef\u7528\u3002\u7136\u5f8c,\u53ef\u4ee5\u5728\"url\"\u4e2d\u4f7f\u7528\u751f\u6210\u7684\"mxc://\"URI \u3002.key\u3002</p> <p>\u7528\u6236\u7aef\u53ef\u4ee5\u5305\u542b\u7528\u6236\u7aef\u751f\u6210\u7684\u9644\u4ef6\u7e2e\u5716 \u5728\"info.thumbnail_url\"\u9375\u4e0b\u3002\u7e2e\u5716\u4e5f\u61c9\u8a72\u662f \"mxc://\"\u70cf\u91cc\u3002\u986f\u793a\u5e36\u6709\u9644\u4ef6\u7684\u4e8b\u4ef6\u7684\u7528\u6236\u7aef\u53ef\u4ee5\u4f7f\u7528 \u7528\u6236\u7aef\u751f\u6210\u7684\u7e2e\u5716\u6216\u8981\u6c42\u5176\u4e3b\u4f3a\u670d\u5668\u751f\u6210 \u539f\u59cb\u9644\u4ef6\u4e2d\u7684\u7e2e\u5716,\u4f7f\u7528 [\u5167\u5bb9\u5b58\u5132\u5eab \u6a21\u7d44]\uff08#content\u5b58\u50a8\u5e93\uff09\u3002</p>"},{"location":"chat/client_server/#_1","title":"\u767c\u9001\u6d88\u606f\u6642\u7684\u5efa\u8b70","text":"<p>\u5982\u679c\u767c\u9001\u5931\u6557,\u7528\u6236\u7aef\u61c9\u4f7f\u7528 \u4e00\u5b9a\u6642\u9593 T \u7684\u6307\u6578\u9000\u907f\u6f14\u7b97\u6cd5\u3002\u662f\u7684 \u5efa\u8b70 T \u4e0d\u8d85\u904e 5 \u5206\u9418\u3002\u5728\u6b64\u4e4b\u5f8c, \u7528\u6236\u7aef\u61c9\u505c\u6b62\u91cd\u8a66\u4e26\u5c07\u6d88\u606f\u6a19\u8a18\u70ba'\u672a\u767c\u9001'\u3002\u4f7f\u7528\u8005 \u61c9\u8a72\u80fd\u5920\u624b\u52d5\u91cd\u65b0\u767c\u9001\u672a\u767c\u9001\u7684\u6d88\u606f\u3002</p> <p>\u7528\u6236\u53ef\u4ee5\u4e00\u6b21\u9375\u5165\u591a\u689d\u6d88\u606f\u4e26\u5feb\u901f\u767c\u9001\u6240\u6709\u6d88\u606f \u7e7c\u627f\u3002\u7528\u6236\u7aef\u61c9\u4fdd\u7559\u767c\u9001\u5b83\u5011\u7684\u9806\u5e8f \u4f7f\u7528\u8005\u3002\u9019\u610f\u5473\u8457\u5ba2\u6236\u7aef\u61c9\u7b49\u5f85\u5c0d \u767c\u9001\u4e0b\u4e00\u500b\u8acb\u6c42\u4e4b\u524d\u7684\u4e0a\u4e00\u500b\u8acb\u6c42\u3002\u9019\u53ef\u80fd\u5c0e\u81f4 \u7dda\u982d\u963b\u585e\u3002\u70ba\u4e86\u6e1b\u5c11\u7dda\u982d\u7684\u5f71\u97ff \u963b\u585e,\u7528\u6236\u7aef\u61c9\u4f7f\u7528\u6bcf\u500b\u623f\u9593\u7684\u4f47\u5217,\u800c\u4e0d\u662f\u5168\u57df\u4f47\u5217 \u4f47\u5217,\u56e0\u70ba\u8a02\u8cfc\u50c5\u5728\u55ae\u500b\u623f\u9593\u5167\u76f8\u95dc,\u800c\u4e0d\u662f \u623f\u9593\u4e4b\u9593\u3002</p>"},{"location":"chat/client_server/#_2","title":"\u672c\u5730\u56de\u8072","text":"<p>\u7576\u4f7f\u7528\u8005\u4f7f\u7528\u6642,\u6d88\u606f\u61c9\u7acb\u5373\u986f\u793a\u5728\u6d88\u606f\u6aa2\u8996\u4e2d \u6309\u4e0b'\u767c\u9001'\u6309\u9215\u3002\u5373\u4f7f\u6d88\u606f\u662f \u4ecd\u5728\u767c\u9001\u3002\u9019\u7a31\u70ba'\u672c\u5730\u56de\u8072'\u3002\u5ba2\u6236\u61c9\u8a72 \u5be6\u73fe\u6d88\u606f\u7684'\u672c\u5730\u56de\u986f'\u3002\u7528\u6236\u7aef\u53ef\u4ee5\u5728 \u4e0d\u540c\u7684\u683c\u5f0f,\u4ee5\u6307\u793a\u4f3a\u670d\u5668\u5c1a\u672a\u8655\u7406 \u6d88\u606f\u3002\u4f3a\u670d\u5668\u56de\u61c9\u6642\u61c9\u522a\u9664\u6b64\u683c\u5f0f\u3002</p> <p>\u7528\u6236\u7aef\u9700\u8981\u80fd\u5920\u5c07\u4ed6\u5011\u767c\u9001\u7684\u6d88\u606f\u8207 \u4ed6\u5011\u5f9e\u4e8b\u4ef6\u6d41\u6536\u5230\u7684\u6d88\u606f\u76f8\u540c\u3002\u56de\u8072 \u4f86\u81ea\u4e8b\u4ef6\u6d41\u7684\u540c\u4e00\u6d88\u606f\u7a31\u70ba'\u9060\u7aef\u56de\u8072'\u3002\u3002\u96d9 \u56de\u8072\u9700\u8981\u6a19\u8b58\u70ba\u540c\u4e00\u6d88\u606f,\u4ee5\u9632\u6b62 \u986f\u793a\u91cd\u8907\u6d88\u606f\u3002\u7406\u60f3\u60c5\u6cc1\u4e0b,\u9019\u7a2e\u914d\u5c0d\u6703\u767c\u751f \u5c0d\u4f7f\u7528\u8005\u900f\u660e:UI \u5728\u8f49\u63db\u6642\u4e0d\u6703\u9583\u720d \u5f9e\u672c\u5730\u5230\u9060\u7aef\u3002\u53ef\u4ee5\u901a\u904e\u7528\u6236\u7aef\u4f7f\u9583\u720d\u6e1b\u5c11 \u4f7f\u7528\u4ed6\u5011\u7528\u65bc\u767c\u9001\u7279\u5b9a\u4e8b\u4ef6\u7684\u4e8b\u52d9ID\u3002\u9019 \u4f7f\u7528\u7684\u4ea4\u6613 ID \u5c07\u5305\u542b\u5728\u4e8b\u4ef6\u7684'\u672a\u7c3d\u540d'\u6578\u64da\u4e2d,\u4f5c\u70ba \u7576\u5b83\u901a\u904e\u4e8b\u4ef6\u6d41\u5230\u9054\u6642transaction_id\u3002</p> <p>\u7121\u6cd5\u4f7f\u7528\u4ea4\u6613 ID \u7684\u7528\u6236\u7aef\u53ef\u80fd\u6703 \u7576\u9060\u7aef\u56de\u8072\u5230\u9054\u4e8b\u4ef6\u6d41\u6642\u9ad4\u9a57\u9583\u720d \u5728\u767c\u9001\u6d88\u606f\u7684\u8acb\u6c42\u5b8c\u6210\u4e4b\u524d\u3002\u5728\u9019\u7a2e\u60c5\u6cc1\u4e0b, \u4e8b\u4ef6\u5728\u5ba2\u6236\u7aef\u7372\u53d6\u4e8b\u4ef6 ID \u4e4b\u524d\u5230\u9054,\u4f7f\u5176 \u7121\u6cd5\u5c07\u5176\u8b58\u5225\u70ba\u9060\u7aef\u56de\u8072\u3002\u9019\u6703\u5c0e\u81f4\u7528\u6236\u7aef \u5728\u4e00\u6bb5\u6642\u9593\u5167\u986f\u793a\u5169\u6b21\u6d88\u606f\uff08\u53d6\u6c7a\u65bc\u4f3a\u670d\u5668\uff09 \u56de\u61c9\u80fd\u529b\uff09\u5728\u539f\u59cb\u8acb\u6c42\u767c\u9001\u6d88\u606f\u4e4b\u524d \u5b8c\u6210\u3002\u5b8c\u6210\u5f8c,\u5ba2\u6236\u7aef\u53ef\u4ee5\u63a1\u53d6\u88dc\u6551\u63aa\u65bd\u4f86 \u901a\u904e\u67e5\u627e\u91cd\u8907\u7684\u4e8b\u4ef6ID\u4f86\u522a\u9664\u91cd\u8907\u7684\u4e8b\u4ef6\u3002</p>"},{"location":"chat/client_server/#_3","title":"\u8a08\u7b97\u4f7f\u7528\u8005\u7684\u986f\u793a\u540d\u7a31","text":"<p>\u7528\u6236\u7aef\u53ef\u80fd\u5e0c\u671b\u986f\u793a\u623f\u9593\u7684\u4eba\u985e\u53ef\u8b80\u986f\u793a\u540d\u7a31 \u6210\u54e1\u8eab\u4efd,\u6216\u7576\u4ed6\u5011\u767c\u9001\u6d88\u606f\u6642\u3002 \u4f46\u662f,\u4e0d\u540c\u7684\u6210\u54e1\u53ef\u80fd\u5177\u6709\u885d\u7a81\u7684\u986f\u793a\u540d\u7a31\u3002\u986f\u793a \u5728\u5411\u7528\u6236\u986f\u793a\u540d\u7a31\u4e4b\u524d,\u5fc5\u9808\u6d88\u9664\u540d\u7a31\u7684\u6b67\u7fa9,\u4ee5\u4fbf \u9632\u6b62\u6b3a\u9a19\u5176\u4ed6\u4f7f\u7528\u8005\u3002</p> <p>\u70ba\u4e86\u78ba\u4fdd\u8de8\u7528\u6236\u7aef\u4e00\u81f4\u5730\u57f7\u884c\u6b64\u64cd\u4f5c,\u7528\u6236\u7aef\u61c9\u4f7f\u7528 \u4ee5\u4e0b\u6f14\u7b97\u6cd5\u7528\u65bc\u8a08\u7b97 \u7d66\u5b9a\u4f7f\u7528\u8005:</p> <ol> <li>\u6aa2\u67e5\u76f8\u95dc\u4f7f\u7528\u8005 ID \u7684\"m.room.member\"\u72c0\u614b\u4e8b\u4ef6\u3002</li> <li>\u5982\u679c\"m.room.member\"\u72c0\u614b\u4e8b\u4ef6\u6c92\u6709\"\u986f\u793a\u540d\u7a31\"\u5b57\u6bb5,\u6216\u8005\u5982\u679c    \u8a72\u6b04\u4f4d\u5177\u6709'null' \u503c,\u8acb\u4f7f\u7528\u539f\u59cb\u4f7f\u7528\u8005 ID \u4f5c\u70ba\u986f\u793a    \u540d\u5b57\u3002\u5426\u5247:</li> <li>\u5982\u679c\"m.room.member\"\u4e8b\u4ef6\u5177\u6709\u552f\u4e00\u7684\"\u986f\u793a\u540d\u7a31\"    \u5728\u5177\u6709'\u6210\u54e1\u8cc7\u683c:\u52a0\u5165'\u6216    \"\u6210\u54e1\u8cc7\u683c:\u9080\u8acb\",\u4f7f\u7528\u7d66\u5b9a\u7684\"\u986f\u793a\u540d\u7a31\"\u4f5c\u70ba    \u7528\u6236\u53ef\u898b\u7684\u986f\u793a\u540d\u7a31\u3002\u5426\u5247:</li> <li>\"m.room.member\"\u4e8b\u4ef6\u5177\u6709\u975e\u552f\u4e00\u7684\"\u986f\u793a\u540d\u7a31\"\u3002\u9019    \u61c9\u4f7f\u7528\u4f7f\u7528\u8005ID\u6d88\u9664\u6b67\u7fa9,\u4f8b\u5982\"\u986f\u793a\u540d\u7a31    (@id:homeserver.org\uff09\"\u3002</li> </ol> <p>\u958b\u767c\u4eba\u54e1\u5728\u5be6\u73fe\u4e0a\u8ff0\u5167\u5bb9\u6642\u61c9\u6ce8\u610f\u4ee5\u4e0b\u4e8b\u9805 \u6f14\u7b97\u6cd5:</p> <ul> <li>\u4e00\u500b\u6210\u54e1\u7684\u7528\u6236\u53ef\u898b\u986f\u793a\u540d\u7a31\u53ef\u80fd\u53d7\u5230\u4ee5\u4e0b\u56e0\u7d20\u7684\u5f71\u97ff   \u53e6\u4e00\u500b\u6210\u54e1\u7684\u72c0\u614b\u66f4\u6539\u3002\u4f8b\u5982,\u5982\u679c   \"@user1:matrix.org\"\u51fa\u73fe\u5728\u4e00\u500b\u623f\u9593\u91cc,\u5e36\u6709\"\u986f\u793a\u540d\u7a31:\u611b\u9e97\u7d72\",   \u7136\u5f8c\u7576\"@user2:\u793a\u4f8b.com\"\u52a0\u5165\u623f\u9593\u6642,\u4e5f\u8207   \"\u986f\u793a\u540d\u7a31:\u611b\u9e97\u7d72\",\u5169\u500b\u7528\u6236\u5fc5\u9808\u6d88\u9664\u6b67\u7fa9   \u986f\u793a\u540d\u7a31\u3002\u540c\u6a23,\u7576\u5176\u4e2d\u4e00\u500b\u4f7f\u7528\u8005\u96a8\u5f8c\u66f4\u6539\u5176   \u986f\u793a\u540d\u7a31,\u4e0d\u518d\u6709\u885d\u7a81,\u5169\u500b\u7528\u6236\u53ef\u4ee5   \u7d66\u5b9a\u4ed6\u5011\u9078\u64c7\u7684\u986f\u793a\u540d\u7a31\u3002\u5ba2\u6236\u61c9\u5c0d\u6b64\u4fdd\u6301\u8b66\u60d5   \u53ef\u80fd\u6027\u4e26\u78ba\u4fdd\u6240\u6709\u53d7\u5f71\u97ff\u7684\u4f7f\u7528\u8005\u90fd\u6b63\u78ba   \u91cd\u65b0\u547d\u540d\u3002</li> <li>\u804a\u5929\u5ba4\u7684\u986f\u793a\u540d\u7a31\u4e5f\u53ef\u80fd\u53d7\u5230   \u6210\u54e1\u540d\u55ae\u3002\u9019\u662f\u7531\u65bc\u623f\u9593\u540d\u7a31\u6709\u6642\u662f\u57fa\u65bc   \u5728\u4f7f\u7528\u8005\u986f\u793a\u540d\u7a31\u4e0a\uff08\u8acb\u53c3\u95b1 [\u8a08\u7b97 \u7684\u986f\u793a\u540d\u7a31   \u623f\u9593]\uff08#calculating\u623f\u95f4\u7684\u663e\u793a\u540d\u79f0\uff09\uff09\u3002</li> <li>\u5982\u679c\u641c\u7d22\u6574\u500b\u6210\u54e1\u8eab\u4efd\u6e05\u55ae\u4ee5\u986f\u793a\u885d\u7a81   \u540d\u7a31,\u9019\u5c0e\u81f4\u7528\u65bc\u69cb\u5efa\u6e05\u55ae\u7684 O\uff08N^2\uff09 \u5be6\u73fe   \u7684\u623f\u9593\u6210\u54e1\u3002\u5c0d\u65bc\u5927\u578b\u623f\u9593\u4f86\u8aaa,\u9019\u5c07\u975e\u5e38\u4f4e\u6548   \u6210\u54e1\u4eba\u6578\u3002\u5efa\u8b70\u5ba2\u6236\u7aef\u5be6\u73fe   \u7dad\u8b77\u5f9e'\u986f\u793a\u540d\u7a31'\u5230\u623f\u9593\u6e05\u55ae\u7684\u54c8\u5e0c\u8868\u6620\u5c04   \u4f7f\u7528\u8a72\u540d\u7a31\u7684\u6210\u54e1\u3002\u7136\u5f8c\u53ef\u4ee5\u4f7f\u7528\u9019\u6a23\u7684\u8868\u4f86\u6709\u6548\u5730   \u8a08\u7b97\u662f\u5426\u9700\u8981\u6d88\u9664\u6b67\u7fa9\u3002</li> </ul>"},{"location":"chat/client_server/#_4","title":"\u4f7f\u7528\u6d88\u606f\u986f\u793a\u6210\u54e1\u8eab\u4efd\u8cc7\u8a0a","text":"<p>\u5ba2\u6236\u53ef\u80fd\u5e0c\u671b\u986f\u793a\u623f\u9593\u7684\u986f\u793a\u540d\u7a31\u548c\u982d\u50cfURL \u767c\u9001\u6d88\u606f\u7684\u6210\u54e1\u3002\u9019\u53ef\u4ee5\u901a\u904e\u6aa2\u67e5 \u8a72\u4f7f\u7528\u8005 ID \u7684\"m.room.member\"\u72c0\u614b\u4e8b\u4ef6\uff08\u8acb\u53c3\u95b1 [\u8a08\u7b97 \u7528\u6236\u7684\u986f\u793a\u540d\u7a31]\uff08#calculating\u7528\u6237\u7684\u663e\u793a\u540d\u79f0\uff09\uff09\u3002</p> <p>\u7576\u4f7f\u7528\u8005\u5c0d\u90f5\u4ef6\u6b77\u53f2\u8a18\u9304\u9032\u884c\u5206\u9801\u6642,\u7528\u6236\u7aef\u53ef\u80fd\u5e0c\u671b\u986f\u793a \u804a\u5929\u5ba4\u6210\u54e1\u7684\u986f\u793a\u540d\u7a31\u548c\u982d\u50cfURL\u3002\u9019\u662f \u53ef\u80fd\u662f\u56e0\u70ba\u8f03\u820a\u7684'm.room.member'\u4e8b\u4ef6\u5728\u4ee5\u4e0b\u60c5\u6cc1\u4e0b\u8fd4\u56de \u5206\u9801\u3002\u9019\u53ef\u4ee5\u901a\u904e\u4fdd\u7559\u5169\u7d44 \u623f\u9593\u72c0\u614b:\u820a\u548c\u7576\u524d\u3002\u96a8\u8457\u65b0\u4e8b\u4ef6\u7684\u5230\u4f86\u548c/\u6216\u4f7f\u7528\u8005 \u6642\u5149\u5012\u6d41,\u9019\u5169\u7d44\u72c0\u614b\u5f7c\u6b64\u5206\u9053\u63da\u9463\u3002 \u65b0\u4e8b\u4ef6\u66f4\u65b0\u7576\u524d\u72c0\u614b,\u5206\u9801\u4e8b\u4ef6\u66f4\u65b0\u820a\u72c0\u614b \u5dde\u3002\u6309\u9806\u5e8f\u8655\u7406\u5206\u9801\u4e8b\u4ef6\u6642,\u820a\u72c0\u614b \u8868\u793a\u767c\u9001\u4e8b\u4ef6\u6642\u804a\u5929\u5ba4\u7684\u72c0\u614b*\u3002\u9019 \u7136\u5f8c\u53ef\u7528\u65bc\u8a2d\u7f6e\u6b77\u53f2\u986f\u793a\u540d\u7a31\u548c\u982d\u50cfURL\u3002</p>"},{"location":"chat/client_server/#_5","title":"\u8a08\u7b97\u804a\u5929\u5ba4\u7684\u986f\u793a\u540d\u7a31","text":"<p>\u5ba2\u6236\u53ef\u80fd\u5e0c\u671b\u70ba\u623f\u9593\u986f\u793a\u4eba\u985e\u53ef\u8b80\u7684\u540d\u7a31\u3002\u6709\u4e00\u500b \u9078\u64c7\u6709\u7528\u540d\u7a31\u7684\u53ef\u80fd\u6027\u6578\u91cf\u3002\u78ba\u4fdd\u623f\u9593 \u5728\u7528\u6236\u7aef\u4e2d\u4e00\u81f4\u547d\u540d,\u7528\u6236\u7aef\u61c9\u4f7f\u7528\u4ee5\u4e0b\u540d\u7a31 \u9078\u64c7\u540d\u7a31\u7684\u6f14\u6f14\u7b97\u6cd5:</p> <ol> <li>\u5982\u679c\u804a\u5929\u5ba4\u5177\u6709\u975e\u7a7a\u7684 [m.room.name]\uff08#mroomname\uff09 \u72c0\u614b\u4e8b\u4ef6    \"\u540d\u7a31\"\u6b04\u4f4d,\u8acb\u4f7f\u7528\u8a72\u6b04\u4f4d\u6307\u5b9a\u7684\u540d\u7a31\u3002</li> <li>\u5982\u679c\u804a\u5929\u5ba4\u5177\u6709 [m.room.canonical_alias]\uff08#mroomcanonical_alias\uff09 \u72c0\u614b\u4e8b\u4ef6,\u4e26\u4e14    \u6709\u6548\u7684\"\u5225\u540d\"\u6b04\u4f4d,\u4f7f\u7528\u8a72\u5b57\u6bb5\u7d66\u51fa\u7684\u5225\u540d\u4f5c\u70ba\u540d\u7a31\u3002    \u8acb\u6ce8\u610f,\u5ba2\u6236\u7aef\u5728\u8a08\u7b97\u6642\u61c9\u907f\u514d\u4f7f\u7528\"alt_aliases\"    \u623f\u9593\u540d\u7a31\u3002    3.\u5982\u679c\u4ee5\u4e0a\u689d\u4ef6\u90fd\u4e0d\u6eff\u8db3,\u5247\u61c9\u7d44\u6210\u4e00\u500b\u540d\u7a31    \u57fa\u65bc\u623f\u9593\u7684\u6210\u54e1\u3002\u5ba2\u6236\u61c9\u8003\u616e    [m.room.member]\uff08#mroommember\uff09 \u767b\u9304\u4f7f\u7528\u8005\u4ee5\u5916\u7684\u4f7f\u7528\u8005\u7684\u4e8b\u4ef6,\u5982    \u5b9a\u7fa9\u5982\u4e0b\u3002<ol> <li>\u5982\u679c\u623f\u9593\u7684'm.hero'\u6578\u91cf\u5927\u65bc\u6216\u7b49\u65bc    \"m.joined_member_count + m.invited_member_count - 1\",\u7136\u5f8c\u4f7f\u7528    \u82f1\u96c4\u8a08\u7b97\u986f\u793a\u540d\u7a31\u7684\u6210\u54e1\u8cc7\u683c\u4e8b\u4ef6    \u5c0d\u65bc\u4f7f\u7528\u8005\uff08[\u6d88\u9664\u6b67\u7fa9,\u5982\u679c    \u5fc5\u9700]\uff08#calculating\u7528\u6237\u7684\u663e\u793a\u540d\u79f0\uff09\uff09\u548c    \u5c07\u5b83\u5011\u9023\u63a5\u8d77\u4f86\u3002\u4f8b\u5982,\u5ba2\u6236\u53ef\u4ee5\u9078\u64c7\u986f\u793a    \"Alice, Bob, and Charlie \uff08@charlie:example.org\uff09\"\u4f5c\u70ba\u623f\u9593    \u540d\u5b57\u3002\u7528\u6236\u7aef\u53ef\u4ee5\u9078\u64c7\u9650\u5236\u5176\u7528\u6236\u6578    \u7528\u65bc\u751f\u6210\u623f\u9593\u540d\u7a31\u3002</li> <li>\u5982\u679c\u82f1\u96c4\u5c11\u65bc    \"m.joined_member_count + m.invited_member_count - 1\",\u4ee5\u53ca    \"m.joined_member_count + m.invited_member_count\"\u5927\u65bc    1,\u7528\u6236\u7aef\u61c9\u4f7f\u7528\u82f1\u96c4\u4f86\u8a08\u7b97\u986f\u793a\u540d\u7a31    \u5c0d\u65bc\u4f7f\u7528\u8005\uff08[\u6d88\u9664\u6b67\u7fa9,\u5982\u679c    \u5fc5\u9700]\uff08#calculating\u7528\u6237\u7684\u663e\u793a\u540d\u79f0\uff09\uff09\u548c    \u5c07\u5b83\u5011\u8207\u5269\u9918\u4f7f\u7528\u8005\u7684\u8a08\u6578\u9023\u63a5\u8d77\u4f86\u3002\u70ba    \u4f8b\u5982,\"\u611b\u9e97\u7d72,\u9b91\u52c3\u548c\u5176\u4ed6 1234 \u4eba\"\u3002</li> <li>\u5982\u679c\"m.joined_member_count + m.invited_member_count\"\u5c0f\u65bc    \u6216\u7b49\u65bc 1\uff08\u8868\u793a\u6210\u54e1\u662f\u55ae\u7368\u7684\uff09,\u7528\u6236\u7aef    \u61c9\u4f7f\u7528\u4e0a\u8ff0\u898f\u5247\u4f86\u6307\u793a\u623f\u9593\u662f\u7a7a\u7684\u3002    \u4f8b\u5982,'\u7a7a\u623f\u9593\uff08\u662f\u611b\u9e97\u7d72\uff09','\u7a7a\u623f\u9593\uff08\u662f\u611b\u9e97\u7d72\uff09    \u548c\u5176\u4ed6 1234 \u4eba\uff09\",\u5982\u679c\u6c92\u6709\u82f1\u96c4,\u5247\u70ba\"\u7a7a\u623f\u9593\"\u3002</li> </ol> </li> </ol> <p>\u5ba2\u6236\u61c9\u5c07\u623f\u9593\u540d\u7a31\u570b\u969b\u5316\u70ba\u7528\u6236\u7684\u8a9e\u8a00 \u7576\u4f7f\u7528\"m.heroes\"\u8a08\u7b97\u540d\u7a31\u6642\u3002\u7528\u6236\u7aef\u61c9\u4f7f\u7528 \u5728\u53ef\u80fd\u7684\u60c5\u6cc1\u4e0b,\u81f3\u5c11 5 \u500b\u82f1\u96c4\u4f86\u8a08\u7b97\u623f\u9593\u540d\u7a31,\u4f46\u53ef\u4ee5\u4f7f\u7528 \u6216\u591a\u6216\u5c11\u662f\u70ba\u4e86\u66f4\u597d\u5730\u9069\u61c9\u4ed6\u5011\u7684\u7528\u6236\u9ad4\u9a57\u3002</p>"},{"location":"chat/client_server/#_6","title":"\u5287\u900f\u6d88\u606f","text":"<p>\u901a\u904e\u4f7f\u7528\u5287\u900f,\u53ef\u4ee5\u76f4\u89c0\u5730\u5411\u7528\u6236\u96b1\u85cf\u6d88\u606f\u7684\u67d0\u4e9b\u90e8\u5206\u3002 \u9019\u4e0d\u6703\u5f71\u97ff\u4f3a\u670d\u5668\u5c0d\u4e8b\u4ef6\u5167\u5bb9\u7684\u8868\u793a - \u5b83 \u53ea\u662f\u5411\u4f7f\u7528\u8005\u63d0\u4f9b\u8996\u89ba\u63d0\u793a,\u6d88\u606f\u53ef\u80fd\u6703\u63ed\u793a\u91cd\u8981\u5167\u5bb9 \u6709\u95dc\u67d0\u4e8b\u7684\u4fe1\u606f,\u7834\u58de\u4efb\u4f55\u76f8\u95dc\u7684\u9a5a\u559c\u3002</p> <p>\u8981\u767c\u9001\u5287\u900f,\u5ba2\u6236\u5fc5\u9808\u4f7f\u7528\"formatted_body\",\u56e0\u6b64 \"org.matrix.custom.html\"\u683c\u5f0f,\u5982\u4e0a\u6240\u8ff0\u3002\u9019\u4f7f\u5f97\u5287\u900f\u5728 \u4efb\u4f55\u53ef\u4ee5\u9069\u7576\u652f\u63f4\u6b64\u683c\u5f0f\u7684\"msgtype\"\u3002</p> <p>\u5287\u900f\u672c\u8eab\u5305\u542b'span'\u6a19\u7c64,\u539f\u56e0\uff08\u53ef\u9078\uff09 \u8655\u65bc'\u6578\u64da-MX-\u5287\u900f'\u5c6c\u6027\u4e2d\u3002\u7121\u6545\u5287\u900f\u5fc5\u9808\u81f3\u5c11 \u6307\u5b9a\u5c6c\u6027,\u4f46\u8a72\u503c\u53ef\u80fd\u70ba\u7a7a/\u672a\u5b9a\u7fa9\u3002</p> <p>\u5287\u900f\u7684\u4e00\u500b\u4f8b\u5b50\u662f:</p> <pre><code>{\n  \"msgtype\": \"m.text\",\n  \"format\": \"org.matrix.custom.html\",\n  \"body\": \"\u96fb\u5f71\u4e2d\u7684\u611b\u9e97\u7d72[\u5287\u900f]\uff08mxc://example.org/abc123\uff09\u3002\n  \"formatted_body\": \"\u611b\u9e97\u7d72&lt;\u8de8\u6578\u64da-mx-\u5287\u900f&gt;\u5f9e\u6b64\u904e\u4e0a\u4e86\u5e78\u798f\u7684\u751f\u6d3b&lt;/\u8de8\u5ea6&gt;\u5728\u96fb\u5f71\u4e2d\u3002\n}\n</code></pre> <p>\u5982\u679c\u8981\u63d0\u4f9b\u539f\u56e0,\u5b83\u5c07\u5982\u4e0b\u6240\u793a:</p> <pre><code>{\n  \"msgtype\": \"m.text\",\n  \"format\": \"org.matrix.custom.html\",\n  \"body\": \"\u611b\u9e97\u7d72[\u611b\u9e97\u7d72\u7684\u5065\u5eb7\u5287\u900f]\uff08mxc://example.org/abc123\uff09\u5728\u96fb\u5f71\u4e2d\u3002\n  \"formatted_body\": \"\u611b\u9e97\u7d72&lt;\u8de8\u5ea6\u6578\u64da-mx-spoiler='\u611b\u9e97\u7d72\u7684\u5065\u5eb7'&gt;\u5f9e\u6b64\u904e\u4e0a\u4e86\u5e78\u798f\u7684\u751f\u6d3b&lt;/\u8de8\u5ea6&gt;\u3002\n}\n</code></pre> <p>\u767c\u9001\u5287\u900f\u6642,\u7528\u6236\u7aef\u61c9\u5728\"\u6b63\u6587\"\u4e2d\u63d0\u4f9b\u56de\u9000,\u5982\u4e0a\u6240\u793a \uff08\u5305\u62ec\u539f\u56e0\uff09\u3002\u56de\u9000\u4e0d\u61c9\u5305\u542b\u5305\u542b\u5287\u900f\u7684\u6587\u672c,\u56e0\u70ba \"body\"\u53ef\u80fd\u6703\u986f\u793a\u5728\u7d14\u6587\u672c\u7528\u6236\u7aef\u6216\u901a\u77e5\u4e2d\u3002\u70ba\u9632\u6b62\u5287\u900f\u51fa\u73fe\u5728 \u5728\u9019\u7a2e\u60c5\u6cc1\u4e0b,\u5f37\u70c8\u5efa\u8b70\u5ba2\u6236\u5148\u4e0a\u50b3\u5305\u542b\u5287\u900f\u7684\u6587\u672c \u5230\u5a92\u9ad4\u5b58\u5132\u5eab,\u7136\u5f8c\u5728 markdown \u6a23\u5f0f\u7684\u9023\u7d50\u4e2d\u5f15\u7528\"mxc://\"URI,\u5982\u4e0a\u6240\u793a\u3002</p> <p>\u5ba2\u6236\u61c9\u8a72\u901a\u904e\u67d0\u7a2e\u62ab\u9732\u4ee5\u4e0d\u540c\u7684\u65b9\u5f0f\u5448\u73fe\u5287\u900f\u3002\u4f8b\u5982, \u7528\u6236\u7aef\u53ef\u4ee5\u6a21\u7cca\u5be6\u969b\u6587\u672c\u4e26\u8981\u6c42\u7528\u6236\u6309\u5169\u4e0b\u5b83\u4ee5\u986f\u793a\u5b83\u3002</p>"},{"location":"chat/client_server/#_7","title":"\u4f3a\u670d\u5668\u884c\u70ba","text":"<p>\u4e3b\u4f3a\u670d\u5668\u61c9\u62d2\u7d55\u6c92\u6709 \"msgtype\"\u9375,\u6216\u8005\u6c92\u6709\u6587\u672c\"body\"\u9375,\u5e36\u6709 HTTP \u72c0\u614b\u4ee3\u78bc\u70ba 400\u3002</p>"},{"location":"chat/client_server/#_8","title":"\u5b89\u5168\u6ce8\u610f\u4e8b\u9805","text":"<p>\u4f7f\u7528\u6b64\u6a21\u7d44\u767c\u9001\u7684\u6d88\u606f\u672a\u52a0\u5bc6,\u5118\u7ba1\u662f\u7aef\u5230\u7aef\u7684 \u52a0\u5bc6\u6b63\u5728\u958b\u767c\u4e2d\uff08\u8acb\u53c3\u95b1 [E2E \u6a21\u7d44]\uff08#end \u7aef\u5230\u7aef\u52a0\u5bc6\uff09\uff09\u3002</p> <p>\u7528\u6236\u7aef\u61c9\u6e05\u7406\u6240\u6709\u986f\u793a\u7684\u5bc6\u9470\u4ee5\u67e5\u627e\u4e0d\u5b89\u5168\u7684HTML \u9632\u6b62\u8de8\u7db2\u7ad9\u8173\u7a3f \uff08XSS\uff09 \u653b\u64ca\u3002\u9019\u5305\u62ec\u623f\u9593\u540d\u7a31\u548c \u4e3b\u984c\u3002</p>"},{"location":"chat/client_server/#113","title":"11.3 \u8c50\u5bcc\u7684\u56de\u5fa9","text":"<p>\u8c50\u5bcc\u7684\u56de\u5fa9\u662f\u4e00\u500b \u7279\u6b8a\u985e\u578b\u7684[\u95dc\u4fc2]\uff08#forming-\u4e8b\u4ef6\u4e4b\u9593\u7684\u95dc\u4fc2-\u4e8b\u4ef6\u4e4b\u9593\uff09 \u6709\u6548\u5730\u5f15\u7528\u5f15\u7528\u7684\u4e8b\u4ef6,\u4ee5\u4fbf\u7528\u6236\u7aef\u5448\u73fe/\u8655\u7406\u5982\u4f55 \u5b83\u5e0c\u671b\u3002\u5b83\u5011\u901a\u5e38\u8207 ['m.room.message']\uff08#mroommessage\uff09 \u4e8b\u4ef6\u4e00\u8d77\u4f7f\u7528\u3002</p> <p>\u5728\u898f\u7bc4\u7684 v1.3 \u4e4b\u524d,\u8c50\u5bcc\u7684\u56de\u5fa9\u50c5\u9650\u65bc\"m.room.message\"\u4e8b\u4ef6 \u5b83\u53ef\u4ee5\u8868\u793a HTML \u683c\u5f0f\u7684\u6b63\u6587\u3002\u5f9e v1.3 \u958b\u59cb,\u73fe\u5728\u5df2\u64f4\u5c55 \u5230 all \u4e8b\u4ef6\u985e\u578b,\u901a\u904e\u653e\u68c4 HTML \u683c\u5f0f\u7684\u6b63\u6587\u7684\u8981\u6c42 \u88ab\u5305\u62ec\u5728\u5167\u3002</p> <p>\u6b64\u5916,\u8c50\u5bcc\u7684\u56de\u5fa9\u53ef\u4ee5\u5f15\u7528\u81ea v1.3 \u8d77\u7684\u4efb\u4f55\u5176\u4ed6\u4e8b\u4ef6\u985e\u578b\u3002 \u4ee5\u524d,\u8c50\u5bcc\u7684\u56de\u5fa9\u53ea\u80fd\u5f15\u7528\u53e6\u4e00\u500b\"m.room.message\"\u4e8b\u4ef6\u3002</p> <p>\u5982\u679c\u53ef\u80fd,\u4e8b\u4ef6\u61c9\u5305\u62ec [\u56de\u9000\u8868\u793a\u5f62\u5f0f]\uff08#fallbacks-for-rich-replies\uff09 \u5141\u8a31\u4e0d\u5448\u73fe\u5bcc\u56de\u5fa9\u7684\u7528\u6236\u7aef\u4ecd\u7136\u770b\u5230\u4ee5\u4e0b\u5167\u5bb9 \u4f3c\u4e4e\u662f\u5f15\u7528\u7684\u7b54\u8986\u3002</p> <p>\u5118\u7ba1\u8c50\u5bcc\u7684\u56de\u5fa9\u8207\u53e6\u4e00\u500b\u4e8b\u4ef6\u5f62\u6210\u95dc\u4fc2,\u4f46\u5b83\u5011\u4e0d\u6703 \u4f7f\u7528\"rel_type\"\u5275\u5efa\u6b64\u95dc\u4fc2\u3002\u800c\u662f\u540d\u70ba\"m.in_reply_to\"\u7684\u5b50\u9805 \u7528\u65bc\u63cf\u8ff0\u56de\u5fa9\u7684\u95dc\u4fc2,\u4fdd\u7559 \"m.relates_to\"\u4f86\u63cf\u8ff0\u4e8b\u4ef6\u7684\u4e3b\u8981\u95dc\u4fc2\u3002\u9019\u610f\u5473\u8457 \u5982\u679c\u4e00\u500b\u4e8b\u4ef6\u53ea\u662f\u56de\u5fa9\u53e6\u4e00\u500b\u4e8b\u4ef6,\u6c92\u6709\u9032\u4e00\u6b65\u7684\u95dc\u4fc2, \"m.relates_to\"\u7684\"rel_type\"\u548c\"event_id\"\u5c6c\u6027\u8b8a\u70ba\u53ef\u9078\u3002</p> <p>\u4e00\u500b\u7bc4\u4f8b\u56de\u5fa9\u662f:</p> <pre><code>{\n  \"\u5167\u5bb9\": {\n    \"m.relates_to\": {\n      \"m.in_reply_to\": {\n        \"event_id\": \"$another_\u4e8b\u4ef6\"\n      }\n    },\n    \"body\": \"\u9019\u807d\u8d77\u4f86\u662f\u500b\u597d\u4e3b\u610f\uff01\n  },\n  \u4e8b\u4ef6\u6240\u9700\u7684\u5176\u4ed6\u6b04\u4f4d\n}\n</code></pre> <p>\u8acb\u6ce8\u610f,\"m.in_reply_to\"\u7269\u4ef6\u7684\"event_id\"\u5177\u6709\u76f8\u540c\u7684\u8981\u6c42 \u597d\u50cf\u5b83\u76f4\u63a5\u5728\"m.relates_to\"\u4e0b\u3002</p>"},{"location":"chat/client_server/#_9","title":"\u8c50\u5bcc\u56de\u5fa9\u7684\u56de\u9000","text":"<p>\u67d0\u4e9b\u7528\u6236\u7aef\u53ef\u80fd\u4e0d\u652f\u6301\u8c50\u5bcc\u7684\u56de\u5fa9,\u56e0\u6b64\u9700\u8981 \u56de\u9000\u4ee5\u6539\u7528\u3002\u4e0d\u652f\u63f4\u5bcc\u56de\u5fa9\u7684\u7528\u6236\u7aef\u61c9 \u5c07\u4e8b\u4ef6\u5448\u73fe\u70ba\u8c50\u5bcc\u7684\u56de\u5fa9\u4e26\u4e0d\u7279\u5225\u3002</p> <p>\u652f\u63f4\u5bcc\u56de\u5fa9\u7684\u7528\u6236\u7aef\u61c9\u63d0\u4f9b\u56de\u9000\u683c\u5f0f \u56de\u5fa9,\u4e26\u4e14\u5fc5\u9808\u5728\u5448\u73fe\u56de\u5fa9\u4e4b\u524d\u525d\u96e2\u56de\u9000\u3002\u9019 \u6bcf\u500b\"msgtype\"\u7684\u7279\u5b9a\u56de\u9000\u6587\u672c\u90fd\u4e0d\u540c,\u4f46\u662f \"\u6b63\u6587\"\u7684\u4e00\u822c\u683c\u5f0f\u70ba:</p> <pre><code>&gt; &lt;@alice:example.org&gt;\u9019\u662f\u539f\u59cb\u6b63\u6587\n&gt; \u9019\u662f\u56de\u5fa9\u7684\u5730\u65b9\n\n</code></pre> <p>\"formatted_body\"\uff08\u5982\u679c\u5b58\u5728\uff09\u4e26\u4f7f\u7528\u95dc\u806f\u7684\"\u683c\u5f0f\" \"org.matrix.custom.html\"\u61c9\u4f7f\u7528\u4ee5\u4e0b\u7bc4\u672c:</p> <pre><code>\n&lt;MX-\u56de\u5fa9&gt;\n    &lt;\u584a\u5f15\u7528&gt;\n        &lt;a href=\"https://matrix.to/#/!somewhere:example.org/$event:example.org\"&gt;\u56de\u5fa9&lt;/a&gt;\n        &lt;a href=\"https://matrix.to/#/@alice:example.org\"&gt;@alice:example.org&lt;/a&gt;\n        &lt;BR/&gt;\n        &lt;!--\u9019\u662f\u76f8\u95dc\u4e8b\u4ef6\u7684 HTML \u6240\u5728\u7684\u4f4d\u7f6e\u3002--&gt;\n    &lt;/\u584a\u5f15\u7528&gt;\n&lt;/MX-\u56de\u5fa9&gt;\n\u9019\u5c31\u662f\u7b54\u8986\u7684\u5730\u65b9\u3002\n</code></pre> <p>\u5982\u679c\u76f8\u95dc\u4e8b\u4ef6\u6c92\u6709\"formatted_body\",\u5247\u4e8b\u4ef6\u7684 \u5728\u5c0d\u4efb\u4f55 HTML \u7279\u6b8a\u5b57\u5143\u9032\u884c\u7de8\u78bc\u5f8c,\u61c9\u8003\u616e\"body\"\u3002 \u8acb\u6ce8\u610f,\u5169\u500b\u9328\u9ede\u4e2d\u7684\"href\"\u90fd\u4f7f\u7528 [matrix.to URI]\uff08/appendices#matrixto-navigation\uff09.</p>"},{"location":"chat/client_server/#_10","title":"\u525d\u96e2\u56de\u9000","text":"<p>\u652f\u63f4\u5bcc\u56de\u5fa9\u7684\u5ba2\u6236\u7aef\u5fc5\u9808\u5f9e \u4e8b\u4ef6,\u7136\u5f8c\u5448\u73fe\u4e8b\u4ef6\u3002\u9019\u662f\u56e0\u70ba \u4e0d\u80fd\u4fe1\u4efb\u56de\u9000\u662f \u4e8b\u4ef6\u3002\u522a\u9664\u56de\u9000\u5f8c,\u5efa\u8b70\u7528\u6236\u7aef\u8868\u793a \"m.in_reply_to\"\u5f15\u7528\u7684\u4e8b\u4ef6\u985e\u4f3c\u65bc\u56de\u9000\u7684\u4e8b\u4ef6 \u8868\u793a,\u5118\u7ba1\u5ba2\u6236\u78ba\u5be6\u70ba\u5176\u4f7f\u7528\u8005\u63d0\u4f9b\u4e86\u5275\u4f5c\u81ea\u7531 \u4ecb\u9762\u3002\u5ba2\u6236\u61c9\u8a72\u66f4\u559c\u6b61\u300cformatted_body\u300d\u800c\u4e0d\u662f\u300cbody\u300d, \u5c31\u50cf\u5176\u4ed6\"m.room.message\"\u4e8b\u4ef6\u4e00\u6a23\u3002</p> <p>\u8981\u525d\u96e2\"\u6b63\u6587\"\u4e0a\u7684\u56de\u9000,\u7528\u6236\u7aef\u61c9\u904d\u6b77\u6bcf\u500b \u5b57\u4e32\u7684\u884c,\u522a\u9664\u4ee5\u56de\u9000\u958b\u982d\u7684\u4efb\u4f55\u884c \u524d\u7db4\uff08\"&gt; \",\u5305\u62ec\u7a7a\u683c,\u4e0d\u5e36\u5f15\u865f\uff09\u4e26\u5728\u4ee5\u4e0b\u60c5\u6cc1\u4e0b\u505c\u6b62 \u9047\u5230\u4e0d\u5e36\u524d\u7db4\u7684\u884c\u3002\u6b64\u524d\u7db4\u7a31\u70ba \u56de\u9000\u524d\u7db4\u5e8f\u5217\"\u3002</p> <p>\u82e5\u8981\u525d\u96e2\"formatted_body\"\u4e0a\u7684\u56de\u9000,\u7528\u6236\u7aef\u61c9\u522a\u9664 \u6574\u500b\"MX-\u56de\u5fa9\"\u6a19\u8a18\u3002</p>"},{"location":"chat/client_server/#mtextmnotice","title":"\"m.text\"\u3001\"m.notice\"\u548c\u7121\u6cd5\u8b58\u5225\u7684\u6d88\u606f\u985e\u578b\u7684\u56de\u9000","text":"<p>\u4f7f\u7528\u524d\u7db4\u5e8f\u5217,\u76f8\u95dc\u4e8b\u4ef6\"\u6b63\u6587\"\u7684\u7b2c\u4e00\u884c \u61c9\u4ee5\u4f7f\u7528\u8005\u7684 ID \u70ba\u524d\u7db4,\u5f8c\u8ddf\u6bcf\u884c \u4ee5\u56de\u9000\u524d\u7db4\u5e8f\u5217\u70ba\u524d\u7db4\u3002\u4f8b\u5982:</p> <pre><code>&gt; &lt;@alice:example.org&gt;\u9019\u662f\u7b2c\u4e00\u884c\n&gt; \u9019\u662f\u7b2c\u4e8c\u884c\n&gt; \u9019\u662f\u56de\u5fa9\n\n</code></pre> <p>\"formatted_body\"\u4f7f\u7528\u672c\u7bc0\u524d\u9762\u5b9a\u7fa9\u7684\u7bc4\u672c\u3002</p>"},{"location":"chat/client_server/#memote","title":"\"m.emote\"\u7684\u56de\u9000","text":"<p>\u8207\"m.text\"\u7684\u56de\u9000\u985e\u4f3c,\u6bcf\u884c\u90fd\u4ee5 \u56de\u9000\u524d\u7db4\u5e8f\u5217\u3002\u4f46\u662f,\u61c9\u5728\u4e4b\u524d\u63d2\u5165\u661f\u865f \u4f7f\u7528\u8005\u7684ID,\u5982\u4e0b\u6240\u793a:</p> <pre><code>&gt; * &lt;@alice:example.org&gt; \u611f\u89ba\u4eca\u5929\u5c07\u662f\u7f8e\u597d\u7684\u4e00\u5929\n    \u9019\u662f\u56de\u5fa9\n</code></pre> <p>\"formatted_body\"\u5c0d\u65bc\u7bc4\u672c\u6709\u4e00\u500b\u7d30\u5fae\u7684\u5340\u5225,\u5176\u4e2d \u661f\u865f\u4e5f\u63d2\u5165\u5230\u4f7f\u7528\u8005\u7684 ID \u4e4b\u524d:</p> <pre><code>\n&lt;MX-\u56de\u5fa9&gt;\n    &lt;\u584a\u5f15\u7528&gt;\n        &lt;a href=\"https://matrix.to/#/!somewhere:example.org/$event:example.org\"&gt;\u56de\u5fa9&lt;/a&gt;\n\n        * &lt;a href=\"https://matrix.to/#/@alice:example.org\"&gt;@alice:example.org&lt;/a&gt;\n        &lt;BR/&gt;\n\n        &lt;!--\u9019\u662f\u76f8\u95dc\u4e8b\u4ef6\u7684 HTML \u6240\u5728\u7684\u4f4d\u7f6e\u3002--&gt;\n    &lt;/\u584a\u5f15\u7528&gt;\n&lt;/MX-\u56de\u5fa9&gt;\n\u9019\u5c31\u662f\u7b54\u8986\u7684\u5730\u65b9\u3002\n\n</code></pre>"},{"location":"chat/client_server/#mimagemvideomaudiomfile","title":"\"m.image\"\u3001\"m.video\"\u3001\"m.audio\"\u548c\"m.file\"\u7684\u56de\u9000","text":"<p>\u76f8\u95dc\u4e8b\u4ef6\u7684\"\u6b63\u6587\"\u5c07\u662f\u4e00\u500b\u6a94\u540d,\u53ef\u80fd\u4e0d\u662f\u5f88 \u63cf\u8ff0\u3002\u76f8\u95dc\u4e8b\u4ef6\u4e0d\u61c9\u5177\u6709\"\u683c\u5f0f\" \u6216\"\u5167\u5bb9\"\u4e2d\u7684\"formatted_body\"\u2014\u2014\u5982\u679c\u6d3b\u52d5\u78ba\u5be6\u6709\"\u683c\u5f0f\" \u548c/\u6216\"formatted_body\",\u5247\u61c9\u5ffd\u7565\u9019\u4e9b\u6b04\u4f4d\u3002\u56e0\u70ba \u6a94\u540d\u672c\u8eab\u53ef\u80fd\u4e0d\u662f\u63cf\u8ff0\u6027\u7684,\u76f8\u95dc\u4e8b\u4ef6\u7684\"\u6b63\u6587\"\u61c9\u8a72 \u88ab\u8996\u70ba\u300c\u5df2\u767c\u9001\u6a94\u300d\u3002' \u4f7f\u8f38\u51fa\u770b\u8d77\u4f86\u76f8\u4f3c \u5230\u4ee5\u4e0b\u5167\u5bb9:</p> <pre><code>&gt; &lt;@alice:example.org&gt;\u767c\u9001\u4e86\u4e00\u500b\u6a94\u3002\n\u9019\u662f\u56de\u5fa9\n</code></pre> <pre><code>\n&lt;MX-\u56de\u5fa9&gt;\n    &lt;\u584a\u5f15\u7528&gt;\n        &lt;a href=\"https://matrix.to/#/!somewhere:example.org/$event:example.org\"&gt;\u56de\u5fa9&lt;/a&gt;\n        &lt;a href=\"https://matrix.to/#/@alice:example.org\"&gt;@alice:example.org&lt;/a&gt;\n        &lt;BR/&gt;\n        \u767c\u9001\u4e86\u4e00\u500b\u6a94\u3002\n    &lt;/\u584a\u5f15\u7528&gt;\n&lt;/MX-\u56de\u5fa9&gt;\n\u9019\u5c31\u662f\u7b54\u8986\u7684\u5730\u65b9\u3002\n\n</code></pre> <p>\u5c0d\u65bc\"m.image\",\u6587\u672c\u61c9\u70ba\"\u767c\u9001\u5716\u50cf\"\u3002<code>.\u5c0d\u65bc\u300cm.video\u300d, \u6587\u672c\u61c9\u70ba\u300c\u767c\u9001\u8996\u983b\u300d\u3002</code>.\u5c0d\u65bc\"m.audio\",\u6587\u672c\u61c9\u70ba \u300c\u767c\u9001\u97f3\u8a0a\u6a94\u300d\u3002\u3002</p>"},{"location":"chat/client_server/#114-ip","title":"11.4 IP \u8a9e\u97f3","text":"<p>\u672c\u6a21\u7d44\u6982\u8ff0\u4e86\u623f\u9593\u4e2d\u7684\u5169\u500b\u4f7f\u7528\u8005\u5982\u4f55\u8a2d\u7f6eIP\u8a9e\u97f3 \uff08VoIP\uff09\u4e92\u76f8\u547c\u53eb\u3002\u8a9e\u97f3\u548c\u8996\u983b\u901a\u8a71\u5efa\u7acb\u5728 WebRTC 1.0\u6a19\u6e96\u3002\u547c\u53eb\u4fe1\u4ee4\u662f\u901a\u904e\u767c\u9001 [\u6d88\u606f] \u4f86\u5be6\u73fe\u7684 \u4e8b\u4ef6]\uff08#events\uff09\u5230\u623f\u9593\u3002\u5728\u6b64\u7248\u672c\u7684\u898f\u7bc4\u4e2d,\u53ea\u6709\u5169\u65b9 \u652f\u63f4\u901a\u4fe1\uff08\u4f8b\u5982,\u5169\u500b\u5c0d\u7b49\u9ad4\u4e4b\u9593\u6216\u5c0d\u7b49\u9ad4\u4e4b\u9593 \u548c\u591a\u9ede\u6703\u8b70\u88dd\u7f6e\uff09\u3002\u9019\u610f\u5473\u8457\u7528\u6236\u7aef\u53ea\u80fd \u5c07\u547c\u53eb\u4e8b\u4ef6\u767c\u9001\u5230\u53ea\u6709\u5169\u500b\u53c3\u8207\u8005\u7684\u804a\u5929\u5ba4\u3002</p>"},{"location":"chat/client_server/#1141","title":"11.4.1 \u4e8b\u4ef6","text":""},{"location":"chat/client_server/#mcallanswer","title":"m.call.answer","text":"<p>\u6b64\u4e8b\u4ef6\u7531\u88ab\u53eb\u65b9\u5728\u5e0c\u671b\u61c9\u7b54\u547c\u53eb\u6642\u767c\u9001</p> <pre><code>{\n  \"content\": {\n    \"answer\": {\n      \"sdp\": \"v=0\\r\\no=- 6584580628695956864 2 IN IP4 127.0.0.1[...]\",\n      \"type\": \"answer\"\n    },\n    \"call_id\": \"12345\",\n    \"version\": 0\n  },\n  \"event_id\": \"$143273582443PhrSn:example.org\",\n  \"origin_server_ts\": 1432735824653,\n  \"room_id\": \"!jEsUZKDJdhlrceRyVU:example.org\",\n  \"sender\": \"@example:example.org\",\n  \"type\": \"m.call.answer\",\n  \"unsigned\": {\n    \"age\": 1234\n  }\n}\n</code></pre>"},{"location":"chat/client_server/#_11","title":"\u5ba2\u6236\u7aef\u884c\u70ba","text":"<p>\u4f7f\u7528\u4ea4\u63db\u7684\u6d88\u606f\u4e8b\u4ef6\u8a2d\u7f6e\u547c\u53eb,\u5982\u4e0b\u6240\u793a:</p> <pre><code>\u4f86\u96fb\u8005\u88ab\u53eb\u65b9\n[\u64a5\u6253\u96fb\u8a71]\nm.call.invite -----------&gt;\nm.call.candidate --------&gt;\n[..\u5019\u9078\u4eba..]--------&gt;\n[\u63a5\u807d\u96fb\u8a71]\n&lt;--------------- m.call.answer\n[\u901a\u8a71\u6b63\u5728\u9032\u884c\u4e2d]\n&lt;--------------- m.call.hangup\n</code></pre> <p>\u6216\u62d2\u7d55\u7684\u547c\u53eb:</p> <pre><code>\u4f86\u96fb\u8005\u88ab\u53eb\u65b9\nm.call.invite ------------&gt;\nm.call.candidate ---------&gt;\n[..\u5019\u9078\u4eba..]---------&gt;\n[\u62d2\u7d55\u4f86\u96fb]\n&lt;-------------- m.call.hangup\n</code></pre> <p>\u8abf\u7528\u662f\u6839\u64daWebRTC\u898f\u7bc4\u5354\u5546\u7684\u3002</p>"},{"location":"chat/client_server/#_12","title":"\u7729\u5149","text":"<p>\"\u7729\u5149\"\u662f\u5169\u500b\u4f7f\u7528\u8005\u5728\u4ee5\u4e0b\u4f4d\u7f6e\u76f8\u4e92\u547c\u53eb\u6642\u51fa\u73fe\u7684\u554f\u984c \u5927\u81f4\u5728\u540c\u4e00\u6642\u9593\u3002\u9019\u6703\u5c0e\u81f4\u547c\u53eb\u7121\u6cd5\u8a2d\u7f6e\u70ba \u5df2\u7d93\u6709\u4f86\u96fb/\u53bb\u96fb\u3002\u7729\u5149\u89e3\u6790\u5ea6\u6f14\u7b97\u6cd5 \u53ef\u7528\u65bc\u78ba\u5b9a\u8981\u639b\u65b7\u7684\u547c\u53eb\u548c\u61c9\u7b54\u7684\u547c\u53eb\u3002 \u5982\u679c\u5169\u500b\u7528\u6236\u7aef\u5be6\u73fe\u76f8\u540c\u7684\u6f14\u7b97\u6cd5,\u5247\u5b83\u5011\u90fd\u5c07\u9078\u64c7 \u540c\u4e00\u547c\u53eb\u548c\u547c\u53eb\u5c07\u6210\u529f\u9023\u63a5\u3002</p> <p>\u7576\u547c\u53eb\u88ab\"\u4e0b\u9054\"\u5230\u623f\u9593\u800c\u4e0d\u662f\u4f7f\u7528\u8005\u6642,\u7729\u5149\u89e3\u6790\u5ea6 \u4e0b\u9762\u6982\u8ff0\u7684\u6f14\u7b97\u6cd5\u50c5\u8003\u616e\u7528\u65bc\u5c0d \u540c\u4e00\u500b\u623f\u9593\u3002\u6f14\u7b97\u6cd5\u5982\u4e0b:</p> <p>-\u5982\u679c\u6536\u5230\u623f\u9593\u7684\"m.call.invite\",\u800c\u5ba2\u6236 \u6e96\u5099\u5411\u540c\u4e00\u623f\u9593\u767c\u9001\"m.call.invite\": -\u7528\u6236\u7aef\u61c9\u53d6\u6d88\u5176\u50b3\u51fa\u547c\u53eb,\u6539\u70ba \u4ee3\u8868\u7528\u6236\u81ea\u52d5\u63a5\u53d7\u50b3\u5165\u547c\u53eb\u3002 -\u5982\u679c\u6536\u5230\u623f\u9593\u7684\"m.call.invite\"\u5728\u7528\u6236\u7aef\u6709 \u5df2\u767c\u9001 \"m.call.invite\"\u5230\u540c\u4e00\u623f\u9593,\u6b63\u5728\u7b49\u5f85 \u56de\u61c9: -\u5ba2\u6236\u61c9\u57f7\u884c \u5169\u500b\u547c\u53eb\u7684\u547c\u53ebID,\u4e26\u4f7f\u7528\u5169\u500b\u547c\u53eb\u4e2d\u7684\u8f03\u5c0f, \u6d41\u7522\u8d8a\u5927\u3002\u5982\u679c\u4f86\u96fb\u8f03\u5c0f,\u5247 \u7528\u6236\u7aef\u61c9\u4ee3\u8868\u4f7f\u7528\u8005\u63a5\u53d7\u6b64\u8abf\u7528\u3002</p> <p>\u547c\u53eb\u8a2d\u7f6e\u61c9\u8a72\u5c0d\u7528\u6236\u986f\u793a\u7121\u7e2b,\u5c31\u597d\u50cf\u4ed6\u5011\u53ea\u662f\u7c21\u55ae\u5730 \u6253\u4e86\u500b\u96fb\u8a71,\u5c0d\u65b9\u63a5\u807d\u4e86\u3002\u9019\u610f\u5473\u8457\u4efb\u4f55\u5a92\u9ad4 \u61c9\u8f49\u79fb\u5df2\u8a2d\u7f6e\u70ba\u7528\u65bc\u547c\u53eb\u7684\u6d41,\u4e26\u4e14 \u7528\u65bc\u66ff\u63db\u5b83\u7684\u8abf\u7528\u3002</p>"},{"location":"chat/client_server/#1143","title":"11.4.3 \u4f3a\u670d\u5668\u884c\u70ba","text":"<p>\u4e3b\u4f3a\u670d\u5668\u53ef\u4ee5\u63d0\u4f9b\u7528\u6236\u7aef\u53ef\u4ee5\u4f7f\u7528\u7684 TURN \u4f3a\u670d\u5668 \u806f\u7e6b\u9060\u7aef\u65b9\u3002\u5c07\u4f7f\u7528\u4ee5\u4e0b HTTP API \u7aef\u9ede \u7528\u6236\u7aef\u4ee5\u7372\u53d6\u6709\u95dc TURN \u4f3a\u670d\u5668\u7684\u8cc7\u8a0a\u3002</p>"},{"location":"chat/client_server/#1144","title":"11.4.4 \u5b89\u5168\u6ce8\u610f\u4e8b\u9805","text":"<p>\u53ea\u80fd\u5411\u5177\u6709\u53e6\u4e00\u500b\u7528\u6236\u7684\u623f\u9593\u767c\u51fa\u547c\u53eb\u3002\u5982\u679c \u5b83\u5011\u88ab\u653e\u7f6e\u5728\u7fa4\u804a\u5ba4\u4e2d,\u53ef\u80fd\u662f\u5176\u4ed6\u4f7f\u7528\u8005 \u5c07\u6514\u622a\u4e26\u63a5\u807d\u96fb\u8a71\u3002</p>"},{"location":"chat/client_server/#115","title":"11.5 \u9375\u5165\u901a\u77e5","text":"<p>\u4f7f\u7528\u8005\u53ef\u80fd\u5e0c\u671b\u5728\u5176\u4ed6\u7528\u6236\u5728\u623f\u9593\u5167\u9375\u5165\u5167\u5bb9\u6642\u6536\u5230\u901a\u77e5\u3002 \u9019\u53ef\u4ee5\u901a\u904e\u9375\u5165\u901a\u77e5\u4f86\u5be6\u73fe\u3002\u9019\u4e9b\u662f\u77ed\u66ab\u7684 \u4e8b\u4ef6,\u56e0\u6b64\u5b83\u5011\u4e0d\u69cb\u6210 [\u4e8b\u4ef6\u5716]\uff08/#event\u56fe\uff09\u3002\u9375\u5165\u901a\u77e5\u7684\u7bc4\u570d\u9650\u5b9a \u5230\u4e00\u500b\u623f\u9593\u3002</p>"},{"location":"chat/client_server/#_13","title":"\u4e8b\u4ef6","text":""},{"location":"chat/client_server/#mtyping","title":"m.typing","text":"<p>\u901a\u77e5\u7528\u6236\u7aef\u76ee\u524d\u6b63\u5728\u9375\u5165\u7684\u7528\u6236\u6e05\u55ae\u3002</p> <pre><code>{\n  \"content\": {\n    \"user_ids\": [\n      \"@alice:matrix.org\",\n      \"@bob:example.com\"\n    ]\n  },\n  \"type\": \"m.typing\"\n}\n</code></pre>"},{"location":"chat/client_server/#_14","title":"\u5ba2\u6236\u7aef\u884c\u70ba","text":"<p>\u7576\u7528\u6236\u7aef\u6536\u5230\u300cm.typing\u300d\u4e8b\u4ef6\u6642,\u5b83\u5fc5\u9808\u4f7f\u7528\u4f7f\u7528\u8005 ID \u6e05\u55ae \u66ff\u63db\u7576\u524d\u6b63\u5728\u9375\u5165\u7684\u6bcf\u500b\u7528\u6236\u7684\u77e5\u8b58\u3002\u9019 \u539f\u56e0\u662f\u4f3a\u670d\u5668\u4e0d\u8a18\u5f97\u4e0d\u662f\u7684\u4f7f\u7528\u8005 \u76ee\u524d\u8f38\u5165,\u56e0\u70ba\u8a72\u6e05\u55ae\u5f88\u5feb\u5c31\u6703\u8b8a\u5927\u3002\u5ba2\u6236\u61c9\u6a19\u8a18 \u56e0\u70ba\u4e0d\u9375\u5165\u4e0d\u5728\u8a72\u6e05\u55ae\u4e2d\u7684\u4efb\u4f55\u4f7f\u7528\u8005ID\u3002</p> <p>\u5efa\u8b70\u7528\u6236\u7aef\u5b58\u5132\u4e00\u500b\u300c\u5e03\u723e\u503c\u300d \u6307\u793a\u662f\u5426 \u4f7f\u7528\u8005\u662f\u5426\u6b63\u5728\u9375\u5165\u3002\u96d6\u7136\u6b64\u503c\u70ba\"true\",\u4f46\u8a08\u6642\u5668\u61c9\u89f8\u767c \u5b9a\u671f\u6bcf N \u79d2\u767c\u9001\u4e00\u6b21\u9375\u5165\u7684 HTTP \u8acb\u6c42\u3002\u7684\u50f9\u503c N\u5efa\u8b70\u4e0d\u8d85\u904e20-30\u79d2\u3002\u6b64\u8acb\u6c42\u61c9 \u7531\u7528\u6236\u7aef\u91cd\u65b0\u767c\u9001\u4ee5\u7e7c\u7e8c\u901a\u77e5\u4f3a\u670d\u5668\u4f7f\u7528\u8005\u662f \u9084\u5728\u6253\u5b57\u3002\u7531\u65bc\u5f8c\u7e8c\u8acb\u6c42\u5c07\u66ff\u63db\u820a\u8acb\u6c42,\u56e0\u6b64 \u9810\u671f\u8d85\u6642\u7528\u5b8c\u524d 5 \u79d2\u7684\u5b89\u5168\u88d5\u5ea6\u70ba \u63a8\u85a6\u3002\u7576\u4f7f\u7528\u8005\u505c\u6b62\u9375\u5165\u6642,\u72c0\u614b\u66f4\u6539 \"\u5e03\u723e\"\u5230\"\u5047\"\u61c9\u8a72\u89f8\u767c\u53e6\u4e00\u500bHTTP\u8acb\u6c42\u4f86\u901a\u77e5 \u4f7f\u7528\u8005\u5df2\u505c\u6b62\u9375\u5165\u7684\u4f3a\u670d\u5668\u3002</p>"},{"location":"chat/client_server/#put-_matrixclientv3roomsroomidtypinguserid","title":"PUT /_matrix/client/v3/rooms/{roomId}/typing/{userId}","text":"<p>\u9019\u544a\u8a34\u4f3a\u670d\u5668\u4f7f\u7528\u8005\u6b63\u5728\u9375\u5165\u4e0b\u4e00\u500b N \u6beb\u79d2,\u5176\u4e2d N \u662f\u9375\u4e2d\u6307\u5b9a\u7684\u503c\u3002 \u6216\u8005,\u5982\u679c\u662f ,\u5b83\u544a\u8a34\u4f3a\u670d\u5668 \u4f7f\u7528\u8005\u5df2\u505c\u6b62\u9375\u5165\u3002timeouttypingfalse</p> <p>\u8acb\u6c42\u6b63\u6587\u793a\u4f8b</p> <pre><code>{\n  \"timeout\": 30000,\n  \"typing\": true\n}\n</code></pre>"},{"location":"chat/client_server/#_15","title":"\u5b89\u5168\u6ce8\u610f\u4e8b\u9805","text":"<p>\u5ba2\u6236\u53ef\u80fd\u4e0d\u5e0c\u671b\u901a\u77e5\u623f\u9593\u91cc\u7684\u6bcf\u500b\u4eba\u4ed6\u5011\u6b63\u5728\u6253\u5b57 \u800c\u662f\u50c5\u6703\u8b70\u5ba4\u4e2d\u7684\u7279\u5b9a\u4f7f\u7528\u8005\u3002</p>"},{"location":"chat/client_server/#116","title":"11.6 \u6536\u64da","text":"<p>{{&lt; changed-in v=\"1.4\" &gt;}}\u6dfb\u52a0\u4e86\u79c1\u4eba\u5df2\u8b80\u56de\u57f7\u3002</p> <p>\u6b64\u6a21\u7d44\u589e\u52a0\u4e86\u5c0d\u6536\u64da\u7684\u652f\u63f4\u3002\u9019\u4e9b\u6536\u64da\u662f \u4e8b\u4ef6\u78ba\u8a8d\u3002\u6b64\u6a21\u7d44\u5b9a\u7fa9\u300cm.read\u300d\u6536\u64da \u7528\u65bc\u6307\u793a\u4f7f\u7528\u8005\u5df2\u8b80\u53d6\u7d66\u5b9a\u4e8b\u4ef6,\u4ee5\u53ca\"m.read.private\" \u5728\u6c92\u6709\u4efb\u4f55\u5176\u4ed6\u4f7f\u7528\u8005\u77e5\u9053\u7684\u60c5\u6cc1\u4e0b\u9054\u5230\u76f8\u540c\u7684\u76ee\u7684\u3002\u4e3b\u8981 \"m.read.private\"\u65e8\u5728\u6e05\u9664[\u901a\u77e5]\uff08#receiving-\u901a\u77e5\uff09 \u6c92\u6709\u5411\u4ed6\u4eba\u5ba3\u50b3\u8b80\u5230\u72c0\u614b\u3002</p> <p>\u70ba\u6bcf\u500b\u4e8b\u4ef6\u767c\u9001\u6536\u64da\u53ef\u80fd\u6703\u5c0e\u81f4\u767c\u9001\u5927\u91cf \u5230\u4e3b\u4f3a\u670d\u5668\u7684\u6d41\u91cf\u3002\u70ba\u4e86\u9632\u6b62\u9019\u6210\u70ba\u4e00\u500b\u554f\u984c, \u6536\u64da\u662f\u4f7f\u7528\"\u6700\u591a\"\u6a19\u8a18\u5be6\u73fe\u7684\u3002\u6b64\u6a19\u8a18\u6307\u793a \u78ba\u8a8d\u9069\u7528\u65bc\"\u4e4b\u524d\u4e26\u5305\u62ec\"\u7684\u6240\u6709\u4e8b\u4ef6 \u6307\u5b9a\u7684\u4e8b\u4ef6\u3002\u4f8b\u5982,\u5c07\u4e8b\u4ef6\u6a19\u8a18\u70ba\u300c\u5df2\u8b80\u300d \u5c07\u6307\u793a \u7528\u6236\u5df2\u8b80\u53d6\u6240\u6709\u4e8b\u4ef6\u76f4\u5230\u5f15\u7528\u7684\u4e8b\u4ef6\u3002\u8acb\u53c3\u95b1\u7684 [\u63a5\u6536\u901a\u77e5]\uff08#receiving-\u901a\u77e5\uff09\u90e8\u5206\u77ad\u89e3\u66f4\u591a\u8cc7\u8a0a \u6709\u95dc\u5df2\u8b80\u56de\u57f7\u5982\u4f55\u5f71\u97ff\u901a\u77e5\u8a08\u6578\u7684\u8cc7\u8a0a\u3002</p> <p>{{&lt; add-in v=\"1.4\" &gt;}}\u5df2\u8b80\u56de\u57f7\u4e3b\u8981\u6709\u4e09\u7a2e\u5f62\u5f0f: \u7121\u7dda\u7a0b:\u8868\u793a\u8b80\u53d6\u5230\u63a5\u6536,\u800c\u4e0d\u8003\u616e\u7dda\u7a0b\u3002\u9019\u5c31\u662f \u9810\u7dda\u7a0b\u5316\u5df2\u8b80\u56de\u57f7\u6709\u6548\u3002 \u7dda\u7a0b,\u4e3b\u6642\u9593\u7dda:\u8868\u793a\u4e0d\u5728 \u7279\u5b9a\u7dda\u7a0b\u3002\u7531\u7dda\u7a0bID MAin\u8b58\u5225\u3002 *\u7dda\u7a0b,\u5728\u7dda\u7a0b\u4e2d:\u8868\u793a\u7279\u5b9a\u7dda\u7a0b\u4e2d\u7684\u8b80\u5230\u63a5\u6536 \u7dda\u3002\u7531\u7dda\u7a0b\u6839\u7684\u4e8b\u4ef6ID\u6a19\u8b58\u3002</p> <p>\u7dda\u7a0b\u5f0f\u8b80\u56de\u57f7\u5c07\u5728\u4e0b\u9762\u9032\u4e00\u6b65\u8a73\u7d30\u8a0e\u8ad6\uff08#threaded-\u5df2\u8b80\u56de\u57f7\uff09\u3002</p>"},{"location":"chat/client_server/#_16","title":"\u4e8b\u4ef6","text":"<p>{{&lt; changed-in v=\"1.4\" &gt;}}\u6bcf\u500b\"user_id\"\u3001\"receipt_type\"\u548c\u5206\u985e \uff08\u7121\u7dda\u7a0b\u6216\"thread_id\"\uff09\u5143\u7d44\u5fc5\u9808\u50c5\u8207\u55ae\u500b\u5143\u7d44\u95dc\u806f \"event_id\"\u3002</p>"},{"location":"chat/client_server/#mreceipt","title":"m.receipt","text":"<p>\u901a\u77e5\u5ba2\u6236\u65b0\u6536\u64da\u3002</p> <pre><code>{\n  \"content\": {\n    \"$1435641916114394fHBLK:matrix.org\": {\n      \"m.read\": {\n        \"@rikj:jki.re\": {\n          \"ts\": 1436451550453\n        }\n      },\n      \"m.read.private\": {\n        \"@self:example.org\": {\n          \"ts\": 1661384801651\n        }\n      }\n    }\n  },\n  \"type\": \"m.receipt\"\n}\n</code></pre>"},{"location":"chat/client_server/#_17","title":"\u5ba2\u6236\u7aef\u884c\u70ba","text":"<p>{{&lt; changed-in v=\"1.4\" &gt;}}\u5df2\u66f4\u6539\u4ee5\u652f\u63f4\u7dda\u7a0b\u5f0f\u5df2\u8b80\u56de\u57f7\u3002</p> <p>\u5728\"/sync\"\u4e2d,\u6536\u64da\u5217\u5728\"\u81e8\u6642\"\u4e8b\u4ef6\u9663\u5217\u4e0b \u5c0d\u65bc\u7d66\u5b9a\u7684\u623f\u9593\u3002\u4e8b\u4ef6\u6d41\u4e2d\u7684\u65b0\u6536\u64da\u662f \u66f4\u65b0\u73fe\u6709\u6620\u5c04\u7684\u589e\u91cf\u3002\u7528\u6236\u7aef\u61c9\u66ff\u63db\u820a\u7684 \u57fa\u65bc\"user_id\"\u3001\"receipt_type\"\u548c \"thread_id\"\uff08\u5982\u679c\u5b58\u5728\uff09\u3002 \u4f8b\u5982:</p> <pre><code>Client receives m.receipt:\n  user = @alice:example.com\n  receipt_type = m.read\n  event_id = $aaa:example.com\n  thread_id = undefined\n\nClient receives another m.receipt:\n  user = @alice:example.com\n  receipt_type = m.read\n  event_id = $bbb:example.com\n  thread_id = main\n\nThe client does not replace any acknowledgements, yet.\n\nClient receives yet another m.receipt:\n  user = @alice:example.com\n  receipt_type = m.read\n  event_id = $ccc:example.com\n  thread_id = undefined\n\nThe client replaces the older acknowledgement for $aaa:example.com\nwith this new one for $ccc:example.com, but does not replace the\nacknowledgement for $bbb:example.com because it belongs to a thread.\n\nClient receives yet another m.receipt:\n  user = @alice:example.com\n  receipt_type = m.read\n  event_id = $ddd:example.com\n  thread_id = main\n\nNow the client replaces the older $bbb:example.com acknowledgement with\nthis new $ddd:example.com acknowledgement. The client does NOT replace the\nolder acknowledgement for $ccc:example.com as it is unthreaded.\n</code></pre> <p>\u7576\u78ba\u5b9a \u6709\u554f\u984c\u7684\u4e8b\u4ef6\u5df2\u5411\u7528\u6236\u986f\u793a\u3002\u53ea\u9700\u63a5\u6536 \u4e8b\u4ef6\u4e0d\u80fd\u63d0\u4f9b\u8db3\u5920\u7684\u78ba\u5b9a\u6027,\u8868\u660e\u7528\u6236\u5df2\u7d93\u770b\u5230\u4e86 \u4e8b\u4ef6\u3002\u7528\u6236\u61c9\u8a72\u9700\u8981\u63a1\u53d6\u4e00\u4e9b\u64cd\u4f5c,\u4f8b\u5982\u67e5\u770b \u4e8b\u4ef6\u767c\u9001\u5230\u7684\u623f\u9593\u6216\u6309\u9806\u5e8f\u95dc\u9589\u901a\u77e5 \u4f7f\u4e8b\u4ef6\u8a08\u70ba\u300c\u5df2\u8b80\u300d\u3002\u7528\u6236\u7aef\u4e0d\u61c9\u767c\u9001\u5df2\u8b80\u56de\u57f7 \u5c0d\u65bc\u81ea\u5df1\u7684\u7528\u6236\u767c\u9001\u7684\u4e8b\u4ef6\u3002</p> <p>\u8207\u767c\u9001\u56de\u57f7\u7684\u898f\u5247\u985e\u4f3c,\u61c9\u986f\u793a\u7dda\u7a0b\u56de\u57f7 \u5728\u7dda\u7a0b\u7684\u4e0a\u4e0b\u6587\u4e2d\u3002\u5982\u679c\u7dda\u7a0b\u5448\u73fe\u5728\u62ab\u9732\u5f8c\u9762, \u7528\u6236\u7aef\u5c1a\u672a\u986f\u793a\u4e8b\u4ef6\uff08\u6216\u4efb\u4f55\u9069\u7528\u7684\u5df2\u8b80\u56de\u57f7\uff09 \u7d66\u4f7f\u7528\u8005\u3002\u4f46\u662f,\u4e00\u65e6\u4ed6\u5011\u64f4\u5c55\u4e86\u7dda\u7a0b,\u7dda\u7a0b\u5df2\u8b80\u56de\u57f7 \u5c07\u767c\u9001\u4e26\u986f\u793a\u4f86\u81ea\u5176\u4ed6\u4f7f\u7528\u8005\u7684\u6bcf\u500b\u7dda\u7a0b\u7684\u6536\u64da\u3002</p> <p>\u7528\u6236\u7aef\u53ef\u4ee5\u901a\u904e\u8207 \u9075\u5faa HTTP API\u3002</p>"},{"location":"chat/client_server/#post-_matrixclientv3roomsroomidreceiptreceipttypeeventid","title":"POST /_matrix/client/v3/rooms/{roomId}/receipt/{receiptType}/{eventId}","text":"<p>\u6b64 API \u5c07\u7d66\u5b9a\u6536\u64da\u985e\u578b\u7684\u6a19\u8a18\u66f4\u65b0\u70ba\u4e8b\u4ef6 ID \u6307\u5b9a\u3002</p> <p>\u8acb\u6c42\u6b63\u6587\u793a\u4f8b</p> <pre><code>{\n  \"thread_id\": \"main\"\n}\n</code></pre>"},{"location":"chat/client_server/#_18","title":"\u79c1\u4eba\u5df2\u8b80\u56de\u57f7","text":"<p>{{% add-in v=\"1.4\" %}}</p> <p>\u4e00\u4e9b\u4f7f\u7528\u8005\u5e0c\u671b\u5c07\u623f\u9593\u6a19\u8a18\u70ba\u5df2\u8b80,\u6e05\u9664\u5176[\u901a\u77e5\u8a08\u6578]\uff08#receiving\u901a\u77e5\uff09, \u4f46\u4e0d\u8981\u6d29\u9732\u4ed6\u5011\u5df2\u7d93\u95b1\u8b80\u4e86\u7279\u5b9a\u6d88\u606f\u7684\u4e8b\u5be6\u3002\u81ea \u70ba\u6b64,\u7528\u6236\u7aef\u53ef\u4ee5\u767c\u9001\u300cm.read.private\u300d\u6536\u64da\u800c\u4e0d\u662f\u300cm.read\u300d\u3002 \u8981\u505a\u5230\u9019\u4e00\u9ede:\u6e05\u9664\u901a\u77e5,\u4e0d\u8981\u5c07\u6536\u64da\u5ee3\u64ad\u5230 \u5176\u4ed6\u4f7f\u7528\u8005\u3002</p> <p>\u4f3a\u670d\u5668\u4e0d\u5f97\u5c07\u300cm.read.private\u300d\u6536\u64da\u767c\u9001\u7d66\u9664 \u4e00\u500b\u6700\u521d\u767c\u9001\u5b83\u3002</p> <p>\u5728\"m.read\"\u548c\"m.read.private\"\u4e4b\u9593,\u6536\u64da\u66f4\"\u9818\u5148\"\u6216 \u5728\u78ba\u5b9a\u6700\u9ad8\u8b80\u6578\u6a19\u8a18\u6642\u4f7f\u7528\"\u6700\u8fd1\"\u3002\u8acb\u53c3\u95b1\u7684 [\u901a\u77e5]\uff08#receiving-\u901a\u77e5\uff09\u90e8\u5206,\u4ee5\u7372\u53d6\u66f4\u591a\u8cc7\u8a0a \u9019\u5c0d\u901a\u77e5\u8a08\u6578\u6709\u4f55\u5f71\u97ff\u3002</p> <p>\u5982\u679c\u5ba2\u6236\u7aef\u767c\u9001\"m.read\"\u6536\u64da,\u8a72\u6536\u64da\u4f4d\u65bc\"m.read.private\"\u7684\"\u5f8c\u9762\" \u6536\u5230,\u5176\u4ed6\u4f7f\u7528\u8005\u5c07\u770b\u5230\u66f4\u6539\u767c\u751f,\u4f46\u767c\u9001\u4f7f\u7528\u8005\u5c07 \u4e0d\u6703\u5c07\u5176\u901a\u77e5\u8a08\u6578\u5012\u56de\u8a72\u6642\u9593\u9ede\u3002\u800c \u4e0d\u5e38\u898b,\"m.read\"\uff08\u516c\u5171\uff09\u63a5\u6536\u6eef\u5f8c\u88ab\u8a8d\u70ba\u662f\u6709\u6548\u7684 \u4f8b\u5982,\"m.read.private\"\u6536\u64da\u5f8c\u9762\u7684\u5e7e\u689d\u6d88\u606f\u3002</p>"},{"location":"chat/client_server/#_19","title":"\u7dda\u7a0b\u5f0f\u8b80\u56de\u57f7","text":"<p>{{% add-in v=\"1.4\" %}}</p> <p>\u5982\u679c\u7528\u6236\u7aef\u4e0d\u4f7f\u7528 [threading]\uff08#threading\uff09,\u90a3\u9ebc\u5b83\u5011\u53ea\u6703 \u767c\u9001\u300c\u7121\u7dda\u7a0b\u300d\u5df2\u8b80\u56de\u57f7,\u7121\u8ad6\u7dda\u7a0b\u5982\u4f55,\u90fd\u6703\u5f71\u97ff\u6574\u500b\u623f\u9593\u3002</p> <p>\u7dda\u7a0b\u5f0f\u5df2\u8b80\u56de\u57f7\u53ea\u662f\u5e36\u6709\"thread_id\"\u7684\u56de\u57f7,\u76ee\u6a19 \u7dda\u7a0b\u6839\u7684\u4e8b\u4ef6 ID \u6216\u4e3b\u6642\u9593\u7dda\u7684\"main\"\u3002</p> <p>\u7dda\u7a0b\u5f15\u5165\u4e86\u5728\u540c\u4e00\u6703\u8a71\u4e2d\u9032\u884c\u591a\u500b\u5c0d\u8a71\u7684\u6982\u5ff5 \u623f\u9593,\u56e0\u6b64\u503c\u5f97\u81ea\u5df1\u7684\u5df2\u8b80\u56de\u57f7\u548c\u901a\u77e5\u8a08\u6578\u3002\u4e8b\u4ef6\u662f \u5982\u679c\u6eff\u8db3\u4ee5\u4e0b\u4efb\u4f55\u689d\u4ef6,\u5247\u88ab\u8996\u70ba\u300c\u5728\u7dda\u7a0b\u4e2d\u300d: \u5b83\u7684\"rel_type\"\u70ba\"m.thread\"\u3002 \u5b83\u5177\u6709\"rel_type\"\u70ba\"m.thread\"\u7684\u5b50\u4e8b\u4ef6\uff08\u5728\u9019\u7a2e\u60c5\u6cc1\u4e0b,\u5b83\u5c07\u662f \u7dda\u7a0b\u6839\uff09\u3002 *\u5728\u4e8b\u4ef6\u95dc\u4fc2\u4e4b\u5f8c,\u5b83\u6709\u4e00\u500b\u7236\u4e8b\u4ef6,\u8a72\u7236\u4e8b\u4ef6\u7b26\u5408 \u4ee5\u4e0a\u4e4b\u4e00\u3002\u4f46\u662f,\u5be6\u73fe\u4e0d\u61c9\u8a72\u7121\u9650\u905e\u6b78:a \u5efa\u8b70\u6700\u591a\u4f7f\u7528 3 \u500b\u8e8d\u9ede\u4ee5\u6db5\u84cb\u9593\u63a5\u95dc\u4fc2\u3002</p> <p>\u4e0d\u5728\u7dda\u7a0b\u4e2d\u4f46\u4ecd\u5728\u623f\u9593\u4e2d\u7684\u4e8b\u4ef6\u88ab\u8996\u70ba \"\u4e3b\u6642\u9593\u7dda\",\u6216ID\u70ba\"main\"\u7684\u7279\u6b8a\u7dda\u7a0b\u3002</p> <p>\u4e0b\u9762\u662f\u4e00\u500b\u804a\u5929\u5ba4\u7684\u793a\u4f8b DAG,\u865b\u7dda\u8868\u793a\u4e8b\u4ef6 \u95dc\u4fc2\u548c\u986f\u793a\u62d3\u64b2\u6392\u5e8f\u7684\u5be6\u7dda\u3002</p> <p></p> <p>\u6b64 DAG \u53ef\u4ee5\u8868\u793a\u70ba 3 \u500b\u7dda\u7a0b\u6642\u9593\u7dda,\u5176\u4e2d\"A\"\u548c\"B\"\u662f\u7dda\u7a0b \u6839:</p> <p></p> <p>\u6709\u4e86\u9019\u500b,\u6211\u5011\u53ef\u4ee5\u8b49\u660e: \"I\"\u4e0a\u7684\u7dda\u7a0b\u5df2\u8b80\u56de\u57f7\u6703\u5c07\"A\"\u3001\"B\"\u548c\"I\"\u6a19\u8a18\u70ba\u5df2\u8b80\u3002 \"E\"\u4e0a\u7684\u7dda\u7a0b\u5df2\u8b80\u56de\u57f7\u6703\u5c07\"C\"\u548c\"E\"\u6a19\u8a18\u70ba\u5df2\u8b80\u3002 *\"D\"\u4e0a\u7684\u975e\u7dda\u7a0b\u5df2\u8b80\u56de\u57f7\u6703\u5c07\"A\"\u3001\"B\"\u3001\"C\"\u548c\"D\"\u6a19\u8a18\u70ba\u5df2\u8b80\u3002</p> <p>\u8acb\u6ce8\u610f,\u4f7f\u7528\u7dda\u7a0b\u5df2\u8b80\u56de\u57f7\u5c07\"A\"\u6a19\u8a18\u70ba\u5df2\u8b80\u4e26\u4e0d\u610f\u5473\u8457 \"C\"\u3001\"E\"\u3001\"G\"\u6216\"H\"\u88ab\u6a19\u8a18\u70ba\u5df2\u8b80:\u7dda\u7a0b A \u7684\u6642\u9593\u7dda\u9700\u8981 \u5b83\u81ea\u5df1\u7684\u7dda\u7a0b\u8b80\u53d6\u56de\u57f7\u4f4d\u65bc\u300cH\u300d\u8655\u4ee5\u5be6\u73fe\u6b64\u76ee\u7684\u3002</p> <p>\u4e0a\u8ff0 3 \u500b\u7bc4\u4f8b\u7684\u5df2\u8b80\u56de\u57f7\u70ba:</p> <pre><code>{\n  \"$I\": {\n    \"m.read\": {\n      \"@user:example.org\": {\n        \"ts\": 1661384801651,\n        \"thread_id\": \"main\" // because `I` is not in a thread, but is a threaded receipt\n      }\n    }\n  },\n  \"$E\": {\n    \"m.read\": {\n      \"@user:example.org\": {\n        \"ts\": 1661384801651,\n        \"thread_id\": \"$A\" // because `E` is in Thread `A`\n      }\n    }\n  },\n  \"$D\": {\n    \"m.read\": {\n      \"@user:example.org\": {\n        \"ts\": 1661384801651\n        // no `thread_id` because the receipt is *unthreaded*\n      }\n    }\n  }\n}\n</code></pre> <p>\u767c\u9001\u5df2\u8b80\u56de\u57f7\u7684\u689d\u4ef6\u8207\u7dda\u7a0b\u548c\u975e\u7dda\u7a0b\u8b80\u53d6\u985e\u4f3c \u6536\u76ca\u3002\u4f8b\u5982,\u7528\u6236\u7aef\u53ef\u80fd\u6703\u70ba\u7dda\u7a0b\u767c\u9001\u5c08\u7528\u5df2\u8b80\u56de\u57f7 \u7528\u6236\u5c55\u958b\u8a72\u7dda\u7a0b\u6642\u7684\u4e8b\u4ef6\u3002</p>"},{"location":"chat/client_server/#_20","title":"\u4f3a\u670d\u5668\u884c\u70ba","text":"<p>\u70ba\u4e86\u63d0\u9ad8\u6548\u7387,\u6536\u64da\u61c9\u5206\u6279\u5230\u6bcf\u500b\u623f\u9593\u7684\u4e00\u500b\u4e8b\u4ef6\u4e2d \u5728\u5c07\u5b83\u5011\u4ea4\u4ed8\u7d66\u5ba2\u6236\u4e4b\u524d\u3002</p> <p>\u67d0\u4e9b\u6536\u64da\u4f5c\u70ba\u985e\u578b\u70ba\u300cm.receipt\u300d\u7684EDU\u901a\u904e\u806f\u5408\u767c\u9001\u3002\u9019 EDU \u683c\u5f0f\u70ba:</p> <pre><code>{\n    &lt;room_id&gt;: {\n        &lt;receipt_type&gt;: {\n            &lt;user_id&gt;: { &lt;content (ts &amp; thread_id, currently)&gt; }\n        },\n        ...\n    },\n    ...\n}\n</code></pre> <p>\u9019\u4e9b\u59cb\u7d42\u4f5c\u70ba\u589e\u91cf\u767c\u9001\u5230\u4ee5\u524d\u767c\u9001\u7684\u56de\u57f7\u3002\u73fe\u5728 \u53ea\u61c9\u4f7f\u7528\u55ae\u500b\"\":\"m.read\"\u3002'm.read.private' \u4e0d\u5f97\u51fa\u73fe\u5728\u6b64\u806f\u5408\"m.receipt\"\u6559\u80b2\u4e2d\u3002"},{"location":"chat/client_server/#_21","title":"\u5b89\u5168\u6ce8\u610f\u4e8b\u9805","text":"<p>\u7531\u65bc\u6536\u64da\u662f\u5728\u4e8b\u4ef6\u5716\u7684\u4e0a\u4e0b\u6587\u4e4b\u5916\u767c\u9001\u7684,\u56e0\u6b64\u5b58\u5728 \u672a\u5c0d\u300cm.receipt\u300d\u4e8b\u4ef6\u7684\u5167\u5bb9\u57f7\u884c\u5b8c\u6574\u6027\u6aa2\u67e5\u3002</p>"},{"location":"chat/customise_doc/","title":"\u670d\u52d9\u5b9a\u5236","text":""},{"location":"chat/customise_doc/#_2","title":"\u6982\u8ff0","text":"<p>\u57fa\u65bcmatrix\u5354\u8b70\uff0c\u6211\u5011\u505a\u4e86\u4e00\u4e9b\u9069\u914dcosmos\u751f\u614b\u7684\u5b9a\u5236\u5de5\u4f5c\u3002 \u5305\u62ec\u5b9a\u5236cosmos\u7c3d\u540d\u9a57\u7c3d\u767b\u9304\uff0c\u53ca\u4e00\u7cfb\u5217\u804a\u5929\u9650\u5236\u7684\u589e\u52a0\u7b49\u3002</p>"},{"location":"chat/customise_doc/#cosmos","title":"cosmos\u9a57\u7c3d\u767b\u9304","text":"<p>\u5728\u539f\u6709\u767b\u9304api\u7684\u57fa\u790e\u4e0a\u589e\u52a0com.xs.cosmos_sign_auth\u7684\u767b\u9678\u985e\u578b\uff0c\u4e26\u4e14\u5728\u767b\u9304\u6642\u5982\u679c\u767c\u73fe\u7528\u6236\u672a\u8a3b\u518a\uff0c\u5be6\u73fe\u4e86\u81ea\u52d5\u8a3b\u518a\uff0c \u904e\u7a0b\u5982\u4e0b\uff1a</p> <pre><code>    1\uff0c\u6821\u9a57\u7c3d\u540d\n    2\uff0c\u5224\u65b7\u7c3d\u540d\u8207\u516c\u9470\u5c0e\u51fa\u5730\u5740\u662f\u5426\u4e00\u81f4\n    3\uff0c\u5224\u65b7\u7528\u6236\u662f\u5426\u5b58\u5728 \n    4\uff0c\u5982\u679c3,\u5224\u65b7\u70ba\u4e0d\u5b58\u5728\uff0c\u81ea\u52d5\u5c07\u7528\u6236\u8a3b\u518a\u5230\u804a\u5929\u7cfb\u7d71\n</code></pre>"},{"location":"chat/customise_doc/#_3","title":"\u7a7a\u9593\u9650\u5236","text":"<pre><code>\u4f7f\u7528\u91cf\u914d\u984d\u8a08\u7b97\u65b9\u6cd5\n\n\u52f3\u7ae0\u7b49\u7d1a\uff0c\u6bcf\u7d1a\u589e\u52a0 \u52a0\u62103% , 33\u7d1a\u6700\u591a\u53ef\u4ee5\u7372\u5f97 100% \u7684\u52a0\u6210\n\n\u7528\u6236\u57fa\u790e\u91cf = \u7bc0\u9ede\u7528\u7684\u5269\u9918\u78c1\u76e4 / \u7bc0\u9ede\u4e0a\u7684\u4eca\u5929\u4f7f\u7528\u904e\u4e0a\u50b3\u7684\u7528\u6236\u6578 / \u6578\u64da\u6e05\u7406\u9031\u671f / 2\n\n\u7528\u6236\u52a0\u6210\u91cf = \u7528\u6236\u57fa\u790e\u91cf x \u52f3\u7ae0\u7b49\u7d1a\u589e\u5e45\n\n\u7576\u984d\u5ea6\u4e0d\u8db3\u6642\u6efe\u52d5\u8986\u84cb\u6700\u65e9\u7684\u6587\u4ef6\n\n\n++++++++++\u8209\u4f8b\u8aaa\u660e\uff1a++++++++++++++\n\n\u7bc0\u9ede\u53ef\u7528\u5269\u9918\u78c1\u76e4 100G\uff0c\u6578\u64da\u6e05\u7406\u9031\u671f\u3000\u70ba\u3000\uff13\u5929 , \u7bc0\u9ede\u4e0a\u4eca\u5929\u7684\u65e5\u6d3b\u7528\u6236\u70ba 500\u500b\n\n100G / 500  / 3 /2 = 35M\uff08\u7bc0\u9ede\u7528\u6236\u57fa\u790e\u5b58\u5132\u91cf\uff09\n\n\u7528\u6236\u3000A \u52f3\u7ae0\u7b49\u7d1a\u70ba10\u7d1a \uff0c\u52a0\u6210\u6bd4\u4f8b\u70ba 9%\n\n35M x (1 + 0.09) = 38.15M (\u52f3\u7ae0\u52a0\u6210\u5f8c\u7684\u5be6\u969b\u5b58\u5132\u91cf)\n</code></pre>"},{"location":"chat/customise_doc/#_4","title":"\u5e36\u5bec\u9650\u5236","text":""},{"location":"chat/customise_doc/#_5","title":"\u516c\u5171\u623f\u9593\u6578\u91cf\u9650\u5236","text":"<p>\u7528\u6236\u57285\u7d1a\u4e4b\u524d\u4e0d\u5141\u8a31\u5275\u5efa\u516c\u5171\u623f\u9593\uff0c\u8d85\u904e\u4e94\u7d1a\u5f8c\u6bcf\u4e00\u7d1a\u589e\u52a0\u4e00\u500b\u516c\u5171\u623f\u9593\u5275\u5efa\u6b0a\u9650</p>"},{"location":"chat/customise_doc/#_6","title":"\u904a\u5ba2\u6a21\u5f0f","text":"<p>\u904a\u5ba2\u6a21\u5f0f\u5340\u5225\u65bc\u6b63\u5f0f\u7528\u6236\uff0c\u904a\u5ba2\u4ee3\u8868\u50c5\u5728\u804a\u5929\u670d\u52d9\u8a3b\u518a\uff0c\u4f46\u662f\u672a\u9032\u884c\u8cea\u62bc\u4e0a\u934a\u767b\u8a18\u7684\u7528\u6236\uff0c\u904a\u5ba2\u5728\u672a\u8db3\u984d\u8cea\u62bc\u6642\u4e0d\u5141\u8a31\u767c\u9001\u6d88\u606f\u3002</p>"},{"location":"chat/faq/","title":"\u5e38\u898b\u554f\u984c","text":""},{"location":"chat/installation/","title":"\u5b89\u88dd\u555f\u52d5","text":""},{"location":"chat/installation/#_2","title":"\u5b89\u88dd","text":""},{"location":"chat/installation/#windows","title":"Windows\u5b89\u88dd","text":"<p>\u96a8PC\u7aef\u7a0b\u5e8f\u5b89\u88dd\u5373\u53ef</p>"},{"location":"chat/installation/#linux","title":"Linux\u5b89\u88dd","text":"<p>\u89e3\u58d3chat_linux.tar.gz\u5230\u7576\u524d\u6587\u4ef6\u593e\uff0c\u6703\u751f\u6210\u4e00\u500bchat/\u76ee\u9304\uff0c\u5305\u542b\u555f\u52d5\u7a0b\u5e8f\uff08\u7531\u8173\u672c\u5b8c\u6210\uff09</p>"},{"location":"chat/installation/#_3","title":"\u914d\u7f6e","text":""},{"location":"chat/installation/#_4","title":"\u914d\u7f6e\u6587\u4ef6","text":"<ul> <li>matrix_key.pem\uff1a\u670d\u52d9\u7aef\u5bc6\u9470\u6587\u4ef6</li> <li>dendrite.yaml\uff1a\u670d\u52d9\u555f\u52d5\u914d\u7f6e\u6587\u4ef6</li> </ul>"},{"location":"chat/installation/#_5","title":"\u914d\u7f6e\u6587\u4ef6\u521d\u59cb\u5316","text":"<p>\u7531\u7db2\u95dc\u7a0b\u5e8f\u555f\u52d5\u6642\u81ea\u52d5\u751f\u6210</p>"},{"location":"chat/installation/#_6","title":"\u555f\u52d5","text":""},{"location":"chat/installation/#_7","title":"\u555f\u52d5\u524d\u7f6e\u689d\u4ef6","text":"<ul> <li>\u5df2\u8a3b\u518a\u7db2\u95dc</li> <li>\u5df2\u70ba\u8a72\u7db2\u95dc\u8a2d\u7f6e\u865f\u78bc\u6bb5</li> </ul>"},{"location":"chat/installation/#_8","title":"\u555f\u52d5\u547d\u4ee4","text":""},{"location":"chat/installation/#_9","title":"\u6ce8\u610f","text":"<p>\u4ee5\u4e0b\u547d\u4ee4\u5168\u90e8\u7531\u7db2\u95dc\u7a0b\u5e8f\u57f7\u884c\uff0c\u7121\u9700\u624b\u52d5\u8abf\u7528</p>"},{"location":"chat/installation/#windows_1","title":"windows","text":"<pre><code>dendrite-monolith-server.exe -public-ip XXX.XXX.XXX.XXX\n</code></pre>"},{"location":"chat/installation/#linux_1","title":"Linux","text":"<pre><code>dendrite-monolith-server -public-ip XXX.XXX.XXX.XXX\n</code></pre>"},{"location":"chat/installation/#_10","title":"\u914d\u7f6e\u8bf4\u660e","text":"<pre><code>\n    version: 2  # \u7248\u672c\u865f\n    global:\n      mode: chain   # \u555f\u52d5\u6a21\u5f0fchain\u7121\u9700\u8b8a\u52d5\n      server_name: 2222222.fm   # \u865b\u64ec\u529f\u80fd\u8b8a\u6578\u540d\u7a31\uff0c\u5c0d\u61c9{\u9598\u9053\u9996\u500b\u865f\u6bb5}.fm\n      private_key: matrix_key.pem  # \u670d\u52d9\u91d1\u9470\u6a94\u6848\uff0c\u56fa\u5b9a\u751f\u6210\u5373\u53ef\n      # guid\u516c\u958b\u91d1\u9470\uff0cmode=center\u6642\u6709\u7528\uff0cchain\u6a21\u5f0f\u7121\u6240\u8b02\n      guid_pub_key: |-\n        -----BEGIN PUBLIC KEY-----\n        MIIBIjANBgkqhkiG9w0BAQEFAAOCAQ8AMIIBCgKCAQEAxXxkr6ikE7niKv/IuFDP\n        zB9ooLNfHO64vcIClgh++ot39myFnCknggXVTOc2+6kkTBqBWxt1/QJ0vDnmQDja\n        EVRDg9ynewas/1GjzpFjC6vlmZ5QbbWT+tcCApzntwmV7+QyJnJx3fePtKdxxpaA\n        PGaoS9DseRUeqSw5gjsYvOnHhzwoJO/qOvOZNaHJPuzJRfV3kDn6kPvy5KQ0/a8K\n        dqQ7koVK4O6AeM8G8K8WLVKQOl8xKt1KtRIiMoLpJHveCiTPeDsya7u4e/ikk5nR\n        FmDMMNaeDyS/xuOBx2Dk/D3Y0R7oH2k4GKbRKn62T7zpCzkLGu/Riw4Ur8pPUJQb\n        iwIDAQAB\n        -----END PUBLIC KEY-----\n      old_private_keys: []  # \u820a\u79c1\u5bc6\u91d1\u9470\n      key_validity_period: 168h0m0s  # \u79c1\u5bc6\u91d1\u9470\u9a57\u8b49\u9031\u671f\uff0c\u7121\u9700\u6539\u52d5\n      database:  # \u8cc7\u6599\u5eab\u76f8\u95dc\u914d\u5bd8\n        connection_string: postgresql://postgres:postgres@localhost:5432/chat?sslmode=disable\n        max_open_conns: 400\n        max_idle_conns: 50\n        conn_max_lifetime: -1\n      well_known_server_name: 3.35.42.193:28008  # \u8de8\u7bc0\u9ede\u901a\u8a0a\u6642\u4f7f\u7528\u7684servername\n      well_known_client_name: \"\"  # \u8de8\u7bc0\u9ede\u901a\u8a0a\u6642\u7684\u7528\u6236\u7aefname\n      disable_federation: false  # \u662f\u5426\u7981\u7528\u8de8\u7bc0\u9ede\u901a\u8a0a\n      presence:  # \u7528\u6236\u4e0a\u7dda\u901a\u77e5\u914d\u5bd8\n        enable_inbound: true\n        enable_outbound: true\n      trusted_third_party_id_servers:  # \u53ef\u4fe1\u4e09\u65b9\u670d\u52d9\uff0c\u4e0d\u91cd\u8981\n      - matrix.org\n      - vector.im\n      jetstream:  # \u6d88\u606f\u968a\u5217\u4e2d\u4ecb\u8edf\u9ad4jetstream\u914d\u5bd8\n        storage_path: ./\n        addresses: []\n        topic_prefix: Dendrite\n      metrics:   # prometheus\u76e3\u63a7\u914d\u5bd8\n        enabled: true\n        basic_auth:\n          username: metrics\n          password: metrics\n      dns_cache:  # DNS\u7de9\u5b58\u914d\u5bd8\n        enabled: false\n        cache_size: 256\n        cache_lifetime: 5m0s\n    app_service_api:  # app_service_api\u914d\u5bd8\n      disable_tls_validation: false\n      config_files: []\n    client_api:  # \u7528\u6236\u7aefAPI\u914d\u5bd8\n      registration_disabled: false  # \u7981\u7528\u6ce8\u518c\n      registration_shared_secret: dsfdfdfsdffdgfdg\n      guests_disabled: true\n      enable_registration_captcha: false\n      recaptcha_public_key: \"\"\n      recaptcha_private_key: \"\"\n      recaptcha_bypass_secret: \"\"\n      recaptcha_siteverify_api: \"\"\n      turn:  # \u7a7f\u900f\u4e2d\u8f49\u670d\u52d9\u914d\u5bd8\u7528\u65bc\u97f3\u8996\u983b\u901a\u8a71\n        turn_user_lifetime: 1m\n        turn_uris:\n        - turn:3.35.42.193:3478?transport=udp\n        turn_shared_secret: \"\"\n        turn_username: kurento\n        turn_password: kurento\n        trusted_servers:\n        - servername: self\n          host: 3.35.42.193\n          bandwidth: 100\n          turn_uris:\n          - turn:3.35.42.193:3478?transport=udp\n          salt_str: KryaEArg\n      rate_limiting:  # \u9650\u6d41\u914d\u5bd8 \n        enabled: true\n        threshold: 5\n        cooloff_ms: 500\n        exempt_user_ids: []\n    federation_api:  # \u7bc0\u9ede\u9593\u901a\u8a0aAPI\u914d\u5bd8\n      send_max_retries: 16\n      disable_tls_validation: false\n      key_perspectives:\n      - server_name: matrix.org\n        keys:\n        - key_id: ed25519:auto\n          public_key: Noi6WqcDj0QmPxCNQqgezwTlBKrfqehY1u2FyWP9uYw\n        - key_id: ed25519:a_RXGa\n          public_key: l8Hft5qXKn1vfHrg3p4+W8gELQVo8N13JkluMfmn2sQ\n      prefer_direct_fetch: false\n    media_api:   # \u6a94\u5b58\u5132API\u914d\u5bd8\n      database:\n        connection_string: \"\"\n        max_open_conns: 0\n        max_idle_conns: 0\n        conn_max_lifetime: 0\n      base_path: ./media_store\n      clear_interval: 3\n      max_file_size_bytes: 10485760   # \u4e0a\u50b3\u6587\u4ef6\u5927\u5c0f\u9650\u5236\u503c\n      dynamic_thumbnails: false\n      max_thumbnail_generators: 10\n      thumbnail_sizes:\n      - width: 32\n        height: 32\n        method: crop\n      - width: 96\n        height: 96\n        method: crop\n      - width: 640\n        height: 480\n        method: scale\n    sync_api:   # \u540c\u6b65API\u914d\u5bd8\n      real_ip_header: \"\"\n    user_api:\n      bcrypt_cost: 10\n    mscs:\n      mscs:\n      - msc2946\n    tracing:\n      enabled: false\n      jaeger:\n        serviceName: \"\"\n        disabled: false\n        rpc_metrics: false\n        tags: []\n    logging:   # \u65e5\u8a8c\u914d\u5bd8\n    - type: file\n      level: info\n      params:\n        path: ./logs\n\n\n</code></pre>"},{"location":"chat/optional_cfg/","title":"\u53ef\u9078\u914d\u7f6e","text":""},{"location":"chat/optional_cfg/#_2","title":"\u5e36\u5bec\u5171\u4eab\u7bc0\u9ede\u6c60\u914d\u7f6e","text":"<p>\u5e36\u5bec\u5171\u4eab\u9700\u6c42\u88ab\u8a2d\u8a08\u70ba\uff0c\u5141\u8a31\u7bc0\u9ede\u64c1\u6709\u8005\u9032\u884c\u806f\u76df\uff0c\u5c07turn\u4e2d\u8f49\u670d\u52d9\u901a\u904e\u5167\u90e8\u6e9d\u901a\uff0c\u4e26\u4fee\u6539\u914d\u7f6e\u6587\u4ef6\u7684\u65b9\u5f0f\uff0c\u4f86\u9054\u5230\u7528\u6236\u53ef\u4ee5\u8de8\u7bc0\u9ede\u4f7f\u7528turn\u670d\u52d9\u3002 \u4f86\u9054\u5230\u97f3\u8996\u983b\u901a\u4fe1\u6642\uff0c\u5171\u4eab\u5e36\u5bec\u7684\u76ee\u7684\u3002</p>"},{"location":"chat/optional_cfg/#_3","title":"\u914d\u7f6e\u6539\u52d5","text":"<p>\u5728\u751f\u6210\u914d\u7f6e\u6587\u4ef6\u6642\uff0c\u9ed8\u8a8d\u65b0\u589e\u4e86\u7576\u524d\u7bc0\u9ede\u4fe1\u606f\u5230trusted_servers\u914d\u7f6e\u9805\u4e0b\u3002\u5982\u4e0b\uff1a</p> <pre><code>\n  turn:\n    turn_user_lifetime: \"1m\"\n    turn_uris: [\"turn:192.168.10.242:3478?transport=udp\"]\n    turn_shared_secret: \"\"\n    turn_username: \"test\"\n    turn_password: \"pwd_test\"\n    trusted_servers:\n      - servername: self   # \u96a8\u4fbf\u547d\u540d\n        host: 192.168.3.32  # \u670d\u52d9\u5668\u516c\u7db2IP\n        bandwidth: 100  # \u670d\u52d9\u5668\u7db2\u7d61\u5e36\u5bec(\u55ae\u4f4dM)\n        turn_uris: [\"turn:192.168.3.32:3478?transport=udp\"]\n        salt_str: salt_str_here # \u7528\u65bc\u63a5\u53e3\u53c3\u6578\u7c3d\u540d\u7684salt\u5b57\u7b26\u4e32\n\n</code></pre>"},{"location":"chat/optional_cfg/#_4","title":"\u5171\u4eab\u914d\u7f6e","text":"<p>\u7576\u7bc0\u9ede\u64c1\u6709\u8005\u79c1\u4e0b\u9054\u6210\u5171\u4eab\u5e36\u5bec\u5171\u8b58\u6642\uff0c\u53ea\u9700\u8981\u628a\u81ea\u5df1\u7bc0\u9ede\u7684trusted_servers\u914d\u7f6e\u9805\u4e0b\u7684\u7b2c\u4e00\u500btrusted_server\u914d\u7f6e\uff0c\u4e5f\u5c31\u662f\u81ea\u5df1\u7bc0\u9ede\u7684 \u914d\u7f6e\u4e92\u76f8\u767c\u9001\u7d66\u5c0d\u65b9\uff0c\u7136\u5f8c\u5c0d\u65b9\u628a\u6536\u5230\u7684\u914d\u7f6e\u8ffd\u52a0\u5230trusted_servers\u4e0b\uff0c\u91cd\u555f\u670d\u52d9\u5373\u53ef\uff0c\u793a\u4f8b\u5982\u4e0b\uff1a</p> <pre><code>\n  turn:\n    turn_user_lifetime: \"1m\"\n    turn_uris: [\"turn:192.168.10.242:3478?transport=udp\"]\n    turn_shared_secret: \"\"\n    turn_username: \"test\"\n    turn_password: \"pwd_test\"\n    trusted_servers:\n      - servername: self   # \u81ea\u5df1\u7bc0\u9ede\u7684trusted_server\u914d\u7f6e\uff0c\u540d\u7a31\u81ea\u5df1\u53d6\n        host: 192.168.3.32  # \u670d\u52d9\u5668\u516c\u7db2IP\n        bandwidth: 100  # \u670d\u52d9\u5668\u7db2\u7d61\u5e36\u5bec(\u55ae\u4f4dM)\uff0c\u8a72\u914d\u7f6e\u66ab\u6642\u6c92\u7528\n        turn_uris: [\"turn:192.168.3.32:3478?transport=udp\"]\n        salt_str: salt_str_here # \u7528\u65bc\u63a5\u53e3\u53c3\u6578\u7c3d\u540d\u7684salt\u5b57\u7b26\u4e32\n\n      - servername: other1   # \u5c0d\u65b9\u7bc0\u9ede\u7684trusted_server\u914d\u7f6e\uff0c\u540d\u7a31\u81ea\u5df1\u53d6\n        host: 192.168.3.30  # \u670d\u52d9\u5668\u516c\u7db2IP\n        bandwidth: 50  # \u670d\u52d9\u5668\u7db2\u7d61\u5e36\u5bec(\u55ae\u4f4dM)\uff0c\u8a72\u914d\u7f6e\u66ab\u6642\u6c92\u7528\n        turn_uris: [\"turn:192.168.3.30:3478?transport=udp\"]\n        salt_str: other_salt_str_here # \u7528\u65bc\u63a5\u53e3\u53c3\u6578\u7c3d\u540d\u7684salt\u5b57\u7b26\u4e32\n\n</code></pre>"},{"location":"chat/optional_cfg/#_5","title":"\u6ce8\u610f","text":"<pre><code>    \u7576\u4fee\u6539\u672c\u7bc0\u9ede\u7684\u6587\u4ef6\u5b58\u5132\u6e05\u7406\u6642\u9593\u9031\u671f\u914d\u7f6e\u6642\uff0c\u804a\u5929\u670d\u52d9\u914d\u7f6e\u6587\u4ef6\u6703\u91cd\u65b0\u751f\u6210\u3002\n    \u4e5f\u5c31\u610f\u5473\u8457\u9019\u88e1\u7684\u5171\u4eab\u5e36\u5bec\u914d\u7f6e\u6703\u5931\u6548\uff0c\u6240\u4ee5\u9700\u8981\u91cd\u65b0\u914d\u7f6e\n</code></pre>"},{"location":"chat/prometheus_doc/","title":"\u666e\u7f85\u7c73\u4fee\u65af\u72c0\u614b\u76e3\u63a7","text":"<pre><code>    # HELP dendrite_caching_ristretto_cost   *ristretto\u7de9\u5b58\u6d88\u8017\n\n    # TYPE dendrite_caching_ristretto_cost gauge\n\n    dendrite_caching_ristretto_cost 0\n\n    # HELP dendrite_caching_ristretto_ratio\n\n    # TYPE dendrite_caching_ristretto_ratio gauge\n\n    dendrite_caching_ristretto_ratio 0\n\n    # HELP dendrite_clientapi_reg_users_total Total number of registered users  \u7e3d\u8a3b\u518a\u7528\u6236\u6578\n\n    # TYPE dendrite_clientapi_reg_users_total counter\n\n    dendrite_clientapi_reg_users_total 0\n\n    # HELP dendrite_federationapi_destination_queues_backing_off   \u8de8\u7bc0\u9ede\u4e8b\u4ef6\u767c\u9001\u4e2d\u7684\u6578\u91cf\n\n    # TYPE dendrite_federationapi_destination_queues_backing_off gauge\n\n    dendrite_federationapi_destination_queues_backing_off 0\n\n    # HELP dendrite_federationapi_destination_queues_running  \u8de8\u7bc0\u9ede\u4e8b\u4ef6\u8655\u7406\u4e2d\u7684\u6578\u91cf\n\n    # TYPE dendrite_federationapi_destination_queues_running gauge\n\n    dendrite_federationapi_destination_queues_running 0\n\n    # HELP dendrite_federationapi_destination_queues_total   \u8de8\u7bc0\u9ede\u4e8b\u4ef6\u7e3d\u6578\u91cf\n\n    # TYPE dendrite_federationapi_destination_queues_total gauge\n\n    dendrite_federationapi_destination_queues_total 0\n\n    # HELP dendrite_federationapi_recv_edus Number of incoming EDUs from remote servers \u5f9e\u9060\u7aef\u63a5\u6536\u7684\u8de8\u7bc0\u9ede\u4e8b\u4ef6\u6578\u91cf\n\n    # TYPE dendrite_federationapi_recv_edus counter\n\n    dendrite_federationapi_recv_edus 0\n\n    # HELP dendrite_syncapi_active_sync_requests The number of sync requests that are active right now  \u6d3b\u8e8d\u7684\u540c\u6b65\u8acb\u6c42\u6578\n\n    # TYPE dendrite_syncapi_active_sync_requests gauge\n\n    dendrite_syncapi_active_sync_requests 0\n\n    # HELP dendrite_syncapi_waiting_sync_requests The number of sync requests that are waiting to be woken by a notifier  \u7b49\u5f85\u88ab\u559a\u9192\u7684\u540c\u6b65\u8acb\u6c42\u6578\n\n    # TYPE dendrite_syncapi_waiting_sync_requests gauge\n\n    dendrite_syncapi_waiting_sync_requests 0\n\n    # HELP dendrite_user_online_num_requests_total Total number of internal API calls  \u5167\u90e8API\u8acb\u6c42\u7e3d\u6578\n\n    # TYPE dendrite_user_online_num_requests_total counter\n\n    dendrite_user_online_num_requests_total{code=\"200\"} 1214\n\n    # HELP dendrite_user_online_num_response_size_bytes A histogram of response sizes for requests.  \u7528\u6236\u5728\u7dda\u6578\u8acb\u6c42\u7684\u6b77\u53f2\u8fd4\u56de\u6578\u64da\u5927\u5c0f\n\n    # TYPE dendrite_user_online_num_response_size_bytes histogram\n\n    dendrite_user_online_num_response_size_bytes_bucket{le=\"200\"} 1214\n\n    dendrite_user_online_num_response_size_bytes_bucket{le=\"500\"} 1214\n\n    dendrite_user_online_num_response_size_bytes_bucket{le=\"900\"} 1214\n\n    dendrite_user_online_num_response_size_bytes_bucket{le=\"1500\"} 1214\n\n    dendrite_user_online_num_response_size_bytes_bucket{le=\"5000\"} 1214\n\n    dendrite_user_online_num_response_size_bytes_bucket{le=\"15000\"} 1214\n\n    dendrite_user_online_num_response_size_bytes_bucket{le=\"50000\"} 1214\n\n    dendrite_user_online_num_response_size_bytes_bucket{le=\"100000\"} 1214\n\n    dendrite_user_online_num_response_size_bytes_bucket{le=\"+Inf\"} 1214\n\n    dendrite_user_online_num_response_size_bytes_sum 1214\n\n    dendrite_user_online_num_response_size_bytes_count 1214\n\n    # HELP go_gc_duration_seconds A summary of the pause duration of garbage collection cycles.\n\n    # TYPE go_gc_duration_seconds summary\n\n    go_gc_duration_seconds{quantile=\"0\"} 2.5635e-05\n\n    go_gc_duration_seconds{quantile=\"0.25\"} 4.6248e-05\n\n    go_gc_duration_seconds{quantile=\"0.5\"} 5.2428e-05\n\n    go_gc_duration_seconds{quantile=\"0.75\"} 6.108e-05\n\n    go_gc_duration_seconds{quantile=\"1\"} 0.0001923\n\n    go_gc_duration_seconds_sum 0.002047596\n\n    go_gc_duration_seconds_count 37\n\n    # HELP go_goroutines Number of goroutines that currently exist.\n\n    # TYPE go_goroutines gauge\n\n    go_goroutines 168\n\n    # HELP go_info Information about the Go environment.\n\n    # TYPE go_info gauge\n\n    go_info{version=\"go1.18.3\"} 1\n\n    # HELP go_memstats_alloc_bytes Number of bytes allocated and still in use.\n\n    # TYPE go_memstats_alloc_bytes gauge\n\n    go_memstats_alloc_bytes 8.1388416e+07\n\n    # HELP go_memstats_alloc_bytes_total Total number of bytes allocated, even if freed.\n\n    # TYPE go_memstats_alloc_bytes_total counter\n\n    go_memstats_alloc_bytes_total 2.02933024e+08\n\n    # HELP go_memstats_buck_hash_sys_bytes Number of bytes used by the profiling bucket hash table.\n\n    # TYPE go_memstats_buck_hash_sys_bytes gauge\n\n    go_memstats_buck_hash_sys_bytes 1.482235e+06\n\n    # HELP go_memstats_frees_total Total number of frees.\n\n    # TYPE go_memstats_frees_total counter\n\n    go_memstats_frees_total 849112\n\n    # HELP go_memstats_gc_sys_bytes Number of bytes used for garbage collection system metadata.\n\n    # TYPE go_memstats_gc_sys_bytes gauge\n\n    go_memstats_gc_sys_bytes 7.936496e+06\n\n    # HELP go_memstats_heap_alloc_bytes Number of heap bytes allocated and still in use.\n\n    # TYPE go_memstats_heap_alloc_bytes gauge\n\n    go_memstats_heap_alloc_bytes 8.1388416e+07\n\n    # HELP go_memstats_heap_idle_bytes Number of heap bytes waiting to be used.\n\n    # TYPE go_memstats_heap_idle_bytes gauge\n\n    go_memstats_heap_idle_bytes 8.8064e+06\n\n    # HELP go_memstats_heap_inuse_bytes Number of heap bytes that are in use.\n\n    # TYPE go_memstats_heap_inuse_bytes gauge\n\n    go_memstats_heap_inuse_bytes 8.5794816e+07\n\n    # HELP go_memstats_heap_objects Number of allocated objects.\n\n    # TYPE go_memstats_heap_objects gauge\n\n    go_memstats_heap_objects 77324\n\n    # HELP go_memstats_heap_released_bytes Number of heap bytes released to OS.\n\n    # TYPE go_memstats_heap_released_bytes gauge\n\n    go_memstats_heap_released_bytes 1.572864e+06\n\n    # HELP go_memstats_heap_sys_bytes Number of heap bytes obtained from system.\n\n    # TYPE go_memstats_heap_sys_bytes gauge\n\n    go_memstats_heap_sys_bytes 9.4601216e+07\n\n    # HELP go_memstats_last_gc_time_seconds Number of seconds since 1970 of last garbage collection.\n\n    # TYPE go_memstats_last_gc_time_seconds gauge\n\n    go_memstats_last_gc_time_seconds 1.6812883440088644e+09\n\n    # HELP go_memstats_lookups_total Total number of pointer lookups.\n\n    # TYPE go_memstats_lookups_total counter\n\n    go_memstats_lookups_total 0\n\n    # HELP go_memstats_mallocs_total Total number of mallocs.\n\n    # TYPE go_memstats_mallocs_total counter\n\n    go_memstats_mallocs_total 926436\n\n    # HELP go_memstats_mcache_inuse_bytes Number of bytes in use by mcache structures.\n\n    # TYPE go_memstats_mcache_inuse_bytes gauge\n\n    go_memstats_mcache_inuse_bytes 9600\n\n    # HELP go_memstats_mcache_sys_bytes Number of bytes used for mcache structures obtained from system.\n\n    # TYPE go_memstats_mcache_sys_bytes gauge\n\n    go_memstats_mcache_sys_bytes 15600\n\n    # HELP go_memstats_mspan_inuse_bytes Number of bytes in use by mspan structures.\n\n    # TYPE go_memstats_mspan_inuse_bytes gauge\n\n    go_memstats_mspan_inuse_bytes 274448\n\n    # HELP go_memstats_mspan_sys_bytes Number of bytes used for mspan structures obtained from system.\n\n    # TYPE go_memstats_mspan_sys_bytes gauge\n\n    go_memstats_mspan_sys_bytes 342720\n\n    # HELP go_memstats_next_gc_bytes Number of heap bytes when next garbage collection will take place.\n\n    # TYPE go_memstats_next_gc_bytes gauge\n\n    go_memstats_next_gc_bytes 1.5774864e+08\n\n    # HELP go_memstats_other_sys_bytes Number of bytes used for other system allocations.\n\n    # TYPE go_memstats_other_sys_bytes gauge\n\n    go_memstats_other_sys_bytes 1.646717e+06\n\n    # HELP go_memstats_stack_inuse_bytes Number of bytes in use by the stack allocator.\n\n    # TYPE go_memstats_stack_inuse_bytes gauge\n\n    go_memstats_stack_inuse_bytes 1.867776e+06\n\n    # HELP go_memstats_stack_sys_bytes Number of bytes obtained from system for stack allocator.\n\n    # TYPE go_memstats_stack_sys_bytes gauge\n\n    go_memstats_stack_sys_bytes 1.867776e+06\n\n    # HELP go_memstats_sys_bytes Number of bytes obtained from system.\n\n    # TYPE go_memstats_sys_bytes gauge\n\n    go_memstats_sys_bytes 1.0789276e+08\n\n    # HELP go_threads Number of OS threads created.\n\n    # TYPE go_threads gauge\n\n    go_threads 14\n\n    # HELP process_cpu_seconds_total Total user and system CPU time spent in seconds.\n\n    # TYPE process_cpu_seconds_total counter\n\n    process_cpu_seconds_total 4.27\n\n    # HELP process_max_fds Maximum number of open file descriptors.\n\n    # TYPE process_max_fds gauge\n\n    process_max_fds 65535\n\n    # HELP process_open_fds Number of open file descriptors.\n\n    # TYPE process_open_fds gauge\n\n    process_open_fds 12\n\n    # HELP process_resident_memory_bytes Resident memory size in bytes.\n\n    # TYPE process_resident_memory_bytes gauge\n\n    process_resident_memory_bytes 5.7909248e+07\n\n    # HELP process_start_time_seconds Start time of the process since unix epoch in seconds.\n\n    # TYPE process_start_time_seconds gauge\n\n    process_start_time_seconds 1.68128474314e+09\n\n    # HELP process_virtual_memory_bytes Virtual memory size in bytes.\n\n    # TYPE process_virtual_memory_bytes gauge\n\n    process_virtual_memory_bytes 1.50509568e+09\n\n    # HELP process_virtual_memory_max_bytes Maximum amount of virtual memory available in bytes.\n\n    # TYPE process_virtual_memory_max_bytes gauge\n\n    process_virtual_memory_max_bytes 1.8446744073709552e+19\n\n    # HELP promhttp_metric_handler_requests_in_flight Current number of scrapes being served.\n\n    # TYPE promhttp_metric_handler_requests_in_flight gauge\n\n    promhttp_metric_handler_requests_in_flight 1\n\n    # HELP promhttp_metric_handler_requests_total Total number of scrapes by HTTP status code.\n\n    # TYPE promhttp_metric_handler_requests_total counter\n\n    promhttp_metric_handler_requests_total{code=\"200\"} 1\n\n    promhttp_metric_handler_requests_total{code=\"500\"} 0\n\n    promhttp_metric_handler_requests_total{code=\"503\"} 0\n\n\n</code></pre>"},{"location":"chat/voip_signaling/","title":"\u547c\u53eb\u6d41\u7a0b","text":"<p>Useful links: - https://codelabs.developers.google.com/codelabs/webrtc-web/#0 - http://webrtc.github.io/webrtc-org/native-code/android/</p> <p> </p>"},{"location":"gateway/config/","title":"\u914d\u7f6e","text":""},{"location":"gateway/config/#_2","title":"\u5340\u584a\u6642\u9593","text":"<p>\u7bc0\u9ede\u914d\u7f6e\u4e2d\u7684\u8d85\u6642\u63d0\u4ea4\u503c\u5b9a\u7fa9\u4e86\u6211\u5011\u5728\u63d0\u4ea4\u4e00\u500b\u584a\u4e4b\u5f8c\u7b49\u5f85\u591a\u9577\u6642\u9593\uff0c\u7136\u5f8c\u518d\u958b\u59cb\u65b0\u7684\u9ad8\u5ea6\uff08\u9019\u8b93\u6211\u5011\u6709\u6a5f\u6703\u6536\u5230\u66f4\u591a\u7684\u9810\u63d0\u4ea4\uff0c\u5373\u4f7f\u6211\u5011\u5df2\u7d93\u6709 +2/3\uff09\u3002 \u7576\u524d\u9ed8\u8a8d\u503c\u70ba<code>6s</code>\u3002</p> <p>\ud83d\udce3 \u63d0\u793a :  <code>$install_path</code> \u7528\u4f86\u8868\u793a\u60a8\u5b89\u88dd <code>stcd</code> \u4e8c\u9032\u88fd\u7a0b\u5e8f\u7684\u8def\u5f91</p> <p>\ud83d\udce3 \u63d0\u793a : \u5f9e v6 \u958b\u59cb\uff0c\u9019\u7531\u670d\u52d9\u5668\u5728\u521d\u59cb\u5316\u7bc0\u9ede\u6642\u81ea\u52d5\u8655\u7406\u3002 \u9a57\u8b49\u8005\u9700\u8981\u78ba\u4fdd\u4ed6\u5011\u7684\u672c\u5730\u7bc0\u9ede\u914d\u7f6e\uff0c\u4ee5\u4fbf\u5c07\u7db2\u7d61\u52a0\u901f\u5230\u7d04 2 \u79d2\u7684\u51fa\u584a\u6642\u9593\u3002 :::</p> <pre><code># In $install_path/.stcd/config/config.toml\n\n#######################################################\n###         Consensus Configuration Options         ###\n#######################################################\n[consensus]\n\n### ... \n\n# How long we wait after committing a block, before starting on the new\n# height (this gives us a chance to receive some more precommits, even\n# though we already have +2/3).\ntimeout_commit = \"1s\"\n</code></pre>"},{"location":"gateway/config/#_3","title":"\u7bc0\u9ede","text":"<p>\u5728 <code>$install_path/.stcd/config/config.toml</code> \u4e2d\uff0c\u4f60\u53ef\u4ee5\u8a2d\u7f6e\u4f60\u7684\u5c0d\u7b49\u9ede\u3002</p> <p>\u8acb\u53c3\u95b1\u6211\u5011\u6587\u6a94\u4e2d\u7684 \u6dfb\u52a0\u6301\u4e45\u7bc0\u9ede \u4ee5\u7372\u53d6\u81ea\u52d5\u5316\u65b9\u6cd5\uff0c\u4f46\u5b57\u6bb5\u61c9\u8a72\u770b\u8d77\u4f86\u50cf\u9017\u865f\u5206\u9694\u7684 peer \u5b57\u7b26\u4e32\uff08\u4e0d\u8981\u5fa9\u5236\u5b83\uff0c\u53ea\u662f\u4e00\u500b\u4f8b\u5b50\uff09\uff1a</p> <pre><code>persistent_peers = \"5576b0160761fe81ccdf88e06031a01bc8643d51@195.201.108.97:24656,13e850d14610f966de38fc2f925f6dc35c7f4bf4@176.9.60.27:26656,38eb4984f89899a5d8d1f04a79b356f15681bb78@18.169.155.159:26656,59c4351009223b3652674bd5ee4324926a5a11aa@51.15.133.26:26656,3a5a9022c8aa2214a7af26ebbfac49b77e34e5c5@65.108.1.46:26656,4fc0bea2044c9fd1ea8cc987119bb8bdff91aaf3@65.21.246.124:26656,6624238168de05893ca74c2b0270553189810aa7@95.216.100.80:26656,9d247286cd407dc8d07502240245f836e18c0517@149.248.32.208:26656,37d59371f7578101dee74d5a26c86128a229b8bf@194.163.172.168:26656,b607050b4e5b06e52c12fcf2db6930fd0937ef3b@95.217.107.96:26656,7a6bbbb6f6146cb11aebf77039089cd038003964@94.130.54.247:26656\"\n</code></pre>"},{"location":"gateway/config/#_4","title":"\u5206\u4eab\u4f60\u7684\u7bc0\u9ede","text":"<p>\u60a8\u53ef\u4ee5\u4f7f\u7528 <code>tendermint show-node-id</code> \u547d\u4ee4\u67e5\u770b\u548c\u5171\u4eab\u60a8\u7684\u5c0d\u7b49\u7bc0\u9ede</p> <pre><code>stcd tendermint show-node-id\nac29d21d0a6885465048a4481d16c12f59b2e58b\n</code></pre> <ul> <li>\u7bc0\u9ede\u683c\u5f0f: <code>node-id@ip:port</code></li> <li>\u6a23\u4f8b: <code>ac29d21d0a6885465048a4481d16c12f59b2e58b@143.198.224.124:26656</code></li> </ul>"},{"location":"gateway/config/#_5","title":"\u5065\u5eb7\u7bc0\u9ede","text":"<p>\u5982\u679c\u60a8\u53ea\u4f9d\u8cf4\u7a2e\u5b50\u7bc0\u9ede\u800c\u6c92\u6709\u6301\u4e45\u5c0d\u7b49\u7bc0\u9ede\u6216\u6578\u91cf\u5f88\u5c11\uff0c\u8acb\u5728 <code>config.toml</code> \u4e2d\u589e\u52a0\u4ee5\u4e0b\u53c3\u6578\uff1a</p> <pre><code># Maximum number of inbound peers\nmax_num_inbound_peers = 120\n\n# Maximum number of outbound peers to connect to, excluding persistent peers\nmax_num_outbound_peers = 60\n</code></pre>"},{"location":"gateway/disk-usage/","title":"\u78c1\u76e4\u4f7f\u7528\u512a\u5316","text":"<p>\u81ea\u5b9a\u7fa9\u914d\u7f6e\u8a2d\u7f6e\u4ee5\u964d\u4f4e\u9a57\u8b49\u5668\u7bc0\u9ede\u7684\u78c1\u76e4\u8981\u6c42\u3002</p> <p>\u5340\u584a\u93c8\u6578\u64da\u5eab\u5f80\u5f80\u6703\u96a8\u8457\u6642\u9593\u7684\u63a8\u79fb\u800c\u589e\u9577\uff0c\u9019\u53d6\u6c7a\u65bc\u4f8b\u5982\u95dc\u65bc\u5340\u584a\u901f\u5ea6\u548c\u4ea4\u6613\u91d1\u984d\u3002 \u5c0d\u65bc Daodst\uff0c\u6211\u5011\u8ac7\u8ad6\u7684\u662f\u524d\u5169\u9031\u63a5\u8fd1 100GB \u7684\u78c1\u76e4\u4f7f\u7528\u91cf\u3002</p> <p>\u5f88\u5c11\u6709\u914d\u7f6e\u53ef\u4ee5\u986f\u8457\u6e1b\u5c11\u6240\u9700\u7684\u78c1\u76e4\u4f7f\u7528\u91cf\u3002 \u5176\u4e2d\u4e00\u4e9b\u66f4\u6539\u53ea\u6709\u5728\u60a8\u9032\u884c\u914d\u7f6e\u4e26\u5f9e\u4f7f\u7528\u5b83\u5011\u958b\u59cb\u540c\u6b65\u6642\u624d\u6703\u5b8c\u5168\u751f\u6548\u3002</p>"},{"location":"gateway/disk-usage/#_2","title":"\u7d22\u5f15","text":"<p>\u5982\u679c\u4e0d\u9700\u8981\u5f9e\u7279\u5b9a\u7bc0\u9ede\u67e5\u8a62\u4ea4\u6613\uff0c\u53ef\u4ee5\u7981\u7528\u7d22\u5f15\u3002\u5728 <code>config.toml</code> \u4e2d\u9032\u884c\u8a2d\u7f6e</p> <pre><code>indexer = \"null\"\n</code></pre> <p>\u5982\u679c\u60a8\u5728\u5df2\u7d93\u540c\u6b65\u7684\u7bc0\u9ede\u4e0a\u57f7\u884c\u6b64\u64cd\u4f5c\uff0c\u5247\u6536\u96c6\u7684\u7d22\u5f15\u4e0d\u6703\u81ea\u52d5\u6e05\u9664\uff0c\u60a8\u9700\u8981\u624b\u52d5\u5c07\u5176\u522a\u9664\u3002 \u8a72\u7d22\u5f15\u4f4d\u65bc\u540d\u70ba <code>data/tx_index.db/</code> \u7684\u6578\u64da\u5eab\u76ee\u9304\u4e0b\u3002</p>"},{"location":"gateway/disk-usage/#_3","title":"\u72c0\u614b\u540c\u6b65\u5feb\u7167","text":"<p>\u6211\u76f8\u4fe1\u9019\u5728 Daodst \u4e0a\u9ed8\u8a8d\u662f\u7981\u7528\u7684\uff0c\u4f46\u7121\u8ad6\u5982\u4f55\u90fd\u6703\u5728\u9019\u88e1\u5217\u51fa\u3002\u5728 <code>app.toml</code> \u96c6</p> <pre><code>snapshot-interval = 0\n</code></pre> <p>\u8acb\u6ce8\u610f\uff0c\u5982\u679c\u5728\u7db2\u7d61\u4e0a\u555f\u7528\u4e86\u72c0\u614b\u540c\u6b65\u4e26\u4e14\u5de5\u4f5c\u6b63\u5e38\uff0c\u5b83\u5c07\u5141\u8a31\u4e00\u500b\u4eba\u5728\u5e7e\u5206\u9418\u5167\u540c\u6b65\u4e00\u500b\u65b0\u7bc0\u9ede\u3002\u4f46\u662f\u9019\u500b\u7bc0\u9ede\u4e0d\u6703\u6709\u6b77\u53f2\u3002</p>"},{"location":"gateway/disk-usage/#_4","title":"\u914d\u7f6e\u4fee\u526a","text":"<p>\u9ed8\u8a8d\u60c5\u6cc1\u4e0b\uff0c\u6bcf 500 \u500b\u72c0\u614b\u4fdd\u7559\u4e00\u6b21\uff0c\u6700\u5f8c 100 \u500b\u72c0\u614b\u4fdd\u7559\u3002 \u5f9e\u9577\u9060\u4f86\u770b\uff0c\u9019\u6703\u6d88\u8017\u5927\u91cf\u78c1\u76e4\u7a7a\u9593\uff0c\u53ef\u4ee5\u901a\u904e\u4ee5\u4e0b\u81ea\u5b9a\u7fa9\u914d\u7f6e\u9032\u884c\u512a\u5316\uff1a</p> <pre><code>pruning = \"custom\"\npruning-keep-recent = \"100\"\npruning-keep-every = \"0\"\npruning-interval = \"10\"\n</code></pre> <p>\u914d\u7f6e <code>pruning-keep-recent = \"0\"</code> \u807d\u8d77\u4f86\u5f88\u8a98\u4eba\uff0c\u4f46\u5982\u679c <code>stcd</code> \u56e0\u4efb\u4f55\u539f\u56e0\u88ab\u6bba\u6b7b\uff0c\u9019\u5c07\u6709\u6578\u64da\u5eab\u640d\u58de\u7684\u98a8\u96aa\u3002 \u56e0\u6b64\uff0c\u5efa\u8b70\u4fdd\u7559\u5c11\u6578\u6700\u65b0\u72c0\u614b\u3002</p>"},{"location":"gateway/disk-usage/#_5","title":"\u65e5\u8a8c\u8a18\u9304","text":"<p>\u9ed8\u8a8d\u60c5\u6cc1\u4e0b\uff0c\u65e5\u8a8c\u8a18\u9304\u7d1a\u5225\u8a2d\u7f6e\u70ba <code>info</code>\uff0c\u9019\u6703\u7522\u751f\u5927\u91cf\u65e5\u8a8c\u3002 \u7576\u555f\u52d5\u6642\u770b\u5230\u7bc0\u9ede\u958b\u59cb\u6b63\u78ba\u540c\u6b65\u6642\uff0c\u6b64\u65e5\u8a8c\u7d1a\u5225\u53ef\u80fd\u5f88\u597d\u3002 \u4f46\u662f\uff0c\u5728\u60a8\u770b\u5230\u540c\u6b65\u9806\u5229\u9032\u884c\u5f8c\uff0c\u60a8\u53ef\u4ee5\u5c07\u65e5\u8a8c\u7d1a\u5225\u964d\u4f4e\u5230 <code>warn</code>\uff08\u6216 <code>error</code>\uff09\u3002 \u5728 <code>config.toml</code> \u4e0a\u8a2d\u7f6e\u4ee5\u4e0b\u5167\u5bb9\u3002</p> <pre><code>log_level = \"warn\"\n</code></pre> <p>\u9084\u8981\u78ba\u4fdd\u60a8\u7684\u65e5\u8a8c\u8f2a\u63db\u914d\u7f6e\u6b63\u78ba\u3002</p>"},{"location":"gateway/disk-usage/#_6","title":"\u7d50\u679c","text":"<p>\u4ee5\u4e0b\u662f Daodst \u6e2c\u8a66\u7db2\u5169\u9031\u5f8c\u7684\u78c1\u76e4\u4f7f\u7528\u60c5\u6cc1\u3002 \u9ed8\u8a8d\u914d\u7f6e\u5c0e\u81f4\u78c1\u76e4\u4f7f\u7528\u91cf\u70ba 90GB\u3002</p> <pre><code>5.3G    ./state.db\n70G     ./application.db\n20K     ./snapshots/metadata.db\n24K     ./snapshots\n9.0G    ./blockstore.db\n20K     ./evidence.db\n1018M   ./cs.wal\n4.7G    ./tx_index.db\n90G     .\n</code></pre> <p>\u6b64\u512a\u5316\u914d\u7f6e\u5df2\u5c07\u78c1\u76e4\u4f7f\u7528\u91cf\u6e1b\u5c11\u5230 17 GB\u3002</p> <pre><code>17G     .\n1.1G    ./cs.wal\n946M    ./application.db\n20K     ./evidence.db\n9.1G    ./blockstore.db\n24K     ./snapshots\n20K     ./snapshots/metadata.db\n5.3G    ./state.db\n</code></pre>"},{"location":"gateway/faq/","title":"\u9a57\u8b49\u5668 FAQ","text":"<p>\u67e5\u770b\u95dc\u65bc\u5728 DST \u4e0a\u904b\u884c\u9a57\u8b49\u5668\u7684\u5e38\u898b\u554f\u984c\u89e3\u7b54\u3002</p>"},{"location":"gateway/faq/#_1","title":"\u4e00\u822c\u6982\u5ff5","text":"\u4ec0\u9ebc\u662f\u9a57\u8b49\u5668? <p>DST \u7531 [Tendermint](https://docs.tendermint.com/v0.34/introduction/what-is-tendermint.html) Core \u63d0\u4f9b\u652f\u6301\uff0c\u5b83\u4f9d\u8cf4\u65bc\u4e00\u7d44\u9a57\u8b49\u5668\u4f86\u4fdd\u8b77\u7db2\u7d61\u3002</p> <p>\u9a57\u8b49\u5668\u904b\u884c\u4e00\u500b\u5b8c\u6574\u7684\u7bc0\u9ede\u4e26\u901a\u904e\u5ee3\u64ad\u6295\u7968\u53c3\u8207\u5171\u8b58\uff0c\u6295\u7968\u5305\u542b\u7531\u4ed6\u5011\u7684\u79c1\u9470\u7c3d\u540d\u7684\u52a0\u5bc6\u7c3d\u540d\u3002\u9a57\u8b49\u5668\u5728\u5340\u584a\u93c8\u4e2d\u63d0\u4ea4\u65b0\u5340\u584a\u4e26\u7372\u5f97\u6536\u5165\u4ee5\u63db\u53d6\u4ed6\u5011\u7684\u5de5\u4f5c\u3002</p> <p>\u4ed6\u5011\u9084\u901a\u904e\u5c0d\u6cbb\u7406\u63d0\u6848\u9032\u884c\u6295\u7968\u4f86\u53c3\u8207\u5354\u8b70\u5167\u7684\u8ca1\u52d9\u6cbb\u7406\u3002\u9a57\u8b49\u5668\u7684\u6295\u7968\u5f71\u97ff\u529b\u6839\u64da\u4ed6\u5011\u7684\u7e3d\u6b0a\u76ca\u9032\u884c\u52a0\u6b0a\u3002</p> \u4ec0\u9ebc\u662f\"\u8cea\u62bc\"? <p>DST \u662f\u4e00\u500b\u516c\u958b\u7684\u80a1\u6b0a\u8b49\u660e (PoS) \u5340\u584a\u93c8\uff0c\u9019\u610f\u5473\u8457\u9a57\u8b49\u5668\u7684\u6b0a\u91cd\u53d6\u6c7a\u65bc\u4f5c\u70ba\u62b5\u62bc\u54c1\u7684\u62b5\u62bc\u4ee3\u5e63 (FM) \u7684\u6578\u91cf\u3002 \u9019\u4e9b\u8cea\u62bc\u4ee3\u5e63\u53ef\u4ee5\u7531\u9a57\u8b49\u5668\u76f4\u63a5\u8cea\u62bc\u6216\u7531 FM \u6301\u6709\u8005\u59d4\u8a17\u7d66\u4ed6\u5011\u3002</p> <p>\u7cfb\u7d71\u4e2d\u7684\u4efb\u4f55\u7528\u6236\u90fd\u53ef\u4ee5\u901a\u904e\u767c\u9001<code>create-validator</code>\u4ea4\u6613\u4f86\u8072\u660e\u5176\u6210\u70ba\u9a57\u8b49\u5668\u7684\u610f\u5716\u3002 \u5f9e\u90a3\u88e1\uff0c\u4ed6\u5011\u6210\u70ba\u9a57\u8b49\u5668\u3002\u9a57\u8b49\u5668\u7684\u6b0a\u91cd\uff08\u5373\u7e3d\u6b0a\u76ca\u6216\u6295\u7968\u6b0a\uff09\u6c7a\u5b9a\u4e86\u5b83\u662f\u5426\u662f\u4e00\u500b\u6d3b\u8e8d\u7684\u9a57\u8b49\u5668\uff0c\u4e5f\u6c7a\u5b9a\u4e86\u8a72\u7bc0\u9ede\u63d0\u51fa\u5340\u584a\u7684\u983b\u7387\u4ee5\u53ca\u5b83\u5c07\u7372\u5f97\u591a\u5c11\u6536\u76ca\u3002</p> <p>\u6700\u521d\uff0c\u53ea\u6709\u6b0a\u91cd\u6700\u9ad8\u7684\u524d 150 \u500b\u9a57\u8b49\u5668\u624d\u662f\u6d3b\u8e8d\u7684\u9a57\u8b49\u5668\u3002\u5982\u679c\u9a57\u8b49\u5668\u96d9\u91cd\u7c3d\u540d\u6216\u7d93\u5e38\u96e2\u7dda\uff0c\u4ed6\u5011\u5c07\u5192\u8457\u88ab\u62b5\u62bc\u7684\u4ee3\u5e63\uff08\u5305\u62ec\u7528\u6236\u59d4\u8a17\u7684 FM\uff09\u88ab\u5354\u8b70`\u7f70\u6c92`\u7684\u98a8\u96aa\uff0c\u4ee5\u61f2\u7f70\u758f\u5ffd\u548c\u4e0d\u7576\u884c\u70ba\u3002</p> \u4ec0\u9ebc\u662f\u5168\u7bc0\u9ede? <p>\u5168\u7bc0\u9ede\u662f\u4e00\u500b\u7a0b\u5e8f\uff0c\u53ef\u4ee5\u5b8c\u5168\u9a57\u8b49\u5340\u584a\u93c8\u7684\u4ea4\u6613\u548c\u5340\u584a\u3002\u5b83\u4e0d\u540c\u65bc\u50c5\u8655\u7406\u5340\u584a\u982d\u548c\u4e00\u5c0f\u90e8\u5206\u4ea4\u6613\u7684\u8f15\u578b\u5ba2\u6236\u7aef\u7bc0\u9ede\u3002 \u904b\u884c\u4e00\u500b\u5b8c\u6574\u7684\u7bc0\u9ede\u9700\u8981\u6bd4\u8f15\u5ba2\u6236\u7aef\u66f4\u591a\u7684\u8cc7\u6e90\uff0c\u4f46\u9019\u662f\u6210\u70ba\u9a57\u8b49\u5668\u6240\u5fc5\u9700\u7684\u3002</p> <p>\u5728\u5be6\u8e10\u4e2d\uff0c\u904b\u884c\u5168\u7bc0\u9ede\u50c5\u610f\u5473\u8457\u904b\u884c\u672a\u59a5\u5354\u4e14\u6700\u65b0\u7248\u672c\u7684\u8edf\u4ef6\uff0c\u5177\u6709\u4f4e\u7db2\u7d61\u5ef6\u9072\u4e14\u4e0d\u6703\u505c\u6a5f\u3002\u7576\u7136\uff0c\u4efb\u4f55\u7528\u6236\u90fd\u53ef\u4ee5\u4e26\u9f13\u52f5\u4ed6\u5011\u904b\u884c\u5b8c\u6574\u7bc0\u9ede\uff0c\u5373\u4f7f\u4ed6\u5011\u4e0d\u6253\u7b97\u6210\u70ba\u9a57\u8b49\u5668\u3002</p> \u4ec0\u9ebc\u662fpos\u59d4\u8a17? <p>\u59d4\u8a17\u4eba\u662f FM \u6301\u6709\u8005\uff0c\u4ed6\u5011\u4e0d\u80fd\u6216\u4e0d\u60f3\u81ea\u5df1\u904b\u884c\u9a57\u8b49\u5668\u64cd\u4f5c\u3002\u3002 \u7528\u6236\u53ef\u4ee5\u5c07 FM \u59d4\u8a17\u7d66\u9a57\u8b49\u5668\u4e26\u7372\u5f97\u5176\u90e8\u5206\u6536\u5165\u4f5c\u70ba\u4ea4\u63db\uff08\u6709\u95dc\u6536\u5165\u5982\u4f55\u5206\u914d\u7684\u66f4\u591a\u8a73\u7d30\u4fe1\u606f\uff0c\u8acb\u53c3\u95b1\u4e0b\u9762\u7684\u8cea\u62bc\u7684\u52d5\u6a5f\u662f\u4ec0\u9ebc\uff1f \u548c \u4ec0\u9ebc\u662f\u9a57\u8b49\u5668\u7684\u4f63\u91d1\uff1f\u90e8\u5206\uff09\u3002</p> <p>\u56e0\u70ba\u4ed6\u5011\u8207\u4ed6\u5011\u7684\u9a57\u8b49\u5668\u5206\u4eab\u6536\u5165\uff0c\u6240\u4ee5\u59d4\u8a17\u4eba\u4e5f\u5206\u64d4\u8cac\u4efb\u3002\u5982\u679c\u9a57\u8b49\u5668\u884c\u70ba\u4e0d\u7576\uff0c\u5176\u6bcf\u500b\u59d4\u8a17\u4eba\u90fd\u5c07\u6839\u64da\u4ed6\u5011\u7684\u80a1\u4efd\u6bd4\u4f8b\u88ab\u90e8\u5206\u524a\u6e1b\u3002\u9019\u5c31\u662f\u70ba\u4ec0\u9ebc\u59d4\u8a17\u4eba\u61c9\u8a72\u5728\u59d4\u8a17\u4e4b\u524d\u5c0d\u9a57\u8b49\u4eba\u9032\u884c\u76e1\u8077\u8abf\u67e5\uff0c\u4e26\u901a\u904e\u5c07\u4ed6\u5011\u7684\u80a1\u4efd\u5206\u6563\u5230\u591a\u500b\u9a57\u8b49\u4eba\u4f86\u5be6\u73fe\u591a\u5143\u5316\u3002</p> <p>\u59d4\u8a17\u4eba\u5728\u7cfb\u7d71\u4e2d\u626e\u6f14\u8457\u95dc\u9375\u89d2\u8272\uff0c\u56e0\u70ba\u4ed6\u5011\u8ca0\u8cac\u9078\u64c7\u9a57\u8b49\u5668\u3002\u8acb\u6ce8\u610f\uff0c\u4f5c\u70ba\u59d4\u8a17\u4eba\u4e26\u4e0d\u662f\u4e00\u500b\u88ab\u52d5\u7684\u89d2\u8272\u3002 \u59d4\u8a17\u4eba\u6709\u7fa9\u52d9\u4fdd\u6301\u8b66\u60d5\u4e26\u7a4d\u6975\u76e3\u63a7\u5176\u9a57\u8b49\u5668\u7684\u884c\u70ba\uff0c\u5982\u679c\u4ed6\u5011\u672a\u80fd\u8ca0\u8cac\u4efb\u5730\u63a1\u53d6\u884c\u52d5\uff0c\u5247\u9032\u884c\u5207\u63db\u3002</p>"},{"location":"gateway/faq/#_2","title":"\u6210\u70ba\u9a57\u8b49\u5668","text":"\u5982\u4f55\u6210\u70ba\u9a57\u8b49\u5668? <p> \u7db2\u7d61\u4e2d\u7684\u4efb\u4f55\u53c3\u8207\u8005\u90fd\u53ef\u4ee5\u901a\u904e\u5275\u5efa\u9a57\u8b49\u5668\u4e26\u8a3b\u518a\u5176\u9a57\u8b49\u5668\u8cc7\u6599\u4f86\u8868\u660e\u4ed6\u5011\u6210\u70ba\u9a57\u8b49\u5668\u7684\u610f\u5716\u3002 \u70ba\u6b64\uff0c\u5019\u9078\u4eba\u5ee3\u64ad\u4e00\u500b<code>create-validator</code>\u4ea4\u6613\uff0c\u4ed6\u5011\u5fc5\u9808\u5728\u5176\u4e2d\u63d0\u4ea4\u4ee5\u4e0b\u4fe1\u606f\uff1a <ul> <li>Validator's PubKey: \u9a57\u8b49\u5668\u904b\u71df\u5546\u53ef\u4ee5\u6709\u4e0d\u540c\u7684\u8cec\u6236\u4f86\u9a57\u8b49\u548c\u6301\u6709\u6d41\u52d5\u8cc7\u91d1\u3002</li> \u63d0\u4ea4\u7684 PubKey \u5fc5\u9808\u8207\u9a57\u8b49\u5668\u6253\u7b97\u7c3d\u7f72 prevotes \u548c precommits \u7684\u79c1\u9470\u76f8\u95dc\u806f\u3002 <li>Validator's Address: dstvaloper1- \u5730\u5740\u3002\u9019\u662f\u7528\u65bc\u516c\u958b\u8b58\u5225\u60a8\u7684\u9a57\u8b49\u5668\u7684\u5730\u5740\u3002 \u8207\u6b64\u5730\u5740\u95dc\u806f\u7684\u79c1\u9470\u7528\u65bc\u7d81\u5b9a\u3001\u89e3\u9664\u7d81\u5b9a\u548c\u9818\u53d6\u734e\u52f5\u3002</li> <li>Validator's name (\u4e5f\u7a31\u70ba \u7dbd\u865f)</li> <li>Validator's website(\u9078\u586b)</li> <li>Validator's description (\u9078\u586b)</li> <li>Initial commission rate: \u5340\u584a\u734e\u52f5\u548c\u5411\u59d4\u8a17\u4eba\u6536\u53d6\u7684\u8cbb\u7528.</li> <li>Maximum commission: \u8a72\u9a57\u8b49\u5668\u5c07\u88ab\u5141\u8a31\u6536\u53d6\u7684\u6700\u9ad8\u4f63\u91d1\u7387\u3002</li> <li>Commission change rate: \u9a57\u8b49\u5668\u4f63\u91d1\u7684\u6bcf\u65e5\u6700\u5927\u589e\u5e45\u3002</li> <li>Minimum self-bond amount: \u9a57\u8b49\u5668\u9700\u8981\u59cb\u7d42\u7d81\u5b9a\u7684\u6700\u5c0f FM \u6578\u91cf\u3002\u5982\u679c\u9a57\u8b49\u5668\u7684\u81ea\u62b5\u62bc\u8cea\u62bc\u4f4e\u65bc\u6b64\u9650\u5236\uff0c\u5176\u6574\u500b\u8cea\u62bc\u6c60\u5c07\u88ab\u89e3\u9664\u62b5\u62bc\u3002</li> <li>Initial self-bond amount: \u9a57\u8b49\u5668\u60f3\u8981\u81ea\u6211\u7d81\u5b9a\u7684\u521d\u59cb FM \u6578\u91cf\u3002</li> </ul> <pre><code>stcd tx staking create-validator\n--pubkey dstvalconspub1zcjduepqs5s0vddx5m65h5ntjzwd0x8g3245rgrytpds4ds7vdtlwx06mcesmnkzly\n--amount \"2fm\"\n--from tmp\n--commission-rate=\"0.20\"\n--commission-max-rate=\"1.00\"\n--commission-max-change-rate=\"0.01\"\n--min-self-delegation \"1\"\n--moniker \"validator\"\n--chain-id \"fm_9000-4\"\n--gas auto\n--node tcp://127.0.0.1:26647\n</code></pre> </p> <p> \ud83d\udea8 \u5371\u9669: \u4e0d\u8981 \u4f7f\u7528test\u4f5c\u70ba keyring \u5f8c\u7aef\u4f86\u5275\u5efa\u60a8\u7684\u4e3b\u7db2\u9a57\u8b49\u5668\u5bc6\u9470\u3002 \u9019\u6a23\u505a\u53ef\u80fd\u6703\u5c0e\u81f4\u8cc7\u91d1\u640d\u5931\uff0c\u56e0\u70ba\u60a8\u7684\u8cc7\u91d1\u53ef\u4ee5\u901a\u904e <code>eth_sendTransaction</code> JSON-RPC \u7aef\u9ede\u9060\u7a0b\u8a2a\u554f\u3002 </p> <p> \u4e00\u65e6\u5275\u5efa\u4e26\u8a3b\u518a\u4e86\u9a57\u8b49\u5668\uff0cFM \u6301\u6709\u8005\u5c31\u53ef\u4ee5\u5c07 FM \u59d4\u8a17\u7d66\u5b83\uff0c\u5f9e\u800c\u6709\u6548\u5730\u5411\u5176\u6c60\u4e2d\u6dfb\u52a0\u80a1\u4efd\u3002 \u9a57\u8b49\u5668\u7684\u7e3d\u8cea\u62bc\u91cf\u662f\u9a57\u8b49\u5668\u904b\u71df\u8005\u81ea\u62b5\u62bc\u7684 FM \u548c\u5916\u90e8\u59d4\u8a17\u4eba\u62b5\u62bc\u7684 FM \u7684\u7e3d\u548c\u3002 </p> <p> \u53ea\u6709\u6301\u6709\u6700\u591a\u80a1\u4efd\u7684\u524d 150 \u540d\u9a57\u8b49\u5668\u624d\u88ab\u8996\u70ba\u6d3b\u8e8d\u9a57\u8b49\u5668\uff0c\u6210\u70ba \u7d81\u5b9a\u9a57\u8b49\u5668\u3002\u5982\u679c\u9a57\u8b49\u5668\u7684\u7e3d\u6b0a\u76ca\u4f4e\u65bc\u524d 150\uff0c\u9a57\u8b49\u5668\u5c07\u5931\u53bb\u5176\u9a57\u8b49\u5668\u7279\u6b0a\uff08\u610f\u5473\u8457\u5b83\u4e0d\u6703\u7522\u751f\u734e\u52f5\uff09\u4e26\u4e14\u4e0d\u518d\u4f5c\u70ba\u6d3b\u52d5\u96c6\u7684\u4e00\u90e8\u5206\uff08\u5373\u4e0d\u53c3\u8207\u5171\u8b58\uff09\uff0c\u8f38\u5165 \u89e3\u9664\u7d81\u5b9a\u6a21\u5f0f\u4e26\u6700\u7d42\u8b8a\u70ba \u89e3\u9664\u7d81\u5b9a\u3002 </p>"},{"location":"gateway/faq/#_3","title":"\u9a57\u8b49\u5668\u5bc6\u9470\u548c\u72c0\u614b","text":"\u6709\u54ea\u4e9b\u4e0d\u540c\u985e\u578b\u7684\u5bc6\u9470? <p>\u7c21\u800c\u8a00\u4e4b\uff0c\u6709\u5169\u7a2e\u985e\u578b\u7684\u5bc6\u9470\uff1a</p> <ul> <li>Tendermint \u5bc6\u94a5\uff1a\u9019\u662f\u7528\u65bc\u5c0d\u584a\u54c8\u5e0c\u9032\u884c\u7c3d\u540d\u7684\u552f\u4e00\u5bc6\u9470\u3002\u5b83\u8207\u516c\u9470\u76f8\u95dc\u806f <code>dstvalconspub</code>\u3002 <ul> <li>\u5728\u4f7f\u7528 <code>stcd init</code> \u5275\u5efa\u7bc0\u9ede\u6642\u751f\u6210\u3002</li> <li>\u4f7f\u7528 <code>stcd tendermint show-validator</code>\u7372\u53d6\u6b64\u503c,\u4f8b\u5982<code>dstvalconspub1zcjduc3qcyj09qc03elte23zwshdx92jm6ce88fgc90rtqhjx8v0608qh5ssp0w94c</code></li> </ul> </li> <li>\u61c9\u7528\u7a0b\u5e8f\u5bc6\u9470\uff1a\u9019\u4e9b\u5bc6\u9470\u662f\u5f9e\u61c9\u7528\u7a0b\u5e8f\u5275\u5efa\u7684\uff0c\u7528\u65bc\u7c3d\u7f72\u4ea4\u6613\u3002\u4f5c\u70ba\u9a57\u8b49\u5668\uff0c\u60a8\u53ef\u80fd\u6703\u4f7f\u7528\u4e00\u500b\u5bc6\u9470\u4f86\u7c3d\u7f72\u8207 staking \u76f8\u95dc\u7684\u4ea4\u6613\uff0c\u800c\u53e6\u4e00\u500b\u5bc6\u9470\u4f86\u7c3d\u7f72\u8207 oracle \u76f8\u95dc\u7684\u4ea4\u6613\u4ea4\u6613\u3002\u61c9\u7528\u7a0b\u5e8f\u5bc6\u9470\u8207\u516c\u9470 <code>dstpub-</code> \u548c\u5730\u5740<code>dst-</code>\u76f8\u95dc\u806f\u3002\u5169\u8005\u90fd\u6e90\u81ea<code>stcd keys add</code>\u751f\u6210\u7684\u5e33\u6236\u5bc6\u9470\u3002</li> </ul> <p> \u26a0\ufe0f\u6ce8\u610f: \u9a57\u8b49\u5668\u7684\u64cd\u4f5c\u54e1\u5bc6\u9470\u76f4\u63a5\u7d81\u5b9a\u5230\u61c9\u7528\u7a0b\u5e8f\u5bc6\u9470\uff0c\u4f46\u50c5\u70ba\u6b64\u76ee\u7684\u4f7f\u7528\u4fdd\u7559\u524d\u7db4\uff1a<code>dstvaloper</code> \u548c<code>dstvaloperpub</code> </p> \u9a57\u8b49\u5668\u53ef\u4ee5\u8655\u65bc\u54ea\u4e9b\u4e0d\u540c\u72c0\u614b? <p>\u4f7f\u7528 create-validator \u4e8b\u52d9\u5275\u5efa\u9a57\u8b49\u5668\u5f8c\uff0c\u5b83\u53ef\u4ee5\u8655\u65bc\u4e09\u7a2e\u72c0\u614b\uff1a</p> <ul> <li>bonded\uff1a\u9a57\u8b49\u5668\u5728\u6d3b\u52d5\u96c6\u4e2d\u4e26\u53c3\u8207\u5171\u8b58\u3002\u9a57\u8b49\u5668\u6b63\u5728\u7372\u5f97\u734e\u52f5\uff0c\u4e26\u53ef\u80fd\u56e0\u4e0d\u7576\u884c\u70ba\u800c\u88ab\u524a\u6e1b\u3002</li> <li>unbonding\uff1a\u9a57\u8b49\u5668\u4e0d\u5728\u6d3b\u8e8d\u96c6\u4e2d\uff0c\u4e0d\u53c3\u8207\u5171\u8b58\u3002 \u9a57\u8b49\u5668\u6c92\u6709\u7372\u5f97\u734e\u52f5\uff0c\u4f46\u4ecd\u53ef\u80fd\u56e0\u4e0d\u7576\u884c\u70ba\u800c\u88ab\u524a\u6e1b\u3002\u9019\u662f\u5f9e \u7d81\u5b9a \u5230 \u672a\u7d81\u5b9a \u7684\u904e\u6e21\u72c0\u614b\u3002\u5982\u679c\u9a57\u8b49\u5668\u5728 \u89e3\u9664\u7d81\u5b9a \u6a21\u5f0f\u4e0b\u672a\u767c\u9001 rebond \u4ea4\u6613\uff0c\u5247\u9700\u8981\u5169\u9031\u6642\u9593\u624d\u80fd\u5b8c\u6210\u72c0\u614b\u8f49\u63db\u3002</li> <li>unbonded\uff1a\u9a57\u8b49\u5668\u4e0d\u5728\u6d3b\u52d5\u96c6\u4e2d\uff0c\u56e0\u6b64\u4e0d\u7c3d\u7f72\u5340\u584a\u3002 \u672a\u7d81\u5b9a\u7684\u9a57\u8b49\u5668\u4e0d\u80fd\u88ab\u524a\u6e1b\uff0c\u4f46\u4e0d\u6703\u5f9e\u4ed6\u5011\u7684\u64cd\u4f5c\u4e2d\u7372\u5f97\u4efb\u4f55\u734e\u52f5\u3002\u4ecd\u7136\u53ef\u4ee5\u5c07 FM \u59d4\u8a17\u7d66\u8a72\u9a57\u8b49\u5668\u3002 \u4ece\u4e00\u4e2a <code>unbonded</code> \u9a57\u8b49\u5668\u4e2d\u53d6\u6d88\u59d4\u8a17\u662f\u7acb\u5373\u7684\u3002\u59d4\u8a17\u4eba\u8207\u4ed6\u5011\u7684\u9a57\u8b49\u4eba\u5177\u6709\u76f8\u540c\u7684\u72c0\u614b\u3002</li> </ul> \u26a0\ufe0f\u6ce8\u610f: \u59d4\u8a17\u4e0d\u4e00\u5b9a\u662f\u7d81\u5b9a\u7684\u3002 FM \u53ef\u4ee5\u662f\u59d4\u8a17\u548c\u7d81\u5b9a\u3001\u59d4\u8a17\u548c\u975e\u7d81\u5b9a\u3001\u59d4\u8a17\u548c\u975e\u7d81\u5b9a\u6216\u6d41\u52d5\u6027\u3002  \u4ec0\u9ebc\u662f\"\u81ea\u6211\u62b5\u62bc\"?\u5982\u4f55\u589e\u52a0\u6211\u7684\"\u81ea\u6211\u62b5\u62bc\"? <p> \u9a57\u8b49\u5668\u904b\u71df\u8005\u7684 \u81ea\u6211\u62b5\u62bc \u662f\u6307\u59d4\u8a17\u7d66\u81ea\u5df1\u7684 FM \u8cea\u62bc\u91cf\u3002\u60a8\u53ef\u4ee5\u901a\u904e\u5c07\u66f4\u591a FM \u59d4\u8a17\u7d66\u60a8\u7684\u9a57\u8b49\u5668\u5e33\u6236\u4f86\u589e\u52a0\u60a8\u7684\u81ea\u6211\u62b5\u62bc\u3002 </p> \u6709\u6e2c\u8a66\u7db2\u6c34\u9f8d\u982d\u55ce? <p> \u5982\u679c\u60a8\u60f3\u7372\u5f97\u6e2c\u8a66\u7db2\u7684\u5e63\uff0c\u60a8\u53ef\u4ee5\u4f7f\u7528 \u6c34\u9f8d\u982d </p> \u662f\u5426\u6709\u6700\u4f4e\u6578\u91cf\u7684 FM \u5fc5\u9808\u62b5\u62bc\u624d\u80fd\u6210\u70ba\u6d3b\u8e8d\u7684\uff08\u7d81\u5b9a\u7684\uff09\u9a57\u8b49\u5668\uff1f <p> \u6c92\u6709\u6700\u4f4e\u9650\u5ea6\u3002\u7e3d\u6b0a\u76ca\u6700\u9ad8\u7684\u524d 150 \u500b\u9a57\u8b49\u5668\uff08\u5176\u4e2d<code>total stake = self-bonded stake + delegators stake</code>) \u662f\u6d3b\u8e8d\u7684\u9a57\u8b49\u5668\u3002 </p> \u59d4\u8a17\u4eba\u5c07\u5982\u4f55\u9078\u64c7\u4ed6\u5011\u7684\u9a57\u8b49\u5668\uff1f <p> \u59d4\u8a17\u4eba\u53ef\u4ee5\u6839\u64da\u81ea\u5df1\u7684\u4e3b\u89c0\u6a19\u6e96\u81ea\u7531\u9078\u64c7\u9a57\u8b49\u4eba\u3002\u4e5f\u5c31\u662f\u8aaa\uff0c\u9810\u8a08\u91cd\u8981\u7684\u6a19\u6e96\u5305\u62ec\uff1a </p> <ul> <li>\u81ea\u7d81\u5b9a FM \u7684\u6578\u91cf\uff1a\u9a57\u8b49\u5668\u81ea\u7d81\u5b9a\u5230\u5176\u8cea\u62bc\u6c60\u7684 FM \u6578\u91cf\u3002\u64c1\u6709\u66f4\u591a\u81ea\u7d81\u5b9a FM \u7684\u9a57\u8b49\u5668\u5728\u904a\u6232\u4e2d\u64c1\u6709\u66f4\u591a\u7684\u76ae\u819a\uff0c\u4f7f\u5176\u5c0d\u5176\u884c\u70ba\u627f\u64d4\u66f4\u591a\u8cac\u4efb\u3002</li> <li>\u59d4\u6258\u7684 FM \u6578\u91cf\uff1a\u59d4\u8a17\u7d66\u9a57\u8b49\u5668\u7684 FM \u7e3d\u6578\u3002\u9ad8 stake \u8868\u660e\u793e\u5340\u4fe1\u4efb\u9019\u500b\u9a57\u8b49\u5668\uff0c\u4f46\u4e5f\u610f\u5473\u8457\u9019\u500b\u9a57\u8b49\u5668\u662f\u9ed1\u5ba2\u66f4\u5927\u7684\u76ee\u6a19\u3002\u96a8\u8457\u59d4\u8a17 FM \u6578\u91cf\u7684\u589e\u9577\uff0c\u9a57\u8b49\u5668\u7684\u5438\u5f15\u529b\u9810\u8a08\u6703\u8d8a\u4f86\u8d8a\u4f4e\u3002\u66f4\u5927\u7684\u9a57\u8b49\u5668\u4e5f\u6703\u589e\u52a0\u7db2\u7d61\u7684\u4e2d\u5fc3\u5316\u7a0b\u5ea6\u3002</li> <li>\u4f63\u91d1\u7387\uff1a\u9a57\u8b49\u5668\u5728\u5c07\u6536\u5165\u5206\u914d\u7d66\u4ed6\u5011\u7684\u59d4\u8a17\u4eba\u4e4b\u524d\u5c0d\u6536\u5165\u61c9\u7528\u7684\u4f63\u91d1</li> <li>\u8ddf\u8e2a\u8a18\u9304\uff1a\u59d4\u8a17\u4eba\u53ef\u80fd\u6703\u67e5\u770b\u4ed6\u5011\u8a08\u5283\u59d4\u8a17\u7d66\u7684\u9a57\u8b49\u5668\u7684\u8ddf\u8e2a\u8a18\u9304\u3002\u9019\u5305\u62ec\u8cc7\u6b77\u3001\u904e\u53bb\u5c0d\u63d0\u6848\u7684\u6295\u7968\u3001\u6b77\u53f2\u5e73\u5747\u6b63\u5e38\u904b\u884c\u6642\u9593\u4ee5\u53ca\u7bc0\u9ede\u88ab\u7834\u58de\u7684\u983b\u7387\u3002</li> </ul> <p> \u9664\u4e86\u9019\u4e9b\u6a19\u6e96\u4e4b\u5916\uff0c\u9a57\u8b49\u5668\u9084\u53ef\u4ee5\u63d0\u4f9b\u4e00\u500b\u7db2\u7ad9\u5730\u5740\u4f86\u5b8c\u6210\u4ed6\u5011\u7684\u7c21\u6b77\u3002\u9a57\u8b49\u5668\u9700\u8981\u4ee5\u67d0\u7a2e\u65b9\u5f0f\u5efa\u7acb\u8072\u8b7d\u4ee5\u5438\u5f15\u59d4\u8a17\u4eba\u3002\u4f8b\u5982\uff0c\u9a57\u8b49\u5668\u8b93\u7b2c\u4e09\u65b9\u5be9\u6838\u4ed6\u5011\u7684\u8a2d\u7f6e\u662f\u4e00\u500b\u5f88\u597d\u7684\u505a\u6cd5\u3002\u4f46\u8acb\u6ce8\u610f\uff0cDST \u793e\u5340\u4e0d\u6703\u81ea\u884c\u6279\u51c6\u6216\u9032\u884c\u4efb\u4f55\u5be9\u6838\u3002 </p>"},{"location":"gateway/faq/#_4","title":"\u8077\u8cac","text":"\u9a57\u8b49\u8005\u662f\u5426\u9700\u8981\u516c\u958b\u8eab\u4efd\uff1f <p> \u4e0d\uff0c\u4ed6\u5011\u6c92\u6709\u3002\u6bcf\u500b\u59d4\u8a17\u4eba\u5c07\u6839\u64da\u81ea\u5df1\u7684\u6a19\u6e96\u8a55\u4f30\u9a57\u8b49\u8005\u3002 \u9a57\u8b49\u8005\u5c07\u80fd\u5920\uff08\u4e26\u88ab\u5efa\u8b70\uff09\u5728\u4ed6\u5011\u63d0\u540d\u81ea\u5df1\u6642\u8a3b\u518a\u4e00\u500b\u7db2\u7ad9\u5730\u5740\uff0c\u4ee5\u4fbf\u4ed6\u5011\u53ef\u4ee5\u5728\u4ed6\u5011\u8a8d\u70ba\u5408\u9069\u7684\u6642\u5019\u5ba3\u50b3\u4ed6\u5011\u7684\u64cd\u4f5c\u3002 \u4e00\u4e9b\u59d4\u8a17\u4eba\u53ef\u80fd\u66f4\u559c\u6b61\u4e00\u500b\u7db2\u7ad9\uff0c\u8a72\u7db2\u7ad9\u53ef\u4ee5\u6e05\u695a\u5730\u986f\u793a\u904b\u884c\u9a57\u8b49\u8005\u7684\u5718\u968a\u548c\u4ed6\u5011\u7684\u7c21\u6b77\uff0c\u800c\u5176\u4ed6\u4eba\u53ef\u80fd\u66f4\u559c\u6b61\u5177\u6709\u826f\u597d\u696d\u7e3e\u8a18\u9304\u7684\u533f\u540d\u9a57\u8b49\u8005\u3002 \u8eab\u4efd\u9a57\u8b49\u8005\u548c\u533f\u540d\u9a57\u8b49\u8005\u5f88\u53ef\u80fd\u6703\u5728\u9a57\u8b49\u8005\u96c6\u4e2d\u5171\u5b58\u3002 </p> \u9a57\u8b49\u4eba\u7684\u8077\u8cac\u662f\u4ec0\u9ebc? <p> \u9a57\u8b49\u8005\u4ff1\u6709\u4e09\u500b\u4e3b\u8981\u8077\u8cac\uff1a  <ul> <li> \u80fd\u5920\u6301\u7e8c\u904b\u884c\u6b63\u78ba\u7248\u672c\u7684\u8edf\u4ef6: \u9a57\u8b49\u8005\u9700\u8981\u78ba\u4fdd\u4ed6\u5011\u7684\u670d\u52d9\u5668\u59cb\u7d42\u5728\u7dda\u4e26\u4e14\u4ed6\u5011\u7684\u79c1\u9470\u4e0d\u88ab\u6d29\u9732\u3002</li> <li> \u5c31\u793e\u5340\u6c60\u8cc7\u91d1\u7684\u6b63\u78ba\u90e8\u7f72\u63d0\u4f9b\u76e3\u7763\u548c\u53cd\u994b\uff1a Daodst \u5354\u8b70\u5305\u62ec\u4e00\u500b\u63d0\u6848\u6cbb\u7406\u7cfb\u7d71\uff0c\u4ee5\u4fc3\u9032\u5176\u8ca8\u5e63\u7684\u63a1\u7528\u3002\u9810\u8a08\u9a57\u8b49\u8005\u5c07\u8ffd\u7a76\u9810\u7b97\u57f7\u884c\u8005\u7684\u8cac\u4efb\uff0c\u4ee5\u63d0\u4f9b\u900f\u660e\u5ea6\u548c\u8cc7\u91d1\u7684\u6709\u6548\u4f7f\u7528\u3002</li> </ul>  \u6b64\u5916\uff0c\u9a57\u8b49\u8005\u61c9\u8a72\u662f\u793e\u5340\u7684\u6d3b\u8e8d\u6210\u54e1\u3002\u4ed6\u5011\u61c9\u8a72\u59cb\u7d42\u4e86\u89e3\u751f\u614b\u7cfb\u7d71\u7684\u7576\u524d\u72c0\u614b\uff0c\u4ee5\u4fbf\u4ed6\u5011\u53ef\u4ee5\u8f15\u9b06\u9069\u61c9\u4efb\u4f55\u8b8a\u5316\u3002 </p> \u8cea\u62bc\u610f\u5473\u8457\u4ec0\u9ebc? <p> \u8cea\u62bc FM \u53ef\u4ee5\u88ab\u8996\u70ba\u9a57\u8b49\u6d3b\u52d5\u7684\u5b89\u5168\u4fdd\u8b49\u91d1\u3002\u7576\u9a57\u8b49\u8005\u6216\u59d4\u8a17\u4eba\u60f3\u8981\u53d6\u56de\u90e8\u5206\u6216\u5168\u90e8\u8cea\u62bc\u6642\uff0c\u4ed6\u5011\u6703\u767c\u9001\u4e00\u500b\u89e3\u9664\u7d81\u5b9a\u7684\u4ea4\u6613\u3002\u7136\u5f8c\uff0c\u5b58\u6b3e\u6703\u7d93\u6b77*\u5169\u9031\u7684\u89e3\u7d81\u671f*\uff0c\u5728\u6b64\u671f\u9593\uff0c\u4ed6\u5011\u53ef\u80fd\u6703\u56e0\u70ba\u9a57\u8b49\u8005\u5728\u89e3\u7d81\u904e\u7a0b\u958b\u59cb\u524d\u7684\u6f5b\u5728\u4e0d\u7576\u884c\u70ba\u800c\u88ab\u524a\u6e1b\u3002 </p> \u9a57\u8b49\u4eba\u53ef\u4ee5\u5e36\u8457\u59d4\u8a17\u4eba\u7684 FM \u9003\u8dd1\u55ce\uff1f <p> \u901a\u904e\u59d4\u8a17\u7d66\u9a57\u8b49\u8005\uff0c\u7528\u6236\u59d4\u8a17\u4e86\u62b5\u62bc\u6b0a\u3002\u9a57\u8b49\u8005\u64c1\u6709\u7684\u62b5\u62bc\u6b0a\u8d8a\u591a\uff0c\u5b83\u5728\u5171\u8b58\u548c\u6d41\u7a0b\u4e2d\u7684\u6b0a\u91cd\u5c31\u8d8a\u5927\u3002 \u9019\u4e26\u4e0d\u610f\u5473\u8457\u9a57\u8b49\u8005\u53ef\u4ee5\u4fdd\u7ba1\u5176\u59d4\u8a17\u4eba\u7684 FM\u3002 \u9a57\u8b49\u8005\u7d55\u4e0d\u80fd\u5e36\u8457\u59d4\u8a17\u4eba\u7684\u8cc7\u91d1\u8dd1\u8def\u3002  \u5373\u4f7f\u59d4\u8a17\u8cc7\u91d1\u4e0d\u80fd\u88ab\u4ed6\u5011\u7684\u9a57\u8b49\u8005\u7aca\u53d6\uff0c\u5982\u679c\u4ed6\u5011\u7684\u9a57\u8b49\u8005\u884c\u70ba\u4e0d\u7576\uff0c\u59d4\u8a17\u4eba\u4ecd\u7136\u8981\u627f\u64d4\u8cac\u4efb\u3002\u5728\u9019\u7a2e\u60c5\u6cc1\u4e0b\uff0c\u6bcf\u500b\u59d4\u8a17\u4eba\u7684\u80a1\u4efd\u5c07\u6839\u64da\u4ed6\u5011\u7684\u76f8\u5c0d\u80a1\u4efd\u6bd4\u4f8b\u88ab\u90e8\u5206\u524a\u6e1b\u3002 </p> \u591a\u4e45\u6703\u9078\u64c7\u4e00\u500b\u9a57\u8b49\u8005\u4f86\u63d0\u8b70\u4e0b\u4e00\u500b\u5340\u584a\uff1f\u5b83\u6703\u96a8\u8457\u62b5\u62bc\u7684 FM \u6578\u91cf\u589e\u52a0\u55ce <p> \u88ab\u9078\u4e2d\u4f86\u6316\u6398\u4e0b\u4e00\u500b\u5340\u584a\u7684\u9a57\u8b49\u8005\u7a31\u70ba\u63d0\u8b70\u8005\uff0c\u5373\u8a72\u8f2a\u5171\u8b58\u4e2d\u7684`\u9818\u5c0e\u8005`\u201d`\u3002\u6bcf\u500b\u63d0\u8b70\u8005\u90fd\u662f\u78ba\u5b9a\u6027\u5730\u9078\u64c7\u7684\uff0c\u88ab\u9078\u4e2d\u7684\u983b\u7387\u7b49\u65bc\u9a57\u8b49\u8005\u7684\u76f8\u5c0d\u7e3d\u6b0a\u76ca\uff08\u5176\u4e2d\u7e3d\u6b0a\u76ca = \u81ea\u62b5\u62bc\u6b0a\u76ca + \u59d4\u8a17\u4eba\u6b0a\u76ca\uff09\u3002 \u4f8b\u5982\uff0c\u5982\u679c\u6240\u6709\u9a57\u8b49\u8005\u7684\u7e3d\u62b5\u62bc\u6b0a\u76ca\u70ba 100 FM\uff0c\u800c\u9a57\u8b49\u8005\u7684\u7e3d\u6b0a\u76ca\u70ba 10 FM\uff0c\u5247\u8a72\u9a57\u8b49\u8005\u5c07\u6709 10% \u7684\u6982\u7387\u88ab\u9078\u70ba\u63d0\u8b70\u8005\u3002  \u8981\u4e86\u89e3\u6709\u95dc Tendermint BFT \u5171\u8b58\u4e2d\u63d0\u8b70\u8005\u9078\u64c7\u904e\u7a0b\u7684\u66f4\u591a\u4fe1\u606f\uff0c\u8acb\u95b1\u8b80\u66f4\u591a (https://docs.tendermint.com/master/spec/consensus/proposer-selection.html) </p>"},{"location":"gateway/faq/#_5","title":"\u6fc0\u52f5\u63aa\u65bd","text":"\u8cea\u62bc\u7684\u52d5\u6a5f\u662f\u4ec0\u9ebc\uff1f  \u9a57\u8b49\u8005\u6b0a\u76ca\u6c60\u4e2d\u7684\u6bcf\u500b\u6210\u54e1\u90fd\u6703\u7372\u5f97\u4e0d\u540c\u985e\u578b\u7684\u6536\u5165:  <p> \u5340\u584a\u734e\u52f5: \u9a57\u8b49\u5668\u904b\u884c\u7684\u61c9\u7528\u7a0b\u5e8f\u7684\u539f\u751f\u4ee3\u5e63\uff08\u4f8b\u5982 Daodst \u4e0a\u7684 FM\uff09\u88ab\u81a8\u8139\u4ee5\u7522\u751f \u584a\u689d\u6b3e\u3002 \u9019\u4e9b\u689d\u6b3e\u7684\u5b58\u5728\u662f\u70ba\u4e86\u6fc0\u52f5 FM \u6301\u6709\u8005\u7d81\u5b9a\u4ed6\u5011\u7684\u80a1\u4efd\uff0c\u56e0\u70ba\u975e\u7d81\u5b9a FM \u5c07 \u96a8\u8457\u6642\u9593\u7684\u63a8\u79fb\u88ab\u7a00\u91cb. </p> <p> \u4ea4\u6613\u8cbb\u7528: Daodst \u7dad\u8b77\u8457\u4e00\u500b\u88ab\u63a5\u53d7\u70ba\u8cbb\u7528\u652f\u4ed8\u7684\u4ee3\u5e63\u767d\u540d\u55ae\u3002 \u521d\u59cb\u8cbb\u7528\u4ee4\u724c\u662f `dst`. <p>  \u8a72\u7e3d\u6536\u5165\u6839\u64da\u6bcf\u500b\u9a57\u8b49\u8005\u7684\u6b0a\u91cd\u5206\u914d\u7d66\u9a57\u8b49\u8005\u7684\u6b0a\u76ca\u6c60\u3002 \u7136\u5f8c\uff0c\u5728\u6bcf\u500b \u9a57\u8b49\u5668\u7684\u8cea\u62bc\u6c60\u6536\u5165\u6309\u6bcf\u500b\u59d4\u8a17\u4eba\u7684\u80a1\u4efd\u6bd4\u4f8b\u5206\u914d\u7d66\u59d4\u8a17\u4eba\u3002 \u4f63\u91d1 \u59d4\u8a17\u4eba\u7684\u6536\u5165\u5728\u5206\u914d\u4e4b\u524d\u7531\u9a57\u8b49\u8005\u61c9\u7528.   \u904b\u884c\u9a57\u8b49\u5668\u7684\u52d5\u6a5f\u662f\u4ec0\u9ebc\uff1f  \u7531\u65bc\u4f63\u91d1\uff0c\u9a57\u8b49\u8005\u6bd4\u4ed6\u5011\u7684\u59d4\u8a17\u8005\u8cfa\u53d6\u66f4\u591a\u7684\u6536\u5165\u3002  \u9a57\u8b49\u8005\u4e5f\u5728\u6cbb\u7406\u4e2d\u767c\u63ee\u91cd\u8981\u4f5c\u7528\u3002 \u5982\u679c\u59d4\u8a17\u4eba\u4e0d\u6295\u7968\uff0c\u4ed6\u5011\u5c07\u7e7c\u627f\u4ed6\u5011\u7684\u6295\u7968\u6b0a \u9a57\u8b49\u5668\u3002 \u9019\u8ce6\u4e88\u4e86\u9a57\u8b49\u8005\u5728\u751f\u614b\u7cfb\u7d71\u4e2d\u7684\u4e3b\u8981\u8cac\u4efb.   \u4ec0\u9ebc\u662f\u9a57\u8b49\u8005\u4f63\u91d1\uff1f  \u9a57\u8b49\u8005\u6c60\u6536\u5230\u7684\u6536\u5165\u5728\u9a57\u8b49\u8005\u548c\u5b83\u7684\u59d4\u8a17\u4eba\u4e4b\u9593\u5206\u914d\u3002 \u9a57\u8b49\u8005\u53ef\u4ee5\u7533\u8acb \u5206\u914d\u7d66\u59d4\u8a17\u4eba\u7684\u90e8\u5206\u6536\u5165\u7684\u4f63\u91d1\u3002 \u8a72\u4f63\u91d1\u8a2d\u7f6e\u70ba\u767e\u5206\u6bd4\u3002  \u6bcf\u500b\u9a57\u8b49\u8005\u53ef\u4ee5\u81ea\u7531\u8a2d\u7f6e\u5176\u521d\u59cb\u4f63\u91d1\u3001\u6700\u5927\u6bcf\u65e5\u4f63\u91d1\u8b8a\u5316\u7387\u548c\u6700\u5927\u4f63\u91d1\u3002 Daodst \u5f37\u5236\u57f7\u884c\u6bcf\u500b\u9a57\u8b49\u5668\u8a2d\u7f6e\u7684\u53c3\u6578\u3002 \u9019\u4e9b\u53c3\u6578\u53ea\u80fd\u5728\u6700\u521d\u8072\u660e\u6642\u5b9a\u7fa9 \u5019\u9078\u8cc7\u683c\uff0c\u4e26\u4e14\u53ea\u6709\u5728\u5ba3\u5e03\u5f8c\u624d\u80fd\u9032\u4e00\u6b65\u53d7\u5230\u9650\u5236\u3002   \u96c6\u9ad4\u689d\u6b3e\u662f\u5982\u4f55\u5206\u914d\u7684\uff1f <p> \u5340\u584a\u689d\u6b3e\uff08\u734e\u52f5\uff09\u76f8\u5c0d\u65bc\u4ed6\u5011\u7684\u7e3d\u6b0a\u76ca\uff08\u6295\u7968\u6b0a\uff09\u6309\u6bd4\u4f8b\u5206\u914d\u7d66\u6240\u6709\u9a57\u8b49\u8005\u3002 \u9019\u610f\u5473\u8457\u5373\u4f7f\u6bcf\u500b\u9a57\u8b49\u8005\u901a\u904e\u6bcf\u9805\u4f9b\u61c9\u7372\u5f97 FM\uff0c\u6240\u6709\u9a57\u8b49\u8005\u4ecd\u5c07\u4fdd\u6301\u5e73\u7b49 \u91cd\u91cf\u3002 </p> <p> \u8b93\u6211\u5011\u8209\u500b\u4f8b\u5b50\uff0c\u6211\u5011\u6709 10 \u500b\u9a57\u8b49\u8005\uff0c\u4ed6\u5011\u64c1\u6709\u76f8\u540c\u7684\u62b5\u62bc\u6b0a\u548c 1% \u7684\u4f63\u91d1\u7387\u3002 \u8b93\u6211\u5011\u4e5f \u5047\u8a2d\u4e00\u500b\u5340\u584a\u7684\u4f9b\u61c9\u91cf\u662f 1000 \u500b FM\uff0c\u6bcf\u500b\u9a57\u8b49\u8005\u6709 20% \u7684\u81ea\u62b5\u62bc FM\u3002 \u9019\u4e9b\u4ee3\u5e63 \u4e0d\u8981\u76f4\u63a5\u53bb\u627e\u63d0\u8b70\u8005\u3002 \u76f8\u53cd\uff0c\u5b83\u5011\u5e73\u5747\u5206\u4f48\u5728\u9a57\u8b49\u8005\u4e4b\u9593\u3002 \u6240\u4ee5\u73fe\u5728\u6bcf\u500b\u9a57\u8b49\u8005\u7684\u6c60 \u6709 100 \u500b FM\u3002 \u9019 100 \u500b FM \u5c07\u6839\u64da\u6bcf\u500b\u53c3\u8207\u8005\u7684 stake \u9032\u884c\u5206\u914d: </p> <ul> <li>\u4f63\u91d1: `100*80%*1% = 0.8 FM`</li> <li> \u9a57\u8b49\u8005\u5f97\u5230: `100\\*20% + \u4f63\u91d1 = 20.8 FM`</li> <li> \u6240\u6709\u59d4\u8a17\u4eba\u7372\u5f97: `100\\*80% - \u4f63\u91d1 = 79.2 FM`</li> </ul> \u7136\u5f8c\uff0c\u6bcf\u500b\u59d4\u8a17\u4eba\u90fd\u53ef\u4ee5\u6839\u64da\u4ed6\u5011\u5728\u9a57\u8b49\u8005\u7684\u6b0a\u76ca\u6c60\u4e2d\u7684\u80a1\u4efd\u6bd4\u4f8b\uff0c\u9818\u53d6 79.2 FM \u7684\u4e00\u90e8\u5206\u3002 \u8acb\u6ce8\u610f\uff0c\u9a57\u8b49\u8005\u7684\u4f63\u91d1\u4e0d\u9069\u7528\u65bc\u5340\u584a\u689d\u6b3e\u3002 \u8acb\u6ce8\u610f\uff0c\u5340\u584a\u734e\u52f5\u662f\u6309\u7167\u76f8\u540c\u7684\u6a5f\u5236\u5206\u767c\u3002   \u8cbb\u7528\u5982\u4f55\u5206\u914d\uff1f <p> \u8cbb\u7528\u7684\u5206\u914d\u65b9\u5f0f\u985e\u4f3c\uff0c\u9664\u4e86\u5340\u584a\u63d0\u8b70\u8005\u53ef\u4ee5\u7372\u5f97\u5340\u584a\u8cbb\u7528\u7684\u734e\u91d1 \u5efa\u8b70\u5b83\u662f\u5426\u5305\u542b\u8d85\u904e\u6240\u9700\u9810\u63d0\u4ea4\u7684\u56b4\u683c\u6700\u5c0f\u503c\u3002 </p> <p> \u7576\u4e00\u500b\u9a57\u8b49\u8005\u88ab\u9078\u4e2d\u63d0\u8b70\u4e0b\u4e00\u500b\u5340\u584a\u6642\uff0c\u5b83\u5fc5\u9808\u81f3\u5c11\u5305\u62ec\u524d\u4e00\u500b\u5340\u584a\u7684 \u2154 \u9810\u63d0\u4ea4 \u9a57\u8b49\u8005\u7c3d\u540d\u7684\u5f62\u5f0f\u3002 \u7136\u800c\uff0c\u6709\u4e00\u7a2e\u52d5\u6a5f\u5305\u62ec\u8d85\u904e \u2154 \u7684\u9810\u63d0\u4ea4 \u734e\u91d1\u3002 \u734e\u52f5\u662f\u7dda\u6027\u7684\uff1a\u5982\u679c\u63d0\u8b70\u8005\u5305\u62ec \u2154rd \u9810\u63d0\u4ea4\uff08\u584a\u7684\u6700\u5c0f\u503c\uff09\uff0c\u5247\u734e\u52f5\u7bc4\u570d\u70ba 1% \u6709\u6548\uff09\u5230 5%\uff0c\u5982\u679c\u63d0\u8b70\u8005\u5305\u62ec 100% \u9810\u63d0\u4ea4\u3002 \u7576\u7136\u6c42\u5a5a\u8005\u4e0d\u80fd\u7b49\u592a\u4e45\u6216\u5176\u4ed6 \u9a57\u8b49\u8005\u53ef\u80fd\u6703\u8d85\u6642\u4e26\u8f49\u5230\u4e0b\u4e00\u500b\u63d0\u8b70\u8005\u3002 \u56e0\u6b64\uff0c\u9a57\u8b49\u8005\u5fc5\u9808\u5728\u5169\u8005\u4e4b\u9593\u627e\u5230\u5e73\u8861 \u7372\u5f97\u6700\u591a\u7c3d\u540d\u7684\u7b49\u5f85\u6642\u9593\u548c\u5931\u53bb\u63d0\u8b70\u4e0b\u4e00\u500b\u5340\u584a\u7684\u98a8\u96aa\u3002 \u8a72\u6a5f\u5236\u65e8\u5728 \u6fc0\u52f5\u975e\u7a7a\u584a\u63d0\u6848\uff0c\u9a57\u8b49\u8005\u4e4b\u9593\u66f4\u597d\u7684\u7db2\u7d61\u4ee5\u53ca\u6e1b\u8f15\u5be9\u67e5\u5236\u5ea6\u3002 </p> <p> \u8b93\u6211\u5011\u8209\u4e00\u500b\u5177\u9ad4\u7684\u4f8b\u5b50\u4f86\u8aaa\u660e\u4e0a\u8ff0\u6982\u5ff5\u3002 \u5728\u9019\u500b\u4f8b\u5b50\u4e2d\uff0c\u6709 10 \u500b\u9a57\u8b49\u5668 \u5e73\u7b49\u7684\u5229\u76ca\u3002 \u4ed6\u5011\u6bcf\u4eba\u6536\u53d61%\u7684\u4f63\u91d1\uff0c\u4e26\u670920%\u7684\u81ea\u4fddFM\u3002 \u73fe\u5728\u4f86\u4e86\u4e00\u500b\u6210\u529f\u7684\u584a \u7e3d\u5171\u6536\u53d6 1005 dst \u7684\u8cbb\u7528\u3002 \u5047\u8a2d\u63d0\u8b70\u8005\u5728\u5176\u63d0\u8b70\u4e2d\u5305\u542b\u4e86 100% \u7684\u7c3d\u540d \u5835\u585e\u3002 \u5f9e\u800c\u7372\u5f975%\u7684\u5168\u984d\u7d05\u5229\u3002 </p> <p> \u6211\u5011\u5fc5\u9808\u6c42\u89e3\u9019\u500b\u7c21\u55ae\u7684\u7b49\u5f0f\u624d\u80fd\u627e\u5230\u6bcf\u500b\u9a57\u8b49\u8005\u7684\u734e\u52f5: </p>  $$9R ~ + ~ R ~ + ~ 5\\%(R) ~ = ~ 1005 ~ \\\u5de6\u53f3\u7bad\u982d ~ R ~ = ~ 1005 ~/ ~10.05 ~ = ~ 100$$  <p> \u5c0d\u65bc\u63d0\u8b70\u8005\u9a57\u8b49\u8005: </p> <ul> <li> \u6c60\u7372\u5f97 $R ~ + ~ 5\\%(R)$: 105 DST</li> <li> \u4f63\u91d1: $105 ~ *~ 80\\% ~* ~ 1\\%$ = 0.84 DST</li> <li> \u9a57\u8b49\u8005\u734e\u52f5: $105 ~ * ~ 20\\% ~ + ~ \u4f63\u91d1 = 21.84 DST</li> <li> \u59d4\u8a17\u4eba\u734e\u52f5: $105 ~ * ~ 80\\% ~ - ~ \u4f63\u91d1 = 83.16 DST (\u6bcf\u500b\u59d4\u8a17\u4eba\u90fd\u53ef\u4ee5\u7d22\u53d6\u81ea\u5df1\u7684\u90e8\u5206 \u9019\u4e9b\u734e\u52f5\u8207\u4ed6\u5011\u7684\u80a1\u4efd\u6210\u6bd4\u4f8b)</li> <li> \u6c60\u7372\u5f97 $R$: 100 DST</li> <li> \u4f63\u91d1: $100 ~ *~ 80\\% ~* ~ 1\\%$ = 0.8 DST</li> <li> \u9a57\u8b49\u8005\u734e\u52f5: $100 ~ * ~ 20\\% ~ + ~ \u4f63\u91d1 = 20.8 DST</li> <li> \u59d4\u8a17\u4eba\u734e\u52f5: $100 ~ * ~ 80\\% ~ - ~ \u4f63\u91d1 = 79.2 DST (\u6bcf\u500b\u59d4\u8a17\u4eba\u90fd\u53ef\u4ee5\u7d22\u53d6\u81ea\u5df1\u7684\u90e8\u5206 \u9019\u4e9b\u734e\u52f5\u8207\u4ed6\u5011\u7684\u80a1\u4efd\u6210\u6bd4\u4f8b)</li> </ul> \u524a\u6e1b\u689d\u4ef6\u662f\u4ec0\u9ebc\uff1f <p> \u5982\u679c\u9a57\u8b49\u8005\u884c\u70ba\u4e0d\u7576\uff0c\u5176\u62b5\u62bc\u80a1\u4efd\u53ca\u5176\u59d4\u8a17\u4eba\u7684\u80a1\u4efd\u5c07\u88ab\u524a\u6e1b\u3002 \u7684\u56b4\u91cd\u6027 \u61f2\u7f70\u53d6\u6c7a\u65bc\u932f\u8aa4\u7684\u985e\u578b\u3002 \u6709 3 \u500b\u4e3b\u8981\u932f\u8aa4\u53ef\u80fd\u5c0e\u81f4\u9a57\u8b49\u8005\u7684\u8cc7\u91d1\u88ab\u524a\u6e1b \u53ca\u5176\u59d4\u8a17\u4eba\uff1a </p> <p> \u96d9\u91cd\u7c3d\u540d: \u5982\u679c\u6709\u4eba\u5728\u93c8 A \u4e0a\u5831\u544a\u9a57\u8b49\u8005\u5728\u93c8 A \u4e0a\u7684\u76f8\u540c\u9ad8\u5ea6\u7c3d\u7f72\u4e86\u5169\u500b\u5340\u584a\u4e26\u4e14 \u93c8 B\uff0c\u5982\u679c\u93c8 A \u548c\u93c8 B \u5171\u4eab\u4e00\u500b\u5171\u540c\u7684\u7956\u5148\uff0c\u90a3\u9ebc\u9019\u500b\u9a57\u8b49\u8005\u5c07\u5728\u93c8 A \u4e0a\u88ab\u7f70\u6c92\u3002\u61f2\u7f70 \u96d9\u7c3d\u662f\u7e3d\u80a1\u4efd\u7684 10.00%\u3002 </p> <ul> <li>\u505c\u6a5f\u6642\u9593: \u5982\u679c\u9a57\u8b49\u8005\u932f\u904e\u4e86\u6700\u5f8c 90.000 \u500b\u5340\u584a\u4e2d\u8d85\u904e 50% \u7684\u5340\u584a\uff0c\u4ed6\u5011\u5c07\u88ab\u524a\u6e1b 0.50%\u3002</li> <li>Unavailability: \u5982\u679c\u9a57\u8b49\u8005\u7684\u7c3d\u540d\u6c92\u6709\u5305\u542b\u5728\u6700\u5f8c\u7684 X \u500b\u584a\u4e2d\uff0c\u9a57\u8b49\u8005\u5c07\u5f97\u5230 \u88ab\u8207 X \u6210\u6bd4\u4f8b\u7684\u908a\u969b\u91cf\u524a\u6e1b\u3002\u5982\u679c X \u9ad8\u65bc\u67d0\u500b\u9650\u5236 Y\uff0c\u5247\u9a57\u8b49\u5668\u5c07\u89e3\u9664\u7d81\u5b9a\u3002</li> </ul> <p> \u8acb\u6ce8\u610f\uff0c\u5373\u4f7f\u9a57\u8b49\u8005\u4e0d\u662f\u6545\u610f\u884c\u70ba\u4e0d\u7576\uff0c\u5982\u679c\u5176\u7bc0\u9ede\u5d29\u6f70\u3001\u4e1f\u5931\uff0c\u5b83\u4ecd\u7136\u6703\u88ab\u524a\u6e1b \u9023\u63a5\u6027\u3001\u7372\u5f97 DDoSed\uff0c\u6216\u8005\u5176\u79c1\u9470\u88ab\u6d29\u9732\u3002 </p> \u9a57\u8b49\u8005\u9700\u8981\u81ea\u7d81\u5b9a FM \u55ce\uff1f <p> \u4e0d\uff0c\u4ed6\u5011\u6c92\u6709\u3002 \u9a57\u8b49\u8005\u7684\u7e3d\u6b0a\u76ca\u7b49\u65bc\u5176\u81ea\u8eab\u62b5\u62bc\u6b0a\u76ca\u53ca\u5176\u59d4\u8a17\u6b0a\u76ca\u7684\u7e3d\u548c\u3002 \u9019\u610f\u5473\u8457\u9a57\u8b49\u8005\u53ef\u4ee5\u901a\u904e\u5438\u5f15\u66f4\u591a\u7684\u59d4\u8a17\u4eba\u4f86\u88dc\u511f\u5176\u5c11\u91cf\u7684\u81ea\u62b5\u62bc\u80a1\u4efd\u3002 \u9019\u662f \u70ba\u4ec0\u9ebc\u8072\u8b7d\u5c0d\u9a57\u8b49\u8005\u4f86\u8aaa\u975e\u5e38\u91cd\u8981\u3002 </p> <p> \u5373\u4f7f\u9a57\u8b49\u8005\u6c92\u6709\u7fa9\u52d9\u81ea\u884c\u7d81\u5b9a FM\uff0c\u59d4\u8a17\u4eba\u4e5f\u61c9\u8a72\u5e0c\u671b\u4ed6\u5011\u7684\u9a57\u8b49\u8005\u64c1\u6709 \u5728\u4ed6\u5011\u7684\u8cea\u62bc\u6c60\u4e2d\u81ea\u7d81\u5b9a FM\u3002 \u63db\u53e5\u8a71\u8aaa\uff0c\u9a57\u8b49\u8005\u61c9\u8a72\u53c3\u8207\u5176\u4e2d\u3002 </p> <p> \u70ba\u4e86\u8b93\u59d4\u8a17\u4eba\u5c0d\u4ed6\u5011\u7684\u9a57\u8b49\u8005\u6709\u591a\u5c11\u5229\u76ca\u6709\u4e00\u4e9b\u4fdd\u8b49\uff0c\u5f8c\u8005\u53ef\u4ee5\u767c\u51fa\u4fe1\u865f \u6700\u5c11\u91cf\u7684\u81ea\u9375\u5408 FM\u3002 \u5982\u679c\u9a57\u8b49\u8005\u7684\u81ea\u6211\u7d04\u675f\u4f4e\u65bc\u5176\u9810\u5b9a\u7fa9\u7684\u9650\u5236\uff0c\u5247\u6b64 \u9a57\u8b49\u8005\u53ca\u5176\u6240\u6709\u59d4\u8a17\u4eba\u5c07\u89e3\u9664\u7d81\u5b9a\u3002 </p> \u5982\u4f55\u9632\u6b62 stake \u96c6\u4e2d\u5728\u5c11\u6578\u9802\u7d1a\u9a57\u8b49\u8005\u624b\u4e2d\uff1f <p> \u76ee\u524d\uff0c\u793e\u5340\u61c9\u8a72\u4ee5\u4e00\u7a2e\u8070\u660e\u548c\u81ea\u6211\u4fdd\u8b77\u7684\u65b9\u5f0f\u884c\u4e8b\u3002 \u7576\u6bd4\u7279\u5e63\u7684\u7926\u6c60\u8b8a\u5f97\u592a \u793e\u5340\u901a\u5e38\u6703\u505c\u6b62\u5411\u8a72\u7926\u6c60\u8ca2\u737b\u5f88\u591a\u6316\u7926\u80fd\u529b\u3002 Daodst \u6700\u521d\u5c07\u4f9d\u8cf4\u65bc\u76f8\u540c\u7684\u6548\u679c\u3002 \u672a\u4f86\uff0c\u5c07\u90e8\u7f72\u5176\u4ed6\u6a5f\u5236\u4f86\u76e1\u53ef\u80fd\u5730\u5e73\u6ed1\u9019\u500b\u904e\u7a0b\uff1a </p> <p> Penalty-free re-delegation: \u9019\u662f\u70ba\u4e86\u8b93\u59d4\u8a17\u4eba\u53ef\u4ee5\u8f15\u9b06\u5730\u5f9e\u4e00\u500b\u9a57\u8b49\u5668\u5207\u63db\u5230\u53e6\u4e00\u500b\u9a57\u8b49\u5668\uff0c\u4ee5\u4fbf \u4ee5\u964d\u4f4e\u9a57\u8b49\u8005\u7684\u7c98\u6027\u3002 </p> <p> UI warning: \u9322\u5305\u53ef\u4ee5\u5be6\u73fe\u8b66\u544a\uff0c\u5982\u679c\u4ed6\u5011\u60f3\u59d4\u8a17\u7d66\u9a57\u8b49\u8005\uff0c\u9019\u4e9b\u8b66\u544a\u5c07\u986f\u793a\u7d66\u7528\u6236 \u5df2\u7d93\u64c1\u6709\u5927\u91cf\u7684\u62b5\u62bc\u6b0a\u3002 </p>"},{"location":"gateway/faq/#_6","title":"\u6280\u8853\u8981\u6c42","text":"\u786c\u4ef6\u8981\u6c42\u662f\u4ec0\u9ebc\uff1f <p> \u9a57\u8b49\u8005\u61c9\u8a72\u671f\u671b\u70ba\u4e00\u500b\u6216\u591a\u500b\u6578\u64da\u4e2d\u5fc3\u4f4d\u7f6e\u63d0\u4f9b\u5197\u9918\u96fb\u6e90\u3001\u7db2\u7d61\u3001\u9632\u706b\u7246\u3001 HSM \u548c\u670d\u52d9\u5668\u3002 </p>  \u6211\u5011\u9810\u8a08\u6700\u521d\u9700\u8981\u9069\u5ea6\u7684\u786c\u4ef6\u898f\u683c\uff0c\u4e26\u4e14\u5b83\u5011\u53ef\u80fd\u6703\u96a8\u8457\u7db2\u7d61\u7684\u767c\u5c55\u800c\u589e\u52a0 \u4f7f\u7528\u589e\u52a0\u3002 \u53c3\u8207\u6e2c\u8a66\u7db2\u662f\u4e86\u89e3\u66f4\u591a\u4fe1\u606f\u7684\u6700\u4f73\u65b9\u5f0f\u3002   \u4ec0\u9ebc\u662f\u8edf\u4ef6\u8981\u6c42\uff1f  \u9664\u4e86\u904b\u884c Daodst \u7bc0\u9ede\u5916\uff0c\u9a57\u8b49\u8005\u9084\u61c9\u958b\u767c\u76e3\u63a7\u3001\u8b66\u5831\u548c\u7ba1\u7406\u89e3\u6c7a\u65b9\u6848\u3002   \u4ec0\u9ebc\u662f\u5e36\u5bec\u8981\u6c42\uff1f <p> \u8207\u4ee5\u592a\u574a\u6216\u6bd4\u7279\u5e63\u7b49\u93c8\u76f8\u6bd4\uff0cDaodst \u5177\u6709\u975e\u5e38\u9ad8\u7684\u541e\u5410\u91cf\u3002 </p> <p> \u56e0\u6b64\uff0c\u6211\u5011\u5efa\u8b70\u6578\u64da\u4e2d\u5fc3\u7bc0\u9ede\u53ea\u9023\u63a5\u5230\u96f2\u7aef\u7684\u53ef\u4fe1\u5168\u7bc0\u9ede\u6216\u5176\u4ed6\u9a57\u8b49\u5668 \u5728\u793e\u4ea4\u4e0a\u76f8\u4e92\u4e86\u89e3\u3002 \u9019\u6e1b\u8f15\u4e86\u6578\u64da\u4e2d\u5fc3\u7bc0\u9ede\u6e1b\u8f15\u62d2\u7d55\u670d\u52d9\u653b\u64ca\u7684\u8ca0\u64d4\u3002 </p> <p> \u6700\u7d42\uff0c\u96a8\u8457\u7db2\u7d61\u7684\u4f7f\u7528\u8d8a\u4f86\u8d8a\u591a\uff0c\u4eba\u5011\u5be6\u969b\u4e0a\u53ef\u4ee5\u671f\u671b\u6bcf\u5929\u7684\u5e36\u5bec\u9054\u5230\u5e7e\u5343\u5146\u5b57\u7bc0\u7684\u6578\u91cf\u7d1a\u3002 </p> \u904b\u884c\u9a57\u8b49\u5668\u610f\u5473\u8457\u4ec0\u9ebc\uff1f  \u4e00\u500b\u6210\u529f\u7684\u9a57\u8b49\u8005\u64cd\u4f5c\u5c07\u9700\u8981\u591a\u500b\u9ad8\u6280\u80fd\u4eba\u54e1\u7684\u52aa\u529b\u548c\u6301\u7e8c\u7684\u64cd\u4f5c \u6ce8\u610f\u529b\u3002 \u4f8b\u5982\uff0c\u9019\u6bd4\u904b\u884c\u6bd4\u7279\u5e63\u7926\u5de5\u8981\u5fa9\u96dc\u5f97\u591a\u3002   \u5982\u4f55\u8655\u7406\u5bc6\u9470\u7ba1\u7406\uff1f  \u9a57\u8b49\u8005\u61c9\u8a72\u671f\u671b\u904b\u884c\u652f\u6301 ed25519 \u5bc6\u9470\u7684 HSM  <p> Daodst \u5718\u968a\u4e0d\u63a8\u8350\u4e00\u7a2e\u89e3\u6c7a\u65b9\u6848\u9ad8\u65bc\u53e6\u4e00\u7a2e\u89e3\u6c7a\u65b9\u6848\u3002 \u9f13\u52f5\u793e\u5340\u52a0\u5f37\u52aa\u529b\uff0c\u4ee5 \u6539\u9032 HSM \u548c\u5bc6\u9470\u7ba1\u7406\u7684\u5b89\u5168\u6027\u3002 </p> \u9a57\u8b49\u8005\u5728\u64cd\u4f5c\u65b9\u9762\u53ef\u4ee5\u671f\u5f85\u4ec0\u9ebc\uff1f  \u904b\u884c\u6709\u6548\u7684\u64cd\u4f5c\u662f\u907f\u514d\u610f\u5916\u89e3\u7d81\u6216\u88ab\u780d\u7684\u95dc\u9375\u3002 \u9019\u5305\u62ec\u80fd\u5920 \u97ff\u61c9\u653b\u64ca\u3001\u4e2d\u65b7\uff0c\u4ee5\u53ca\u7dad\u8b77\u6578\u64da\u4e2d\u5fc3\u7684\u5b89\u5168\u548c\u9694\u96e2\u3002   \u7dad\u8b77\u8981\u6c42\u662f\u4ec0\u9ebc\uff1f  \u9a57\u8b49\u8005\u61c9\u8a72\u671f\u671b\u57f7\u884c\u5b9a\u671f\u8edf\u4ef6\u66f4\u65b0\u4ee5\u9069\u61c9\u5347\u7d1a\u548c\u932f\u8aa4\u4fee\u5fa9\u3002 \u96e3\u514d\u6703\u6709 \u5728\u7db2\u7d61\u5f15\u5c0e\u968e\u6bb5\u7684\u65e9\u671f\u51fa\u73fe\u554f\u984c\uff0c\u9700\u8981\u9ad8\u5ea6\u8b66\u60d5\u3002   \u9a57\u8b49\u8005\u5982\u4f55\u4fdd\u8b77\u81ea\u5df1\u514d\u53d7\u62d2\u7d55\u670d\u52d9\u653b\u64ca\uff1f <p> \u7576\u653b\u64ca\u8005\u5411\u67d0\u500b IP \u5730\u5740\u767c\u9001\u5927\u91cf\u4e92\u806f\u7db2\u6d41\u91cf\u4ee5\u963b\u6b62\u670d\u52d9\u5668\u8a2a\u554f\u6642\uff0c\u5c31\u6703\u767c\u751f\u62d2\u7d55\u670d\u52d9\u653b\u64ca \u5728\u9023\u63a5\u5230\u4e92\u806f\u7db2\u7684 IP \u5730\u5740\u4e0a\u3002 </p> <p> \u653b\u64ca\u8005\u6383\u63cf\u7db2\u7d61\uff0c\u8a66\u5716\u4e86\u89e3\u5404\u7a2e\u9a57\u8b49\u5668\u7bc0\u9ede\u7684 IP \u5730\u5740\u4e26\u65b7\u958b\u5b83\u5011\u8207 \u901a\u904e\u7528\u6d41\u91cf\u6df9\u6c92\u4ed6\u5011\u4f86\u9032\u884c\u6e9d\u901a\u3002 </p> <p> \u6e1b\u8f15\u9019\u4e9b\u98a8\u96aa\u7684\u4e00\u7a2e\u63a8\u85a6\u65b9\u6cd5\u662f\u9a57\u8b49\u8005\u4ee5\u6240\u8b02\u7684\u65b9\u5f0f\u4ed4\u7d30\u69cb\u5efa\u5176\u7db2\u7d61\u62d3\u64b2 \u54e8\u5175\u7bc0\u9ede\u67b6\u69cb\u3002 </p> <p> \u9a57\u8b49\u8005\u7bc0\u9ede\u61c9\u8a72\u53ea\u9023\u63a5\u5230\u4ed6\u5011\u4fe1\u4efb\u7684\u5168\u7bc0\u9ede\uff0c\u56e0\u70ba\u4ed6\u5011\u81ea\u5df1\u64cd\u4f5c\u6216\u7531\u5176\u4ed6\u4eba\u904b\u884c \u4ed6\u5011\u5728\u793e\u4ea4\u4e0a\u8a8d\u8b58\u7684\u9a57\u8b49\u8005\u3002 \u9a57\u8b49\u5668\u7bc0\u9ede\u901a\u5e38\u5728\u6578\u64da\u4e2d\u5fc3\u904b\u884c\u3002 \u5927\u591a\u6578\u6578\u64da\u4e2d\u5fc3\u76f4\u63a5\u63d0\u4f9b \u93c8\u63a5\u4e3b\u8981\u96f2\u63d0\u4f9b\u5546\u7684\u7db2\u7d61\u3002 \u9a57\u8b49\u5668\u53ef\u4ee5\u4f7f\u7528\u9019\u4e9b\u93c8\u63a5\u9023\u63a5\u5230\u96f2\u4e2d\u7684\u54e8\u5175\u7bc0\u9ede\u3002 \u9019\u5c07\u62d2\u7d55\u670d\u52d9\u7684\u8ca0\u64d4\u5f9e\u9a57\u8b49\u8005\u7684\u7bc0\u9ede\u76f4\u63a5\u8f49\u79fb\u5230\u5b83\u7684\u54e8\u5175\u7bc0\u9ede\uff0c\u4e26\u4e14\u53ef\u80fd\u9700\u8981\u65b0\u7684 \u555f\u52d5\u6216\u6fc0\u6d3b\u54e8\u5175\u7bc0\u9ede\u4ee5\u6e1b\u8f15\u5c0d\u73fe\u6709\u7bc0\u9ede\u7684\u653b\u64ca\u3002 </p> <p> \u54e8\u5175\u7bc0\u9ede\u53ef\u4ee5\u5feb\u901f\u555f\u52d5\u6216\u66f4\u6539\u5176 IP \u5730\u5740\u3002 \u56e0\u70ba\u5230\u54e8\u5175\u7bc0\u9ede\u7684\u93c8\u63a5\u662f\u79c1\u6709\u7684 IP \u7a7a\u9593\uff0c\u57fa\u65bc\u4e92\u806f\u7db2\u7684\u653b\u64ca\u4e0d\u80fd\u76f4\u63a5\u5e72\u64fe\u4ed6\u5011\u3002 \u9019\u5c07\u78ba\u4fdd\u9a57\u8b49\u8005\u963b\u6b62\u63d0\u6848\u548c\u6295\u7968 \u7e3d\u662f\u8b93\u5b83\u5230\u9054\u7db2\u7d61\u7684\u5176\u9918\u90e8\u5206\u3002 </p> <p> \u9810\u8a08\u9019\u90e8\u5206\u9a57\u8b49\u8005\u7684\u826f\u597d\u64cd\u4f5c\u7a0b\u5e8f\u5c07\u5b8c\u5168\u6e1b\u8f15\u9019\u4e9b\u5a01\u8105\u3002 </p>"},{"location":"gateway/guide-linux/","title":"windows\u7db2\u95dc\u64cd\u4f5c\u6307\u5357","text":""},{"location":"gateway/guide-linux/#_1","title":"\u5b89\u88dd","text":"<pre><code>\u6253\u958b\u5b89\u88dd\u5305\uff0c\u8df3\u51fa\u5982\u4e0b\u4ecb\u9762\uff0c\u9ede\u64ca\u78ba\u5b9a\uff08\u90e8\u5206\u6bba\u6bd2\u8edf\u9ad4\u6703\u8aa4\u5831\uff09\n</code></pre> <pre><code>\u9078\u64c7\u5b89\u88dd\u76ee\u9304\uff08\u5efa\u8b70\u5927\u65bc1TB\uff09\n</code></pre> <pre><code>\u8010\u5fc3\u7b49\u5f85\u5b89\u88dd\u5b8c\u6210\n</code></pre>"},{"location":"gateway/guide-linux/#_2","title":"\u6d41\u7a0b","text":"<pre><code>\u65b0\u5efa\u6216\u5c0e\u5165\u9322\u5305\u5730\u5740--&gt;\u5275\u5efadpos --&gt;\u5275\u5efa\u9598\u9053--&gt;\u8cea\u62bcFM --&gt;\u9818\u53d6\u734e\u52f5\n</code></pre>"},{"location":"gateway/guide-linux/#_3","title":"\u65b0\u5efa\u9322\u5305","text":""},{"location":"gateway/guide-linux/#_4","title":"\u5c0e\u5165\u9322\u5305","text":""},{"location":"gateway/guide-linux/#dpos","title":"\u5275\u5efadpos","text":""},{"location":"gateway/guide-linux/#_5","title":"\u7533\u8bf7\u7f51\u5173","text":""},{"location":"gateway/guide-linux/#fm","title":"\u8cea\u62bcFM","text":""},{"location":"gateway/guide-linux/#_6","title":"\u9818\u53d6\u734e\u52f5","text":""},{"location":"gateway/guide-linux/#_7","title":"\u9996\u9801","text":"<pre><code>\u9996\u9801\u5305\u542b\u4e86\u4e00\u4e9b\u5168\u5c40\u6027\u7684\u67e5\u770b\u8207\u529f\u80fd\n\u5176\u4e2d\u5305\u62ec\uff1a\n\n\u67e5\u770b\u5340\u584a\u540c\u6b65\u60c5\u6cc1 \uff08\u4ecb\u9762\u53f3\u4e0a\u65b9\uff09\n</code></pre> <pre><code>\u67e5\u770b\u4efb\u52d9\u72c0\u614b\uff08\u4ecb\u9762\u53f3\u4e0a\u65b9\uff09\n</code></pre> <pre><code>\u7ba1\u7406\u8edf\u4ef6\u8a2d\u7f6e \uff08\u4ecb\u9762\u5de6\u4e0b\u89d2\uff09\n</code></pre>"},{"location":"gateway/guide-linux/#_8","title":"\u64cd\u4f5c","text":"<pre><code>\u53f3\u4e0a\u89d2\u7684\u64cd\u4f5c\u53ef\u4ee5\u7ba1\u7406DID\u548c\u4fee\u6539\u7db2\u95dc\u4fe1\u606f\n</code></pre>"},{"location":"gateway/guide-linux/#did","title":"DID\u6bb5\u7ba1\u7406","text":"<pre><code>\u53ef\u4ee5\u901a\u904e\u8cea\u62bcFM\u7684\u65b9\u5f0f\u7372\u53d6\u66f4\u591a\u7684DID\u865f\u6bb5\n</code></pre> <pre><code>\u9996\u9801\u5de6\u5074\u9078\u7dda\u689d\uff0c\u5305\u62ec\u8cc7\u7522\u548c\u7db2\u95dc\u5169\u500b\u9078\u9805\u5361\n</code></pre>"},{"location":"gateway/guide-linux/#_9","title":"\u8cc7\u7522","text":"<pre><code>\u8cc7\u7522\u754c\u9762\u7ba1\u7406\u5305\u62ec\u9918\u984d\u3001\u8f49\u8cec\u3001\u4ea4\u6613\u8a18\u9304\u3001\u8cec\u865f\u7684\u7ba1\u7406\n\n\u5de6\u5074\u4e09\u500b\u6309\u9215\uff0c\u5206\u5225\u5c0d\u61c9 DST,FM\uff0cHASH\u4e09\u500b\u4e3b\u5e63\n</code></pre> <pre><code>\u53f3\u5074\u53ef\u4ee5\u67e5\u770b\u9918\u984d\u6578\u91cf \u4ea4\u6613\u8a18\u9304\uff0c\u4ee5\u53ca\u9032\u884c\u4e3b\u5e63\u7684\u767c\u9001\u548c\u63a5\u6536\n</code></pre> <pre><code>\u9019\u88e1\u5c0e\u51fa\u52a9\u8a18\u8a5e\uff0c\u4ee5\u53ca\u4fee\u6539\u5bc6\u78bc\n</code></pre>"},{"location":"gateway/guide-linux/#_10","title":"\u7db2\u95dc","text":"<pre><code>\u7db2\u95dc\u529f\u80fd\u7ba1\u7406dpos\u8cea\u62bc\uff0c\u7db2\u95dc\u670d\u52d9\u5668\uff0c\u7db2\u95dcapp\uff0c\u7db2\u95dc\u5bc6\u9470\u7b49\n</code></pre>"},{"location":"gateway/guide-linux/#dpos_1","title":"DPOS\u8cea\u62bc\u7ba1\u7406","text":"<pre><code>\u6210\u70ba\u9a57\u8b49\u5668\u5f8c\uff0c\u53ef\u4ee5\u5728 _DPOS\u8cea\u62bc\u7ba1\u7406_ \u9801\u9762\u67e5\u770b\u672c\u7bc0\u9ede\u7684DPOS\u72c0\u614b\n\n\u53ef\u4ee5\u9032\u884c\u8cea\u62bc\u8207\u8d16\u56de\n</code></pre> <pre><code>DPOS\u7684\u8d16\u56de\u4e0d\u662f\u7acb\u5373\u5230\u8cec\u7684\uff0c\u5728\u6b64\u67e5\u770b\u8d16\u56de\u72c0\u614b\n</code></pre> <pre><code>\u53ef\u4ee5\u67e5\u770b\u548c\u9818\u53d6\u8cea\u62bc\u734e\u52f5\u4ee5\u53ca\u4f63\u91d1\n</code></pre> <pre><code>\u5728\u6b64\u4fee\u6539\u7db2\u95dc\u7684\u8a2d\u7f6e\n</code></pre>"},{"location":"gateway/guide-linux/#_11","title":"\u7db2\u95dc\u670d\u52d9\u5668\u8cc7\u6e90","text":""},{"location":"gateway/guide-linux/#app","title":"\u7db2\u95dcapp","text":""},{"location":"gateway/guide-linux/#_12","title":"\u7db2\u95dc\u5bc6\u9470","text":"<pre><code>\u7db2\u95dc\u5bc6\u9470\u7684\u4f7f\u7528\u65b9\u6cd5\u8a73\u898b\n</code></pre>"},{"location":"gateway/guide-linux/#_13","title":"\u7db2\u95dc\u5bc6\u9470\u4f7f\u7528\u65b9\u6cd5","text":""},{"location":"gateway/guide-linux/#_14","title":"\u8a2d\u7f6e","text":"<pre><code>\u8a2d\u7f6e\u5305\u62ec\uff1a\u7248\u672c\u6aa2\u6e2c\u3001\u8a9e\u8a00\u6aa2\u6e2c\u3001\u6b77\u53f2\u6e05\u9664\u8a2d\u7f6e\u3001\u7bc0\u9ede\u8a2d\u7f6e\u3001\u6578\u64da\u76ee\u9304\u8a2d\u7f6e\u3001\u8def\u7531\u5c64\u6578\u6aa2\u6e2c\n</code></pre>"},{"location":"gateway/guide-linux/#_15","title":"\u5347\u7d1a","text":"<pre><code>\u901a\u904e\u6aa2\u67e5\u66f4\u65b0\u67e5\u770b\u662f\u5426\u6709\u53ef\u5347\u7d1a\u7684\u7248\u672c\n</code></pre> <pre><code>\u7b49\u5f85\u4e0b\u8f09\u5b8c\u7562\n</code></pre> <pre><code>\u9000\u51fa\u66f4\u65b0\u5373\u53ef\n</code></pre>"},{"location":"gateway/guide-win/","title":"windows\u7db2\u95dc\u64cd\u4f5c\u6307\u5357","text":""},{"location":"gateway/guide-win/#_1","title":"\u5b89\u88dd","text":"<pre><code>\u6253\u958b\u5b89\u88dd\u5305\uff0c\u8df3\u51fa\u5982\u4e0b\u4ecb\u9762\uff0c\u9ede\u64ca\u78ba\u5b9a\uff08\u90e8\u5206\u6bba\u6bd2\u8edf\u9ad4\u6703\u8aa4\u5831\uff09\n</code></pre> <pre><code>\u9078\u64c7\u5b89\u88dd\u76ee\u9304\uff08\u5efa\u8b70\u5927\u65bc1TB\uff09\n</code></pre> <pre><code>\u8010\u5fc3\u7b49\u5f85\u5b89\u88dd\u5b8c\u6210\n</code></pre>"},{"location":"gateway/guide-win/#_2","title":"\u6d41\u7a0b","text":"<pre><code>\u65b0\u5efa\u6216\u5c0e\u5165\u9322\u5305\u5730\u5740--&gt;\u5275\u5efadpos --&gt;\u5275\u5efa\u9598\u9053--&gt;\u8cea\u62bcFM --&gt;\u9818\u53d6\u734e\u52f5\n</code></pre>"},{"location":"gateway/guide-win/#_3","title":"\u65b0\u5efa\u9322\u5305","text":""},{"location":"gateway/guide-win/#_4","title":"\u5c0e\u5165\u9322\u5305","text":""},{"location":"gateway/guide-win/#dpos","title":"\u5275\u5efadpos","text":""},{"location":"gateway/guide-win/#_5","title":"\u7533\u8bf7\u7f51\u5173","text":""},{"location":"gateway/guide-win/#fm","title":"\u8cea\u62bcFM","text":""},{"location":"gateway/guide-win/#_6","title":"\u9818\u53d6\u734e\u52f5","text":""},{"location":"gateway/guide-win/#_7","title":"\u9996\u9801","text":"<pre><code>\u9996\u9801\u5305\u542b\u4e86\u4e00\u4e9b\u5168\u5c40\u6027\u7684\u67e5\u770b\u8207\u529f\u80fd\n\u5176\u4e2d\u5305\u62ec\uff1a\n\n\u67e5\u770b\u5340\u584a\u540c\u6b65\u60c5\u6cc1 \uff08\u4ecb\u9762\u53f3\u4e0a\u65b9\uff09\n</code></pre> <pre><code>\u67e5\u770b\u4efb\u52d9\u72c0\u614b\uff08\u4ecb\u9762\u53f3\u4e0a\u65b9\uff09\n</code></pre> <pre><code>\u7ba1\u7406\u8edf\u4ef6\u8a2d\u7f6e \uff08\u4ecb\u9762\u5de6\u4e0b\u89d2\uff09\n</code></pre>"},{"location":"gateway/guide-win/#_8","title":"\u64cd\u4f5c","text":"<pre><code>\u53f3\u4e0a\u89d2\u7684\u64cd\u4f5c\u53ef\u4ee5\u7ba1\u7406DID\u548c\u4fee\u6539\u7db2\u95dc\u4fe1\u606f\n</code></pre>"},{"location":"gateway/guide-win/#did","title":"DID\u6bb5\u7ba1\u7406","text":"<pre><code>\u53ef\u4ee5\u901a\u904e\u8cea\u62bcFM\u7684\u65b9\u5f0f\u7372\u53d6\u66f4\u591a\u7684DID\u865f\u6bb5\n</code></pre> <pre><code>\u9996\u9801\u5de6\u5074\u9078\u7dda\u689d\uff0c\u5305\u62ec\u8cc7\u7522\u548c\u7db2\u95dc\u5169\u500b\u9078\u9805\u5361\n</code></pre>"},{"location":"gateway/guide-win/#_9","title":"\u8cc7\u7522","text":"<pre><code>\u8cc7\u7522\u754c\u9762\u7ba1\u7406\u5305\u62ec\u9918\u984d\u3001\u8f49\u8cec\u3001\u4ea4\u6613\u8a18\u9304\u3001\u8cec\u865f\u7684\u7ba1\u7406\n\n\u5de6\u5074\u4e09\u500b\u6309\u9215\uff0c\u5206\u5225\u5c0d\u61c9 DST,FM\uff0cHASH\u4e09\u500b\u4e3b\u5e63\n</code></pre> <pre><code>\u53f3\u5074\u53ef\u4ee5\u67e5\u770b\u9918\u984d\u6578\u91cf \u4ea4\u6613\u8a18\u9304\uff0c\u4ee5\u53ca\u9032\u884c\u4e3b\u5e63\u7684\u767c\u9001\u548c\u63a5\u6536\n</code></pre> <pre><code>\u9019\u88e1\u5c0e\u51fa\u52a9\u8a18\u8a5e\uff0c\u4ee5\u53ca\u4fee\u6539\u5bc6\u78bc\n</code></pre>"},{"location":"gateway/guide-win/#_10","title":"\u7db2\u95dc","text":"<pre><code>\u7db2\u95dc\u529f\u80fd\u7ba1\u7406dpos\u8cea\u62bc\uff0c\u7db2\u95dc\u670d\u52d9\u5668\uff0c\u7db2\u95dcapp\uff0c\u7db2\u95dc\u5bc6\u9470\u7b49\n</code></pre>"},{"location":"gateway/guide-win/#dpos_1","title":"DPOS\u8cea\u62bc\u7ba1\u7406","text":"<pre><code>\u6210\u70ba\u9a57\u8b49\u5668\u5f8c\uff0c\u53ef\u4ee5\u5728 _DPOS\u8cea\u62bc\u7ba1\u7406_ \u9801\u9762\u67e5\u770b\u672c\u7bc0\u9ede\u7684DPOS\u72c0\u614b\n\n\u53ef\u4ee5\u9032\u884c\u8cea\u62bc\u8207\u8d16\u56de\n</code></pre> <pre><code>DPOS\u7684\u8d16\u56de\u4e0d\u662f\u7acb\u5373\u5230\u8cec\u7684\uff0c\u5728\u6b64\u67e5\u770b\u8d16\u56de\u72c0\u614b\n</code></pre> <pre><code>\u53ef\u4ee5\u67e5\u770b\u548c\u9818\u53d6\u8cea\u62bc\u734e\u52f5\u4ee5\u53ca\u4f63\u91d1\n</code></pre> <pre><code>\u5728\u6b64\u4fee\u6539\u7db2\u95dc\u7684\u8a2d\u7f6e\n</code></pre>"},{"location":"gateway/guide-win/#_11","title":"\u7db2\u95dc\u670d\u52d9\u5668\u8cc7\u6e90","text":""},{"location":"gateway/guide-win/#app","title":"\u7db2\u95dcapp","text":""},{"location":"gateway/guide-win/#_12","title":"\u7db2\u95dc\u5bc6\u9470","text":"<pre><code>\u7db2\u95dc\u5bc6\u9470\u7684\u4f7f\u7528\u65b9\u6cd5\u8a73\u898b\n</code></pre>"},{"location":"gateway/guide-win/#_13","title":"\u7db2\u95dc\u5bc6\u9470\u4f7f\u7528\u65b9\u6cd5","text":""},{"location":"gateway/guide-win/#_14","title":"\u8a2d\u7f6e","text":"<pre><code>\u8a2d\u7f6e\u5305\u62ec\uff1a\u7248\u672c\u6aa2\u6e2c\u3001\u8a9e\u8a00\u6aa2\u6e2c\u3001\u6b77\u53f2\u6e05\u9664\u8a2d\u7f6e\u3001\u7bc0\u9ede\u8a2d\u7f6e\u3001\u6578\u64da\u76ee\u9304\u8a2d\u7f6e\u3001\u8def\u7531\u5c64\u6578\u6aa2\u6e2c\n</code></pre>"},{"location":"gateway/guide-win/#_15","title":"\u5347\u7d1a","text":"<pre><code>\u901a\u904e\u6aa2\u67e5\u66f4\u65b0\u67e5\u770b\u662f\u5426\u6709\u53ef\u5347\u7d1a\u7684\u7248\u672c\n</code></pre> <pre><code>\u7b49\u5f85\u4e0b\u8f09\u5b8c\u7562\n</code></pre> <pre><code>\u9000\u51fa\u66f4\u65b0\u5373\u53ef\n</code></pre>"},{"location":"gateway/key-backup/","title":"\u5bc6\u94a5\u5907\u4efd\u548c\u6062\u590d","text":"<p> \u7528\u6236\u53ef\u4ee5\u9078\u64c7\u5c07\u9598\u9053\u7684\u91d1\u9470\uff0c\u9a57\u8b49\u5668\u91d1\u9470\u548capp\u52a0\u5bc6\u6a94\u5099\u4efd\uff0c\u4ee5\u4f9b\u9700\u8981\u6642\u6062\u5fa9</p> <p>\u5099\u4efd\u5206\u70ba\u624b\u52d5\u5099\u4efd\u8207\u4e0a\u93c8\u5099\u4efd\uff0c\u4e0a\u93c8\u5099\u4efd\u53ea\u9700\u82b1\u8cbb\u5c11\u91cf\u7684gas\uff0c\u5373\u53ef\u5099\u4efd\u5230\u93c8\u4e0a\uff0c\u96a8\u6642\u53ef\u4ee5\u4e0b\u8f09</p>"},{"location":"gateway/key-backup/#_2","title":"\u624b\u52a8\u5907\u4efd","text":"<p>\u9ede\u64ca\u5de6\u5074\u9598\u9053\u9078\u9805\uff0c\u9ede\u64ca[\u4e0b\u8f09\u5bc6\u9470\u6a94\u6848]\u6309\u9215\uff0c\u5c07\u5176\u4fdd\u5b58\u5230\u6307\u5b9a\u4f4d\u7f6e\u5373\u53ef</p>"},{"location":"gateway/key-backup/#_3","title":"\u4e0a\u94fe\u5907\u4efd","text":"<p>\u9ede\u64ca\u5de6\u5074\u9598\u9053\u9078\u9805\uff0c\u9ede\u64ca[\u9598\u9053\u5bc6\u9470\u93c8\u4e0a\u5b58\u5132]\u6309\u9215\uff0c\u8f38\u5165\u5bc6\u78bc\uff0c\u5f85\u4e0a\u93c8\u6210\u529f\u5373\u5b58\u5132\u5b8c\u7562</p>"},{"location":"gateway/key-backup/#_4","title":"\u8fd8\u539f","text":"<p>\u5982\u679c\u662f\u93c8\u4e0a\u5b58\u5132\u7684\uff0c\u90a3\u9ebc[\u9598\u9053\u5bc6\u9470\u93c8\u4e0a\u5b58\u5132\u6309\u9215]\u6309\u9215\u6703\u8b8a\u66f4\u70ba[\u4e0b\u8f09\u93c8\u4e0a\u5bc6\u9470]\uff0c\u9ede\u64ca\u5f8c\uff0c\u6703\u5c07\u4e09\u500b\u6a94\u6848\u4fdd\u5b58\u5728\u9598\u9053\u76ee\u9304\u4e0b\u7684GatewayKey\u76ee\u9304</p> <pre><code>GatewayKey/\n\u251c\u2500\u2500 fmc.jks                 # app\u7684\u7c3d\u540d\u6a94\u6848\n\u2502\u2500\u2500 node_key.json           # \u9598\u9053\u5bc6\u9470\u6a94\u6848\n\u2514\u2500\u2500 priv_validator_key.json # \u9a57\u8b49\u5668\u79c1\u5bc6\u5bc6\u9470\u6a94\u6848\n</code></pre> <p>\u5728\u93c8\u505c\u6b62\u72c0\u614b\u4e0b \u5c07fmc.jks\u79fb\u52d5\u5230\u5bb6\u76ee\u9304\u4e0b \u5c07node_ key.json\u548cpriv_ validator_ key.json\u79fb\u52d5\u5230gateway\u76ee\u9304\u4e0b\u7684     .stcd/config/ \u4e0b</p> <p>\u5982\u679c\u662f\u624b\u52d5\u5b58\u5132\uff0c\u5247\u540c\u6a23\u7684\uff0c\u5c07\u5c0d\u61c9\u6a94\u6848\u9084\u539f\u5230\u5c0d\u61c9\u4f4d\u7f6e\u5373\u53ef</p>"},{"location":"gateway/mainnet/","title":"\u4e3b\u7db2","text":"<p>\u672c\u6587\u6a94\u6982\u8ff0\u4e86\u52a0\u5165\u73fe\u6709\u4e3b\u7db2\u7684\u6b65\u9a5f\u3002</p>"},{"location":"gateway/mainnet/#_2","title":"\u5148\u51b3\u6761\u4ef6\u9605\u8bfb","text":"<ul> <li>\u9a57\u8b49\u5668\u5b89\u5168</li> </ul>"},{"location":"gateway/mainnet/#_3","title":"\u4e3b\u7db2","text":"<p>\u60a8\u9700\u8981\u8a2d\u7f6e \u521b\u4e16\u6587\u4ef6 \u548c \u79cd\u5b50\u8282\u70b9\u3002 \u5982\u679c\u60a8\u9700\u8981\u6709\u95dc\u904e\u53bb\u7db2\u7d61\u7684\u66f4\u591a\u4fe1\u606f\uff0c\u8acb\u67e5\u770b\u6211\u5011\u7684 mainnet repo\u3002 \u4e0b\u8868\u6982\u8ff0\u4e86\u6240\u6709\u4e3b\u7db2\u93c8 ID\u3002 \u8acb\u6ce8\u610f\uff0c\u7576\u93c8\u4e0a\u5b58\u5728\u6d3b\u52d5\u7684\u8edf\u4ef6\u5347\u7d1a\u63d0\u8b70\u6642\uff0c\u986f\u793a\u7684\u7248\u672c\u53ef\u80fd\u6703\u6709\u6240\u4e0d\u540c\u3002</p> Chain ID \u63cf\u8ff0 \u4f4d\u7f6e \u7248\u672c \u72c0\u614b <code>daodst_7777-1</code> Daodst Mainnet 1 Daodst <code>v1.0.0</code> <code>\u6d3b\u8dc3</code> <p>\u26a0\ufe0f\u91cd\u8981\u7684: \u5982\u679c\u60a8\u4f5c\u70ba\u9a57\u8b49\u8005\u52a0\u5165\u4e3b\u7db2\uff0c\u8acb\u78ba\u4fdd\u60a8\u9075\u5faa\u6240\u6709 security \u5efa\u8b70\uff01</p>"},{"location":"gateway/mainnet/#daodst","title":"\u5b89\u88c5 <code>daodst</code>","text":"<p>\u6309\u7167 \u5b89\u88c5 \u6587\u6a94\u5b89\u88dd \u7a0b\u5e8f</p> <p>\u26a0\ufe0f\u6ce8\u610f :  \u78ba\u4fdd\u5b89\u88dd\u4e86\u6b63\u78ba\u7248\u672c\u7684\u7a0b\u5e8f\u3002</p>"},{"location":"gateway/mainnet/#chain-id","title":"\u4fdd\u5b58 Chain ID","text":"<p>\u6211\u5011\u5efa\u8b70\u5c07\u4e3b\u7db2 <code>chain-id</code> \u4fdd\u5b58\u5230\u60a8\u7684\u7a0b\u5e8f\u7684 <code>client.toml</code> \u4e2d\u3002 \u9019\u5c07\u4f7f\u60a8\u4e0d\u5fc5\u70ba\u6bcf\u500b CLI \u547d\u4ee4\u624b\u52d5\u50b3\u905e <code>chain-id</code> \u6a19\u8a8c\u3002</p> <p>\ud83d\udce3 \u63d0\u793a :  \u8acb\u53c3\u95b1\u5b98\u65b9 \u93c8 ID \u4ee5\u4f9b\u53c3\u8003\u3002</p> <pre><code>stcd config chain-id daodst_7777-1\n</code></pre>"},{"location":"gateway/mainnet/#_4","title":"\u521d\u59cb\u5316\u7bc0\u9ede","text":"<p>\u6211\u5011\u9700\u8981\u521d\u59cb\u5316\u7bc0\u9ede\u4ee5\u5275\u5efa\u6240\u6709\u5fc5\u8981\u7684\u9a57\u8b49\u5668\u548c\u7bc0\u9ede\u914d\u7f6e\u6587\u4ef6\uff1a</p> <pre><code>stcd init &lt;your_custom_moniker&gt; --chain-id daodst_7777-1\n</code></pre> <p>\u26a0\ufe0f\u5371\u9669 :  \u540d\u5b57\u5c0d\u50cf\u53ea\u80fd\u5305\u542b ASCII \u5b57\u7b26\u3002\u4f7f\u7528 Unicode \u5b57\u7b26\u5c07\u4f7f\u60a8\u7684\u7bc0\u9ede\u7121\u6cd5\u8a2a\u554f\u3002</p> <p>\ud83d\udce3 \u63d0\u793a :  <code>$install_path</code> \u7528\u6765\u8868\u793a\u60a8\u5b89\u88c5 <code>stcd</code> \u4e8c\u8fdb\u5236\u7a0b\u5e8f\u7684\u8def\u5f84</p> <p>\u9ed8\u8a8d\u60c5\u6cc1\u4e0b\uff0c<code>init</code> \u547d\u4ee4\u5275\u5efa\u5e36\u6709\u5b50\u6587\u4ef6\u593e<code>config/</code> \u548c<code>data/</code> \u7684<code>$install_path/.stcd</code>\uff08\u5373<code>$HOME</code>\uff09\u76ee\u9304\u3002 \u5728 <code>config</code> \u76ee\u9304\u4e2d\uff0c\u6700\u91cd\u8981\u7684\u914d\u7f6e\u6587\u4ef6\u662f <code>app.toml</code> \u548c <code>config.toml</code>\u3002</p>"},{"location":"gateway/mainnet/#_5","title":"\u521b\u4e16 &amp; \u79cd\u5b50\u8282\u70b9","text":""},{"location":"gateway/mainnet/#_6","title":"\u8907\u88fd\u5275\u4e16\u6587\u4ef6","text":"<p>\u5f9e <code>github</code> \u4e0b\u8f7d <code>genesis.json</code> \u6587\u4ef6\u4e26\u5c07\u5176\u8907\u88fd\u5230 <code>config</code> \u76ee\u9304\uff1a<code>$install_path/.stcd/config/genesis.json</code>\u3002\u9019\u662f\u4e00\u500b\u5305\u542b\u93c8 ID \u548c\u5275\u4e16\u8cec\u6236\u9918\u984d\u7684\u5275\u4e16\u6587\u4ef6\u3002</p> <pre><code>wget https://github.com/daodst/mainnet/daodst_7777-1/genesis.json\nmv genesis.json $install_path/.stcd/config/\n</code></pre> <p>\u7136\u5f8c\u9a57\u8b49genesis\u914d\u7f6e\u6587\u4ef6\u7684\u6b63\u78ba\u6027\uff1a</p> <pre><code>stcd validate-genesis\n</code></pre>"},{"location":"gateway/mainnet/#_7","title":"\u6dfb\u52a0\u7a2e\u5b50\u7bc0\u9ede","text":"<p>\u60a8\u7684\u7bc0\u9ede\u9700\u8981\u77e5\u9053\u5982\u4f55\u627e\u5230 peers\u3002</p> <p>\u60a8\u9700\u8981\u6dfb\u52a0\u5065\u5eb7\u7684\u7a2e\u5b50\u7bc0\u9ede \u5230 <code>$install_path/.stcd/config/config.toml</code> <code>mainnet</code> \u5b58\u5132\u5eab\u5305\u542b\u4e00\u4e9b\u93c8\u63a5 \u7a2e\u5b50\u7bc0\u9ede\u3002</p> <p>\u5c07\u4f4d\u65bc <code>$install_path/.stcd/config/config.toml</code> \u548c <code>seeds</code> \u4e2d\u7684\u6587\u4ef6\u7de8\u8f2f\u70ba\u4ee5\u4e0b\u5167\u5bb9\uff1a</p> <pre><code>#######################################################\n###           P2P Configuration Options             ###\n#######################################################\n[p2p]\n\n# ...\n\n# Comma separated list of seed nodes to connect to\nseeds = \"&lt;node-id&gt;@&lt;ip&gt;:&lt;p2p port&gt;\"\n</code></pre> <p>\u60a8\u53ef\u4ee5\u4f7f\u7528\u4ee5\u4e0b\u4ee3\u78bc\u5f9e\u5b58\u5132\u5eab\u4e2d\u7372\u53d6\u7a2e\u5b50\u4e26\u5c07\u5176\u6dfb\u52a0\u5230\u60a8\u7684\u914d\u7f6e\u4e2d\uff1a</p> <pre><code>SEEDS=`curl -sL https://raw.githubusercontent.com/daodst/mainnet/main/daodst_7777-1/seeds.txt | awk '{print $1}' | paste -s -d, -`\nsed -i.bak -e \"s/^seeds =.*/seeds = \\\"$SEEDS\\\"/\" $install_path/.stcd/config/config.toml\n</code></pre> <p>\ud83d\udce3 \u63d0\u793a :  \u6709\u95dc\u7a2e\u5b50\u548c\u7bc0\u9ede\u7684\u66f4\u591a\u4fe1\u606f\uff0c\u60a8\u53ef\u4ee5\u67e5\u770b Tendermint P2P \u6587\u6a94\u3002</p>"},{"location":"gateway/mainnet/#_8","title":"\u6dfb\u52a0\u6301\u4e45\u7bc0\u9ede","text":"<p>\u6211\u5011\u53ef\u4ee5\u8a2d\u7f6e <code>persistent_peers</code> <code>$install_path/.stcd/config/config.toml</code> \u4e2d\u7684\u5b57\u6bb5\u6307\u5b9a\u60a8\u7684\u7bc0\u9ede\u5c07\u8207\u4e4b\u4fdd\u6301\u6301\u4e45\u9023\u63a5\u7684\u5c0d\u7b49\u9ede\u3002 \u60a8\u53ef\u4ee5\u5f9e <code>mainnet</code> \u5b58\u5132\u5eab\u7684\u53ef\u7528\u7bc0\u9ede\u5217\u8868\u4e2d\u6aa2\u7d22\u5b83\u5011\u3002</p> <p>\u60a8\u53ef\u4ee5\u901a\u904e\u904b\u884c\u4ee5\u4e0b\u547d\u4ee4\u5f9e <code>PEERS</code> \u8b8a\u91cf\u7684 <code>peers.txt</code> \u6587\u4ef6\u4e2d\u96a8\u6a5f\u7372\u53d6 10 \u500b\u689d\u76ee\uff1a</p> <pre><code>PEERS=`curl -sL https://raw.githubusercontent.com/daodst/mainnet/main/daodst_7777-1/peers.txt | sort -R | head -n 10 | awk '{print $1}' | paste -s -d, -`\n</code></pre> <p>\u4f7f\u7528 <code>sed</code> \u5c07\u5b83\u5011\u5305\u542b\u5230\u914d\u7f6e\u4e2d\u3002\u60a8\u4e5f\u53ef\u4ee5\u624b\u52d5\u6dfb\u52a0\u5b83\u5011\uff1a</p> <pre><code>sed -i.bak -e \"s/^persistent_peers *=.*/persistent_peers = \\\"$PEERS\\\"/\" $install_path/.stcd/config/config.toml\n</code></pre>"},{"location":"gateway/mainnet/#_9","title":"\u904b\u884c\u4e3b\u7db2\u9a57\u8b49\u5668","text":"<p>\ud83d\udce3 \u63d0\u793a :  \u6709\u95dc\u5982\u4f55\u904b\u884c\u9a57\u8b49\u5668\u7684\u66f4\u591a\u8a73\u7d30\u4fe1\u606f\uff0c\u8acb\u9075\u5faa\u9a57\u8b49\u5668 \u9019\u4e9b \u6307\u793a\u3002</p> <pre><code>stcd tx staking create-validator \\\n--amount=1000000000000dst \\\n--pubkey=$(stcd tendermint show-validator) \\\n--moniker=\"Daodst1\" \\\n--chain-id=&lt;chain_id&gt; \\\n--commission-rate=\"0.05\" \\\n--commission-max-rate=\"0.20\" \\\n--commission-max-change-rate=\"0.01\" \\\n--min-self-delegation=\"1000000\" \\\n--gas=\"auto\" \\\n--gas-prices=\"0.025dst\" \\\n--from=&lt;key_name&gt;\n</code></pre> <p>\ud83d\udea8 \u5371\u96aa: \u6c38\u9060\u4e0d\u8981\u4f7f\u7528 <code>test</code> \u4f5c\u4e3a\u5bc6\u94a5\u73af\u5f8c\u7aef\u5275\u5efa\u9a57\u8b49\u5668\u5bc6\u9470\u3002 \u9019\u6a23\u505a\u53ef\u80fd\u6703\u5c0e\u81f4\u60a8\u7684\u8cc7\u91d1\u901a\u904e<code>eth_sendTransaction</code> JSON-RPC \u7aef\u9ede\u9060\u7a0b\u8a2a\u554f\uff0c\u5f9e\u800c\u5c0e\u81f4\u8cc7\u91d1\u640d\u5931\u3002</p> <p>\u53c3\u8003\uff1a\u5b89\u5168\u8aee\u8a62\uff1a\u4e0d\u5b89\u5168\u914d\u7f6e\u7684 geth \u53ef\u4ee5\u4f7f\u8cc7\u91d1\u9060\u7a0b\u8a2a\u554f</p>"},{"location":"gateway/mainnet/#_10","title":"\u555f\u52d5\u4e3b\u7db2","text":"<p>\u6700\u5f8c\u4e00\u6b65\u662f\u555f\u52d5\u7bc0\u9ede\u3002\u4e00\u65e6\u8db3\u5920\u7684\u6295\u7968\u6b0a\uff08+2/3\uff09 \u5f9e\u5275\u4e16\u9a57\u8b49\u5668\u958b\u59cb\u904b\u884c\uff0c\u7bc0\u9ede\u5c07\u958b\u59cb\u751f\u7522\u584a\u3002</p> <pre><code>stcd daemon\n</code></pre>"},{"location":"gateway/mainnet/#_11","title":"\u5206\u4eab\u4f60\u7684\u7bc0\u9ede","text":"<p>\u60a8\u53ef\u4ee5\u5728 Daodst Discord \u7684<code>#find-peers</code>\u983b\u9053\u4e2d\u5206\u4eab\u60a8\u7684\u540c\u4f34\u4e26\u5c07\u5176\u767c\u5e03\u3002</p> <p>\ud83d\udce3 \u63d0\u793a : \u8981\u7372\u53d6\u60a8\u7684\u7bc0\u9ede ID\uff0c\u8acb\u4f7f\u7528</p> <pre><code>stcd tendermint show-node-id\n</code></pre>"},{"location":"gateway/mainnet/#_12","title":"\u72c0\u614b\u540c\u6b65\u7bc0\u9ede","text":"<p>\u5982\u679c\u60a8\u60f3\u4f7f\u7528\u72c0\u614b\u540c\u6b65\u52a0\u5165\u7db2\u7d61\uff08\u5feb\u901f\uff0c\u4f46\u4e0d\u9069\u7528\u65bc\u5b58\u6a94\u7bc0\u9ede\uff09\uff0c\u8acb\u67e5\u770b\u6211\u5011\u7684\u72c0\u614b\u540c\u6b65 \u9801\u9762\u3002</p>"},{"location":"gateway/mempool/","title":"\u5167\u5b58\u6c60","text":"<p>\u4e86\u89e3 Tendermint \u4e2d\u53ef\u7528\u7684\u5167\u5b58\u6c60\u9078\u9805\u3002</p>"},{"location":"gateway/mempool/#_2","title":"\u5148\u9032\u5148\u51fa\u5167\u5b58\u6c60","text":"<p>\u5167\u5b58\u6c60\u6301\u6709\u672a\u63d0\u4ea4\u7684\u4ea4\u6613\uff0c\u9019\u4e9b\u4ea4\u6613\u5c1a\u672a\u5305\u542b\u5728\u5340\u584a\u4e2d\u3002 Tendermint \u5340\u584a\u93c8\u7684\u9ed8\u8a8d\u5167\u5b58\u6c60\u5be6\u73fe\u9075\u5faa\u5148\u9032\u5148\u51fa (FIFO) \u539f\u5247\uff0c\u9019\u610f\u5473\u8457\u4ea4\u6613\u7684\u9806\u5e8f\u50c5\u53d6\u6c7a\u65bc\u5b83\u5011\u5230\u9054\u7bc0\u9ede\u7684\u9806\u5e8f\u3002 \u6536\u5230\u7684\u7b2c\u4e00\u7b46\u4ea4\u6613\u5c07\u662f\u7b2c\u4e00\u7b46\u8981\u8655\u7406\u7684\u4ea4\u6613\u3002 \u9019\u9069\u7528\u65bc\u5c07\u6536\u5230\u7684\u4ea4\u6613\u516b\u5366\u7d66\u5176\u4ed6\u7bc0\u9ede\u4e26\u5c07\u5b83\u5011\u5305\u542b\u5728\u4e00\u500b\u584a\u4e2d\u3002</p>"},{"location":"gateway/mempool/#_3","title":"\u512a\u5148\u5167\u5b58\u6c60","text":"<p>\u5f9e Tendermint v0.35 \u958b\u59cb \uff08\u4e5f\u5df2\u53cd\u5411\u79fb\u690d\u5230 v0.34.20\uff09 \u53ef\u4ee5\u4f7f\u7528\u512a\u5148\u5167\u5b58\u6c60\u5be6\u73fe\u3002 \u9019\u5141\u8a31\u9a57\u8b49\u8005\u6839\u64da\u76f8\u95dc\u8cbb\u7528\u6216\u5176\u4ed6\u6fc0\u52f5\u6a5f\u5236\u9078\u64c7\u4ea4\u6613\u3002 \u5b83\u662f\u901a\u904e\u70ba\u6bcf\u500b <code>CheckTx</code> \u97ff\u61c9 \u50b3\u905e\u4e00\u500b <code>priority</code> \u5b57\u6bb5\u4f86\u5be6\u73fe\u7684\uff0c \u5b83\u5728\u4efb\u4f55\u8a66\u5716\u9032\u5165\u5167\u5b58\u6c60\u7684\u4ea4\u6613\u4e0a\u904b\u884c\u3002</p> <p>daodst \u901a\u904e\u5176\u652f\u6301 EIP-1559 EVM \u4ea4\u6613 \u3002 \u9019\u7a2e\u4ea4\u6613\u985e\u578b\u4f7f\u7528\u4e00\u500b\u57fa\u672c\u8cbb\u7528\u548c\u4e00\u500b\u53ef\u9078\u64c7\u7684\u512a\u5148\u63d0\u793a\uff0c\u5b83\u5011\u52a0\u8d77\u4f86\u5c31\u662f\u7e3d\u4ea4\u6613\u8cbb\u7528\u3002 \u512a\u5148\u5167\u5b58\u6c60\u63d0\u4f9b\u4e86\u4e00\u500b\u9078\u9805\uff0c\u53ef\u4ee5\u81ea\u52d5\u4f7f\u7528\u9019\u7a2e\u6a5f\u5236\u4f86\u751f\u6210\u584a\u3002</p> <p>\u7576\u4f7f\u7528\u512a\u5148\u5167\u5b58\u6c60\u6642\uff0c\u4e0b\u4e00\u500b\u751f\u6210\u584a\u7684\u4ea4\u6613\u6309\u7167\u512a\u5148\u7d1a\uff08\u5373\u8cbb\u7528\uff09\u5f9e\u9ad8\u5230\u4f4e\u7684\u9806\u5e8f\u9078\u64c7\u3002 \u5982\u679c mempool \u5df2\u6eff\uff0c\u512a\u5148\u7d1a\u5be6\u73fe\u5141\u8a31\u522a\u9664\u512a\u5148\u7d1a\u6700\u4f4e\u7684\u4ea4\u6613\uff0c\u76f4\u5230\u6709\u8db3\u5920\u7684\u78c1\u76e4\u7a7a\u9593\u53ef\u7528\u65bc\u50b3\u5165\u7684\u3001\u66f4\u9ad8\u512a\u5148\u7d1a\u7684\u4ea4\u6613\uff08\u53c3\u898b v1/mempool.go\u5be6\u73fe\u66f4\u591a\u7d30\u7bc0\uff09\u3002</p> <p>\ud83d\udce3 \u63d0\u793a\uff1a\u5118\u7ba1\u4e8b\u52d9\u8655\u7406\u53ef\u4ee5\u6309\u512a\u5148\u7d1a\u6392\u5e8f\uff0c\u4f46\u4e8b\u52d9\u7684\u516b\u5366\u5c07\u59cb\u7d42\u6309\u7167 FIFO \u9032\u884c\u3002</p>"},{"location":"gateway/mempool/#_4","title":"\u914d\u7f6e","text":"<p>\ud83d\udce3 \u63d0\u793a :  <code>$install_path</code> \u7528\u4f86\u8868\u793a\u60a8\u5b89\u88dd <code>stcd</code> \u4e8c\u9032\u88fd\u7a0b\u5e8f\u7684\u8def\u5f91</p> <p>\u8981\u4f7f\u7528\u512a\u5148\u5167\u5b58\u6c60\uff0c\u8acb\u5728 <code>$install_path/.stcd/config/config.toml</code> \u7684\u7bc0\u9ede\u914d\u7f6e\u4e2d\u8abf\u6574 <code>version = \"v1\"</code>\u3002 \u9ed8\u8a8d\u503c<code>v0</code>\u8868\u793a\u50b3\u7d71\u7684 FIFO \u5167\u5b58\u6c60\u3002</p> <p>\ud83d\udce3 \u63d0\u793a\uff1a\u8acb\u8a18\u4f4f\u91cd\u65b0\u555f\u52d5\u7bc0\u9ede\u4ee5\u4f7f\u66f4\u6539\u751f\u6548\u3002</p> <p>\u8acb\u5728\u6b64\u8655\u67e5\u770b <code>config.toml</code> \u7684\u76f8\u95dc\u6458\u9304\uff1a</p> <pre><code>#######################################################\n###          Mempool Configuration Option          ###\n#######################################################\n[mempool]\n\n# Mempool version to use:\n#   1) \"v0\" - (default) FIFO mempool.\n#   2) \"v1\" - prioritized mempool.\nversion = \"v1\"\n</code></pre>"},{"location":"gateway/mempool/#_5","title":"\u8cc7\u6e90","text":"<p>\u66f4\u8a73\u7d30\u7684\u4fe1\u606f\u53ef\u4ee5\u5f9e\u9019\u88e1\u627e\u5230\uff1a</p> <ul> <li>Tendermint ADR-067 - Mempool Refactor.</li> <li>Blogpost: Tendermint v0.35 Announcement</li> <li>EIP-1559: Fee market change for ETH 1.0 chain</li> <li>EIP-1559 FAQ</li> <li>Blogpost: What is EIP-1559? How will it change Ethereum?</li> </ul>"},{"location":"gateway/run/","title":"\u904b\u884c\u9a57\u8b49\u5668","text":"<p>\u4e86\u89e3\u5982\u4f55\u904b\u884c\u9a57\u8b49\u5668\u7bc0\u9ede\u3002</p>"},{"location":"gateway/run/#_2","title":"\u5148\u6c7a\u689d\u4ef6","text":"<ul> <li>\u9a57\u8b49\u5668\u6982\u8ff0</li> <li>\u9a57\u8b49\u5668\u5b89\u5168</li> </ul> <p>\ud83d\udce3 \u63d0\u793a\uff1a \u5982\u679c\u60a8\u8a08\u5283\u4f7f\u7528\u5bc6\u9470\u7ba1\u7406\u7cfb\u7d71 (KMS)\uff0c\u5247\u61c9\u9996\u5148\u5b8c\u6210\u4ee5\u4e0b\u6b65\u9a5f\uff1a\u4f7f\u7528 KMS\u3002</p>"},{"location":"gateway/run/#_3","title":"\u5275\u5efa\u4f60\u7684\u9a57\u8b49\u5668","text":"<p>\u60a8\u7684\u7bc0\u9ede\u5171\u8b58\u516c\u9470 (<code>dstvalconspub...</code>) \u53ef\u7528\u65bc\u901a\u904e\u62b5\u62bc FM \u4ee3\u5e63\u4f86\u5275\u5efa\u65b0\u7684\u9a57\u8b49\u5668\u3002\u60a8\u53ef\u4ee5\u901a\u904e\u904b\u884c\u4ee5\u4e0b\u547d\u4ee4\u627e\u5230\u60a8\u7684\u9a57\u8b49\u5668\u516c\u9470\uff1a</p> <pre><code>stcd tendermint show-validator\n</code></pre> <p>\ud83d\udea8 \u5371\u96aa\uff1a\u5207\u52ff\u4f7f\u7528 <code>test</code> \u9375\u63a7\u5f8c\u7aef\u5275\u5efa\u60a8\u7684\u4e3b\u7db2\u9a57\u8b49\u5668\u5bc6\u9470\u3002\u9019\u6a23\u505a\u53ef\u80fd\u6703\u5c0e\u81f4\u60a8\u7684\u8cc7\u91d1\u901a\u904e<code>eth_sendTransaction</code>JSON-RPC \u7aef\u9ede\u9060\u7a0b\u8a2a\u554f\uff0c\u5f9e\u800c\u5c0e\u81f4\u8cc7\u91d1\u640d\u5931\u3002</p> <p>Ref: \u5b89\u5168\u5efa\u8b70\uff1a\u4e0d\u5b89\u5168\u914d\u7f6e\u7684 geth \u53ef\u4ee5\u9060\u7a0b\u8a2a\u554f\u8cc7\u91d1</p> <p>\u8981\u5728\u6e2c\u8a66\u7db2\u4e0a\u5275\u5efa\u9a57\u8b49\u5668\uff0c\u53ea\u9700\u4f7f\u7528\u4ee5\u4e0b\u547d\u4ee4\uff1a</p> <pre><code>stcd tx staking create-validator \\\n  --amount=100000000000000000000dst \\\n  --pubkey=$(stcd tendermint show-validator) \\\n  --moniker=\"choose a moniker\" \\\n  --chain-id=&lt;chain_id&gt; \\\n  --commission-rate=\"0.05\" \\\n  --commission-max-rate=\"0.10\" \\\n  --commission-max-change-rate=\"0.01\" \\\n  --min-self-delegation=\"1000000\" \\\n  --gas=\"auto\" \\\n  --gas-prices=\"0.025dst\" \\\n  --from=&lt;key_name&gt;\n</code></pre> <p>\ud83d\udce3 \u63d0\u793a : \u6307\u5b9a\u4f63\u91d1\u53c3\u6578\u6642\uff0c<code>commission-max-change-rate</code> \u7528\u65bc\u8861\u91cf % point  \u76f8\u5c0d\u65bc <code>commission-rate</code> \u7684\u8b8a\u5316\u3002\u4f8b\u5982\u3002 1% \u5230 2% \u662f 100% \u7684\u589e\u9577\u7387\uff0c\u4f46\u53ea\u6709 1 \u500b\u767e\u5206\u9ede\u3002</p> <p>\ud83d\udce3 \u63d0\u793a :  <code>Min-self-delegation</code> \u662f\u4e00\u500b\u56b4\u683c\u7684\u6b63\u6574\u6578\uff0c\u8868\u793a\u60a8\u7684\u9a57\u8b49\u8005\u5fc5\u9808\u59cb\u7d42\u64c1\u6709\u7684\u6700\u5c0f\u81ea\u6211\u59d4\u8a17\u6295\u7968\u6b0a\u3002 <code>min-self-delegation</code> \u70ba <code>1000000000000000000</code> \u610f\u5473\u8457\u60a8\u7684\u9a57\u8b49\u8005\u7684\u81ea\u6211\u59d4\u8a17\u6c38\u9060\u4e0d\u80fd\u4f4e\u65bc <code>1 dst</code></p> <p>\u60a8\u53ef\u4ee5\u4f7f\u7528\u7b2c\u4e09\u65b9\u700f\u89bd\u5668\u78ba\u8a8d\u60a8\u5728\u9a57\u8b49\u4eba\u96c6\u4e2d\u3002</p>"},{"location":"gateway/run/#_4","title":"\u7de8\u8f2f\u9a57\u8b49\u5668\u8aaa\u660e","text":"<p>\u60a8\u53ef\u4ee5\u7de8\u8f2f\u9a57\u8b49\u5668\u7684\u516c\u958b\u63cf\u8ff0\u3002\u6b64\u4fe1\u606f\u7528\u65bc\u8b58\u5225\u60a8\u7684\u9a57\u8b49\u8005\uff0c\u59d4\u8a17\u4eba\u5c07\u6839\u64da\u9019\u4e9b\u4fe1\u606f\u4f86\u6c7a\u5b9a\u5411\u54ea\u4e9b\u9a57\u8b49\u8005\u4e0b\u6ce8\u3002\u78ba\u4fdd\u70ba\u4e0b\u9762\u7684\u6bcf\u500b\u6a19\u8a8c\u63d0\u4f9b\u8f38\u5165\u3002\u5982\u679c\u547d\u4ee4\u4e2d\u672a\u5305\u542b\u6a19\u8a8c\uff0c\u5247\u8a72\u5b57\u6bb5\u5c07\u9ed8\u8a8d\u70ba\u7a7a\uff08<code>--moniker</code> \u9ed8\u8a8d\u70ba\u6a5f\u5668\u540d\u7a31\uff09\uff0c\u5982\u679c\u8a72\u5b57\u6bb5\u5f9e\u672a\u8a2d\u7f6e\u904e\uff0c\u6216\u8005\u5982\u679c\u904e\u53bb\u8a2d\u7f6e\u904e\u5247\u4fdd\u6301\u4e0d\u8b8a\u3002</p> <p> \u6307\u5b9a\u60a8\u6b63\u5728\u7de8\u8f2f\u7684\u9a57\u8b49\u5668\u3002\u5982\u679c\u60a8\u9078\u64c7\u4e0d\u5305\u542b\u67d0\u4e9b\u6a19\u8a8c\uff0c\u8acb\u8a18\u4f4f\u5fc5\u9808\u5305\u542b --from \u6a19\u8a8c\u4ee5\u6a19\u8b58\u8981\u66f4\u65b0\u7684\u9a57\u8b49\u5668\u3002 <p><code>--identity</code> \u53ef\u7528\u65bc\u901a\u904e Keybase \u6216 UPort \u7b49\u7cfb\u7d71\u9a57\u8b49\u8eab\u4efd\u3002\u8207 Keybase \u4e00\u8d77\u4f7f\u7528\u6642\uff0c\u61c9\u4f7f\u7528 keybase.io \u5e33\u6236\u751f\u6210\u7684 16 \u4f4d\u5b57\u7b26\u4e32\u586b\u5145 <code>--identity</code>\u3002\u9019\u662f\u4e00\u7a2e\u8de8\u591a\u500b\u5728\u7dda\u7db2\u7d61\u9a57\u8b49\u60a8\u8eab\u4efd\u7684\u52a0\u5bc6\u5b89\u5168\u65b9\u6cd5\u3002 Keybase API \u5141\u8a31\u6211\u5011\u6aa2\u7d22\u60a8\u7684 Keybase \u982d\u50cf\u3002\u9019\u5c31\u662f\u60a8\u53ef\u4ee5\u5c07\u5fbd\u6a19\u6dfb\u52a0\u5230\u9a57\u8b49\u5668\u914d\u7f6e\u6587\u4ef6\u7684\u65b9\u6cd5\u3002</p> <pre><code>stcd tx staking edit-validator\n  --moniker=\"choose a moniker\" \\\n  --website=\"https://daodst.com\" \\\n  --identity=6A0D65E29A4CBC8E \\\n  --details=\"To infinity and beyond!\" \\\n  --chain-id=&lt;chain_id&gt; \\\n  --gas=\"auto\" \\\n  --gas-prices=\"0.025dst\" \\\n  --from=&lt;key_name&gt; \\\n  --commission-rate=\"0.10\"\n</code></pre> <p>\u26a0\ufe0f\u6ce8\u610f:<code>commission-rate</code> \u503c\u5fc5\u9808\u9075\u5b88\u4ee5\u4e0b\u8981\u6c42\uff1a</p> <ul> <li>\u5fc5\u9808\u5728 0 \u548c\u9a57\u8b49\u8005\u7684 <code>commission-max-rate</code> \u4e4b\u9593</li> <li>\u4e0d\u5f97\u8d85\u904e\u9a57\u8b49\u8005\u7684 <code>commission-max-change-rate</code>\uff0c\u9019\u662f\u6bcf\u5929\u7684\u6700\u5927\u767e\u5206\u6bd4\u8b8a\u5316\u7387\u3002\u63db\u53e5\u8a71\u8aaa\uff0c\u9a57\u8b49\u8005\u6bcf\u5929\u53ea\u80fd\u5728<code>commission-max-change-rate</code> \u7bc4\u570d\u5167\u66f4\u6539\u5176\u4f63\u91d1\u4e00\u6b21\u3002</li> </ul>"},{"location":"gateway/run/#_5","title":"\u67e5\u770b\u9a57\u8b49\u5668\u8aaa\u660e","text":"<p>\u4f7f\u7528\u6b64\u547d\u4ee4\u67e5\u770b\u9a57\u8b49\u5668\u7684\u4fe1\u606f\uff1a</p> <pre><code>stcd query staking validator &lt;account_cosmos&gt;\n</code></pre>"},{"location":"gateway/run/#signing-info","title":"signing-info \u8ddf\u8e2a\u9a57\u8b49\u5668\u7c3d\u540d\u4fe1\u606f","text":"<p>\u70ba\u4e86\u8ddf\u8e2a\u904e\u53bb\u9a57\u8b49\u5668\u7684\u7c3d\u540d\uff0c\u60a8\u53ef\u4ee5\u4f7f\u7528 <code>signing-info</code> \u547d\u4ee4\uff1a</p> <pre><code>stcd query slashing signing-info &lt;validator-pubkey&gt;\\\n  --chain-id=&lt;chain_id&gt;\n</code></pre>"},{"location":"gateway/run/#unjail","title":"unjail \u89e3\u7981\u9a57\u8b49\u5668","text":"<p>\u7576\u9a57\u8b49\u8005\u56e0\u505c\u6a5f\u800c\u201c\u5165\u7344\u201d\u6642\uff0c\u60a8\u5fc5\u9808\u5f9e\u904b\u71df\u5546\u8cec\u6236\u63d0\u4ea4 <code>Unjail</code> \u4ea4\u6613\uff0c\u4ee5\u4fbf\u80fd\u5920\u518d\u6b21\u7372\u5f97\u5340\u584a\u63d0\u8b70\u8005\u734e\u52f5\uff08\u53d6\u6c7a\u65bc\u5340\u57df\u8cbb\u7528\u5206\u914d\uff09\u3002</p> <pre><code>stcd tx slashing unjail \\\n  --from=&lt;key_name&gt; \\\n  --chain-id=&lt;chain_id&gt;\n</code></pre>"},{"location":"gateway/run/#_6","title":"\u78ba\u8a8d\u60a8\u7684\u9a57\u8b49\u5668\u6b63\u5728\u904b\u884c","text":"<p>\u5982\u679c\u4ee5\u4e0b\u547d\u4ee4\u8fd4\u56de\u4efb\u4f55\u5167\u5bb9\uff0c\u5247\u60a8\u7684\u9a57\u8b49\u5668\u8655\u65bc\u6d3b\u52d5\u72c0\u614b\uff1a</p> <pre><code>stcd query tendermint-validator-set | grep \"$(stcd tendermint show-address)\"\n</code></pre> <p>\ud83d\udce3 \u63d0\u793a :  <code>$install_path</code> \u7528\u4f86\u8868\u793a\u60a8\u5b89\u88dd <code>stcd</code> \u4e8c\u9032\u88fd\u7a0b\u5e8f\u7684\u8def\u5f91</p> <p>\u60a8\u73fe\u5728\u61c9\u8a72\u53ef\u4ee5\u5728\u5176\u4e2d\u4e00\u500b Daodst \u700f\u89bd\u5668\u4e2d\u770b\u5230\u60a8\u7684\u9a57\u8b49\u5668\u3002\u60a8\u6b63\u5728\u5c0b\u627e <code>$install_path/.stcd/config/priv_validator.json</code> \u6587\u4ef6\u4e2d\u7684 <code>bech32</code> \u7de8\u78bc\u7684 <code>address</code>\u3002</p> <p>\u26a0\ufe0f\u6ce8\u610f \u8981\u9032\u5165\u9a57\u8b49\u8005\u96c6\u5408\uff0c\u60a8\u9700\u8981\u64c1\u6709\u6bd4\u7b2c 100 \u500b\u9a57\u8b49\u8005\u66f4\u591a\u7684\u7e3d\u6295\u7968\u6b0a\u3002</p>"},{"location":"gateway/run/#_7","title":"\u505c\u6b62\u4f60\u7684\u9a57\u8b49\u5668","text":"<p>\u7576\u5617\u8a66\u57f7\u884c\u4f8b\u884c\u7dad\u8b77\u6216\u8a08\u5283\u5373\u5c07\u9032\u884c\u7684\u5354\u8abf\u5347\u7d1a\u6642\uff0c\u8b93\u60a8\u7684\u9a57\u8b49\u5668\u7cfb\u7d71\u5730\u3001\u512a\u96c5\u5730\u505c\u6b62\u662f\u5f88\u6709\u7528\u7684\u3002</p> <p>\u60a8\u53ef\u4ee5\u901a\u904e\u5c07 <code>halt-height</code> \u8a2d\u7f6e\u70ba\u60a8\u5e0c\u671b\u7bc0\u9ede\u95dc\u9589\u7684\u9ad8\u5ea6\u6216\u5c07 <code>--halt-height</code> \u6a19\u8a8c\u50b3\u905e\u7d66 <code>stcd</code> \u4f86\u5be6\u73fe\u6b64\u76ee\u7684\u3002</p> <p>\u63d0\u4ea4\u584a\u5f8c\uff0c\u7bc0\u9ede\u5c07\u5728\u7d66\u5b9a\u9ad8\u5ea6\u4ee5\u96f6\u9000\u51fa\u4ee3\u78bc\u95dc\u9589\u3002</p>"},{"location":"gateway/run/#_8","title":"\u5e38\u898b\u554f\u984c","text":""},{"location":"gateway/run/#1-voting_power-0","title":"\u554f\u984c #1\uff1a\u6211\u7684\u9a57\u8b49\u5668\u662f <code>voting_power: 0</code>","text":"<p>\u60a8\u7684\u9a57\u8b49\u8005\u5df2\u5165\u7344\u3002\u5982\u679c\u9a57\u8b49\u8005\u4e0d\u5c0d\u6700\u5f8c<code>10000</code>\u584a\u4e2d\u7684<code>500</code>\u9032\u884c\u6295\u7968\uff0c\u6216\u8005\u5982\u679c\u4ed6\u5011\u96d9\u91cd\u7c3d\u540d\uff0c\u9a57\u8b49\u8005\u5c07\u88ab\u76e3\u7981\uff0c\u5373\u5f9e\u6d3b\u52d5\u9a57\u8b49\u8005\u96c6\u5408\u4e2d\u79fb\u9664\u3002</p> <p>\u5982\u679c\u60a8\u56e0\u505c\u6a5f\u800c\u5165\u7344\uff0c\u60a8\u53ef\u4ee5\u5c07\u60a8\u7684\u6295\u7968\u6b0a\u9084\u7d66\u60a8\u7684\u9a57\u8b49\u8005\u3002\u9996\u5148\uff0c\u5982\u679c <code>stcd</code> \u6c92\u6709\u904b\u884c\uff0c\u8acb\u91cd\u65b0\u555f\u52d5\u5b83\uff1a</p> <pre><code>stcd daemon\n</code></pre> <p>\u7b49\u5f85\u4f60\u7684\u5168\u7bc0\u9ede\u8d95\u4e0a\u6700\u65b0\u7684\u5340\u584a\u3002\u7136\u5f8c\uff0c\u60a8\u53ef\u4ee5 \u89e3\u7981\u60a8\u7684\u9a57\u8b49\u5668 \u6700\u5f8c\uff0c\u518d\u6b21\u6aa2\u67e5\u60a8\u7684\u9a57\u8b49\u5668\uff0c\u770b\u770b\u60a8\u7684\u6295\u7968\u6b0a\u662f\u5426\u6062\u5fa9\u3002</p> <pre><code>stcd status\n</code></pre> <p>\u60a8\u53ef\u80fd\u6703\u6ce8\u610f\u5230\u60a8\u7684\u6295\u7968\u6b0a\u6bd4\u4ee5\u524d\u5c11\u4e86\u3002\u90a3\u662f\u56e0\u70ba\u4f60\u56e0\u505c\u6a5f\u800c\u88ab\u524a\u6e1b\u4e86\uff01</p>"},{"location":"gateway/run/#2too-many-open-files","title":"\u554f\u984c #2\uff1a\u6211\u7684\u7bc0\u9ede\u56e0\u70ba<code>too many open files</code>\u800c\u5d29\u6f70","text":"<p>Linux \u53ef\u4ee5\u6253\u958b\u7684\u9ed8\u8a8d\u6587\u4ef6\u6578\uff08\u6bcf\u500b\u9032\u7a0b\uff09\u662f<code>1024</code>\u3002\u773e\u6240\u5468\u77e5\uff0c<code>stcd</code> \u53ef\u4ee5\u6253\u958b\u8d85\u904e <code>1024</code> \u500b\u6587\u4ef6\u3002 \u9019\u6703\u5c0e\u81f4\u9032\u7a0b\u5d29\u6f70\u3002\u5feb\u901f\u4fee\u5fa9\u662f\u904b\u884c <code>ulimit -n 40960</code>\uff08\u589e\u52a0\u5141\u8a31\u6253\u958b\u7684\u6587\u4ef6\u6578\uff09\uff0c\u7136\u5f8c\u4f7f\u7528 <code>stcd daemon</code> \u91cd\u65b0\u555f\u52d5\u9032\u7a0b\u3002 \u5982\u679c\u60a8\u4f7f\u7528 <code>systemd</code> \u6216\u5176\u4ed6\u9032\u7a0b\u7ba1\u7406\u5668\u4f86\u555f\u52d5 <code>stcd</code>\uff0c\u9019\u53ef\u80fd\u9700\u8981\u5728\u8a72\u7d1a\u5225\u9032\u884c\u4e00\u4e9b\u914d\u7f6e\u3002 \u4fee\u5fa9\u6b64\u554f\u984c\u7684\u793a\u4f8b<code>systemd</code>\u6587\u4ef6\u5982\u4e0b\uff1a</p> <pre><code># /etc/systemd/system/stcd.service\n[Unit]\nDescription=Daodst Chain Node\nAfter=network.target\n\n[Service]\nType=simple\nUser=ubuntu\nWorkingDirectory=/home/ubuntu\nExecStart=/home/ubuntu/go/bin/stcd start\nRestart=on-failure\nRestartSec=3\nLimitNOFILE=4096\n\n[Install]\nWantedBy=multi-user.target\n</code></pre>"},{"location":"gateway/security/","title":"\u9a57\u8b49\u5668\u5b89\u5168\u6aa2\u67e5\u8868","text":"<p>\u5728\u4e0b\u9762\u627e\u5230\u4e00\u500b\u5b89\u5168\u6aa2\u67e5\u8868\u8abf\u67e5\uff0c\u4ee5\u9032\u884c\u9a57\u8b49\u5668\u7684\u5b89\u5168\u6e2c\u91cf\u3002 \u5c0d\u8a17\u7ba1\u7406\u6578\u64da\u4e2d\u5fc3\u548c\u7bc0\u9ede\u8a2d\u7f6e\u9032\u884c\u8abf\u67e5\uff0c\u4e26\u5c07\u60a8\u7684\u7d50\u679c\u8207\u4e0b\u9762\u5efa\u8b70\u7684\u6700\u4f73\u5be6\u8e10\u9032\u884c\u6bd4\u8f03\u3002</p>"},{"location":"gateway/security/#_2","title":"\u8a17\u7ba1\u6578\u64da\u4e2d\u5fc3\u7684\u4e00\u822c\u63a7\u5236","text":"\u63a7\u5236\u985e \u6700\u4f73\u5be6\u8e10\u8aaa\u660e \u6578\u64da\u4e2d\u5fc3 \u5197\u9918\u96fb\u6e90 \u6578\u64da\u4e2d\u5fc3 \u5197\u9918\u51b7\u537b \u6578\u64da\u4e2d\u5fc3 \u5197\u9918\u7db2\u7d61 \u6578\u64da\u4e2d\u5fc3 \u7269\u7406\u7c60\u5b50/\u9580\u63a7\u8a2a\u554f \u6578\u64da\u4e2d\u5fc3 \u9060\u7a0b\u8b66\u5831\u5b89\u5168\u651d\u50cf\u982d"},{"location":"gateway/security/#_3","title":"\u7bc0\u9ede\u8a2d\u7f6e","text":"\u63a7\u5236\u985e \u6700\u4f73\u5be6\u8e10\u8aaa\u660e \u4e00\u822c\u7cfb\u7d71\u5b89\u5168 \u64cd\u4f5c\u7cfb\u7d71\u5df2\u9069\u7576\u4fee\u88dc\u3002\u5167\u6838\u66f4\u65b0\u5230\u6700\u65b0\u7684\u7a69\u5b9a\u7248\u672c. \u7bc0\u9ede\u8981\u904b\u884c\u5728x86_64\u74b0\u5883\u4e0b \u4e00\u822c\u7cfb\u7d71\u5b89\u5168 \u914d\u7f6e\u4e86\u64cd\u4f5c\u7cfb\u7d71\u7684\u81ea\u52d5\u66f4\u65b0\u3002\u5b58\u5728\u7528\u65bc\u81ea\u52d5\u5347\u7d1a\u7684\u5de5\u5177\u5305\uff08\u4f8b\u5982 auter\u3001yum-cron\u3001dnf-automatic\u3001unattended-upgrades\uff09 \u4e00\u822c\u7cfb\u7d71\u5b89\u5168 \u555f\u7528\u548c\u57f7\u884c\u5b89\u5168\u6846\u67b6\u3002 SELinux / AppArmor / Tomoyo / Grsecurity \u5df2\u555f\u7528\u3002 \u4e00\u822c\u7cfb\u7d71\u5b89\u5168 \u6c92\u6709\u5b89\u88dd\u4e0d\u5b89\u5168\u548c\u4e0d\u5fc5\u8981\u7684\u670d\u52d9\u3002 \uff08\u4f8b\u5982 telnet\u3001rsh\u3001inetd \u7b49... \u4e00\u822c\u7cfb\u7d71\u5b89\u5168 GRUB \u5f15\u5c0e\u88dd\u8f09\u7a0b\u5e8f\u5bc6\u78bc\u5df2\u914d\u7f6e\u3002 Grub2 \u914d\u7f6e\u5bc6\u78bc \u4e00\u822c\u7cfb\u7d71\u5b89\u5168 \u53ea\u6709\u6838\u5fc3\u7cfb\u7d71\u6587\u4ef6\u7684root\u6b0a\u9650 \u6587\u4ef6\u76ee\u9304\u5b89\u5168 \u78ba\u4fdd\u76ee\u9304\u201c~/.stcd\u201d\u50c5\u4f9b\u5f52\u5c5e\u8005\u8a2a\u554f \u4e8c\u9032\u88fd\u914d\u7f6e \u70ba\u6027\u80fd\u548c\u5b89\u5168\u6027\u63a8\u85a6 config.toml \u4e2d\u7684\u4ee5\u4e0b\u8a2d\u7f6e - \u5c0d\u65bc sentry \u7bc0\u9ede\uff1a<code>max_num_inbound_peers = 500, max_num_outbound_peers = 50, flush_throttle_timeout = \"300ms\"</code> - \u5c0d\u65bc validator \u7bc0\u9ede\uff1a<code>max_num_inbound_peers = 100 , max_num_outbound_peers = 10, flush_throttle_timeout = \"100ms\"</code> \u5e33\u6236\u5b89\u5168\u548c\u9060\u7a0b\u8a2a\u554f \u5f37\u5236\u57f7\u884c\u4ee5\u4e0b\u5bc6\u78bc\u7b56\u7565\uff1a\u6c92\u6709\u7a7a\u767d\u5bc6\u78bc\uff1b\u4e0d\u5141\u8a31\u4f7f\u7528\u5f31\u5bc6\u78bc \u5e33\u6236\u5b89\u5168\u548c\u9060\u7a0b\u8a2a\u554f \u555f\u7528\u4ee5\u4e0b SSH \u914d\u7f6e\uff1aPermitRootLogin: <code>no</code>; PasswordAuthentication <code>no</code>; ChallengeResponseAuthentication <code>no</code>;\u4f7f\u7528PAM <code>yes</code>; AllowUsers <code>\u50c5\u9650\u5fc5\u8981\u7684\u7528\u6236</code>\uff1b AllowGroups <code>\u50c5\u9650\u5fc5\u8981\u7684\u7d44</code>\u3002 \u806f\u7db2 \u4f7f\u7528 speedtest \u9032\u884c\u7db2\u7d61\u541e\u5410\u91cf\u6e2c\u8a66\u3002\u5efa\u8b70\u4e0a\u50b3\u901f\u5ea6\u81f3\u5c11\u70ba 5 Mbps\uff0c\u4e0b\u8f09\u901f\u5ea6\u81f3\u5c11\u70ba 5 Mbps\uff09 \u806f\u7db2 \u555f\u7528\u57fa\u65bc\u4e3b\u6a5f\uff08\u4f8b\u5982 iptables\uff09\u6216\u57fa\u65bc\u96f2\uff08\u4f8b\u5982 AWS \u5b89\u5168\u7d44\uff09\u7684\u9632\u706b\u7246\u4f86\u4fdd\u8b77\u6240\u6709\u76f8\u95dc\u7bc0\u9ede\u3002\u9060\u7a0b\u7ba1\u7406\u7aef\u53e3\uff08\u4f8b\u5982 SSH - TCP 22\uff09\u61c9\u8a72\u53ea\u66b4\u9732\u7d66\u9078\u5b9a\u7684 IP \u800c\u4e0d\u662f\u4e92\u806f\u7db2\u3002\u4e0d\u61c9\u8a2d\u7f6e\u904e\u65bc\u5bec\u9b06\u7684\u898f\u5247\uff08\u4f8b\u5982\uff0c\u5141\u8a31\u7684\u7aef\u53e3\u7bc4\u570d\u5f88\u5ee3 1-65535\uff09\u3002\u5c0d\u65bc\u7bc0\u9ede\u4e4b\u9593\u7684\u5167\u90e8\u901a\u4fe1\u901a\u9053\uff0c\u5b83\u5011\u61c9\u8a72\u8a2d\u7f6e\u6709\u7279\u5b9a\u7684\u6e90\u5730\u5740\u548c\u76ee\u7684\u5730\u5740\u3002\u5c0d\u65bc Internet \u53ef\u9054\u7bc0\u9ede\uff0c\u5982\u679c\u53ef\u80fd\uff0c\u5c07 TCP 26656 \u8a2d\u7f6e\u70ba\u552f\u4e00\u7684\u50b3\u5165\u7aef\u53e3\u3002 \u806f\u7db2 \u5b89\u88dd\u4e26\u57f7\u884c\u5165\u4fb5\u6aa2\u6e2c/\u9810\u9632\u7cfb\u7d71\uff08\u4f8b\u5982 Fail2Ban\u3001Snort\u3001OSSEC\uff09 \u806f\u7db2 \u8a2d\u7f6e\u54e8\u5175\u7bc0\u9ede\u67b6\u69cb\u4ee5\u4fdd\u8b77\u9a57\u8b49\u7bc0\u9ede\uff0c\u4e26\u8a2d\u7f6e\u9632\u706b\u7246\u898f\u5247\u4ee5\u9650\u5236\u5c0d\u5176\u7684\u76f4\u63a5\u4e92\u806f\u7db2\u8a2a\u554f\u3002 \u806f\u7db2 \u9060\u7a0b\u904e\u7a0b\u8abf\u7528 (RPC) \u63d0\u4f9b\u4e0d\u61c9\u66b4\u9732\u5728 Internet \u4e0a\u7684\u654f\u611f\u64cd\u4f5c\u548c\u4fe1\u606f\u3002\u9ed8\u8a8d\u60c5\u6cc1\u4e0b\uff0cRPC \u8655\u65bc\u6253\u958b\u72c0\u614b\u4e26\u4e14\u50c5\u5141\u8a31\u4f86\u81ea <code>127.0.0.1</code> \u7684\u9023\u63a5\u3002\u5982\u679c\u60a8\u9700\u8981\u5141\u8a31\u4f86\u81ea\u5176\u4ed6 IP \u5730\u5740\u7684 RPC\uff0c\u8acb\u683c\u5916\u5c0f\u5fc3\u3002 \u5197\u9918 \u71b1\u5099\u7bc0\u9ede\u8a2d\u7f6e\u8207\u4e3b\u7bc0\u9ede\u76f8\u540c\u7684\u914d\u7f6e \u5197\u9918 \u8a2d\u7f6e\u7cfb\u7d71\u76e3\u63a7\u548c\u8b66\u5831\u4ee5\u63d0\u9192\u6240\u6709\u8005\u7570\u5e38\u60c5\u6cc1 \u5bc6\u9470\u7ba1\u7406 \u4f7f\u7528 HSM \u6216\u7b49\u6548\u7684\u5728\u7dda\u670d\u52d9\u8a2d\u7f6e Tendermint KMS\uff0c\u5b83\u61c9\u8a72\u66ff\u63db\u975c\u614b\u5bc6\u9470\u6587\u4ef6\u3002 DDOS \u6839\u64da\u54e8\u5175\u67b6\u69cb\u8a2d\u7f6e\u9a57\u8b49\u5668\u3002\u8acb\u53c3\u8003\u8a2d\u7f6e\u8aaa\u660e\u548c\u8a73\u7d30\u8aaa\u660e\u3002"},{"location":"gateway/state-sync/","title":"\u72c0\u614b\u540c\u6b65","text":"<p>\u4e86\u89e3 Cosmos SDK \u63d0\u4f9b\u7684 Tendermint Core \u72c0\u614b\u540c\u6b65\u548c\u652f\u6301\u3002</p> <p>\ud83d\udce3 \u63d0\u793a : \u53ea\u662f\u95dc\u5fc3\u5982\u4f55\u5c07\u7bc0\u9ede\u8207\u7db2\u7d61\u540c\u6b65\uff1f\u8df3\u5230 \u672c\u7bc0\u3002</p>"},{"location":"gateway/state-sync/#tendermint","title":"Tendermint \u6838\u5fc3\u72c0\u614b\u540c\u6b65","text":"<p>\u72c0\u614b\u540c\u6b65\u5141\u8a31\u65b0\u7bc0\u9ede\u901a\u904e\u7372\u53d6\u6700\u8fd1\u9ad8\u5ea6\u7684\u7db2\u7d61\u72c0\u614b\u5feb\u7167\u4f86\u52a0\u5165\u7db2\u7d61\uff0c\u800c\u4e0d\u662f\u7372\u53d6\u548c\u91cd\u64ad\u6240\u6709\u6b77\u53f2\u584a\u3002 \u7531\u65bc\u61c9\u7528\u7a0b\u5e8f\u72c0\u614b\u5c0f\u65bc\u6240\u6709\u584a\u7684\u7d44\u5408\uff0c\u4e26\u4e14\u6062\u5fa9\u72c0\u614b\u6bd4\u91cd\u653e\u584a\u66f4\u5feb\uff0c\u9019\u5c07\u8207\u7db2\u7d61\u540c\u6b65\u7684\u6642\u9593\u5f9e\u5e7e\u5929\u7e2e\u77ed\u5230\u5e7e\u5206\u9418\u3002</p> <p>\u672c\u6587\u6a94\u7684\u9019\u4e00\u90e8\u5206\u7c21\u8981\u6982\u8ff0\u4e86 Tendermint \u72c0\u614b\u540c\u6b65\u5354\u8b70\uff0c\u4ee5\u53ca\u5982\u4f55\u540c\u6b65\u7bc0\u9ede\u3002 \u6709\u95dc\u66f4\u591a\u8a73\u7d30\u4fe1\u606f\uff0c\u8acb\u53c3\u95b1 ABCI \u61c9\u7528\u6307\u5357 \u548c ABCI \u53c3\u8003\u6587\u6a94\u3002</p>"},{"location":"gateway/state-sync/#_2","title":"\u72c0\u614b\u540c\u6b65\u5feb\u7167","text":"<p>\u8a2d\u8a08 Tendermint \u72c0\u614b\u540c\u6b65\u6642\u7684\u6307\u5c0e\u539f\u5247\u662f\u70ba\u61c9\u7528\u7a0b\u5e8f\u63d0\u4f9b\u76e1\u53ef\u80fd\u591a\u7684\u9748\u6d3b\u6027\u3002\u56e0\u6b64\uff0cTendermint \u4e0d\u95dc\u5fc3\u5feb\u7167\u5305\u542b\u4ec0\u9ebc\u3001\u5b83\u5011\u662f\u5982\u4f55\u62cd\u651d\u7684\u6216\u5b83\u5011\u662f\u5982\u4f55\u6062\u5fa9\u7684\u3002\u5b83\u53ea\u95dc\u5fc3\u767c\u73fe\u7db2\u7d61\u4e2d\u7684\u73fe\u6709\u5feb\u7167\u3001\u7372\u53d6\u5b83\u5011\u4e26\u901a\u904e ABCI \u5c07\u5b83\u5011\u50b3\u905e\u7d66\u61c9\u7528\u7a0b\u5e8f\u3002</p> <p>Tendermint \u4f7f\u7528\u8f15\u5ba2\u6236\u7aef\u9a57\u8b49\u4f86\u6aa2\u67e5\u5df2\u6062\u5fa9\u61c9\u7528\u7a0b\u5e8f\u7684\u6700\u7d42\u61c9\u7528\u7a0b\u5e8f\u54c8\u5e0c\u503c\u8207\u93c8\u61c9\u7528\u7a0b\u5e8f\u54c8\u5e0c\u503c\u7684\u5c0d\u6bd4\uff0c\u4f46\u4efb\u4f55\u9032\u4e00\u6b65\u7684\u9a57\u8b49\u90fd\u5fc5\u9808\u5728\u6062\u5fa9\u904e\u7a0b\u4e2d\u7531\u61c9\u7528\u7a0b\u5e8f\u672c\u8eab\u5b8c\u6210\u3002</p> <p>\u5feb\u7167\u7531\u4efb\u610f\u683c\u5f0f\u7684\u4e8c\u9032\u5236\u584a\u7d44\u6210\u3002\u584a\u4e0d\u80fd\u5927\u65bc 16 MB\uff0c\u5426\u5247\u6c92\u6709\u9650\u5236\u3002 \u5feb\u7167\u5143\u6578\u64da\uff0c\u901a\u904e ABCI \u548c P2P \u4ea4\u63db\uff0c\u5305\u542b\u4ee5\u4e0b\u5b57\u6bb5\uff1a</p> <ul> <li><code>height</code> (<code>uint64</code>): \u62cd\u651d\u5feb\u7167\u7684\u9ad8\u5ea6</li> <li><code>format</code> (<code>uint32</code>)\uff1a\u4efb\u610f\u7279\u5b9a\u65bc\u61c9\u7528\u7a0b\u5e8f\u7684\u683c\u5f0f\u6a19\u8b58\u7b26\uff08\u4f8b\u5982\u7248\u672c\uff09</li> <li><code>chunks</code> (<code>uint32</code>): \u5feb\u7167\u4e2d\u4e8c\u9032\u5236\u584a\u7684\u6578\u91cf</li> <li><code>hash</code> (<code>bytes</code>): \u7528\u65bc\u8de8\u7bc0\u9ede\u6bd4\u8f03\u5feb\u7167\u7684\u4efb\u610f\u5feb\u7167\u54c8\u5e0c</li> <li><code>metadata</code> (<code>bytes</code>)\uff1a\u4f9b\u61c9\u7528\u7a0b\u5e8f\u4f7f\u7528\u7684\u4efb\u610f\u4e8c\u9032\u5236\u5feb\u7167\u5143\u6578\u64da</li> </ul> <p><code>format</code> \u5b57\u6bb5\u5141\u8a31\u61c9\u7528\u7a0b\u5e8f\u4ee5\u5411\u5f8c\u517c\u5bb9\u7684\u65b9\u5f0f\u66f4\u6539\u5176\u5feb\u7167\u683c\u5f0f\uff0c\u65b9\u6cd5\u662f\u63d0\u4f9b\u591a\u7a2e\u683c\u5f0f\u7684\u5feb\u7167\uff0c\u4e26\u9078\u64c7\u5728\u6062\u5fa9\u671f\u9593\u63a5\u53d7\u54ea\u4e9b\u683c\u5f0f\u3002</p> <p>\u4f8b\u5982\uff0c\u9019\u5728\u66f4\u6539\u5e8f\u5217\u5316\u6216\u58d3\u7e2e\u683c\u5f0f\u6642\u5f88\u6709\u7528\uff1a\u56e0\u70ba\u7bc0\u9ede\u53ef\u80fd\u80fd\u5920\u5411\u904b\u884c\u820a\u7248\u672c\u7684\u7bc0\u9ede\u63d0\u4f9b\u5feb\u7167\uff0c\u6216\u8005\u5728\u4f7f\u7528\u8f03\u65b0\u7248\u672c\u555f\u52d5\u6642\u4f7f\u7528\u820a\u5feb\u7167\u3002</p> <p><code>hash</code> \u5b57\u6bb5\u5305\u542b\u4efb\u610f\u5feb\u7167\u54c8\u5e0c\u3002\u8de8\u7bc0\u9ede\u5177\u6709\u76f8\u540c <code>metadata</code> \u5b57\u6bb5\uff08\u5305\u62ec <code>hash</code>\uff09\u7684\u5feb\u7167\u88ab\u8a8d\u70ba\u662f\u76f8\u540c\u7684\uff0c\u4e26\u4e14\u5c07\u5f9e\u9019\u4e9b\u7bc0\u9ede\u4e2d\u7684\u4efb\u4f55\u4e00\u500b\u7372\u53d6 <code>chunks</code>\u3002</p> <p><code>hash</code> \u4e0d\u53ef\u4fe1\u4efb\uff0c\u4e26\u4e14\u672a\u7d93 Tendermint \u672c\u8eab\u9a57\u8b49\uff0c\u9019\u53ef\u4ee5\u9632\u6b62\u5feb\u7167\u751f\u6210\u4e2d\u7684\u7121\u610f\u4e0d\u78ba\u5b9a\u6027\u3002</p> <p><code>hash</code> \u53ef\u4ee5\u6539\u70ba\u7531\u61c9\u7528\u7a0b\u5e8f\u9a57\u8b49\u3002</p> <p><code>metadata</code> \u5b57\u6bb5\u53ef\u4ee5\u5305\u542b\u61c9\u7528\u7a0b\u5e8f\u6240\u9700\u7684\u4efb\u4f55\u4efb\u610f\u5143\u6578\u64da\u3002 \u4f8b\u5982\uff0c\u61c9\u7528\u7a0b\u5e8f\u53ef\u80fd\u5e0c\u671b\u5305\u542b\u584a\u6821\u9a57\u548c\u4ee5\u4e1f\u68c4\u640d\u58de\u7684<code>chunks</code>\uff0c\u6216 Merkle \u8b49\u660e \u6839\u64da\u93c8\u61c9\u7528\u7a0b\u5e8f\u54c8\u5e0c\u5206\u5225\u9a57\u8b49\u6bcf\u500b\u584a\u3002 \u5728 Protobuf \u7de8\u78bc\u5f62\u5f0f\u4e2d\uff0c\u5feb\u7167 <code>metadata</code> \u6d88\u606f\u4e0d\u80fd\u8d85\u904e 4 MB\u3002</p>"},{"location":"gateway/state-sync/#_3","title":"\u62cd\u651d\u3001\u63d0\u4f9b\u5feb\u7167","text":"<p>\u8981\u555f\u7528\u72c0\u614b\u540c\u6b65\uff0c\u7db2\u7d61\u4e2d\u7684\u67d0\u4e9b\u7bc0\u9ede\u5fc5\u9808\u62cd\u651d\u4e26\u63d0\u4f9b\u5feb\u7167\u3002 \u7576\u5c0d\u7b49\u9ede\u5617\u8a66\u72c0\u614b\u540c\u6b65\u6642\uff0c\u73fe\u6709\u7684 Tendermint \u7bc0\u9ede\u5c07\u5728\u61c9\u7528\u7a0b\u5e8f\u4e0a\u8abf\u7528\u4ee5\u4e0b ABCI \u65b9\u6cd5\u4ee5\u5411\u8a72\u5c0d\u7b49\u9ede\u63d0\u4f9b\u5feb\u7167\u6578\u64da\uff1a</p> <ul> <li><code>ListSnapshots</code>\uff1a\u8fd4\u56de\u53ef\u7528\u5feb\u7167\u5217\u8868\uff0c\u4ee5\u53ca\u5143\u6578\u64da</li> <li><code>LoadSnapshotChunk</code>\uff1a\u8fd4\u56de\u4e8c\u9032\u5236\u584a\u6578\u64da</li> </ul> <p>\u5feb\u7167\u901a\u5e38\u61c9\u8a72\u5b9a\u671f\u751f\u6210\uff0c\u800c\u4e0d\u662f\u6309\u9700\u751f\u6210\uff1a\u9019\u53ef\u4ee5\u63d0\u9ad8\u72c0\u614b\u540c\u6b65\u6027\u80fd\uff0c\u56e0\u70ba\u5feb\u7167\u751f\u6210\u53ef\u80fd\u5f88\u6162\uff0c\u4e26\u4e14\u53ef\u4ee5\u907f\u514d\u653b\u64ca\u8005\u7528\u6b64\u985e\u8acb\u6c42\u6df9\u6c92\u7bc0\u9ede\u7684\u62d2\u7d55\u670d\u52d9\u5411\u91cf\u3002</p> <p>\u901a\u5e38\u53ef\u4ee5\u522a\u9664\u8f03\u820a\u7684\u5feb\u7167\uff0c\u4f46\u81f3\u5c11\u4fdd\u7559\u5169\u500b\u6700\u65b0\u7684\u5feb\u7167\u53ef\u80fd\u5f88\u6709\u7528\uff0c\u4ee5\u907f\u514d\u5728\u7bc0\u9ede\u6062\u5fa9\u6642\u522a\u9664\u5148\u524d\u7684\u5feb\u7167\u3002</p> <p>\u5b8c\u5168\u7531\u61c9\u7528\u7a0b\u5e8f\u6c7a\u5b9a\u5982\u4f55\u62cd\u651d\u5feb\u7167\uff0c\u4f46\u5b83\u61c9\u52aa\u529b\u6eff\u8db3\u4ee5\u4e0b\u4fdd\u8b49\uff1a</p> <ul> <li>\u7570\u6b65\uff1a\u5feb\u7167\u4e0d\u61c9\u8a72\u505c\u6b62\u584a\u8655\u7406\uff0c\u56e0\u6b64\u5b83\u61c9\u8a72\u7570\u6b65\u767c\u751f\uff0c\u4f8b\u5982\u3002\u5728\u4e00\u500b\u55ae\u7368\u7684\u7dda\u7a0b\u4e2d</li> <li>\u4e00\u81f4\uff1a\u5feb\u7167\u61c9\u5728\u5b64\u7acb\u7684\u9ad8\u5ea6\u62cd\u651d\uff0c\u4e26\u4e14\u4e0d\u61c9\u53d7\u5230\u4e26\u767c\u5beb\u5165\u7684\u5f71\u97ff\uff0c\u4f8b\u5982\u3002\u7531\u65bc\u4e3b\u7dda\u7a0b\u4e2d\u7684\u584a\u8655\u7406</li> <li>\u78ba\u5b9a\u6027\uff1a\u5c0d\u65bc\u7d66\u5b9a\u7684<code>height</code>\u548c<code>format</code>\uff0c\u6240\u6709\u7bc0\u9ede\u7684\u5feb\u7167<code>chunks</code>\u548c<code>metadata</code> \u61c9\u8a72\u76f8\u540c\uff08\u5728\u5b57\u7bc0\u7d1a\u5225\uff09\uff0c\u4ee5\u78ba\u4fdd<code>chunks</code>\u7684\u826f\u597d\u53ef\u7528\u6027</li> </ul> <p>\u4f8b\u5982\uff0c\u9019\u53ef\u4ee5\u6309\u5982\u4e0b\u65b9\u5f0f\u5be6\u73fe\uff1a</p> <ol> <li>\u4f7f\u7528\u652f\u6301\u5e36\u5feb\u7167\u9694\u96e2\u7684\u4e8b\u52d9\u7684\u6578\u64da\u5b58\u5132\uff0c\u4f8b\u5982 RocksDB \u6216 BadgerDB\u3002</li> <li>\u63d0\u4ea4\u584a\u5f8c\u5728\u4e3b\u7dda\u7a0b\u4e2d\u555f\u52d5\u53ea\u8b80\u6578\u64da\u5eab\u4e8b\u52d9\u3002</li> <li>\u5c07\u6578\u64da\u5eab\u4e8b\u52d9\u53e5\u67c4\u50b3\u905e\u5230\u65b0\u751f\u6210\u7684\u7dda\u7a0b\u4e2d\u3002</li> <li>\u4ee5\u78ba\u5b9a\u7684\u9806\u5e8f\u904d\u6b77\u6240\u6709\u6578\u64da\u9805\uff08\u4f8b\u5982\uff0c\u6309\u9375\u6392\u5e8f\uff09</li> <li>\u5e8f\u5217\u5316\u6578\u64da\u9805\uff08\u4f8b\u5982\u4f7f\u7528 Protobuf\uff09\uff0c\u4e26\u5c07\u5b83\u5011\u5beb\u5165\u5b57\u7bc0\u6d41\u3002</li> <li>\u5c0d\u5b57\u7bc0\u6d41\u9032\u884c\u54c8\u5e0c\u8655\u7406\uff0c\u4e26\u5c07\u5176\u62c6\u5206\u70ba\u56fa\u5b9a\u5927\u5c0f\u7684\u584a\uff08\u4f8b\u5982 10 MB\uff09</li> <li>\u5c07\u584a\u4f5c\u70ba\u55ae\u7368\u7684\u6587\u4ef6\u5b58\u5132\u5728\u6587\u4ef6\u7cfb\u7d71\u4e2d\u3002</li> <li>\u5c07\u5feb\u7167\u5143\u6578\u64da\u5beb\u5165\u6578\u64da\u5eab\u6216\u6587\u4ef6\uff0c\u5305\u62ec\u5b57\u7bc0\u6d41\u54c8\u5e0c\u3002</li> <li>\u95dc\u9589\u6578\u64da\u5eab\u4e8b\u52d9\u4e26\u9000\u51fa\u7dda\u7a0b\u3002</li> </ol> <p>\u61c9\u7528\u7a0b\u5e8f\u53ef\u80fd\u9084\u9700\u8981\u63a1\u53d6\u984d\u5916\u7684\u6b65\u9a5f\uff0c\u4f8b\u5982\u58d3\u7e2e\u6578\u64da\u3001\u6821\u9a57\u584a\u3001\u70ba\u589e\u91cf\u9a57\u8b49\u751f\u6210\u8b49\u660e\u4ee5\u53ca\u522a\u9664\u820a\u5feb\u7167\u3002</p>"},{"location":"gateway/state-sync/#_4","title":"\u6062\u5fa9\u5feb\u7167","text":"<p>\u7576 Tendermint \u555f\u52d5\u6642\uff0c\u5b83\u6703\u6aa2\u67e5\u672c\u5730\u7bc0\u9ede\u662f\u5426\u6709\u4efb\u4f55\u72c0\u614b\uff08\u5373\u662f\u5426 <code>LastBlockHeight == 0</code>\uff09\uff0c\u5982\u679c\u6c92\u6709\uff0c\u5b83\u5c07\u958b\u59cb\u901a\u904e P2P \u7db2\u7d61\u767c\u73fe\u5feb\u7167\u3002 \u9019\u4e9b\u5feb\u7167\u5c07\u901a\u904e\u4ee5\u4e0b ABCI \u8abf\u7528\u63d0\u4f9b\u7d66\u672c\u5730\u61c9\u7528\u7a0b\u5e8f\uff1a</p> <ul> <li><code>OfferSnapshot(snapshot, apphash)</code>\uff1a\u5411\u61c9\u7528\u7a0b\u5e8f\u63d0\u4f9b\u5df2\u767c\u73fe\u7684\u5feb\u7167</li> <li><code>ApplySnapshotChunk(index, chunk, sender)</code>\uff1a\u61c9\u7528\u5feb\u7167\u584a</li> </ul> <p>\u5c07\u767c\u73fe\u7684\u5feb\u7167\u63d0\u4f9b\u7d66\u61c9\u7528\u7a0b\u5e8f\uff0c\u5b83\u53ef\u4ee5\u901a\u904e\u63a5\u53d7\u5feb\u7167\u3001\u62d2\u7d55\u5feb\u7167\u3001\u62d2\u7d55\u683c\u5f0f\u3001\u62d2\u7d55\u767c\u9001\u8005\u3001\u4e2d\u6b62\u72c0\u614b\u540c\u6b65\u7b49\u65b9\u5f0f\u505a\u51fa\u97ff\u61c9\u3002</p> <p>\u4e00\u65e6\u5feb\u7167\u88ab\u63a5\u53d7\uff0cTendermint \u5c07\u5f9e\u53ef\u7528\u7684\u5c0d\u7b49\u9ede\u7372\u53d6\u584a\uff0c\u4e26\u5c07\u5b83\u5011\u6309\u9806\u5e8f\u61c9\u7528\u5230\u61c9\u7528\u7a0b\u5e8f\uff0c\u61c9\u7528\u7a0b\u5e8f\u53ef\u4ee5\u9078\u64c7\u63a5\u53d7\u584a\u3001\u91cd\u65b0\u7372\u53d6\u3001\u62d2\u7d55\u5feb\u7167\u3001\u62d2\u7d55\u767c\u9001\u8005\u3001\u4e2d\u6b62\u72c0\u614b\u540c\u6b65\u7b49\u3002</p> <p>\u61c9\u7528\u6240\u6709\u584a\u5f8c\uff0cTendermint \u5c07\u5728\u61c9\u7528\u7a0b\u5e8f\u4e0a\u8abf\u7528 <code>Info</code> ABCI \u65b9\u6cd5\uff0c\u4e26\u6aa2\u67e5\u61c9\u7528\u7a0b\u5e8f\u54c8\u5e0c\u548c\u9ad8\u5ea6\u5c0d\u61c9\u65bc\u93c8\u4e2d\u7684\u53ef\u4fe1\u503c\u3002 \u7136\u5f8c\u5b83\u5c07\u5207\u63db\u5230\u5feb\u901f\u540c\u6b65\u4ee5\u7372\u53d6\u4efb\u4f55\u5269\u9918\u7684\u584a\uff08\u5982\u679c\u555f\u7528\uff09\uff0c\u7136\u5f8c\u6700\u7d42\u52a0\u5165\u6b63\u5e38\u7684\u5171\u8b58\u64cd\u4f5c\u3002</p> <p>\u5feb\u7167\u5982\u4f55\u5be6\u969b\u6062\u5fa9\u5b8c\u5168\u53d6\u6c7a\u65bc\u61c9\u7528\u7a0b\u5e8f\uff0c\u4f46\u901a\u5e38\u8207\u5b83\u5011\u7684\u751f\u6210\u65b9\u5f0f\u76f8\u53cd\u3002</p> <p>\u4f46\u662f\u8acb\u6ce8\u610f\uff0cTendermint \u50c5\u5728\u6240\u6709\u584a\u90fd\u5df2\u6062\u5fa9\u5f8c\u624d\u9a57\u8b49\u5feb\u7167\uff0c\u4e26\u4e14\u4e0d\u6703\u81ea\u884c\u62d2\u7d55\u4efb\u4f55 P2P \u5c0d\u7b49\u65b9\u3002</p> <p>\u53ea\u8981\u53ef\u4fe1\u54c8\u5e0c\u548c\u61c9\u7528\u7a0b\u5e8f\u4ee3\u78bc\u662f\u6b63\u78ba\u7684\uff0c\u5c0d\u624b\u5c31\u4e0d\u53ef\u80fd\u5728\u52a0\u5165\u5171\u8b58\u6642\u5c0e\u81f4\u72c0\u614b\u540c\u6b65\u7bc0\u9ede\u5177\u6709\u4e0d\u6b63\u78ba\u7684\u72c0\u614b\uff0c\u4f46\u662f\u61c9\u7528\u7a0b\u5e8f\u53ef\u4ee5\u62b5\u6d88\u72c0\u614b\u540c\u6b65\u62d2\u7d55\u670d\u52d9\uff08\u4f8b\u5982\uff0c\u901a\u904e\u5be6\u65bd\u589e\u91cf\u9a57\u8b49\u3001\u62d2\u7d55\u7121\u6548\u7bc0\u9ede\uff09\u3002</p> <p>\u8acb\u6ce8\u610f\uff0c\u72c0\u614b\u540c\u6b65\u7bc0\u9ede\u5c07\u6709\u4e00\u500b\u5f9e\u6062\u5fa9\u5feb\u7167\u7684\u9ad8\u5ea6\u958b\u59cb\u7684\u622a\u65b7\u584a\u6b77\u53f2\u8a18\u9304\uff0c\u76ee\u524d\u6c92\u6709\u6240\u6709\u584a\u6578\u64da\u7684\u56de\u586b\u3002 \u7db2\u7d61\u61c9\u8a72\u8003\u616e\u66f4\u5ee3\u6cdb\u7684\u5f71\u97ff\uff0c\u4e26\u4e14\u53ef\u80fd\u5e0c\u671b\u78ba\u4fdd\u81f3\u5c11\u6709\u5e7e\u500b\u5b58\u6a94\u7bc0\u9ede\u4fdd\u7559\u5b8c\u6574\u7684\u584a\u6b77\u53f2\u8a18\u9304\uff0c\u4ee5\u7528\u65bc\u53ef\u5be9\u8a08\u6027\u548c\u5099\u4efd\u3002</p>"},{"location":"gateway/state-sync/#cosmos-sdk","title":"Cosmos SDK \u72c0\u614b\u540c\u6b65","text":"<p>Cosmos SDK v0.40+ \u5305\u542b\u5c0d\u72c0\u614b\u540c\u6b65\u7684\u81ea\u52d5\u652f\u6301\uff0c\u56e0\u6b64\u61c9\u7528\u958b\u767c\u8005\u53ea\u9700\u555f\u7528\u5b83\u5373\u53ef\u4f7f\u7528\u3002\u4ed6\u5011\u5c07\u4e0d\u9700\u8981\u81ea\u5df1\u5be6\u65bd \u4e0a\u9762\u95dc\u65bc Tendermint \u7684\u90e8\u5206 \u4e2d\u63cf\u8ff0\u7684\u72c0\u614b\u540c\u6b65\u5354\u8b70\u3002</p>"},{"location":"gateway/state-sync/#_5","title":"\u72c0\u614b\u540c\u6b65\u5feb\u7167","text":"<p>Tendermint Core \u8655\u7406\u5927\u90e8\u5206\u70ba\u72c0\u614b\u540c\u6b65\u767c\u73fe\u3001\u4ea4\u63db\u548c\u9a57\u8b49\u72c0\u614b\u6578\u64da\u7684\u7e41\u91cd\u5de5\u4f5c\uff0c\u4f46\u61c9\u7528\u7a0b\u5e8f\u5fc5\u9808\u5b9a\u671f\u70ba\u5176\u72c0\u614b\u62cd\u651d\u5feb\u7167\uff0c\u4e26\u901a\u904e ABCI \u8abf\u7528\u5c07\u9019\u4e9b\u5feb\u7167\u63d0\u4f9b\u7d66 Tendermint\uff0c\u4e26\u80fd\u5920\u6062\u5fa9\u9019\u4e9b\u540c\u6b65\u65b0\u7bc0\u9ede\u6642\u3002</p> <p>Cosmos SDK \u5c07\u61c9\u7528\u7a0b\u5e8f\u72c0\u614b\u5b58\u5132\u5728\u540d\u70ba IAVL \u7684\u6578\u64da\u5b58\u5132\u4e2d\uff0c\u6bcf\u500b\u6a21\u584a\u90fd\u53ef\u4ee5\u8a2d\u7f6e\u81ea\u5df1\u7684 IAVL \u5b58\u5132\u3002 \u5728\u56fa\u5b9a\u7684\u9ad8\u5ea6\u9593\u9694\uff08\u53ef\u914d\u7f6e\uff09\uff0cCosmos SDK \u5c07\u5728\u8a72\u9ad8\u5ea6\u5c0e\u51fa\u6bcf\u500b\u5546\u5e97\u7684\u5167\u5bb9\uff0cProtobuf-\u7de8\u78bc\u548c\u58d3\u7e2e\u5b83\uff0c\u4e26\u5c07\u5176\u4fdd\u5b58\u5230\u672c\u5730\u6587\u4ef6\u7cfb\u7d71\u4e2d\u7684\u5feb\u7167\u5b58\u5132\u4e2d\u3002 \u7531\u65bc IAVL \u4fdd\u7559\u4e86\u6578\u64da\u7684\u6b77\u53f2\u7248\u672c\uff0c\u56e0\u6b64\u53ef\u4ee5\u5728\u57f7\u884c\u65b0\u584a\u7684\u540c\u6642\u751f\u6210\u9019\u4e9b\u5feb\u7167\u3002</p> <p>\u7576\u65b0\u7bc0\u9ede\u9032\u884c\u72c0\u614b\u540c\u6b65\u6642\uff0cTendermint \u5c07\u901a\u904e ABCI \u7372\u53d6\u9019\u4e9b\u5feb\u7167\u3002</p> <p>\u8acb\u6ce8\u610f\uff0c\u53ea\u6709\u7531 Cosmos SDK \u7ba1\u7406\u7684 IAVL \u5b58\u5132\u53ef\u4ee5\u88ab\u5feb\u7167\u3002\u5982\u679c\u61c9\u7528\u7a0b\u5e8f\u5728\u5916\u90e8\u6578\u64da\u5b58\u5132\u4e2d\u5b58\u5132\u984d\u5916\u7684\u6578\u64da\uff0c\u76ee\u524d\u6c92\u6709\u6a5f\u5236\u5c07\u9019\u4e9b\u5305\u542b\u5728\u72c0\u614b\u540c\u6b65\u5feb\u7167\u4e2d\uff0c\u56e0\u6b64\u61c9\u7528\u7a0b\u5e8f\u7121\u6cd5\u901a\u904e SDK \u4f7f\u7528\u81ea\u52d5\u72c0\u614b\u540c\u6b65\u3002</p> <p>\u4f46\u662f\uff0c\u5982 ABCI \u6587\u6a94 \u4e2d\u6240\u8ff0\uff0c\u53ef\u4ee5\u81ea\u7531\u5be6\u65bd\u72c0\u614b\u540c\u6b65\u5354\u8b70\u672c\u8eab\u3002</p> <p>\u7576\u4e00\u500b\u65b0\u7bc0\u9ede\u72c0\u614b\u540c\u6b65\u6642\uff0cTendermint \u5c07\u5f9e\u7db2\u7d61\u4e2d\u7684\u5c0d\u7b49\u9ede\u7372\u53d6\u5feb\u7167\u4e26\u5c07\u5176\u63d0\u4f9b\u7d66\u672c\u5730\uff08\u7a7a\uff09\u61c9\u7528\u7a0b\u5e8f\uff0c\u8a72\u61c9\u7528\u7a0b\u5e8f\u6703\u5c07\u5176\u5c0e\u5165\u5176 IAVL \u5b58\u5132\u3002</p> <p>Tendermint \u7136\u5f8c\u4f7f\u7528\u8f15\u5ba2\u6236\u7aef\u9a57\u8b49\u91dd\u5c0d\u4e3b\u5340\u584a\u93c8\u9a57\u8b49\u61c9\u7528\u7a0b\u5e8f\u7684\u61c9\u7528\u7a0b\u5e8f\u54c8\u5e0c\uff0c\u4e26\u50cf\u5f80\u5e38\u4e00\u6a23\u7e7c\u7e8c\u57f7\u884c\u584a\u3002</p> <p>\u8acb\u6ce8\u610f\uff0c\u72c0\u614b\u540c\u6b65\u7bc0\u9ede\u53ea\u6703\u6062\u5fa9\u5feb\u7167\u62cd\u651d\u9ad8\u5ea6\u7684\u61c9\u7528\u7a0b\u5e8f\u72c0\u614b\uff0c\u4e26\u4e14\u4e0d\u6703\u5305\u542b\u6b77\u53f2\u6578\u64da\u6216\u6b77\u53f2\u584a\u3002</p>"},{"location":"gateway/state-sync/#_6","title":"\u555f\u7528\u72c0\u614b\u540c\u6b65\u5feb\u7167","text":"<p>\u8981\u555f\u7528\u72c0\u614b\u540c\u6b65\u5feb\u7167\uff0c\u4f7f\u7528 CosmosSDK <code>BaseApp</code> \u7684\u61c9\u7528\u7a0b\u5e8f\u9700\u8981\u8a2d\u7f6e\u5feb\u7167\u5b58\u5132\uff08\u5e36\u6709\u6578\u64da\u5eab\u548c\u6587\u4ef6\u7cfb\u7d71\u76ee\u9304\uff09\u4e26\u914d\u7f6e\u5feb\u7167\u9593\u9694\u548c\u8981\u4fdd\u7559\u7684\u6b77\u53f2\u5feb\u7167\u6578\u91cf\u3002\u4e00\u500b\u6700\u5c0f\u7684\u4f8b\u5b50\u5982\u4e0b\uff1a</p> <pre><code>snapshotDir := filepath.Join(\n  cast.ToString(appOpts.Get(flags.FlagHome)), \"data\", \"snapshots\")\nsnapshotDB, err := sdk.NewLevelDB(\"metadata\", snapshotDir)\nif err != nil {\n  panic(err)\n}\nsnapshotStore, err := snapshots.NewStore(snapshotDB, snapshotDir)\nif err != nil {\n  panic(err)\n}\napp := baseapp.NewBaseApp(\n  \"app\", logger, db, txDecoder,\n  baseapp.SetSnapshotStore(snapshotStore),\n  baseapp.SetSnapshotInterval(cast.ToUint64(appOpts.Get(\n    server.FlagStateSyncSnapshotInterval))),\n  baseapp.SetSnapshotKeepRecent(cast.ToUint32(appOpts.Get(\n    server.FlagStateSyncSnapshotKeepRecent))),\n)\n</code></pre> <p>\u7576\u4f7f\u7528\u9069\u7576\u7684\u6a19\u8a8c\u555f\u52d5\u61c9\u7528\u7a0b\u5e8f\u6642\uff0c\uff08\u4f8b\u5982 <code>--state-sync.snapshot-interval 1000 --state-sync.snapshot-keep-recent 2</code>\uff09\u5b83\u61c9\u8a72\u751f\u6210\u5feb\u7167\u4e26\u8f38\u51fa\u65e5\u8a8c\u6d88\u606f\uff1a</p> <pre><code>Creating state snapshot    module=main height=3000\nCompleted state snapshot   module=main height=3000 format=1\n</code></pre> <p>\u8acb\u6ce8\u610f\uff0c\u5feb\u7167\u9593\u9694\u7576\u524d\u5fc5\u9808\u662f <code>pruning-keep-every</code>\uff08\u9ed8\u8a8d\u70ba 100\uff09\u7684\u500d\u6578\uff0c\u4ee5\u9632\u6b62\u5728\u62cd\u651d\u5feb\u7167\u6642\u4fee\u526a\u9ad8\u5ea6\u3002\u81f3\u5c11\u4fdd\u7559 2 \u500b\u6700\u8fd1\u7684\u5feb\u7167\u901a\u5e38\u4e5f\u662f\u4e00\u500b\u597d\u4e3b\u610f\uff0c\u9019\u6a23\u7576\u7bc0\u9ede\u5617\u8a66\u4f7f\u7528\u5b83\u9032\u884c\u72c0\u614b\u540c\u6b65\u6642\uff0c\u4e0d\u6703\u522a\u9664\u4ee5\u524d\u7684\u5feb\u7167\u3002</p>"},{"location":"gateway/state-sync/#_7","title":"\u72c0\u614b\u540c\u6b65\u7bc0\u9ede","text":"<p>\ud83d\udce3 \u63d0\u793a : \u5c0b\u627e\u5feb\u7167\u6216\u5b58\u6a94\u7bc0\u9ede\u4f86\u540c\u6b65\u60a8\u7684\u7bc0\u9ede\uff1f\u67e5\u770b \u6b64\u9801\u9762\u3002</p> <p>\u4e00\u65e6\u7db2\u7d61\u4e2d\u7684\u5e7e\u500b\u7bc0\u9ede\u62cd\u651d\u4e86\u72c0\u614b\u540c\u6b65\u5feb\u7167\uff0c\u65b0\u7bc0\u9ede\u5c31\u53ef\u4ee5\u4f7f\u7528\u72c0\u614b\u540c\u6b65\u52a0\u5165\u7db2\u7d61\u3002 \u70ba\u6b64\uff0c\u9996\u5148\u61c9\u8a72\u50cf\u5f80\u5e38\u4e00\u6a23\u914d\u7f6e\u7bc0\u9ede\uff0c\u4e26\u4e14\u5fc5\u9808\u7372\u53d6\u4ee5\u4e0b\u4fe1\u606f\u4ee5\u9032\u884c\u8f15\u5ba2\u6236\u7aef\u9a57\u8b49\uff1a</p> <ul> <li>\u5169\u500b\u53ef\u7528\u7684 RPC \u670d\u52d9\u5668\uff08\u81f3\u5c11\uff09</li> <li>\u53ef\u4fe1\u9ad8\u5ea6</li> <li>\u53ef\u4fe1\u9ad8\u5ea6\u7684\u5340\u584aID\u54c8\u5e0c</li> </ul> <p>\u53ef\u4fe1\u54c8\u5e0c\u5fc5\u9808\u5f9e\u53ef\u4fe1\u6e90\uff08\u4f8b\u5982\u5340\u584a\u700f\u89bd\u5668\uff09\u7372\u5f97\uff0c\u4f46 RPC \u670d\u52d9\u5668\u4e0d\u9700\u8981\u53ef\u4fe1\u3002 Tendermint \u5c07\u4f7f\u7528\u54c8\u5e0c\u5f9e\u5340\u584a\u93c8\u4e2d\u7372\u53d6\u53d7\u4fe1\u4efb\u7684\u61c9\u7528\u7a0b\u5e8f\u54c8\u5e0c\uff0c\u4ee5\u9a57\u8b49\u6062\u5fa9\u7684\u61c9\u7528\u7a0b\u5e8f\u5feb\u7167\u3002\u61c9\u7528\u7a0b\u5e8f\u54c8\u5e0c\u548c\u76f8\u61c9\u7684\u9ad8\u5ea6\u662f\u6062\u5fa9\u5feb\u7167\u6642\u552f\u4e00\u53ef\u4ee5\u4fe1\u4efb\u7684\u4fe1\u606f\u3002\u5176\u4ed6\u4e00\u5207\u90fd\u53ef\u4ee5\u7531\u5c0d\u624b\u507d\u9020\u3002</p> <p>\u5728\u672c\u6307\u5357\u4e2d\uff0c\u6211\u5011\u4f7f\u7528 Ubuntu 20.04</p>"},{"location":"gateway/state-sync/#_8","title":"\u6e96\u5099\u7cfb\u7d71","text":"<p>\u66f4\u65b0\u7cfb\u7d71</p> <pre><code>sudo apt update -y\n</code></pre> <p>\u5347\u7d1a\u7cfb\u7d71</p> <pre><code>sudo apt upgrade -y\n</code></pre> <p>\u5b89\u88dd\u4f9d\u8cf4</p> <pre><code>sudo apt-get install ca-certificates curl gnupg lsb-release make gcc git jq wget -y\n</code></pre> <p>\u5b89\u88dd Go</p> <pre><code>wget -q -O - https://raw.githubusercontent.com/canha/golang-tools-install-script/master/goinstall.sh | bash\nsource ~/.bashrc\n</code></pre> <p>\u8a2d\u7f6e\u7bc0\u9ede\u540d\u7a31</p> <pre><code>moniker=\"NODE_NAME\"\n</code></pre>"},{"location":"gateway/state-sync/#_9","title":"\u4f7f\u7528\u4ee5\u4e0b\u547d\u4ee4\u9032\u884c\u4e3b\u7db2\u8a2d\u7f6e","text":"<pre><code>SNAP_RPC1=\"http://xxx1:26657\"\nSNAP_RPC=\"http://xxx:26657\"\nCHAIN_ID=\"daodst_7777-1\"\nPEER=\"96557e26aabf3b23e8ff5282d03196892a7776fc@xxx,dec587d55ff38827ebc6312cedda6085c59683b6@xxx\"\nwget -O $HOME/genesis.json https://raw.githubusercontent.com/daodst/mainnet/genesis.json \n</code></pre>"},{"location":"gateway/state-sync/#stcd","title":"\u5b89\u88dd stcd","text":"<pre><code>git clone https://github.com/daodst/blockchain.git &amp;&amp; \\ \ncd cmd &amp;&amp; cd stcd\ngo build\n</code></pre>"},{"location":"gateway/state-sync/#_10","title":"\u914d\u7f6e","text":"<p>\u7bc0\u9ede\u521d\u59cb\u5316</p> <pre><code>stcd init $moniker --chain-id $CHAIN_ID\n</code></pre> <p>\ud83d\udce3 \u63d0\u793a :  <code>$install_path</code> \u7528\u4f86\u8868\u793a\u60a8\u5b89\u88dd <code>stcd</code> \u4e8c\u9032\u88fd\u7a0b\u5e8f\u7684\u8def\u5f91</p> <p>\u5c07 genesis \u6587\u4ef6\u79fb\u52d5\u5230 $install_path/.stcd/config \u6587\u4ef6\u593e</p> <pre><code>mv $HOME/genesis.json $install_path/.stcd/config/\n</code></pre> <p>\u91cd\u7f6e\u7bc0\u9ede</p> <pre><code>stcd tendermint unsafe-reset-all --home .stcd\n</code></pre> <p>\u66f4\u6539\u914d\u7f6e\u6587\u4ef6\uff08\u8a2d\u7f6e\u7bc0\u9ede\u540d\u7a31\u3001\u6dfb\u52a0\u6301\u4e45\u5c0d\u7b49\u9ede\u3001\u8a2d\u7f6e\u7d22\u5f15\u5668 =\u201cnull\u201d\uff09</p> <pre><code>sed -i -e \"s%^moniker *=.*%moniker = \\\"$moniker\\\"%; \" $install_path/.stcd/config/config.toml\nsed -i -e \"s%^indexer *=.*%indexer = \\\"null\\\"%; \" $install_path/.stcd/config/config.toml\nsed -i -e \"s%^persistent_peers *=.*%persistent_peers = \\\"$PEER\\\"%; \" $install_path/.stcd/config/config.toml\n</code></pre> <p>\u8a2d\u7f6e\u5f9e\u5feb\u7167\u958b\u59cb\u7684\u8b8a\u91cf</p> <pre><code>LATEST_HEIGHT=$(curl -s $SNAP_RPC/block | jq -r .result.block.header.height); \\\nBLOCK_HEIGHT=$((LATEST_HEIGHT - 2000)); \\\nTRUST_HASH=$(curl -s \"$SNAP_RPC/block?height=$BLOCK_HEIGHT\" | jq -r .result.block_id.hash)\n</code></pre> <p>\u6aa2\u67e5</p> <pre><code>echo $LATEST_HEIGHT $BLOCK_HEIGHT $TRUST_HASH\n</code></pre> <p>\u8f38\u51fa\u793a\u4f8b\uff08\u6578\u5b57\u6703\u6709\u6240\u4e0d\u540c\uff09\uff1a</p> <pre><code>376080 374080 F0C78FD4AE4DB5E76A298206AE3C602FF30668C521D753BB7C435771AEA47189\n</code></pre> <p>\u5982\u679c\u8f38\u51fa\u6b63\u5e38\uff0c\u4e0b\u4e00\u6b65</p> <pre><code>sed -i.bak -E \"s|^(enable[[:space:]]+=[[:space:]]+).*$|\\1true| ; \\\n\ns|^(rpc_servers[[:space:]]+=[[:space:]]+).*$|\\1\\\"$SNAP_RPC,$SNAP_RPC1\\\"| ; \\\n\ns|^(trust_height[[:space:]]+=[[:space:]]+).*$|\\1$BLOCK_HEIGHT| ; \\\n\ns|^(trust_hash[[:space:]]+=[[:space:]]+).*$|\\1\\\"$TRUST_HASH\\\"| ; \\\n\ns|^(seeds[[:space:]]+=[[:space:]]+).*$|\\1\\\"\\\"|\" $install_path/.stcd/config/config.toml\n</code></pre>"},{"location":"gateway/state-sync/#stcd_1","title":"\u5275\u5efastcd\u670d\u52d9","text":"<pre><code>echo \"[Unit]\nDescription=Daodst Chain Node\nAfter=network.target\n#\n[Service]\nUser=$USER\nType=simple\nExecStart=$(which stcd) daemon\nRestart=on-failure\nLimitNOFILE=65535\n#\n[Install]\nWantedBy=multi-user.target\" &gt; $HOME/stcd.service; sudo mv $HOME/stcd.service /etc/systemd/system/\n</code></pre> <pre><code>sudo systemctl enable stcd.service &amp;&amp; sudo systemctl daemon-reload\n</code></pre>"},{"location":"gateway/state-sync/#stcd_2","title":"\u904b\u884c stcd","text":"<pre><code>sytemctl start stcd\n</code></pre>"},{"location":"gateway/state-sync/#_11","title":"\u6aa2\u67e5\u65e5\u8a8c","text":"<pre><code>journalctl -u stcd -f\n</code></pre> <p>\u7576\u7bc0\u9ede\u555f\u52d5\u6642\uff0c\u5b83\u5c07\u5617\u8a66\u5728\u7db2\u7d61\u4e2d\u627e\u5230\u72c0\u614b\u540c\u6b65\u5feb\u7167\uff0c\u4e26\u6062\u5fa9\u5b83\uff1a</p> <pre><code>Started node                   module=main nodeInfo=\"...\"\nDiscovering snapshots for 20s\nDiscovered new snapshot        height=3000 format=1 hash=0F14A473\nDiscovered new snapshot        height=2000 format=1 hash=C6209AF7\nOffering snapshot to ABCI app  height=3000 format=1 hash=0F14A473\nSnapshot accepted, restoring   height=3000 format=1 hash=0F14A473\nFetching snapshot chunk        height=3000 format=1 chunk=0 total=3\nFetching snapshot chunk        height=3000 format=1 chunk=1 total=3\nFetching snapshot chunk        height=3000 format=1 chunk=2 total=3\nApplied snapshot chunk         height=3000 format=1 chunk=0 total=3\nApplied snapshot chunk         height=3000 format=1 chunk=1 total=3\nApplied snapshot chunk         height=3000 format=1 chunk=2 total=3\nVerified ABCI app              height=3000 appHash=F7D66BC9\nSnapshot restored              height=3000 format=1 hash=0F14A473\nExecuted block                 height=3001 validTxs=16 invalidTxs=0\nCommitted state                height=3001 txs=16 appHash=0FDBB0D5F\nExecuted block                 height=3002 validTxs=25 invalidTxs=0\nCommitted state                height=3002 txs=25 appHash=40D12E4B3\n</code></pre> <p>\u7bc0\u9ede\u73fe\u5728\u72c0\u614b\u540c\u6b65\uff0c\u5728\u5e7e\u79d2\u9418\u5167\u52a0\u5165\u7db2\u7d61</p>"},{"location":"gateway/state-sync/#_12","title":"\u95dc\u9589\u72c0\u614b\u540c\u6b65\u6a21\u5f0f","text":"<p>\u5728\u7bc0\u9ede\u5b8c\u5168\u540c\u6b65\u5f8c\uff0c\u4f7f\u7528\u6b64\u547d\u4ee4\u95dc\u9589\u72c0\u614b\u540c\u6b65\u6a21\u5f0f\uff0c\u4ee5\u907f\u514d\u5c07\u4f86\u7bc0\u9ede\u91cd\u65b0\u555f\u52d5\u6642\u51fa\u73fe\u554f\u984c\uff01</p> <pre><code>sed -i.bak -E \"s|^(enable[[:space:]]+=[[:space:]]+).*$|\\1false|\" $install_path/.stcd/config/config.toml\n</code></pre> <p>\u26a0\ufe0f\u6ce8\u610f :\u672c\u6587\u6a94\u4e2d\u5305\u542b\u7684\u4fe1\u606f\u4f86\u81ea Erik Grinaker\uff0c\u7279\u5225\u662f\u4ed6\u7684\u72c0\u614b\u540c\u6b65\u6307\u5357 Tendermint Core and the Cosmos SDK.</p>"},{"location":"gateway/testnet/","title":"\u6e2c\u8a66\u7db2","text":"<p>\u672c\u6587\u6a94\u6982\u8ff0\u4e86\u52a0\u5165\u73fe\u6709\u6e2c\u8a66\u7db2\u7684\u6b65\u9a5f\u3002</p>"},{"location":"gateway/testnet/#_2","title":"\u9078\u64c7\u4e00\u500b\u6e2c\u8a66\u7db2","text":"<p>\u60a8\u53ef\u4ee5\u901a\u904e\u8a2d\u7f6e \u521b\u4e16\u6587\u4ef6 \u548c \u79cd\u5b50\u8282\u70b9 \u4f86\u6307\u5b9a\u8981\u52a0\u5165\u7684\u7db2\u7d61\u3002</p> \u6e2c\u8a66\u7db2 Chain ID \u63cf\u8ff0 \u5730\u9ede \u7248\u672c \u72c0\u614b <code>daodst_7000-1</code> daodst Testnet Arsia Mons <code>v0.1.x</code> <code>\u6d3b\u8dc3</code>"},{"location":"gateway/testnet/#stcd","title":"\u5b89\u88c5 <code>stcd</code>","text":"<p>\u6309\u7167 \u5b89\u88c5 \u6587\u6a94\u5b89\u88dd  \u7a0b\u5e8f \u3002</p> <p>\u26a0\ufe0f\u6ce8\u610f :  \u78ba\u4fdd\u5b89\u88dd\u4e86\u6b63\u78ba\u7248\u672c\u7684 \u7a0b\u5e8f\u3002</p>"},{"location":"gateway/testnet/#chain-id","title":"\u4fdd\u5b58 Chain ID","text":"<p>\u6211\u5011\u5efa\u8b70\u5c07\u6e2c\u8a66\u7db2 <code>chain-id</code> \u4fdd\u5b58\u5230\u60a8\u7684 <code>client.toml</code> \u4e2d\u3002 \u9019\u5c07\u4f7f\u60a8\u4e0d\u5fc5\u70ba\u6bcf\u500b CLI \u547d\u4ee4\u624b\u52d5\u50b3\u905e <code>chain-id</code> \u6a19\u8a8c\u3002</p> <p>\ud83d\udce3 \u63d0\u793a : \u8acb\u53c3\u95b1\u5b98\u65b9 \u93c8 ID \u4ee5\u4f9b\u53c3\u8003\u3002</p> <pre><code>stcd config chain-id daodst_7000-1\n</code></pre>"},{"location":"gateway/testnet/#_3","title":"\u521d\u59cb\u5316\u8282\u70b9","text":"<p>\ud83d\udce3 \u63d0\u793a :  <code>$install_path</code> \u7528\u6765\u8868\u793a\u60a8\u5b89\u88c5 <code>stcd</code> \u4e8c\u8fdb\u5236\u7a0b\u5e8f\u7684\u8def\u5f84</p> <p>\u6211\u5011\u9700\u8981\u521d\u59cb\u5316\u7bc0\u9ede\u4ee5\u5275\u5efa\u6240\u6709\u5fc5\u8981\u7684\u9a57\u8b49\u5668\u548c\u7bc0\u9ede\u914d\u7f6e\u6587\u4ef6\uff1a</p> <pre><code>stcd init &lt;your_custom_moniker&gt; --chain-id daodst_7000-1\n</code></pre> <p>\u26a0\ufe0f\u6ce8\u610f :  \u540d\u5b57\u5c0d\u50cf\u53ea\u80fd\u5305\u542b ASCII \u5b57\u7b26\u3002\u4f7f\u7528 Unicode \u5b57\u7b26\u5c07\u4f7f\u60a8\u7684\u7bc0\u9ede\u7121\u6cd5\u8a2a\u554f\u3002</p> <p>\u9ed8\u8a8d\u60c5\u6cc1\u4e0b\uff0c<code>init</code> \u547d\u4ee4\u5275\u5efa\u5e36\u6709\u5b50\u6587\u4ef6\u593e<code>config/</code> \u548c<code>data/</code> \u7684<code>$install_path/.stcd</code>\uff08\u5373<code>$HOME</code>\uff09\u76ee\u9304\u3002 \u5728 <code>config</code> \u76ee\u9304\u4e2d\uff0c\u6700\u91cd\u8981\u7684\u914d\u7f6e\u6587\u4ef6\u662f <code>app.toml</code> \u548c <code>config.toml</code>\u3002</p>"},{"location":"gateway/testnet/#seeds","title":"\u521b\u4e16 &amp; Seeds","text":""},{"location":"gateway/testnet/#_4","title":"\u62f7\u8d1d\u521b\u4e16\u6587\u4ef6","text":"<p>\u5f9e <code>github</code> \u4e0b\u8f7d <code>genesis.json</code> \u6587\u4ef6\u4e26\u5c07\u5176\u8907\u88fd\u5230 <code>config</code> \u76ee\u9304\uff1a<code>$install_path/.stcd/config/genesis.json</code>\u3002  \u9019\u662f\u4e00\u500b\u5305\u542b\u93c8 ID \u548c\u5275\u4e16\u8cec\u6236\u9918\u984d\u7684\u5275\u4e16\u6587\u4ef6\u3002</p> <pre><code>sudo apt install -y unzip wget\nwget -P $install_path/.stcd/config https://github.com/daodst/testnets/daodst_7000-1/genesis.json\n</code></pre> <p>\u7136\u5f8c\u9a57\u8b49genesis\u914d\u7f6e\u6587\u4ef6\u7684\u6b63\u78ba\u6027\uff1a</p> <pre><code>stcd validate-genesis\n</code></pre>"},{"location":"gateway/testnet/#seeds_1","title":"seeds","text":"<p>\u60a8\u7684\u7bc0\u9ede\u9700\u8981\u77e5\u9053\u5982\u4f55\u627e\u5230 peers\u3002 \u60a8\u9700\u8981\u6dfb\u52a0\u5065\u5eb7\u7684\u7a2e\u5b50\u7bc0\u9ede \u5230 <code>$HOME/.stcd/config/config.toml</code>\u3002   <code>testnets</code> \u5b58\u5132\u5eab\u5305\u542b\u6307\u5411\u4e00\u4e9b\u7a2e\u5b50\u7bc0\u9ede\u3002</p> <p>\u5c07\u4f4d\u65bc <code>$install_path/.stcd/config/config.toml</code> \u548c <code>seeds</code> \u4e2d\u7684\u6587\u4ef6\u7de8\u8f2f\u70ba\u4ee5\u4e0b\u5167\u5bb9\uff1a</p> <pre><code>#######################################################\n###           P2P Configuration Options             ###\n#######################################################\n[p2p]\n\n# ...\n\n# Comma separated list of seed nodes to connect to\nseeds = \"&lt;node-id&gt;@&lt;ip&gt;:&lt;p2p port&gt;\"\n</code></pre> <p>\u60a8\u53ef\u4ee5\u4f7f\u7528\u4ee5\u4e0b\u4ee3\u78bc\u5f9e\u5b58\u5132\u5eab\u4e2d\u7372\u53d6\u7a2e\u5b50\u4e26\u5c07\u5176\u6dfb\u52a0\u5230\u60a8\u7684\u914d\u7f6e\u4e2d\uff1a</p> <pre><code>SEEDS=`curl -sL https://raw.githubusercontent.com/daodst/testnets/main/daodst_7000-1/seeds.txt | awk '{print $1}' | paste -s -d, -`\nsed -i.bak -e \"s/^seeds =.*/seeds = \\\"$SEEDS\\\"/\" ~/.stcd/config/config.toml\n</code></pre> <p>\ud83d\udce3 \u63d0\u793a : \u6709\u95dc\u7a2e\u5b50\u548c\u540c\u884c\u7684\u66f4\u591a\u4fe1\u606f\uff0c\u60a8\u53ef\u4ee5\u8a2a\u554f Tendermint P2P \u6587\u6a94\u3002</p>"},{"location":"gateway/testnet/#persistent_peers","title":"persistent_peers","text":"<p>\u6211\u5011\u53ef\u4ee5\u5728 <code>$install_path/.stcd/config/config.toml</code> \u4e2d\u8a2d\u7f6e <code>persistent_peers</code> \u5b57\u6bb5\u3002  \u4f86\u6307\u5b9a\u60a8\u7684\u7bc0\u9ede\u5c07\u8207\u4e4b\u4fdd\u6301\u6301\u4e45\u9023\u63a5\u7684\u5c0d\u7b49\u9ede\u3002  \u60a8\u53ef\u4ee5\u5f9e <code>testnets</code> \u5b58\u5132\u5eab\u7684\u53ef\u7528\u5c0d\u7b49\u9ede\u5217\u8868\u4e2d\u6aa2\u7d22\u5b83\u5011\u3002</p> <p>\u60a8\u53ef\u4ee5\u5f9e <code>peers.txt</code> \u4e2d\u96a8\u6a5f\u7372\u5f97 10 \u500b\u689d\u76ee\u901a\u904e\u904b\u884c\u4ee5\u4e0b\u547d\u4ee4\u5c07\u6587\u4ef6\u6dfb\u52a0\u5230 <code>PEERS</code> \u8b8a\u91cf\u4e2d\uff1a</p> <pre><code>PEERS=`curl -sL https://raw.githubusercontent.com/daodst/testnets/main/daodst_7000-1/peers.txt | sort -R | head -n 10 | awk '{print $1}' | paste -s -d, -`\n</code></pre> <p>\u4f7f\u7528 <code>sed</code> \u5c07\u5b83\u5011\u5305\u542b\u5230\u914d\u7f6e\u4e2d\u3002\u60a8\u4e5f\u53ef\u4ee5\u624b\u52d5\u6dfb\u52a0\u5b83\u5011\uff1a</p> <pre><code>sed -i.bak -e \"s/^persistent_peers *=.*/persistent_peers = \\\"$PEERS\\\"/\" $install_path/.stcd/config/config.toml\n</code></pre>"},{"location":"gateway/testnet/#_5","title":"\u904b\u884c\u6e2c\u8a66\u7db2\u9a57\u8b49\u5668","text":"<p>\u5728 \u6c34\u9f8d\u982d \u4e0a\u8072\u660e\u60a8\u7684\u6e2c\u8a66\u7db2\u4f7f\u7528\u4f60\u7684\u9a57\u8b49\u8005\u8cec\u6236\u5730\u5740\u4e26\u63d0\u4ea4\u4f60\u7684\u9a57\u8b49\u8005\u8cec\u6236\u5730\u5740\uff1a</p> <p>\ud83d\udce3 \u63d0\u793a : \u6709\u95dc\u5982\u4f55\u904b\u884c\u9a57\u8b49\u5668\u7684\u66f4\u591a\u8a73\u7d30\u4fe1\u606f\uff0c\u8acb\u9075\u5faa \u9019\u4e9b \u8aaa\u660e\u3002</p> <pre><code>stcd tx staking create-validator \\\n  --amount=1000000000000dst \\\n  --pubkey=$(stcd tendermint show-validator) \\\n  --moniker=\"Daodst1\" \\\n  --chain-id=&lt;chain_id&gt; \\\n  --commission-rate=\"0.10\" \\\n  --commission-max-rate=\"0.20\" \\\n  --commission-max-change-rate=\"0.01\" \\\n  --min-self-delegation=\"1000000\" \\\n  --gas=\"auto\" \\\n  --gas-prices=\"0.025dst\" \\\n  --from=&lt;key_name&gt;\n</code></pre>"},{"location":"gateway/testnet/#_6","title":"\u555f\u52d5\u6e2c\u8a66\u7db2","text":"<p>\u6700\u5f8c\u4e00\u6b65\u662f\u555f\u52d5\u7bc0\u9ede\u3002 \u4e00\u65e6\u4f86\u81ea\u5275\u4e16\u9a57\u8b49\u8005\u7684\u8db3\u5920\u6295\u7968\u6b0a\uff08+2/3\uff09\u555f\u52d5\u4e26\u904b\u884c\uff0c\u6e2c\u8a66\u7db2\u5c07\u958b\u59cb\u751f\u7522\u5340\u584a\u3002</p> <pre><code>stcd daemon\n</code></pre>"},{"location":"gateway/testnet/#_7","title":"\u5347\u7d1a\u4f60\u7684\u7bc0\u9ede","text":"<p>\ud83d\udce3 \u63d0\u793a :  \u9019\u4e9b\u8aaa\u660e\u9069\u7528\u65bc\u5df2\u7d93\u5728\u4e4b\u524d\u7248\u672c\u4e0a\u904b\u884c\u4e26\u5e0c\u671b\u5347\u7d1a\u5230\u6700\u65b0\u6e2c\u8a66\u7db2\u7248\u672c\u7684\u5b8c\u6574\u7bc0\u9ede\u3002</p> <p>\ud83d\udce3 \u63d0\u793a :  <code>$install_path</code> \u7528\u6765\u8868\u793a\u60a8\u5b89\u88c5 <code>stcd</code> \u4e8c\u8fdb\u5236\u7a0b\u5e8f\u7684\u8def\u5f84</p>"},{"location":"gateway/testnet/#_8","title":"\u91cd\u7f6e\u6578\u64da","text":"<p>\u26a0\ufe0f\u6ce8\u610f :  \u5982\u679c\u60a8\u8981\u5347\u7d1a\u5230\u7684\u7248\u672c  \u8207\u4e4b\u524d\u7684\u7248\u672c\u6c92\u6709\u885d\u7a81\uff0c\u60a8\u4e0d\u61c9\u8a72\u91cd\u7f6e\u6578\u64da\u3002 \u5982\u679c\u662f\u9019\u7a2e\u60c5\u6cc1\uff0c\u60a8\u53ef\u4ee5\u8df3\u5230 \u91cd\u65b0\u555f\u52d5 <p>\u9996\u5148\uff0c\u522a\u9664\u904e\u6642\u7684\u6587\u4ef6\u4e26\u91cd\u7f6e\u6578\u64da\u3002</p> <pre><code>rm $install_path/.stcd/config/addrbook.json $install_path/.stcd/config/genesis.json\nstcd tendermint unsafe-reset-all --home $install_path/.stcd\n</code></pre> <p>\u60a8\u7684\u7bc0\u9ede\u73fe\u5728\u8655\u65bc\u539f\u59cb\u72c0\u614b\uff0c\u540c\u6642\u4fdd\u7559\u539f\u59cb\u7684 <code>priv_validator.json</code> \u548c <code>config.toml</code>\u3002 \u5982\u679c\u60a8\u4e4b\u524d\u8a2d\u7f6e\u4e86\u4efb\u4f55\u54e8\u5175\u7bc0\u9ede\u6216\u5b8c\u6574\u7bc0\u9ede\uff0c\u60a8\u7684\u7bc0\u9ede\u4ecd\u5c07\u5617\u8a66\u9023\u63a5\u5230\u5b83\u5011\uff0c\u4f46\u5982\u679c\u5b83\u5011\u9084\u6c92\u6709\u5347\u7d1a\uff0c\u5247\u53ef\u80fd\u6703\u5931\u6557\u3002</p> <p>\u26a0\ufe0f\u6ce8\u610f :  \u78ba\u4fdd\u6bcf\u500b\u7bc0\u9ede\u90fd\u6709\u4e00\u500b\u552f\u4e00\u7684 <code>priv_validator.json</code>\u3002\u4e0d\u8981\u5c07 <code>priv_validator.json</code> \u5f9e\u820a\u7bc0\u9ede\u8907\u88fd\u5230\u591a\u500b\u65b0\u7bc0\u9ede\u3002 \u4f7f\u7528\u76f8\u540c\u7684 <code>priv_validator.json</code> \u904b\u884c\u5169\u500b\u7bc0\u9ede\u5c07\u5c0e\u81f4\u60a8\u96d9\u91cd\u7c3d\u540d\u3002</p>"},{"location":"gateway/testnet/#_9","title":"\u91cd\u65b0\u958b\u59cb","text":"<p>\u8981\u91cd\u65b0\u555f\u52d5\u60a8\u7684\u7bc0\u9ede\uff0c\u53ea\u9700\u9375\u5165\uff1a</p> <pre><code>stcd daemon\n</code></pre>"},{"location":"gateway/testnet/#_10","title":"\u5206\u4eab\u4f60\u7684\u8282\u70b9\u4fe1\u606f","text":"<p>\u60a8\u53ef\u4ee5\u5728\u4e92\u8054\u7f51\u4e0a\u5206\u4eab\u60a8\u7684\u540c\u4f34\u4e26\u5c07\u5176\u767c\u5e03\u3002</p> <p>\ud83d\udce3 \u63d0\u793a : \u8981\u7372\u53d6\u60a8\u7684\u7bc0\u9ede ID\uff0c\u8acb\u4f7f\u7528</p> <pre><code>stcd tendermint show-node-id\n</code></pre>"},{"location":"gateway/testnet/#_11","title":"\u72c0\u614b\u540c\u6b65\u7bc0\u9ede","text":"<p>\u5982\u679c\u60a8\u60f3\u4f7f\u7528\u72c0\u614b\u540c\u6b65\u52a0\u5165\u7db2\u7d61\uff08\u5feb\u901f\uff0c\u4f46\u4e0d\u9069\u7528\u65bc\u5b58\u6a94\u7bc0\u9ede\uff09\uff0c\u8acb\u67e5\u770b\u6211\u5011\u7684 \u72c0\u614b\u540c\u6b65 \u9801\u9762</p>"},{"location":"protocol/account/","title":"\u5e33\u865f","text":"<p>\u53ef\u4ee5\u5728\u4e0d\u540c\u7684\u5340\u584a\u93c8\u4e0a\u4ee5\u7368\u7279\u7684\u65b9\u5f0f\u5275\u5efa\u548c\u8868\u793a\u52a0\u5bc6\u9322\u5305\uff08\u6216\u5e33\u6236\uff09\u3002\u5c0d\u65bc\u5728 Daodst \u4e0a\u8207\u5e33\u6236\u985e\u578b\u4ea4\u4e92\u7684\u958b\u767c\u4eba\u54e1\uff0c\u5728\u5176 dApp \u524d\u7aef\u7684\u9322\u5305\u96c6\u6210\u904e\u7a0b\u4e2d\uff0c\u91cd\u8981\u7684\u662f\u8981\u4e86\u89e3 Daodst \u4e0a\u7684\u8cec\u6236\u88ab\u5be6\u65bd\u70ba\u8207\u4ee5\u592a\u574a\u985e\u578b\u5730\u5740\u517c\u5bb9\u3002</p>"},{"location":"protocol/account/#_1","title":"\u5275\u5efa\u8cec\u865f","text":"<p>\u8981\u5275\u5efa\u4e00\u500b\u5e33\u6236\uff0c\u60a8\u53ef\u4ee5\u5275\u5efa\u79c1\u9470\u3001\u5bc6\u9470\u5eab\u6587\u4ef6\uff08\u53d7\u5bc6\u78bc\u4fdd\u8b77\u7684\u79c1\u9470\uff09\u6216\u52a9\u8a18\u8a5e\uff08\u53ef\u4ee5\u8a2a\u554f\u591a\u500b\u79c1\u9470\u7684\u4e00\u4e32\u55ae\u8a5e\uff09\u3002</p> <p>\u9664\u4e86\u5177\u6709\u4e0d\u540c\u7684\u5b89\u5168\u529f\u80fd\u5916\uff0c\u5b83\u5011\u4e4b\u9593\u6700\u5927\u7684\u5340\u5225\u5728\u65bc\u79c1\u9470\u6216\u5bc6\u9470\u5eab\u6587\u4ef6\u50c5\u5275\u5efa\u4e00\u500b\u5e33\u6236\u3002\u5275\u5efa\u4e00\u500b\u52a9\u8a18\u8a5e\u53ef\u4ee5\u8b93\u60a8\u63a7\u5236\u8a31\u591a\u5e33\u6236\uff0c\u6240\u6709\u5e33\u6236\u90fd\u53ef\u4ee5\u4f7f\u7528\u540c\u4e00\u500b\u77ed\u8a9e\u8a2a\u554f\u3002</p> <p>Cosmos \u5340\u584a\u93c8\u8207 Daodst \u4e00\u6a23\uff0c\u652f\u6301\u4f7f\u7528\u52a9\u8a18\u8a5e\u5275\u5efa\u5e33\u6236\uff0c\u4e5f\u7a31\u70ba\u5206\u5c64\u78ba\u5b9a\u6027\u5bc6\u9470\u751f\u6210\uff08HD \u5bc6\u9470\uff09\u3002\u9019\u5141\u8a31\u7528\u6236\u5728\u591a\u500b\u5340\u584a\u93c8\u4e0a\u5275\u5efa\u5e33\u6236\uff0c\u800c\u7121\u9700\u7ba1\u7406\u591a\u500b\u5bc6\u9470\u3002</p> <p>HD \u5bc6\u9470\u901a\u904e\u7372\u53d6\u52a9\u8a18\u8a5e\u4e26\u5c07\u5176\u8207\u4e00\u689d\u7a31\u70ba\u6d3e\u751f\u8def\u5f91\u7684\u4fe1\u606f\u7d44\u5408\u4f86\u751f\u6210\u5730\u5740\u3002\u5340\u584a\u93c8\u53ef\u4ee5\u5728\u5b83\u5011\u652f\u6301\u7684\u63a8\u5c0e\u8def\u5f91\u4e0a\u6709\u6240\u4e0d\u540c\u3002\u56e0\u6b64\uff0c\u8981\u901a\u904e\u5340\u584a\u93c8\u4e0a\u7684\u52a9\u8a18\u8a5e\u8a2a\u554f\u6240\u6709\u8cec\u6236\uff0c\u4f7f\u7528\u8a72\u5340\u584a\u93c8\u7684\u7279\u5b9a\u63a8\u5c0e\u8def\u5f91\u975e\u5e38\u91cd\u8981\u3002</p>"},{"location":"protocol/account/#_2","title":"\u4ee3\u7406\u8cec\u6236","text":"<p>\u8853\u8a9e<code>\u8cec\u6236</code>\u548c<code>\u5730\u5740</code>\u7d93\u5e38\u4e92\u63db\u4f7f\u7528\u4f86\u63cf\u8ff0\u52a0\u5bc6\u9322\u5305\u3002\u5728 Cosmos SDK \u4e2d\uff0c\u4e00\u500b\u8cec\u6236\u6307\u5b9a\u4e00\u5c0d\u516c\u9470\uff08PubKey\uff09\u548c\u79c1\u9470\uff08PrivKey\uff09\u3002\u6d3e\u751f\u8def\u5f91\u5b9a\u7fa9\u4e86\u79c1\u9470\u3001\u516c\u9470\u548c\u5730\u5740\u3002</p> <p>\u53ef\u4ee5\u6d3e\u751f PubKey \u4ee5\u751f\u6210\u4e0d\u540c\u683c\u5f0f\u7684\u5404\u7a2e\u5730\u5740\uff0c\u9019\u4e9b\u5730\u5740\u7528\u65bc\u8b58\u5225\u61c9\u7528\u7a0b\u5e8f\u4e2d\u7684\u7528\u6236\uff08\u4ee5\u53ca\u5176\u4ed6\u65b9\uff09\u3002 Cosmos \u93c8\u7684\u5e38\u898b\u5730\u5740\u5f62\u5f0f\u662f bech32 \u683c\u5f0f\uff08\u4f8b\u5982 dst1 ...\uff09\u3002\u5730\u5740\u4e5f\u8207\u6d88\u606f\u76f8\u95dc\u806f\u4ee5\u8b58\u5225\u6d88\u606f\u7684\u767c\u9001\u8005\u3002</p> <p>PrivKey \u7528\u65bc\u751f\u6210\u6578\u5b57\u7c3d\u540d\uff0c\u4ee5\u8b49\u660e\u8207 PrivKey \u95dc\u806f\u7684\u5730\u5740\u6279\u51c6\u7d66\u5b9a\u6d88\u606f\u3002\u901a\u904e\u5c0d PrivKey \u61c9\u7528\u52a0\u5bc6\u65b9\u6848\uff08\u7a31\u70ba\u6a62\u5713\u66f2\u7dda\u6578\u5b57\u7c3d\u540d\u7b97\u6cd5 (ECDSA)\uff09\u4f86\u57f7\u884c\u8b49\u660e\uff0c\u4ee5\u751f\u6210\u8207\u6d88\u606f\u4e2d\u7684\u5730\u5740\u9032\u884c\u6bd4\u8f03\u7684\u516c\u9470\u3002</p>"},{"location":"protocol/account/#daodst","title":"Daodst \u8cec\u865f","text":"<p>Daodst \u5b9a\u7fa9\u4e86\u81ea\u5df1\u7684\u81ea\u5b9a\u7fa9\u8cec\u6236\u985e\u578b\uff0c\u4ee5\u5be6\u73fe\u8207\u4ee5\u592a\u574a\u985e\u578b\u5730\u5740\u517c\u5bb9\u7684 HD \u9322\u5305\u3002\u5b83\u4f7f\u7528\u4ee5\u592a\u574a\u7684 ECDSA secp256k1 \u66f2\u7dda\u4f5c\u70ba\u5bc6\u9470 (eth_secp265k1) \u4e26\u6eff\u8db3 EIP84 \u7684\u5b8c\u6574 BIP44 \u8def\u5f91\u3002\u4e0d\u8981\u5c07\u9019\u689d\u52a0\u5bc6\u66f2\u7dda\u8207\u6bd4\u7279\u5e63\u7684 ECDSA secp256k1 \u66f2\u7dda\u6df7\u6dc6\u3002</p> <p>\u57fa\u65bc Daodst \u7684\u5e33\u6236\u7684\u6839 HD \u8def\u5f91\u662f <code>m/44'/60'/0'/0</code>\u3002 Daodst \u4f7f\u7528 Coin type 60 \u4f86\u652f\u6301\u4ee5\u592a\u574a\u985e\u578b\u7684\u8cec\u6236\uff0c\u4e0d\u50cf\u8a31\u591a\u5176\u4ed6\u4f7f\u7528 Coin type 118 \u7684 Cosmos \u93c8\uff08coin types \u5217\u8868</p> <p>\u81ea\u5b9a\u7fa9 Daodst EthAccount \u6eff\u8db3\u4f86\u81ea Cosmos SDK \u8eab\u4efd\u9a57\u8b49\u6a21\u584a\u7684 AccountI \u63a5\u53e3\uff0c\u4e26\u5305\u542b\u4ee5\u592a\u574a\u985e\u578b\u5730\u5740\u6240\u9700\u7684\u5176\u4ed6\u5b57\u6bb5\uff1a</p> <pre><code>// EthAccountI represents the interface of an Daodst compatible account\ntype EthAccountI interface {\n    authtypes.AccountI\n    // EthAddress returns the ethereum Address representation of the AccAddress\n    EthAddress() common.Address\n    // CodeHash is the keccak256 hash of the contract code (if any)\n    GetCodeHash() common.Hash\n    // SetCodeHash sets the code hash to the account fields\n    SetCodeHash(code common.Hash) error\n    // Type returns the type of Ethereum Account (EOA or Contract)\n    Type() int8\n}\n</code></pre>"},{"location":"protocol/account/#_3","title":"\u5730\u5740\u548c\u516c\u9470","text":"<p>BIP-0173 \u70ba\u9694\u96e2\u898b\u8b49\u8f38\u51fa\u5730\u5740\u5b9a\u7fa9\u4e86\u4e00\u7a2e\u65b0\u683c\u5f0f\uff0c\u5176\u4e2d\u5305\u542b\u6a19\u8b58 Bech32 \u7528\u6cd5\u7684\u4eba\u985e\u53ef\u8b80\u90e8\u5206\u3002 Daodst \u4f7f\u7528\u4ee5\u4e0b HRP\uff08\u4eba\u985e\u53ef\u8b80\u524d\u7db4\uff09\u4f5c\u70ba\u57fa\u790e HRP\uff1a</p> \u7f51\u7edc \u4e3b\u7f51 \u6d4b\u8bd5\u7f51 Daodst dst dst <p>\u5728 Daodst \u4e0a\u9ed8\u8a8d\u53ef\u7528\u7684\u5730\u5740/\u516c\u9470\u6709 3 \u7a2e\u4e3b\u8981\u985e\u578b\u7684 HRP\uff1a</p> <ul> <li>\u5e33\u6236\u7684\u5730\u5740\u548c\u5bc6\u9470\uff0c\u7528\u65bc\u8b58\u5225\u7528\u6236\uff08\u4f8b\u5982\u6d88\u606f\u7684\u767c\u4ef6\u4eba\uff09\u3002\u5b83\u5011\u662f\u4f7f eth_secp256k1 \u66f2\u7dda\u5f97\u51fa\u7684\u3002</li> <li>\u9a57\u8b49\u5668\u64cd\u4f5c\u54e1\u7684\u5730\u5740\u548c\u5bc6\u9470\uff0c\u7528\u65bc\u8b58\u5225\u9a57\u8b49\u5668\u7684\u64cd\u4f5c\u54e1\u3002\u5b83\u5011\u662f\u4f7f eth_secp256k1 \u66f2\u7dda\u5f97\u51fa\u7684\u3002</li> <li>\u5171\u8b58\u7bc0\u9ede\u7684\u5730\u5740\u548c\u5bc6\u9470\uff0c\u7528\u65bc\u6a19\u8b58\u53c3\u8207\u5171\u8b58\u7684\u9a57\u8b49\u7bc0\u9ede\u3002\u5b83\u5011\u662f\u4f7f\u7528 ed25519 \u66f2\u7dda\u5f97\u51fa\u7684</li> </ul> \u540d\u79f0 bech32 \u5730\u5740\u524d\u7f00 bech32 \u516c\u94a5\u524d\u7f00 \u66f2\u7ebf  \u5730\u5740\u5b57\u8282\u957f\u5ea6 \u516c\u94a5\u5b57\u8282\u957f\u5ea6 \u5e33\u6236 dst dstpub eth_secp256k1 20 33(compressed) \u9a57\u8b49\u5668\u64cd\u4f5c dstvaloper dstvaloperpub eth_secp256k1 20 33(compressed) \u5171\u8b58\u7bc0\u9ede dstvalcons dstvalconspub ed25519 32"},{"location":"protocol/account/#_4","title":"\u5ba2\u6237\u7684\u5730\u5740\u683c\u5f0f","text":"<p>Eth\u8d26\u53f7 \u53ef\u4ee5\u7528 Bech32 (dst1...) \u548c\u5341\u516d\u8fdb\u5236 (0x...) \u683c\u5f0f\u8868\u793a\uff0c\u4ee5\u5b9e\u73b0\u4ee5\u592a\u574a\u7684 Web3 \u5de5\u5177\u517c\u5bb9\u6027.</p> <p>Bech32 \u683c\u5f0f\u662f\u901a\u904e CLI \u548c REST \u5ba2\u6236\u7aef\u9032\u884c Cosmos-SDK \u67e5\u8a62\u548c\u4ea4\u6613\u7684\u9ed8\u8a8d\u683c\u5f0f\u3002\u53e6\u4e00\u65b9\u9762\uff0c\u5341\u516d\u9032\u5236\u683c\u5f0f\u662f\u4ee5\u592a\u574a common.Address \u8868\u793a Cosmos sdk.AccAddress\u3002</p> <ul> <li>\u5730\u5740 (Bech32): <code>dst1z3t55m0l9h0eupuz3dp5t5cypyv674jj7mz2jw</code></li> <li>\u5730\u5740 (EIP55 16\u8fdb\u5236): <code>0x91defC7fE5603DFA8CC9B655cF5772459BF10c6f</code></li> <li>\u538b\u7f29\u516c\u94a5: <code>{\"@type\":\"/ethermint.crypto.v1.ethsecp256k1.PubKey\",\"key\":\"AsV5oddeB+hkByIJo/4lZiVUgXTzNfBPKC73cZ4K1YD2\"}</code></li> </ul>"},{"location":"protocol/account/#_5","title":"\u5730\u5740\u8f6c\u6362","text":"<p>stcd debug addr  \u53ef\u7528\u4e8e\u5728\u5341\u516d\u8fdb\u5236\u548c bech32 \u683c\u5f0f\u4e4b\u95f4\u8f6c\u6362\u5730\u5740\u3002\u4f8b\u5982\uff1a Bech32 <pre><code> $ stcd debug addr dst1z3t55m0l9h0eupuz3dp5t5cypyv674jj7mz2jw\n  Address: [20 87 74 109 255 45 223 158 7 130 139 67 69 211 4 9 25 175 86 82]\n  Address (hex): 14574A6DFF2DDF9E07828B4345D3040919AF5652\n  Bech32 Acc: dst1z3t55m0l9h0eupuz3dp5t5cypyv674jj7mz2jw\n  Bech32 Val: dstvaloper1z3t55m0l9h0eupuz3dp5t5cypyv674jjn4d6nn\n</code></pre> <p>Hex</p> <pre><code> $ stcd debug addr 14574A6DFF2DDF9E07828B4345D3040919AF5652\n  Address: [20 87 74 109 255 45 223 158 7 130 139 67 69 211 4 9 25 175 86 82]\n  Address (hex): 14574A6DFF2DDF9E07828B4345D3040919AF5652\n  Bech32 Acc: dst1z3t55m0l9h0eupuz3dp5t5cypyv674jj7mz2jw\n  Bech32 Val: dstvaloper1z3t55m0l9h0eupuz3dp5t5cypyv674jjn4d6nn\n</code></pre>"},{"location":"protocol/account/#key","title":"Key \u5bfc\u51fa","text":"<p>\u6211\u4eec\u53ef\u4ee5\u4f7f\u7528\u5e26\u6709\u6807\u5fd7 --bech  (acc|val|cons) \u7684 stcd \u7684 keys show \u547d\u4ee4\u6765\u83b7\u53d6\u5730\u5740\u548c\u5bc6\u94a5\uff0c\u5982\u4e0a\u6240\u8ff0\uff0c <p>\u666e\u901a\u8d26\u53f7</p> <pre><code> $ stcd keys show dev0 --bech acc\n- name: dev0\n  type: local\n  address: dst1z3t55m0l9h0eupuz3dp5t5cypyv674jj7mz2jw\n  pubkey: '{\"@type\":\"/ethermint.crypto.v1.ethsecp256k1.PubKey\",\"key\":\"AsV5oddeB+hkByIJo/4lZiVUgXTzNfBPKC73cZ4K1YD2\"}'\n  mnemonic: \"\"\n</code></pre> <p>\u9a8c\u8bc1\u5668</p> <pre><code> $ stcd keys show dev0 --bech val\n- name: dev0\n  type: local\n  address: dstvaloper1z3t55m0l9h0eupuz3dp5t5cypyv674jjn4d6nn\n  pubkey: '{\"@type\":\"/ethermint.crypto.v1.ethsecp256k1.PubKey\",\"key\":\"AsV5oddeB+hkByIJo/4lZiVUgXTzNfBPKC73cZ4K1YD2\"}'\n  mnemonic: \"\"\n</code></pre> <p>\u5171\u8bc6</p> <pre><code> $ stcd keys show dev0 --bech cons\n- name: dev0\n  type: local\n  address: dstvalcons1rllqa5d97n6zyjhy6cnscc7zu30zjn3f7wyj2n\n  pubkey: '{\"@type\":\"/ethermint.crypto.v1.ethsecp256k1.PubKey\",\"key\":\"A/fVLgIqiLykFQxum96JkSOoTemrXD0tFaFQ1B0cpB2c\"}'\n  mnemonic: \"\"\n</code></pre>"},{"location":"protocol/account/#_6","title":"\u8cec\u865f\u67e5\u8a62","text":"<p>\u60a8\u53ef\u4ee5\u4f7f\u7528 CLI\u3001gRPC \u6216</p> <p>\u547d\u4ee4\u884c\u754c\u9762</p> <pre><code># NOTE: the --output (-o) flag will define the output format in JSON or YAML (text)\nstcd q auth account $(stcd keys show dev0 -a) -o text\n\n'@type': /ethermint.types.v1.EthAccount\nbase_account:\naccount_number: \"0\"\naddress: dst1z3t55m0l9h0eupuz3dp5t5cypyv674jj7mz2jw\npub_key:\n  '@type': /ethermint.crypto.v1.ethsecp256k1.PubKey\n  key: AsV5oddeB+hkByIJo/4lZiVUgXTzNfBPKC73cZ4K1YD2\nsequence: \"1\"\ncode_hash: 0xc5d2460186f7233c927e7db2dcc703c0e500b653ca82273b7bfad8045d85a470\n</code></pre> <p>Cosmos gRPC and REST</p> <pre><code># GET /cosmos/auth/v1beta1/accounts/{address}\ncurl -X GET \"http://localhost:10337/cosmos/auth/v1beta1/accounts/dst14au322k9munkmx5wrchz9q30juf5wjgz2cfqku\" -H \"accept: application/json\"\n</code></pre> <p>JSON-RPC \u8981\u4f7f\u7528 Web3 \u68c0\u7d22\u4ee5\u592a\u574a\u5341\u516d\u8fdb\u5236\u5730\u5740\uff0c\u8bf7\u4f7f\u7528 JSON-RPC eth_accounts \u6216 personal_listAccounts \u7aef\u70b9</p> <pre><code># query against a local node\ncurl -X POST --data '{\"jsonrpc\":\"2.0\",\"method\":\"eth_accounts\",\"params\":[],\"id\":1}' -H \"Content-Type: application/json\" http://localhost:8545\n\ncurl -X POST --data '{\"jsonrpc\":\"2.0\",\"method\":\"personal_listAccounts\",\"params\":[],\"id\":1}' -H \"Content-Type: application/json\" http://localhost:8545\n</code></pre>"},{"location":"protocol/chainid/","title":"\u93c8ID","text":"<p>\u93c8 ID \u662f\u4ee3\u8868\u5340\u584a\u934a\u7db2\u7d61\u7684\u552f\u4e00\u6a19\u8b58\u7b26\u3002\u6211\u5011\u7528\u5b83\u4f86\u5340\u5206\u4e0d\u540c\u7684\u5340\u584a\u934a\u7db2\u7d61\uff0c\u4e26\u78ba\u4fdd\u4ea4\u6613\u548c\u6d88\u606f\u88ab\u767c\u9001\u5230\u6b63\u78ba\u7684\u7db2\u7d61\u3002 Daodst\u7db2\u7d61\u9075\u5faa identifier_EIP155-version \u7684\u683c\u5f0f\u3002</p>"},{"location":"protocol/chainid/#_1","title":"\u4e3b\u7db2","text":"\u540d\u7a31 \u93c8 ID \u6a19\u8b58\u7b26 EIP155 Number \u7248\u672c \u6fc0\u6d3b Daodst1 <code>daodst_7777-1</code> daodst 7777 1 yes"},{"location":"protocol/chainid/#_2","title":"\u6e2c\u8a66\u7db2","text":"\u540d\u7a31 \u93c8 ID \u6a19\u8b58\u7b26 EIP155 Number \u7248\u672c \u6fc0\u6d3b Daodst Public Testnet <code>daodst_7000-1</code> daodst 7000 1 yes"},{"location":"protocol/chainid/#_3","title":"\u93c8\u8eab\u4efd","text":"<p>\u6bcf\u689d\u93c8\u90fd\u5fc5\u9808\u6709\u4e00\u500b\u552f\u4e00\u7684\u6a19\u8b58\u7b26\u6216 <code>chain-id</code>\u3002 Tendermint \u8981\u6c42\u6bcf\u500b\u61c9\u7528\u7a0b\u5e8f\u5728 genesis.json \u5b57\u6bb5 \u4e2d\u5b9a\u7fa9\u81ea\u5df1\u7684 <code>chain-id</code>\u3002\u4f46\u662f\uff0c\u70ba\u4e86\u540c\u6642\u7b26\u5408 EIP155 \u548c Cosmos \u93c8\u5347\u7d1a\u6a19\u6e96\uff0cDaodst \u517c\u5bb9\u93c8\u5fc5\u9808\u5be6\u73fe\u4ed6\u5011\u7684\u93c8\u6a19\u8b58\u7b26\u7684\u7279\u6b8a\u7d50\u69cb\u3002</p>"},{"location":"protocol/chainid/#_4","title":"\u7d50\u69cb","text":"<p>Daodst \u93c8 ID \u5305\u542b 3 \u500b\u4e3b\u8981\u7d44\u4ef6</p> <ul> <li>\u6a19\u8b58\u7b26: \u5b9a\u7fa9\u61c9\u7528\u7a0b\u5e8f\u540d\u7a31\u7684\u975e\u7d50\u69cb\u5316\u5b57\u7b26\u4e32\u3002</li> <li>EIP155 Number: \u4e0d\u53ef\u8b8a EIP155 <code>CHAIN_ID</code>   \u5b9a\u7fa9\u91cd\u653e\u653b\u64ca\u4fdd\u8b77\u6578\u3002</li> <li>\u7248\u672c\u865f: \u662f\u93c8\u7576\u524d\u6b63\u5728\u904b\u884c\u7684\u7248\u672c\u865f\uff08\u59cb\u7d42\u70ba\u6b63\u6578\uff09\u3002\u6bcf\u6b21\u93c8\u5347\u7d1a\u6216\u5206\u53c9\u6642\uff0c\u9019\u500b\u6578\u5b57\u5fc5\u9808\u905e\u589e\uff0c\u4ee5\u907f\u514d\u7db2\u7d61\u6216\u5171\u8b58\u932f\u8aa4\u3002</li> </ul>"},{"location":"protocol/chainid/#_5","title":"\u683c\u5f0f","text":"<p>genesis\u4e2d\u6307\u5b9a\u548cDaodst\u517c\u5bb9\u7684chain-id\u7684\u683c\u5f0f\u5982\u4e0b\uff1a</p> <pre><code>{identifier}_{EIP155}-{version}\n</code></pre> <p>\u4e0b\u8868\u63d0\u4f9b\u4e86\u4e00\u500b\u793a\u4f8b\uff0c\u5176\u4e2d\u7b2c\u4e8c\u884c\u5c0d\u61c9\u65bc\u7b2c\u4e00\u884c\u7684\u5347\u7d1a\uff1a</p> ChainID Identifier EIP155 Number Version Number <code>daodst_7777-1</code> daodst 7777 1 <code>daodst_7777-2</code> daodst 7777 2 <code>...</code> ... ... ... <code>daodst_7777-N</code> daodst 7777 N"},{"location":"protocol/coin/","title":"\u4ee3\u5e63","text":""},{"location":"protocol/coin/#daodst","title":"DAODST \u4ee3\u5e01","text":"<p>EVM \u4e0a\u7528\u65bc\u8cea\u62bc\u3001\u6cbb\u7406\u548c\u6c23\u9ad4\u6d88\u8017\u7684\u9762\u984d\u662f FM\u3002 FM \u63d0\u4f9b\u4ee5\u4e0b\u5be6\u7528\u7a0b\u5e8f\uff1a\u4fdd\u8b77\u6b0a\u76ca\u8b49\u660e\u93c8\u3001\u7528\u65bc\u6cbb\u7406\u5efa\u8b70\u7684\u4ee3\u5e63\u3001\u5411\u9a57\u8b49\u8005\u548c\u7528\u6236\u5206\u914d\u8cbb\u7528\uff0c\u4ee5\u53ca\u4f5c\u70ba\u5728 EVM \u4e0a\u904b\u884c\u667a\u80fd\u5408\u7d04\u7684\u71c3\u6599\u3002</p> <p>DAODST \u8cc7\u7522\u5206\u70ba\u4e09\u985e\uff1a</p> <ul> <li>\u539f\u751f FM\u3001DST\u3001HASH \u4ee3\u5e63</li> <li>IBC\u4ee3\u5e63\uff08\u901a\u904e IBC\uff09</li> <li>\u4ee5\u592a\u574a\u985e\u578b\u7684\u4ee3\u5e63\uff0c\u4f8b\u5982 ERC-20</li> </ul>"},{"location":"protocol/coin/#cosmos","title":"Cosmos \u4ee3\u5e01","text":"<p>\u8cec\u6236\u53ef\u4ee5\u5728\u5176\u9918\u984d\u4e2d\u64c1\u6709 Cosmos \u5e63\uff0c\u9019\u4e9b\u5e63\u7528\u65bc\u8207\u5176\u4ed6 Cosmos \u7684\u64cd\u4f5c\u548c\u4ea4\u6613\u3002 \u9019\u4e9b\u4f8b\u5b50\u5305\u62ec\u4f7f\u7528\u4ee3\u5e63\u9032\u884c\u8cea\u62bc\u3001IBC \u8f49\u8cec\u3001\u6cbb\u7406\u5b58\u6b3e\u548c EVM\u3002</p>"},{"location":"protocol/coin/#evm","title":"EVM \u4ee3\u5e01","text":"<p>Daodst \u8207 ERC20 \u4ee3\u5e63\u548c EVM \u539f\u751f\u652f\u6301\u7684\u5176\u4ed6\u4e0d\u53ef\u66ff\u4ee3\u4ee3\u5e63\u6a19\u6e96\uff08EIP721\u3001EIP1155\uff09\u517c\u5bb9\u3002</p>"},{"location":"protocol/encode/","title":"\u7de8\u78bc","text":"<p>\u7de8\u78bc\u662f\u6307\u5c07\u6578\u64da\u5f9e\u4e00\u7a2e\u683c\u5f0f\u8f49\u63db\u70ba\u53e6\u4e00\u7a2e\u683c\u5f0f\u4ee5\u4f7f\u5176\u66f4\u52a0\u5b89\u5168\u548c\u9ad8\u6548\u7684\u904e\u7a0b\u3002</p> <p>\u5728\u5340\u584a\u93c8\u7684\u80cc\u666f\u4e0b\uff0c\u7de8\u78bc\u7528\u65bc\u78ba\u4fdd\u6578\u64da\u4ee5\u5b89\u5168\u4e14\u6613\u65bc\u8a2a\u554f\u7684\u65b9\u5f0f\u5b58\u5132\u548c\u50b3\u8f38\u3002</p> <p>\u905e\u6b78\u9577\u5ea6\u524d\u7db4 (RLP) \u662f\u4e00\u7a2e\u5728\u4ee5\u592a\u574a\u57f7\u884c\u5ba2\u6236\u7aef\u4e2d\u5ee3\u6cdb\u4f7f\u7528\u7684\u5e8f\u5217\u5316\u683c\u5f0f\u3002</p> <p>\u5b83\u7684\u76ee\u7684\u662f\u5c0d\u4efb\u610f\u5d4c\u5957\u7684\u4e8c\u9032\u5236\u6578\u64da\u6578\u7d44\u9032\u884c\u7de8\u78bc\uff0c\u662f\u4ee5\u592a\u574a\u4e2d\u7528\u65bc\u5e8f\u5217\u5316\u5c0d\u8c61\u7684\u4e3b\u8981\u7de8\u78bc\u65b9\u5f0f\u3002</p> <p>RLP \u50c5\u5c0d\u7d50\u69cb\u9032\u884c\u7de8\u78bc\uff0c\u800c\u5c07\u5c0d\u7279\u5b9a\u539f\u5b50\u6578\u64da\u985e\u578b\uff08\u4f8b\u5982\u5b57\u7b26\u4e32\u3001\u6574\u6578\u548c\u6d6e\u9ede\u6578\uff09\u7684\u7de8\u78bc\u7559\u7d66\u9ad8\u968e\u5354\u8b70\u3002</p> <p>\u5728\u4ee5\u592a\u574a\u4e2d\uff0c\u6574\u6578\u5fc5\u9808\u4ee5\u6c92\u6709\u524d\u5c0e\u96f6\u7684\u5927\u7aef\u4e8c\u9032\u5236\u5f62\u5f0f\u8868\u793a\uff0c\u4f7f\u5f97\u6574\u6578\u503c\u96f6\u7b49\u540c\u65bc\u7a7a\u5b57\u7bc0\u6578\u7d44\u3002</p> <p>RLP \u7de8\u78bc\u51fd\u6578\u63a5\u53d7\u4e00\u500b\u9805\u76ee\uff0c\u8a72\u9805\u76ee\u88ab\u5b9a\u7fa9\u70ba\u503c\u5728 [0x00, 0x7f] \u7bc4\u570d\u5167\u7684\u55ae\u500b\u5b57\u7bc0\u6216 0-55 \u5b57\u7bc0\u9577\u7684\u5b57\u7b26\u4e32\u3002</p> <p>\u5982\u679c\u5b57\u7b26\u4e32\u7684\u9577\u5ea6\u8d85\u904e 55 \u500b\u5b57\u7bc0\uff0c\u5247 RLP \u7de8\u78bc\u5305\u542b\u4e00\u500b\u503c\u70ba 0xb7\uff08dec.183\uff09\u7684\u5b57\u7bc0\u52a0\u4e0a\u9577\u5ea6 \u4e8c\u9032\u5236\u5f62\u5f0f\u7684\u5b57\u7b26\u4e32\u9577\u5ea6\u7684\u5b57\u7bc0\uff0c\u5f8c\u8ddf\u5b57\u7b26\u4e32\u7684\u9577\u5ea6\uff0c\u5f8c\u8ddf\u5b57\u7b26\u4e32\u3002</p> <p>RLP \u7528\u65bc\u54c8\u5e0c\u9a57\u8b49\uff0c\u5176\u4e2d\u901a\u904e\u7c3d\u7f72\u4ea4\u6613\u6578\u64da\u7684 RLP \u54c8\u5e0c\u4f86\u7c3d\u7f72\u4ea4\u6613\uff0c\u4e26\u4e14\u5340\u584a\u7531\u5176\u6a19\u982d\u7684 RLP \u54c8\u5e0c\u6a19\u8b58\u3002</p> <p>RLP \u9084\u7528\u65bc\u901a\u904e\u7db2\u7d61\u5c0d\u6578\u64da\u9032\u884c\u7de8\u78bc\uff0c\u4ee5\u53ca\u5728\u67d0\u4e9b\u60c5\u6cc1\u4e0b\u61c9\u8a72\u652f\u6301\u9ed8\u514b\u723e\u6a39\u6578\u64da\u7d50\u69cb\u7684\u9ad8\u6548\u7de8\u78bc\u3002</p> <p>\u4ee5\u592a\u574a\u57f7\u884c\u5c64\u4f7f\u7528 RLP \u4f5c\u70ba\u5e8f\u5217\u5316\u5c0d\u8c61\u7684\u4e3b\u8981\u7de8\u78bc\u65b9\u5f0f\uff0c\u4f46\u66f4\u65b0\u7684 Simple Serialize (SSZ) \u53d6\u4ee3\u4e86 RLP \u4f5c\u70ba\u4ee5\u592a\u574a 2.0 \u4e2d\u65b0\u5171\u8b58\u5c64\u7684\u7de8\u78bc\u3002</p> <p>Cosmos Stargate \u7248\u672c\u5f15\u5165\u4e86 protobuf \u4f5c\u70ba\u5ba2\u6236\u7aef\u548c\u72c0\u614b\u5e8f\u5217\u5316\u7684\u4e3b\u8981\u7de8\u78bc\u683c\u5f0f\u3002</p> <p>\u6240\u6709\u7528\u65bc\u72c0\u614b\u548c\u5ba2\u6236\u7aef\u7684 EVM \u6a21\u584a\u985e\u578b\uff0c\u5982\u4ea4\u6613\u6d88\u606f\u3001\u5275\u4e16\u3001\u67e5\u8a62\u670d\u52d9\u7b49\uff0c\u90fd\u5c07\u4f5c\u70ba\u5354\u8b70\u7de9\u885d\u5340\u6d88\u606f\u5be6\u73fe\u3002</p> <p>Cosmos SDK \u9084\u652f\u6301\u50b3\u7d71\u7684 Amino \u7de8\u78bc\u3002</p> <p>Protocol Buffers (protobuf) \u662f\u4e00\u7a2e\u8207\u8a9e\u8a00\u7121\u95dc\u7684\u4e8c\u9032\u5236\u5e8f\u5217\u5316\u683c\u5f0f\uff0c\u5b83\u6bd4 JSON \u66f4\u5c0f\u66f4\u5feb\u3002</p> <p>\u5b83\u7528\u65bc\u5e8f\u5217\u5316\u7d50\u69cb\u5316\u6578\u64da\uff0c\u4f8b\u5982\u6d88\u606f\uff0c\u4e26\u4e14\u88ab\u8a2d\u8a08\u70ba\u9ad8\u6548\u548c\u53ef\u64f4\u5c55\u7684\u3002</p> <p>\u7de8\u78bc\u683c\u5f0f\u4ee5\u8207\u8a9e\u8a00\u7121\u95dc\u7684\u8a9e\u8a00\u5b9a\u7fa9\uff0c\u7a31\u70ba Protocol Buffers Language (proto3)\uff0c\u7de8\u78bc\u7684\u6d88\u606f\u53ef\u7528\u65bc\u70ba\u5404\u7a2e\u7de8\u7a0b\u8a9e\u8a00\u751f\u6210\u4ee3\u78bc\u3002</p> <p>protobuf \u7684\u4e3b\u8981\u512a\u9ede\u662f\u5b83\u7684\u6548\u7387\uff0c\u9019\u5c0e\u81f4\u66f4\u5c0f\u7684\u6d88\u606f\u5927\u5c0f\u548c\u66f4\u5feb\u7684\u5e8f\u5217\u5316\u548c\u53cd\u5e8f\u5217\u5316\u6642\u9593\u3002</p> <p>RLP\u89e3\u78bc\u904e\u7a0b\u5982\u4e0b\uff1a\u6839\u64da\u8f38\u5165\u6578\u64da\u7684\u7b2c\u4e00\u500b\u5b57\u7bc0\uff08\u5373\u524d\u7db4\uff09\u89e3\u78bc\u6578\u64da\u985e\u578b\u3001\u5be6\u969b\u6578\u64da\u7684\u9577\u5ea6\u548c\u504f\u79fb\u91cf\uff1b\u6839\u64da\u6578\u64da\u7684\u985e\u578b\u548c\u504f\u79fb\u91cf\uff0c\u5c0d\u6578\u64da\u9032\u884c\u76f8\u61c9\u7684\u89e3\u78bc\u3002</p>"},{"location":"protocol/encode/#_1","title":"\u5148\u6c7a\u689d\u4ef6\u95b1\u8b80","text":"<ul> <li>Cosmos SDK Encoding</li> <li>Ethereum RLP</li> </ul>"},{"location":"protocol/encode/#_2","title":"\u7de8\u78bc\u683c\u5f0f","text":"<p> Protocol Buffers </p> <p>Cosmos Stargate \u7248\u672c\u5f15\u5165\u4e86 protobuf \u4f5c\u70ba\u5ba2\u6236\u7aef\u548c\u72c0\u614b\u5e8f\u5217\u5316\u7684\u4e3b\u8981\u7de8\u78bc\u683c\u5f0f\u3002</p> <p>\u6240\u6709\u7528\u65bc\u72c0\u614b\u548c\u5ba2\u6236\u7aef\uff08\u4ea4\u6613\u6d88\u606f\u3001\u5275\u4e16\u3001\u67e5\u8a62\u670d\u52d9\u7b49\uff09\u7684 EVM \u6a21\u584a\u985e\u578b\u90fd\u5c07\u4f5c\u70ba\u5354\u8b70\u7de9\u885d\u5340\u6d88\u606f\u5be6\u73fe\u3002</p> <p>  Amino </p> <p>Cosmos SDK \u9084\u652f\u6301\u820a\u7248 Amino \u7de8\u78bc\u683c\u5f0f\uff0c\u4ee5\u5411\u5f8c\u517c\u5bb9\u4ee5\u524d\u7684\u7248\u672c\uff0c\u7279\u5225\u662f\u7528\u65bc\u5ba2\u6236\u7aef\u7de8\u78bc\u548c\u4f7f\u7528 Ledger \u8a2d\u5099\u7c3d\u540d\u3002</p> <p>Daodst \u5728 EVM \u6a21\u584a\u4e2d\u4e0d\u652f\u6301 Amino\uff0c\u4f46\u6240\u6709\u5176\u4ed6\u555f\u7528\u5b83\u7684 Cosmos SDK \u6a21\u584a\u90fd\u652f\u6301\u5b83\u3002</p> <p>  RLP </p> <p>\u905e\u6b78\u9577\u5ea6\u524d\u7db4 (RLP) \u662f\u4e00\u7a2e\u7de8\u78bc/\u89e3\u78bc\u7b97\u6cd5\uff0c\u53ef\u5e8f\u5217\u5316\u6d88\u606f\u4e26\u5141\u8a31\u5feb\u901f\u91cd\u5efa\u7de8\u78bc\u6578\u64da\u3002</p> <p>Daodst \u4f7f\u7528 RLP \u7de8\u78bc/\u89e3\u78bc\u4ee5\u592a\u574a\u6d88\u606f\u4ee5\u9032\u884c JSON-RPC \u8655\u7406\uff0c\u4ee5\u4f7f\u6d88\u606f\u7b26\u5408\u6b63\u78ba\u7684\u4ee5\u592a\u574a\u683c\u5f0f\u3002\u9019\u5141\u8a31\u4ee5\u8207\u4ee5\u592a\u574a\u7684\u683c\u5f0f\u5b8c\u5168\u76f8\u540c\u7684\u683c\u5f0f\u5c0d\u6d88\u606f\u9032\u884c\u7de8\u78bc\u548c\u89e3\u78bc\u3002</p> <p><code>x/evm</code> \u4ea4\u6613 (<code>MsgEthereumTx</code>) \u7de8\u78bc\u662f\u901a\u904e\u5c07\u6d88\u606f\u8f49\u63db\u70ba go-ethereum \u7684 <code>Transaction</code> \u7136\u5f8c\u4f7f\u7528 RLP \u7de8\u7d44\u4ea4\u6613\u6578\u64da\u4f86\u57f7\u884c\u7684\uff1a</p> <pre><code>// TxEncoder overwrites sdk.TxEncoder to support MsgEthereumTx\nfunc (g txConfig) TxEncoder() sdk.TxEncoder {\nreturn func(tx sdk.Tx) ([]byte, error) {\n  msg, ok := tx.(*evmtypes.MsgEthereumTx)\n  if ok {\n    return msg.AsTransaction().MarshalBinary()\n  }\n  return g.TxConfig.TxEncoder()(tx)\n}\n}\n\n// TxDecoder overwrites sdk.TxDecoder to support MsgEthereumTx\nfunc (g txConfig) TxDecoder() sdk.TxDecoder {\nreturn func(txBytes []byte) (sdk.Tx, error) {\n  tx := &amp;ethtypes.Transaction{}\n\n  err := tx.UnmarshalBinary(txBytes)\n  if err == nil {\n    msg := &amp;evmtypes.MsgEthereumTx{}\n    msg.FromEthereumTx(tx)\n    return msg, nil\n  }\n\n  return g.TxConfig.TxDecoder()(txBytes)\n}\n}\n</code></pre>"},{"location":"protocol/gas/","title":"Gas\u548c\u624b\u7e8c\u8cbb","text":"<p>\u7528\u6236\u9700\u8981\u652f\u4ed8\u8cbb\u7528\u624d\u80fd\u5728 Daodst \u7db2\u7d61\u4e0a\u63d0\u4ea4\u4ea4\u6613\u3002 \u7531\u65bc\u4ee5\u592a\u574a\u548c Cosmos \u7684\u8cbb\u7528\u8655\u7406\u65b9\u5f0f\u4e0d\u540c\uff0c\u4e86\u89e3 Daodst \u5340\u584a\u93c8\u5982\u4f55\u5be6\u73fe\u8207 Cosmos SDK \u517c\u5bb9\u7684\u4ee5\u592a\u574a\u985e\u578b\u7684\u8cbb\u7528\u8a08\u7b97\u975e\u5e38\u91cd\u8981\u3002</p> <p>\u56e0\u6b64\uff0c\u672c\u6982\u8ff0\u89e3\u91cb\u4e86\u5929\u7136\u6c23\u8a08\u7b97\u7684\u57fa\u790e\u77e5\u8b58\u3001\u5982\u4f55\u70ba\u4ea4\u6613\u63d0\u4f9b\u8cbb\u7528\u4ee5\u53ca\u4ee5\u592a\u574a\u985e\u578b\u7684\u8cbb\u7528\u8a08\u7b97\u5982\u4f55\u4f7f\u7528\u8cbb\u7528\u5e02\u5834 (EIP1559) \u4f86\u78ba\u5b9a\u4ea4\u6613\u7684\u512a\u5148\u7d1a\u3002</p> <p>\u53e6\u5916\u8acb\u6ce8\u610f\uff0c\u8207 Daodst \u4e0a\u7684\u667a\u80fd\u5408\u7d04\u4ea4\u4e92\u6240\u652f\u4ed8\u7684\u8cbb\u7528\u53ef\u4ee5\u70ba\u667a\u80fd\u5408\u7d04\u90e8\u7f72\u8005\u8cfa\u53d6\u6536\u5165\u3002</p>"},{"location":"protocol/gas/#_1","title":"\u5148\u6c7a\u689d\u4ef6\u95b1\u8b80","text":"<ul> <li>Cosmos SDK Gas</li> <li>Ethereum Gas</li> </ul>"},{"location":"protocol/gas/#_2","title":"\u57fa\u790e","text":""},{"location":"protocol/gas/#_3","title":"\u70ba\u4ec0\u9ebc\u4ea4\u6613\u9700\u8981\u624b\u7e8c\u8cbb?","text":"<p>\u5982\u679c\u4efb\u4f55\u4eba\u90fd\u53ef\u4ee5\u514d\u8cbb\u5411\u7db2\u7d61\u63d0\u4ea4\u4ea4\u6613\uff0c\u5247\u7db2\u7d61\u53ef\u80fd\u6703\u88ab\u5c11\u6578\u53c3\u8207\u8005\u767c\u9001\u5927\u91cf\u6b3a\u8a50\u6027\u4ea4\u6613\u4ee5\u963b\u585e\u7db2\u7d61\u4e26\u4f7f\u5176\u7121\u6cd5\u6b63\u5e38\u5de5\u4f5c\u3002</p> <p>\u9019\u500b\u554f\u984c\u7684\u89e3\u6c7a\u65b9\u6848\u662f\u4e00\u500b\u53eb\u505a<code>gas</code>\u7684\u6982\u5ff5\uff0c\u5b83\u662f\u5728\u6574\u500b\u4ea4\u6613\u57f7\u884c\u904e\u7a0b\u4e2d\u6d88\u8017\u7684\u8cc7\u6e90\u3002</p> <p>\u5728\u5be6\u8e10\u4e2d\uff0c\u4ee3\u78bc\u57f7\u884c\u7684\u6bcf\u4e00\u6b65\u90fd\u6703\u6d88\u8017\u5c11\u91cfgas\uff0c\u5f9e\u800c\u6709\u6548\u5730\u5c0d\u9a57\u8b49\u8005\u8cc7\u6e90\u7684\u4f7f\u7528\u9032\u884c\u6536\u8cbb\uff0c\u4e26\u9632\u6b62\u60e1\u610f\u884c\u70ba\u8005\u96a8\u610f\u4e2d\u65b7\u7db2\u7d61\u3002</p>"},{"location":"protocol/gas/#gas","title":"\u4ec0\u9ebc\u662f Gas?","text":"<p>\u4e00\u822c\u4f86\u8aaa\uff0cgas \u662f\u8861\u91cf\u7279\u5b9a\u4ea4\u6613\u8a08\u7b97\u5f37\u5ea6\u7684\u55ae\u4f4d\u2014\u2014\u63db\u53e5\u8a71\u8aaa\uff0c\u8a55\u4f30\u548c\u57f7\u884c\u9019\u9805\u5de5\u4f5c\u9700\u8981\u591a\u5c11\u5de5\u4f5c\u91cf\u3002</p> <p>\u8907\u96dc\u7684\u591a\u6b65\u4ea4\u6613\uff0c\u4f8b\u5982\u59d4\u8a17\u7d66\u5341\u5e7e\u500b\u9a57\u8b49\u5668\u7684 Cosmos \u4ea4\u6613\uff0c\u6bd4\u7c21\u55ae\u7684\u55ae\u6b65\u4ea4\u6613\uff08\u4f8b\u5982\u5c07\u4ee3\u5e63\u767c\u9001\u5230\u53e6\u4e00\u500b\u5730\u5740\u7684 Cosmos \u4ea4\u6613\uff09\u9700\u8981\u66f4\u591a\u7684 gas\u3002</p> <p>\u5728\u63d0\u53ca\u4ea4\u6613\u6642\uff0c<code>gas</code>\u662f\u6307\u4ea4\u6613\u6240\u9700\u7684gas\u7e3d\u91cf\u3002</p> <p>\u4f8b\u5982\uff0c\u4e00\u7b46\u4ea4\u6613\u53ef\u80fd\u9700\u8981 300,000 \u55ae\u4f4d\u7684gas\u624d\u80fd\u57f7\u884c\u3002</p> <p>\u53ef\u4ee5\u5c07gas\u8996\u70ba\u623f\u5c4b\u6216\u5de5\u5ee0\u5167\u7684\u96fb\u529b (kWh)\uff0c\u6216\u6c7d\u8eca\u71c3\u6599\u3002</p> <p>\u9019\u500b\u60f3\u6cd5\u662f\u8981\u82b1\u4e00\u4e9b\u9322\u624d\u80fd\u5230\u9054\u67d0\u500b\u5730\u65b9\u3002</p> <p>\u66f4\u591a Gas \u4ecb\u7d39:</p> <ul> <li>Cosmos Gas Fees</li> <li>Cosmos Tx Lifecycle</li> <li>Ethereum Gas</li> </ul>"},{"location":"protocol/gas/#gas_1","title":"\u5982\u4f55\u8a08\u7b97Gas","text":"<p>\u4e00\u822c\u4f86\u8aaa\uff0c\u5982\u679c\u4e0d\u7c21\u55ae\u5730\u904b\u884c\u4ea4\u6613\uff0c\u5c31\u7121\u6cd5\u78ba\u5207\u77e5\u9053\u4ea4\u6613\u5c07\u82b1\u8cbb\u591a\u5c11 gas\u3002</p> <p>\u4f7f\u7528 Cosmos SDK\uff0c\u9019\u53ef\u4ee5\u901a\u904e\u6a21\u64ec Tx \u4f86\u5b8c\u6210\u3002</p> <p>\u5426\u5247\uff0c\u6709\u4e00\u4e9b\u65b9\u6cd5\u53ef\u4ee5\u6839\u64da\u4ea4\u6613\u5b57\u6bb5\u548c\u6578\u64da\u7684\u8a73\u7d30\u4fe1\u606f\u4f86\u4f30\u8a08\u4ea4\u6613\u5c07\u9700\u8981\u7684gas\u3002</p> <p>\u4f8b\u5982\uff0c\u5728 EVM \u7684\u60c5\u6cc1\u4e0b\uff0c\u6bcf\u500b\u5b57\u7bc0\u78bc\u64cd\u4f5c\u90fd\u6709 \u76f8\u61c9\u6578\u91cf\u7684gas\u3002</p> <p>\u66f4\u591a\u95dc\u65bcGas\u8a08\u7b97:</p> <ul> <li>Estimate Gas</li> <li>Executing EVM Bytecode</li> <li>Simulate a Cosmos SDK Tx</li> </ul>"},{"location":"protocol/gas/#gas_2","title":"Gas\u548c\u624b\u7e8c\u8cbb\u7684\u95dc\u4fc2?","text":"<p>Gas \u662f\u6307\u57f7\u884c\u6240\u9700\u7684\u8a08\u7b97\u5de5\u4f5c\uff0c\u800c\u8cbb\u7528\u662f\u6307\u60a8\u5be6\u969b\u82b1\u8cbb\u4f86\u57f7\u884c\u4ea4\u6613\u7684\u4ee3\u5e63\u6578\u91cf\u3002</p> <p>\u5b83\u5011\u662f\u4f7f\u7528\u4ee5\u4e0b\u516c\u5f0f\u5f97\u51fa\u7684\uff1a</p> <pre><code>Total Fees = Gas * Gas Price (the price per unit of gas)\n</code></pre> <p>\u5982\u679c <code>gas</code> \u4ee5 kWh \u70ba\u55ae\u4f4d\uff0c\u5247\u201cgas price\u201d\u5c07\u662f\u60a8\u7684\u80fd\u6e90\u4f9b\u61c9\u5546\u78ba\u5b9a\u7684\u8cbb\u7387\uff08\u4ee5\u7f8e\u5143/kWh \u70ba\u55ae\u4f4d\uff09\uff0c\u800c <code>fees\u200b\u200b</code> \u5c07\u662f\u60a8\u7684\u8cec\u55ae\u3002</p> <p>\u8207\u96fb\u529b\u4e00\u6a23\uff0cgas\u50f9\u683c\u5728\u67d0\u4e00\u5929\u53ef\u80fd\u6703\u6ce2\u52d5\uff0c\u5177\u9ad4\u53d6\u6c7a\u65bc\u7db2\u7d61\u6d41\u91cf\u3002</p> <p>\u66f4\u591a\u95dc\u65bc Gas \u548c \u624b\u7e8c\u8cbb:</p> <ul> <li>Cosmos Gas and Fees</li> <li>Ethereum Gas and Fees</li> </ul>"},{"location":"protocol/gas/#cosmos","title":"Cosmos\u5982\u4f55\u8655\u7406\u624b\u7e8c\u8cbb?","text":"<p>Cosmos \u7684gas\u8cbb\u76f8\u5c0d\u7c21\u55ae\u3002\u4f5c\u70ba\u7528\u6236\uff0c\u60a8\u6307\u5b9a\u5169\u500b\u5b57\u6bb5\uff1a</p> <ol> <li>\u5c0d\u61c9\u65bc\u57f7\u884c\u6c23\u9ad4\u4e0a\u9650\u7684 <code>GasLimit</code>\uff0c\u5b9a\u7fa9\u70ba<code>GasWanted</code></li> <li><code>Fees</code> \u6216 <code>GasPrice</code> \u4e4b\u4e00\uff0c\u5c07\u7528\u65bc\u6307\u5b9a\u6216\u8a08\u7b97\u4ea4\u6613\u8cbb\u7528</li> </ol> <p>\u7bc0\u9ede\u5c07\u5b8c\u5168\u6d88\u8017\u6240\u63d0\u4f9b\u7684\u8cbb\u7528\uff0c\u7136\u5f8c\u958b\u59cb\u57f7\u884c\u4ea4\u6613\u3002 \u5982\u679c\u5728\u57f7\u884c\u904e\u7a0b\u4e2d\u767c\u73fe<code>GasLimit</code>\u4e0d\u8db3\uff0c\u4ea4\u6613\u5c07\u5931\u6557\u4e26\u56de\u6efe\u4efb\u4f55\u66f4\u6539\uff0c\u4e0d\u9000\u9084\u63d0\u4f9b\u7684\u8cbb\u7528\u3002</p> <p>\u57fa\u65bc Cosmos SDK \u7684\u93c8\u7684\u9a57\u8b49\u8005\u53ef\u4ee5\u6307\u5b9a\u4ed6\u5011\u5728\u9078\u64c7\u8981\u5305\u542b\u5728\u5340\u584a\u4e2d\u7684\u4ea4\u6613\u6642\u5c07\u5f37\u5236\u57f7\u884c\u7684\u201c\u6700\u4f4e\u6c7d\u6cb9\u50f9\u683c\u201d\u3002</p> <p>\u56e0\u6b64\uff0c\u8cbb\u7528\u4e0d\u8db3\u7684\u4ea4\u6613\u5c07\u9047\u5230\u5ef6\u9072\u6216\u5fb9\u5e95\u5931\u6557\u3002</p> <p>\u5728\u6bcf\u500b\u5340\u584a\u7684\u958b\u59cb\uff0c\u524d\u4e00\u500b\u5340\u584a\u7684\u8cbb\u7528\u88ab\u5206\u914d\u7d66\u9a57\u8b49\u8005\u548c\u59d4\u8a17\u8005\uff0c\u4e4b\u5f8c\u5b83\u5011\u53ef\u4ee5\u88ab\u63d0\u53d6\u548c\u4f7f\u7528\u3002</p>"},{"location":"protocol/gas/#_4","title":"\u5982\u4f55\u5728\u4ee5\u592a\u574a\u4e0a\u8655\u7406\u624b\u7e8c\u8cbb?","text":"<p>\u4ee5\u592a\u574a\u7684\u8cbb\u7528\u5305\u62ec\u96a8\u8457\u6642\u9593\u7684\u63a8\u79fb\u5f15\u5165\u7684\u591a\u7a2e\u5be6\u73fe\u3002</p> <p>\u6700\u521d\uff0c\u7528\u6236\u6703\u5728\u4ea4\u6613\u4e2d\u6307\u5b9a <code>GasPrice</code> \u548c <code>GasLimit</code> \u2014\u2014\u5f88\u50cf Cosmos SDK \u4ea4\u6613\u3002</p> <p>\u5340\u584a\u63d0\u8b70\u8005\u5c07\u5f9e\u5340\u584a\u4e2d\u7684\u6bcf\u7b46\u4ea4\u6613\u4e2d\u6536\u53d6\u5168\u90e8\u6c7d\u6cb9\u8cbb\uff0c\u4e26\u4e14\u4ed6\u5011\u6703\u76f8\u61c9\u5730\u9078\u64c7\u8981\u5305\u542b\u7684\u4ea4\u6613\u3002</p> <p>\u96a8\u8457\u63d0\u6848 EIP-1559 \u548c\u502b\u6566\u786c\u5206\u53c9\uff0cgas \u8a08\u7b97\u767c\u751f\u4e86\u8b8a\u5316\u3002</p> <p>\u4e0a\u9762\u7684 <code>GasPrice</code> \u73fe\u5728\u88ab\u5206\u6210\u5169\u500b\u7368\u7acb\u7684\u90e8\u5206\uff1a<code>BaseFee</code> \u548c <code>PriorityFee</code>\u3002</p> <p><code>BaseFee</code> \u662f\u6839\u64da\u5340\u584a\u5927\u5c0f\u81ea\u52d5\u8a08\u7b97\u7684\uff0c\u4e00\u65e6\u5340\u584a\u88ab\u6316\u51fa\u5c31\u6703\u88ab\u92b7\u6bc0\u3002</p> <p><code>PriorityFee</code> \u4ea4\u7d66\u63d0\u8b70\u8005\u4e26\u4ee3\u8868\u4e00\u500b\u5c0f\u8cbb\uff0c\u6216\u6fc0\u52f5\u63d0\u8b70\u8005\u5c07\u4ea4\u6613\u5305\u542b\u5728\u4e00\u500b\u5340\u584a\u4e2d\u3002</p> <pre><code>Gas Price = Base Fee + Priority Fee\n</code></pre> <p>\u5728\u4ea4\u6613\u4e2d\uff0c\u9664\u4e86\u50cf\u4ee5\u524d\u4e00\u6a23\u6307\u5b9a <code>gas_limit</code> \u4e4b\u5916\uff0c\u7528\u6236\u9084\u53ef\u4ee5\u6307\u5b9a\u5c0d\u61c9\u65bc\u7e3d <code>GasPrice</code> \u7684 <code>max_fee_per_gas</code> \u548c\u5c0d\u61c9\u65bc\u6700\u5927 <code>PriorityFee</code> \u7684 <code>max_priority_fee_per_gas</code>\u3002</p> <p>\u6240\u6709\u4e0d\u9700\u8981\u57f7\u884c\u7684\u591a\u9918\u6c23\u9ad4\u90fd\u9000\u9084\u7d66\u7528\u6236\u3002</p> <p>\u66f4\u591a\u95dc\u65bc Ethereum \u624b\u7e8c\u8cbb:</p> <ul> <li>Gas Calculation Docs</li> <li>Proposal EIP-1559</li> </ul>"},{"location":"protocol/gas/#_5","title":"\u5be6\u65bd","text":""},{"location":"protocol/gas/#daodstgas","title":"\u5982\u4f55\u5728Daodst\u4e0a\u8655\u7406Gas\u548c\u624b\u7e8c\u8cbb?","text":"<p>\u5f9e\u6839\u672c\u4e0a\u8aaa\uff0cDaodst \u662f\u4e00\u500b Cosmos SDK \u93c8\uff0c\u53ef\u4f5c\u70ba Cosmos SDK \u6a21\u584a\u7684\u4e00\u90e8\u5206\u5be6\u73fe EVM \u517c\u5bb9\u6027\u3002\u7531\u65bc\u9019\u7a2e\u67b6\u69cb\uff0c\u6240\u6709 EVM \u4ea4\u6613\u6700\u7d42\u90fd\u88ab\u7de8\u78bc\u70ba Cosmos SDK \u4ea4\u6613\u4e26\u66f4\u65b0 Cosmos SDK \u7ba1\u7406\u7684\u72c0\u614b\u3002\u7531\u65bc\u6240\u6709\u4ea4\u6613\u90fd\u8868\u793a\u70ba Cosmos SDK \u4ea4\u6613\uff0c\u56e0\u6b64\u4ea4\u6613\u8cbb\u7528\u53ef\u4ee5\u5728\u4e0d\u540c\u57f7\u884c\u5c64\u3002</p> <p>\u5be6\u969b\u4e0a\uff0c\u8655\u7406\u8cbb\u7528\u5305\u62ec\u6a19\u6e96\u7684 Cosmos SDK \u908f\u8f2f\u3001\u4e00\u4e9b\u4ee5\u592a\u574a\u908f\u8f2f\u548c customDaodst \u908f\u8f2f\u3002\u5927\u591a\u6578\u60c5\u6cc1\u4e0b\uff0c\u8cbb\u7528\u7531 <code>fee_collector</code> \u6a21\u584a\u6536\u53d6\uff0c\u7136\u5f8c\u652f\u4ed8\u7d66\u9a57\u8b49\u8005\u548c\u59d4\u8a17\u8005\u3002\u4e00\u4e9b\u95dc\u9375\u7684\u5340\u5225\u5982\u4e0b\uff1a</p> <p>1.Fee \u5e02\u5834\u6a21\u584a</p> <p>\u70ba\u4e86\u5728 Daodst \u7684 EVM \u5c64\u4e0a\u652f\u6301 EIP-1559 \u6c23\u9ad4\u548c\u8cbb\u7528\u8a08\u7b97\uff0cDaodst \u8ddf\u8e2a\u70ba\u6bcf\u500b\u5340\u584a\u4f9b\u61c9\u7684\u6c23\u9ad4\uff0c\u4e26\u4f7f\u7528\u5b83\u4f86\u8a08\u7b97\u672a\u4f86 EVM \u4ea4\u6613\u7684\u57fa\u672c\u8cbb\u7528\uff0c\u5f9e\u800c\u5be6\u73fe EIP \u6307\u5b9a\u7684 EVM \u52d5\u614b\u8cbb\u7528\u548c\u4ea4\u6613\u512a\u5148\u7d1a -1559\u3002</p> <p>\u5c0d\u65bc EVM \u4ea4\u6613\uff0c\u6bcf\u500b\u7bc0\u9ede\u90fd\u7e5e\u904e\u5176\u672c\u5730\u7684 <code>min-gas-prices</code> \u914d\u7f6e\uff0c\u800c\u662f\u61c9\u7528 EIP-1559 \u8cbb\u7528\u908f\u8f2f\u2014\u2014gas \u50f9\u683c\u5fc5\u9808\u7c21\u55ae\u5730\u5927\u65bc\u5168\u5c40 <code>min-gas-price</code> \u548c\u5340\u584a\u7684 <code>BaseFee</code> \uff0c\u5269\u9918\u90e8\u5206\u88ab\u8996\u70ba\u512a\u5148\u5c0f\u8cbb\u3002</p> <p>\u9019\u5141\u8a31\u9a57\u8b49\u8005\u5728\u4e0d\u61c9\u7528 Cosmos SDK \u8cbb\u7528\u908f\u8f2f\u7684\u60c5\u6cc1\u4e0b\u8a08\u7b97\u4ee5\u592a\u574a\u8cbb\u7528\u3002</p> <p>\u8207\u4ee5\u592a\u574a\u4e0d\u540c\uff0cDaodst \u4e0a\u7684<code>BaseFee</code>\u4e0d\u6703\u88ab\u92b7\u6bc0\uff0c\u800c\u662f\u5206\u767c\u7d66\u9a57\u8b49\u8005\u548c\u59d4\u8a17\u8005</p> <p>\u6b64\u5916\uff0c<code>BaseFee</code> \u53d7\u5168\u5c40<code>min-gas-price</code> \u7684\u4e0b\u9650\uff08\u76ee\u524d\uff0c\u5168\u5c40<code>min-gas-price</code> \u53c3\u6578\u8a2d\u7f6e\u70ba\u96f6\uff0c\u5118\u7ba1\u5b83\u53ef\u4ee5\u901a\u904e\u6cbb\u7406\u9032\u884c\u66f4\u65b0\uff09\u3002</p> <p>2.EVM Gas\u8fd4\u9084</p> <p>Daodst \u6703\u70ba EVM \u4ea4\u6613\u9000\u9084\u4e00\u5c0f\u90e8\u5206\uff08\u9ed8\u8a8d\u60c5\u6cc1\u4e0b\u81f3\u5c11 50%\uff09\u672a\u4f7f\u7528\u7684\u6c23\u9ad4\uff0c\u4ee5\u63a5\u8fd1\u4ee5\u592a\u574a\u4e0a\u7684\u7576\u524d\u884c\u70ba\u3002</p> <p>3.\u6536\u5165\u6a21\u584a</p> <p>Daodst \u958b\u767c\u6536\u5165\u6a21\u584a\u4f5c\u70ba\u734e\u52f5\u958b\u767c\u4eba\u54e1\u5275\u5efa\u6709\u7528\u7684 dApp \u7684\u4e00\u7a2e\u65b9\u5f0f\u2014\u2014\u4efb\u4f55\u5728 Daodst \u6536\u5165\u6a21\u584a\u8a3b\u518a\u7684\u5408\u540c\u90fd\u6703\u5f9e\u8207\u5408\u540c\u4ea4\u4e92\u7684\u6bcf\u7b46\u4ea4\u6613\u4e2d\u5411\u5408\u540c\u958b\u767c\u4eba\u54e1\u734e\u52f5\u4e00\u5c0f\u90e8\u5206\u4ea4\u6613\u8cbb\u7528\uff08\u76ee\u524d\u70ba 95%\uff09. \u9a57\u8b49\u8005\u548c\u59d4\u8a17\u8005\u8cfa\u53d6\u5269\u9918\u90e8\u5206\u3002</p>"},{"location":"protocol/gas/#_6","title":"\u8a73\u7d30\u6642\u9593\u8868","text":"<p>1.\u7bc0\u9ede\u57f7\u884c\u524d\u4e00\u500b\u584a\u4e26\u904b\u884c <code>EndBlock</code> \u639b\u9264 * \u4f5c\u70ba\u6b64\u639b\u9264\u7684\u4e00\u90e8\u5206\uff0cFeeMarket (EIP-1559) \u6a21\u584a\u5f9e\u8a72\u584a\u4e0a\u7684\u4ea4\u6613\u4e2d\u8ddf\u8e2a\u7e3d\u7684 <code>TransientGasWanted</code>\u3002 \u9019\u5c07\u7528\u65bc\u4e0b\u4e00\u500b\u5340\u584a\u7684 <code>BaseFee</code>\u3002</p> <p>2.\u7bc0\u9ede\u63a5\u6536\u5f8c\u7e8c\u5340\u584a\u7684\u4ea4\u6613\u4e26\u5c07\u9019\u4e9b\u4ea4\u6613\u516b\u5366\u7d66\u540c\u884c*\u9019\u4e9b\u53ef\u4ee5\u6309\u5305\u542b\u7684\u8cbb\u7528\u50f9\u683c\u6392\u5e8f\u548c\u512a\u5148\u7d1a\uff08\u4f7f\u7528 EIP-1559 \u8cbb\u7528\u512a\u5148\u6a5f\u5236\u9032\u884c EVM \u4ea4\u6613 \uff0c\u5c07\u5305\u542b\u5728\u4e0b\u4e00\u500b\u5340\u584a\u4e2d</p> <p>3.\u7bc0\u9ede\u70ba\u5f8c\u7e8c\u584a\u904b\u884c <code>BeginBlock</code> * FeeMarket \u6a21\u584a\u8a08\u7b97 <code>BaseFee</code> \u4f7f\u7528\u524d\u4e00\u500b\u584a\u4e2d\u7684\u7e3d <code>GasWanted</code> \u61c9\u7528\u65bc\u6b64\u584a\u3002 * \u5206\u914d\u6a21\u584a distributes \u524d\u4e00\u500b\u5340\u584a\u7684\u8cbb\u7528\u734e\u52f5\u7d66\u9a57\u8b49\u8005\u548c\u59d4\u8a17\u8005</p> <p>4.\u5c0d\u65bc\u5c07\u5305\u542b\u5728\u6b64\u584a\u4e2d\u7684\u6bcf\u500b\u6709\u6548\u4ea4\u6613\uff0c\u7bc0\u9ede\u57f7\u884c\u4ee5\u4e0b\u64cd\u4f5c\uff1a</p> <p> \u4ed6\u5011\u904b\u884c\u4e00\u500b\u5c0d\u61c9\u65bc\u4ea4\u6613\u985e\u578b\u7684<code>AnteHandler</code> \u3002</p> <p>\u9019\u500b\u6d41\u7a0b:</p> <ol> <li>\u57f7\u884c\u57fa\u672c\u4ea4\u6613\u9a57\u8b49</li> <li>\u9a57\u8b49\u63d0\u4f9b\u7684\u8cbb\u7528\u662f\u5426\u5927\u65bc\u5168\u7403\u548c\u672c\u5730\u6700\u5c0f\u9a57\u8b49\u5668\u503c\u4e26\u4e14\u5927\u65bc\u8a08\u7b97\u51fa\u7684<code>BaseFee</code>    3.\uff08\u5c0d\u65bc\u4ee5\u592a\u574a\u4ea4\u6613\uff09\u6436\u5360EVM\u4ea4\u6613\u6d88\u8017gas</li> <li>\u6263\u9664\u7528\u6236\u7684\u4ea4\u6613\u624b\u7e8c\u8cbb\uff0c\u8f49\u5165<code>fee_collector</code>\u6a21\u584a</li> <li> <p>\u589e\u52a0\u7576\u524d\u5340\u584a\u4e2d\u7684 <code>TransientGasWanted</code>\uff0c\u7528\u65bc\u8a08\u7b97\u4e0b\u4e00\u500b\u5340\u584a\u7684 <code>BaseFee</code></p> <p>\u7136\u5f8c\uff0c\u5c0d\u65bc\u6a19\u6e96Cosmos\u4ea4\u6613,\u8282\u70b9</p> <ul> <li>\u57f7\u884c\u4ea4\u6613\u4e26\u66f4\u65b0\u72c0\u614b</li> <li>\u4ea4\u6613\u6d88\u8017gas</li> </ul> <p>\u5c0d\u65bc\u4ee5\u592a\u574a\u4ea4\u6613\uff0c\u7bc0\u9ede:</p> <ul> <li>\u57f7\u884c\u4ea4\u6613\u4e26\u66f4\u65b0\u72c0\u614b</li> <li>\u8a08\u7b97\u4f7f\u7528\u7684gas\u4e26\u8207\u4f9b\u61c9\u7684gas\u9032\u884c\u6bd4\u8f03\uff0c\u7136\u5f8c\u9000\u9084\u6307\u5b9a\u90e8\u5206\u7684\u5269\u9918\u90e8\u5206</li> <li>\u5982\u679c\u4ea4\u6613\u8207\u5df2\u8a3b\u518a\u7684\u667a\u80fd\u5408\u7d04\u4ea4\u4e92\uff0c\u5247\u5c07\u4e00\u5c0f\u90e8\u5206\u7528\u4f5c\u6536\u5165\u7684\u8cbb\u7528\u4f5c\u70ba\u6536\u5165\u6a21\u584a\u7684\u4e00\u90e8\u5206\u767c\u9001\u7d66\u5408\u540c\u958b\u767c\u5546</li> </ul> </li> <li> <p>\u7bc0\u9ede\u70ba\u6b64\u584a\u904b\u884c <code>EndBlock</code> \u4e26\u5b58\u5132\u584a\u7684 <code>GasWanted</code></p> </li> </ol>"},{"location":"protocol/gas/#_7","title":"\u8be6\u7ec6\u505a\u6cd5","text":""},{"location":"protocol/gas/#cosmos-gas","title":"Cosmos <code>Gas</code>","text":"<p>\u5728 Cosmos SDK \u4e2d\uff0cgas \u4e3b\u8981\u5728 <code>GasMeter</code>\u548c <code>BlockGasMeter</code> \u4e2d\u9032\u884c\u8ddf\u8e2a\uff1a</p> <ul> <li><code>GasMeter</code>\uff1a\u8ddf\u8e2a\u5c0e\u81f4\u72c0\u614b\u8f49\u63db\u7684\u57f7\u884c\u904e\u7a0b\u4e2d\u6d88\u8017\u7684\u6c23\u9ad4\u3002 \u5b83\u5728\u6bcf\u6b21\u4ea4\u6613\u57f7\u884c\u6642\u91cd\u7f6e\u3002</li> <li><code>BlockGasMeter</code>\uff1a\u8ddf\u8e2a\u5340\u584a\u4e2d\u6d88\u8017\u7684\u6c23\u9ad4\u4e26\u5f37\u5236\u6c23\u9ad4\u4e0d\u8d85\u904e\u9810\u5b9a\u7fa9\u7684\u9650\u5236\u3002\u6b64\u9650\u5236\u5728 Tendermint \u5171\u8b58\u53c3\u6578\u4e2d\u5b9a\u7fa9\uff0c\u53ef\u4ee5\u901a\u904e\u6cbb\u7406\u53c3\u6578\u66f4\u6539\u63d0\u6848\u9032\u884c\u66f4\u6539\u3002</li> </ul> <p>\u7531\u65bc gas \u662f\u6309\u5b57\u7bc0\u5b9a\u50f9\u7684\uff0c\u56e0\u6b64\u76f8\u540c\u7684\u4ea4\u4e92\u5728\u53c3\u6578\u503c\u8f03\u5927\u7684\u60c5\u6cc1\u4e0b\u6bd4\u8f03\u5c0f\u7684\u53c3\u6578\u503c\u66f4\u8017\u8cbb\u6c23\u9ad4\uff08\u8207\u4ee5\u592a\u574a\u7684 <code>uint256</code> \u503c\u4e0d\u540c\uff0cCosmos SDK \u6578\u503c\u4f7f\u7528 Big.Int \u985e\u578b\uff0c\u5b83\u5011\u662f\u52d5\u614b\u8abf\u6574\u5927\u5c0f\u7684\uff09\u3002</p> <p>\u53ef\u4ee5\u5728\u6b64\u8655 \u627e\u5230\u6709\u95dc\u4f5c\u70ba Cosmos SDK \u4e00\u90e8\u5206\u7684 gas \u7684\u66f4\u591a\u4fe1\u606f\u3002</p>"},{"location":"protocol/gas/#evm-gas","title":"\u5339\u914dEVM Gas\u6d88\u8017","text":"<p>Daodst \u662f\u4e00\u689d EVM \u517c\u5bb9\u93c8\uff0c\u652f\u6301\u4ee5\u592a\u574a Web3 \u5de5\u5177\u3002 \u51fa\u65bc\u9019\u500b\u539f\u56e0\uff0c\u6c23\u9ad4\u6d88\u8017\u5fc5\u9808\u8207\u5176\u4ed6 EVM \u76f8\u7576\uff0c\u6700\u91cd\u8981\u7684\u662f\u4ee5\u592a\u574a\u3002</p> <p>EVM \u548c Cosmos \u72c0\u614b\u8f49\u63db\u4e4b\u9593\u7684\u4e3b\u8981\u5340\u5225\u5728\u65bc\uff0cEVM \u70ba\u6bcf\u500b\u64cd\u4f5c\u78bc\u4f7f\u7528\u4e00\u500b gas table\uff0c\u800c Cosmos \u4f7f\u7528<code>GasConfig</code>\u70ba\u6bcf\u500b CRUD \u64cd\u4f5c\u6536\u53d6 gas\uff0c\u65b9\u6cd5\u662f\u70ba\u8a2a\u554f\u6578\u64da\u5eab\u8a2d\u7f6e\u56fa\u5b9a\u7684\u6bcf\u5b57\u7bc0\u6210\u672c\u3002</p> <p>\u70ba\u4e86\u5339\u914dEVM\u6d88\u8017\u7684gas\uff0c\u5ffd\u7565SDK\u4e2d\u7684gas\u6d88\u8017\u908f\u8f2f\uff0c\u53d6\u800c\u4ee3\u4e4b\u7684\u662f\u6d88\u8017\u7684gas\u662f\u901a\u904e\u5f9e\u6d88\u606f\u4e0a\u5b9a\u7fa9\u7684\u6c23\u9ad4\u9650\u5236\u4e2d\u6e1b\u53bb\u72c0\u614b\u8f49\u63db\u5269\u9918\u6c23\u9ad4\u52a0\u4e0a\u9000\u6b3e\u4f86\u8a08\u7b97\u7684\u3002</p> <p>\u70ba\u4e86\u5ffd\u7565 SDK \u7684 gas \u6d88\u8017\uff0c\u6211\u5011\u5c07\u4ea4\u6613<code>GasMeter</code>\u8a08\u6578\u91cd\u7f6e\u70ba 0\uff0c\u4e26\u624b\u52d5\u5c07\u5176\u8a2d\u7f6e\u70ba EVM \u6a21\u584a\u5728\u57f7\u884c\u7d50\u675f\u6642\u8a08\u7b97\u51fa\u7684<code>gasUsed</code>\u503c\u3002</p>"},{"location":"protocol/gas/#antehandler","title":"<code>AnteHandler</code>","text":"<p>Cosmos SDK <code>AnteHandler</code> \u5728\u4ea4\u6613\u57f7\u884c\u4e4b\u524d\u57f7\u884c\u57fa\u672c\u6aa2\u67e5\u3002</p> <p>\u9019\u4e9b\u6aa2\u67e5\u901a\u5e38\u662f\u7c3d\u540d\u9a57\u8b49\u3001\u4ea4\u6613\u5b57\u6bb5\u9a57\u8b49\u3001\u4ea4\u6613\u8cbb\u7528\u7b49\u3002</p> <p>\u95dc\u65bc gas \u6d88\u8017\u548c\u8cbb\u7528\uff0c<code>AnteHandler</code> \u6aa2\u67e5\u7528\u6236\u662f\u5426\u6709\u8db3\u5920\u7684\u9918\u984d\u4f86\u652f\u4ed8 tx \u6210\u672c\uff08\u91d1\u984d\u52a0\u4e0a\u8cbb\u7528\uff09\uff0c\u4e26\u6aa2\u67e5\u6d88\u606f\u4e2d\u5b9a\u7fa9\u7684 gas \u9650\u5236\u662f\u5426\u5927\u65bc\u6216\u7b49\u65bc\u8a08\u7b97\u7684\u56fa\u6709 gas \u6d88\u606f\u3002</p>"},{"location":"protocol/gas/#gas_3","title":"Gas \u8fd4\u8fd8","text":"<p>\u5728 EVM \u4e2d\uff0cgas \u53ef\u4ee5\u5728\u57f7\u884c\u4e4b\u524d\u6307\u5b9a\u3002 \u6307\u5b9a\u7684\u5168\u90e8\u6c23\u9ad4\u5728\u57f7\u884c\u958b\u59cb\u6642\uff08\u5728<code>AnteHandler</code>\u6b65\u9a5f\u671f\u9593\uff09\u88ab\u6d88\u8017\uff0c\u5982\u679c\u57f7\u884c\u5f8c\u6709\u4efb\u4f55\u6c23\u9ad4\u5269\u9918\uff0c\u5269\u9918\u7684\u6c23\u9ad4\u5c07\u9000\u9084\u7d66\u7528\u6236\u3002</p> <p>\u6b64\u5916\uff0cEVM \u9084\u53ef\u4ee5\u5b9a\u7fa9\u8981\u8fd4\u9084\u7d66\u7528\u6236\u7684\u6c23\u9ad4\uff0c\u4f46\u9019\u4e9b\u6c23\u9ad4\u5c07\u88ab\u9650\u5236\u70ba\u6240\u7528\u6c23\u9ad4\u7684\u4e00\u5c0f\u90e8\u5206\uff0c\u5177\u9ad4\u53d6\u6c7a\u65bc\u6240\u4f7f\u7528\u7684\u5206\u53c9/\u7248\u672c\u3002</p>"},{"location":"protocol/gas/#_8","title":"\u96f6\u624b\u7eed\u8d39\u4ea4\u6613","text":"<p>\u5728 Cosmos \u4e2d\uff0c<code>AnteHandler</code> \u4e0d\u5f37\u5236\u57f7\u884c\u6700\u4f4e gas \u50f9\u683c\uff0c\u56e0\u70ba<code>min-gas-prices</code>\u662f\u6839\u64da\u672c\u5730\u7bc0\u9ede/\u9a57\u8b49\u5668\u6aa2\u67e5\u7684\u3002</p> <p>\u63db\u53e5\u8a71\u8aaa\uff0c\u63a5\u53d7\u7684\u6700\u4f4e\u8cbb\u7528\u7531\u7db2\u7d61\u7684\u9a57\u8b49\u8005\u6c7a\u5b9a\uff0c\u6bcf\u500b\u9a57\u8b49\u8005\u53ef\u4ee5\u70ba\u5176\u8cbb\u7528\u6307\u5b9a\u4e0d\u540c\u7684\u6700\u4f4e\u503c\u3002</p> <p>\u5982\u679c\u81f3\u5c11\u6709\u4e00\u500b\u9a57\u8b49\u8005\u9858\u610f\u5728\u4ed6\u5011\u63d0\u8b70\u7684\u5340\u584a\u4e2d\u5305\u542b<code>0</code> gas price \u7684\u4ea4\u6613\uff0c\u9019\u53ef\u80fd\u5141\u8a31\u6700\u7d42\u7528\u6236\u63d0\u4ea4 0 \u8cbb\u7528\u4ea4\u6613\u3002</p> <p>\u51fa\u65bc\u540c\u6a23\u7684\u539f\u56e0\uff0c\u5728 Daodst \u4e2d\uff0c\u5c0d\u65bc<code>evm</code>\u6a21\u584a\u5b9a\u7fa9\u7684\u4ea4\u6613\u985e\u578b\u4ee5\u5916\u7684\u4ea4\u6613\u985e\u578b\uff0c\u53ef\u4ee5\u767c\u9001<code>0</code>\u8cbb\u7528\u7684\u4ea4\u6613\u3002</p> <p>EVM \u6a21\u584a\u4ea4\u6613\u4e0d\u80fd\u6709\u201c0\u201d\u8cbb\u7528\uff0c\u56e0\u70ba EVM \u672c\u8eab\u5c31\u9700\u8981 gas\u3002</p> <p>\u6b64\u6aa2\u67e5\u7531 EVM \u4e8b\u52d9\u7121\u72c0\u614b\u9a57\u8b49\uff08\u5373<code>ValidateBasic</code>\uff09\u51fd\u6578\u4ee5\u53ca Daodst \u5b9a\u7fa9\u7684\u81ea\u5b9a\u7fa9<code>AnteHandler</code>\u5b8c\u6210\u3002</p>"},{"location":"protocol/gas/#gas_4","title":"Gas \u9884\u4f30","text":"<p>\u4ee5\u592a\u574a\u63d0\u4f9b\u4e86\u4e00\u500b JSON-RPC \u7aef\u9ede<code>eth_estimateGas</code>\u4f86\u5e6b\u52a9\u7528\u6236\u5728\u4ed6\u5011\u7684\u4ea4\u6613\u4e2d\u8a2d\u7f6e\u6b63\u78ba\u7684\u6c23\u9ad4\u9650\u5236\u3002</p> <p>\u56e0\u6b64\uff0c\u5728 Daodst \u4e2d\u5be6\u73fe\u4e86\u4e00\u500b\u7279\u5b9a\u7684\u67e5\u8a62 API <code>EstimateGas</code>\u3002 \u5b83\u5c07\u91dd\u5c0d\u7576\u524d\u5340\u584a/\u72c0\u614b\u61c9\u7528\u4ea4\u6613\u4e26\u57f7\u884c\u4e8c\u9032\u5236\u641c\u7d22\u4ee5\u627e\u5230\u8fd4\u56de\u7d66\u7528\u6236\u7684\u6700\u4f73\u6c23\u9ad4\u503c\uff08\u76f8\u540c\u7684\u4ea4\u6613\u5c07\u4e00\u904d\u53c8\u4e00\u904d\u5730\u61c9\u7528\uff0c\u76f4\u5230\u6211\u5011\u627e\u5230\u5931\u6557\u524d\u6240\u9700\u7684\u6700\u5c0f\u6c23\u9ad4\uff09 .</p> <p>\u6211\u5011\u9700\u8981\u4f7f\u7528\u4e8c\u5206\u67e5\u627e\u7684\u539f\u56e0\u662f\u4ea4\u6613\u6240\u9700\u7684 gas \u53ef\u80fd\u9ad8\u65bc\u61c9\u7528\u4ea4\u6613\u5f8c EVM \u8fd4\u56de\u7684\u503c\uff0c\u56e0\u6b64\u6211\u5011\u9700\u8981\u5617\u8a66\u76f4\u5230\u627e\u5230\u6700\u512a\u503c\u3002</p> <p>\u5728\u6574\u500b\u57f7\u884c\u904e\u7a0b\u4e2d\u5c07\u4f7f\u7528\u7de9\u5b58\u4e0a\u4e0b\u6587\u4ee5\u907f\u514d\u66f4\u6539\u5728\u72c0\u614b\u4e2d\u6301\u4e45\u5316\u3002</p> <p>\u5c0d\u65bc Cosmos Tx\uff0c\u958b\u767c\u8005\u53ef\u4ee5\u4f7f\u7528 Cosmos SDK \u7684\u4ea4\u6613\u6a21\u64ec \u4f86\u5275\u5efa\u6e96\u78ba\u7684\u9810\u4f30\u3002</p>"},{"location":"protocol/gas/#daodst-cligas","title":"\u4f7f\u7528Daodst CLI\u5904\u7406Gas\u548c\u624b\u7eed\u8d39","text":"<p>\u4f7f\u7528 Daodst CLI \u5ba2\u6236\u7aef\u5ee3\u64ad\u4ea4\u6613\u6642\uff0c\u7528\u6236\u61c9\u8003\u616e\u53ef\u7528\u7684\u9078\u9805\u3002 \u5411\u7db2\u7d61\u767c\u9001\u4ea4\u6613\u6642\u9700\u8981\u8003\u616e\u4e09\u500b\u6a19\u8a8c\uff1a</p> <ul> <li><code>--fees</code>: \u96a8\u4ea4\u6613\u4e00\u8d77\u652f\u4ed8\u7684\u8cbb\u7528\uff1b \u4f8b\u5982\uff1a10dst\u3002 \u9ed8\u8a8d\u70ba\u6240\u9700\u8cbb\u7528\u3002</li> <li><code>--gas</code>: \u6bcf\u7b46\u4ea4\u6613\u8a2d\u7f6e\u7684\u6c23\u9ad4\u9650\u5236\uff1b \u9ed8\u8a8d\u503c\u70ba 200000\u3002</li> <li><code>--gas-prices</code>: gas \u50f9\u683c\u4f86\u78ba\u5b9a\u4ea4\u6613\u8cbb\u7528\uff08\u4f8b\u5982 10dst\uff09\u3002</li> </ul> <p>\u4f46\u662f\uff0c\u4e26\u975e\u6240\u6709\u9019\u4e9b\u90fd\u9700\u8981\u5728\u6bcf\u500b\u4e8b\u52d9\u4e2d\u5b9a\u7fa9\u3002 \u6b63\u78ba\u7684\u7d44\u5408\u662f\uff1a</p> <ul> <li><code>--fees=auto</code>: \u81ea\u52d5\u4f30\u7b97\u8cbb\u7528\u548c\u6c7d\u6cb9\uff08\u8207 --gas=auto \u76f8\u540c\u7684\u884c\u70ba\uff09\u3002   \u5982\u679c\u4f7f\u7528\u4efb\u4f55\u5176\u4ed6\u8207\u8cbb\u7528\u76f8\u95dc\u7684\u6a19\u8a8c\uff08\u4f8b\u5982\uff0c<code>--gas-prices</code>\u3001<code>--fees</code>\uff09\uff0c\u5247\u6703\u5f15\u767c\u932f\u8aa4</li> <li><code>--gas=auto</code>: \u8207 <code>--fees=auto</code> \u76f8\u540c\u7684\u884c\u70ba\u3002   \u5982\u679c\u4f7f\u7528\u4efb\u4f55\u5176\u4ed6\u8207\u8cbb\u7528\u76f8\u95dc\u7684\u6a19\u8a8c\uff08\u4f8b\u5982\uff0c<code>--gas-prices</code>\u3001<code>--fees</code>\uff09\uff0c\u5247\u6703\u5f15\u767c\u932f\u8aa4</li> <li><code>--gas={int}</code>: \u4f7f\u7528\u6307\u5b9a\u7684\u6c23\u9ad4\u91cf\u548c\u4ea4\u6613\u6240\u9700\u7684\u8cbb\u7528</li> <li><code>--fees={int}{denom}</code>: \u4f7f\u7528 tx \u7684\u6307\u5b9a\u8cbb\u7528\u3002 \u5c0d tx \u4f7f\u7528 gas \u9ed8\u8a8d\u503c (200000)\u3002</li> <li><code>--fees={int}{denom} --gas={int}</code>: \u4f7f\u7528\u6307\u5b9a\u7684\u6c23\u9ad4\u548c\u8cbb\u7528\u3002 \u4f7f\u7528\u63d0\u4f9b\u7684\u53c3\u6578\u8a08\u7b97 gas-price</li> <li><code>--gas-prices={int}{denom}</code>: \u4f7f\u7528\u63d0\u4f9b\u7684 gas \u50f9\u683c\u548c\u9ed8\u8a8d gas \u91cf (200000)</li> <li><code>--gas-prices={int}{denom} --gas={int}</code>: \u4f7f\u7528\u70ba tx \u6307\u5b9a\u7684\u6c23\u9ad4\uff0c\u4e26\u4f7f\u7528\u76f8\u61c9\u7684\u53c3\u6578\u8a08\u7b97\u8cbb\u7528\u3002</li> </ul> <p>\u8b80\u8005\u61c9\u6ce8\u610f\uff0c\u524d\u5169\u500b\u9078\u9805\u70ba\u65b0\u7528\u6236\u63d0\u4f9b\u4e86\u66f4\u53cb\u597d\u7684\u7528\u6236\u9ad4\u9a57\uff0c\u800c\u5f8c\u8005\u5247\u9069\u7528\u65bc\u66f4\u9ad8\u7d1a\u7684\u7528\u6236\uff0c\u4ed6\u5011\u5e0c\u671b\u5c0d\u9019\u4e9b\u53c3\u6578\u6709\u66f4\u591a\u7684\u63a7\u5236\u6b0a\u3002</p> <p>\u8a72\u5718\u968a\u5f15\u5165\u4e86<code>\u81ea\u52d5</code>\u6a19\u8a8c\u9078\u9805\uff0c\u53ef\u4ee5\u81ea\u52d5\u8a08\u7b97\u57f7\u884c\u4ea4\u6613\u6240\u9700\u7684\u6c7d\u6cb9\u548c\u8cbb\u7528\u3002\u901a\u904e\u9019\u7a2e\u65b9\u5f0f\uff0c\u65b0\u7528\u6236\u6216\u958b\u767c\u4eba\u54e1\u53ef\u4ee5\u57f7\u884c\u4ea4\u6613\u800c\u7121\u9700\u5b9a\u7fa9\u7279\u5b9a\u7684 gas \u548c\u8cbb\u7528\u503c\u3002</p> <p>\u4f7f\u7528 <code>auto</code> \u6a19\u8a8c\u6709\u6642\u53ef\u80fd\u7121\u6cd5\u6839\u64da\u7db2\u7d61\u6d41\u91cf\u4f30\u7b97\u6b63\u78ba\u7684 gas \u548c\u8cbb\u7528\u3002 \u70ba\u4e86\u514b\u670d\u9019\u500b\u554f\u984c\uff0c\u60a8\u53ef\u4ee5\u70ba <code>--gas-adjustment</code> \u6a19\u8a8c\u4f7f\u7528\u66f4\u9ad8\u7684\u503c\u3002 \u9ed8\u8a8d\u60c5\u6cc1\u4e0b\uff0c\u5b83\u8a2d\u7f6e\u70ba<code>1.2</code>\u3002 \u7576\u4f30\u8a08\u503c\u4e0d\u8db3\u6642\uff0c\u91cd\u8a66\u66f4\u9ad8\u7684 gas \u8abf\u6574\uff0c\u4f8b\u5982 <code>--gas-adjustment 1.3</code>\u3002</p> <p>\u4e0d\u80fd\u7d50\u5408\u4f7f\u7528 <code>--gas-prices</code> \u548c <code>--fees</code> \u6a19\u8a8c\u3002 \u5982\u679c\u662f\u9019\u6a23\uff0c\u7528\u6236\u5c07\u6536\u5230\u4e00\u689d\u932f\u8aa4\u6d88\u606f\uff0c\u6307\u51fa\u7121\u6cd5\u540c\u6642\u63d0\u4f9b\u8cbb\u7528\u548c\u6c7d\u6cb9\u50f9\u683c\u3002</p> <p>\u8acb\u8a18\u4f4f\uff0c\u5982\u679c\u63d0\u4f9b\u7684\u8cbb\u7528\u6216\u6c7d\u6cb9\u91cf\u4e0d\u8db3\uff0c\u4e0a\u8ff0\u7d44\u5408\u53ef\u80fd\u6703\u5931\u6557\u3002 \u5982\u679c\u662f\u9019\u7a2e\u60c5\u6cc1\uff0cCLI \u5c07\u8fd4\u56de\u4e00\u689d\u5305\u542b\u7279\u5b9a\u539f\u56e0\u7684\u932f\u8aa4\u6d88\u606f\u3002 \u4f8b\u5982\uff1a</p> <pre><code>raw_log: 'out of gas in location: submit proposal; gasWanted: 200000, gasUsed: 263940.\n  Please retry with a gas (--gas flag) amount higher than gasUsed: out of gas'\n</code></pre>"},{"location":"protocol/key-management/","title":"\u5bc6\u9470\u7ba1\u7406","text":"<p>\u52a9\u8a18\u8a5e\uff0c\u4e5f\u7a31\u70ba\u52a9\u8a18\u8a5e\uff0c\u662f\u4e00\u7d44\u7528\u65bc\u6062\u5fa9\u6216\u6062\u5fa9\u52a0\u5bc6\u8ca8\u5e63\u9322\u5305\u7684\u8a5e\u3002\u5982\u679c\u60a8\u7121\u6cd5\u8a2a\u554f\u539f\u59cb\u9322\u5305\uff0c\u5b83\u53ef\u4ee5\u4f5c\u70ba\u8a2a\u554f\u60a8\u7684\u6578\u5b57\u8cc7\u7522\u7684\u5099\u4efd\u3002\u8a72\u77ed\u8a9e\u901a\u5e38\u662f\u60a8\u5275\u5efa\u9322\u5305\u6642\u751f\u6210\u7684\u4e00\u7cfb\u5217 12-24 \u500b\u55ae\u8a5e\uff0c\u61c9\u4fdd\u6301\u5b89\u5168\u548c\u79c1\u5bc6\u3002</p> <p>\u52a9\u8a18\u8a5e\u7684\u91cd\u8981\u6027\u5728\u65bc\u52a0\u5bc6\u8ca8\u5e63\u4ee5\u5206\u6563\u7684\u65b9\u5f0f\u5b58\u5132\uff0c\u9019\u610f\u5473\u8457\u6c92\u6709\u4e2d\u592e\u6a5f\u69cb\u6216\u6a5f\u69cb\u6301\u6709\u6216\u63a7\u5236\u4f60\u7684\u8cc7\u91d1\u3002\u9019\u610f\u5473\u8457\u5982\u679c\u60a8\u7121\u6cd5\u8a2a\u554f\u60a8\u7684\u9322\u5305\uff08\u4f8b\u5982\u5fd8\u8a18\u5bc6\u78bc\u3001\u4e1f\u5931\u60a8\u7684\u8a2d\u5099\uff09\uff0c\u60a8\u5c07\u7121\u6cd5\u5728\u6c92\u6709\u52a9\u8a18\u8a5e\u7684\u60c5\u6cc1\u4e0b\u53d6\u56de\u60a8\u7684\u8cc7\u91d1\u3002\u56e0\u6b64\uff0c\u5c07\u60a8\u7684\u52a9\u8a18\u8a5e\u5b58\u5132\u5728\u5b89\u5168\u53ef\u9760\u7684\u5730\u65b9\u81f3\u95dc\u91cd\u8981\uff0c\u4f8b\u5982\u7269\u7406\u7d19\u5f35\u6216\u5b89\u5168\u7684\u6578\u5b57\u6587\u4ef6\u3002</p> <p>\u6b64\u5916\uff0c\u5efa\u8b70\u88fd\u4f5c\u591a\u4efd\u526f\u672c\u4e26\u5c07\u5b83\u5011\u5b58\u653e\u5728\u4e0d\u540c\u7684\u4f4d\u7f6e\uff0c\u4ee5\u4fbf\u60a8\u53ef\u4ee5\u5728\u4efb\u4f55\u7dca\u6025\u60c5\u6cc1\u4e0b\u4f7f\u7528\u60a8\u7684\u8cc7\u91d1\u3002</p>"},{"location":"protocol/key-management/#_1","title":"\u52a9\u8a18\u7b26\u77ed\u8a9e\u8207\u79c1\u9470","text":"<p>\u7a2e\u5b50\u77ed\u8a9e\uff0c\u4e5f\u7a31\u70ba\u6062\u5fa9\u77ed\u8a9e\u6216\u5099\u4efd\u77ed\u8a9e\uff0c\u662f\u7528\u65bc\u751f\u6210\u79c1\u9470\u7684\u4e00\u7cfb\u5217\u55ae\u8a5e\u3002\u5b83\u901a\u5e38\u662f\u4e00\u7d44 12 \u6216 24 \u500b\u55ae\u8a5e\uff0c\u7528\u65bc\u5728\u539f\u59cb\u79c1\u9470\u4e1f\u5931\u6216\u640d\u58de\u7684\u60c5\u6cc1\u4e0b\u6062\u5fa9\u6216\u6062\u5fa9\u5c0d\u52a0\u5bc6\u8ca8\u5e63\u9322\u5305\u7684\u8a2a\u554f\u3002\u7a2e\u5b50\u77ed\u8a9e\u53ef\u7528\u65bc\u751f\u6210\u591a\u500b\u79c1\u9470\uff0c\u9019\u4e9b\u79c1\u9470\u53ef\u7528\u65bc\u8a2a\u554f\u591a\u500b\u52a0\u5bc6\u8ca8\u5e63\u5730\u5740\u548c\u4f59\u984d\u3002</p> <p>\u53e6\u4e00\u65b9\u9762\uff0c\u79c1\u9470\u662f\u4e00\u9577\u4e32\u5b57\u7b26\uff0c\u7528\u65bc\u7c3d\u7f72\u4ea4\u6613\u4e26\u63d0\u4f9b\u5c0d\u60a8\u7684\u52a0\u5bc6\u8ca8\u5e63\u8cc7\u91d1\u7684\u8a2a\u554f\u3002\u79c1\u9470\u662f\u5f9e\u7a2e\u5b50\u77ed\u8a9e\u751f\u6210\u7684\uff0c\u4e26\u4e14\u5c0d\u65bc\u6bcf\u500b\u52a0\u5bc6\u8ca8\u5e63\u5730\u5740\u90fd\u662f\u552f\u4e00\u7684\u3002\u5b83\u7528\u65bc\u70ba\u4ea4\u6613\u5275\u5efa\u6578\u5b57\u7c3d\u540d\uff0c\u4ee5\u78ba\u4fdd\u4ea4\u6613\u5408\u6cd5\u4e26\u5df2\u7372\u5f97\u8cc7\u91d1\u5408\u6cd5\u6240\u6709\u8005\u7684\u6388\u6b0a\u3002</p> <p>\u7e3d\u4e4b\uff0c\u60a8\u7684\u79c1\u9470\u548c\u52a9\u8a18\u8a5e\u7684\u5b89\u5168\u6027\u81f3\u95dc\u91cd\u8981\u3002\u5982\u679c\u60a8\u7684\u79c1\u9470\u906d\u5230\u6d29\u9732\uff0c\u53ef\u80fd\u6703\u4f7f\u6240\u6709\u95dc\u806f\u7684\u5e33\u6236\u9762\u81e8\u98a8\u96aa\u3002\u4f46\u662f\uff0c\u4e1f\u5931\u52a9\u8a18\u8a5e\u53ef\u80fd\u6703\u7522\u751f\u66f4\u56b4\u91cd\u7684\u5f8c\u679c\uff0c\u56e0\u70ba\u5b83\u7528\u65bc\u751f\u6210\u591a\u500b\u79c1\u9470\u3002\u56e0\u6b64\uff0c\u63a1\u53d6\u9069\u7576\u7684\u63aa\u65bd\u4f86\u4fdd\u8b77\u60a8\u7684\u79c1\u9470\u548c\u52a9\u8a18\u8a5e\u4ee5\u907f\u514d\u4efb\u4f55\u707d\u96e3\u6027\u7684\u640d\u5931\u662f\u81f3\u95dc\u91cd\u8981\u7684\u3002</p>"},{"location":"protocol/key-management/#stcd-cli","title":"stcd CLI\u4e2d\u7684\u52a9\u8a18\u7b26","text":"<p>**\u5728\u7e7c\u7e8c\u4f7f\u7528 CLI \u4e4b\u524d\uff0c\u8acb\u78ba\u4fdd\u60a8\u5df2\u5b89\u88dd <code>stcd</code></p> <p>\u7576\u60a8\u5275\u5efa\u65b0\u5bc6\u9470\u6642\uff0c\u60a8\u6703\u6536\u5230\u4e00\u500b\u53ef\u7528\u65bc\u6062\u5fa9\u8a72\u5bc6\u9470\u7684\u52a9\u8a18\u8a5e\u3002\u5099\u4efd\u52a9\u8a18\u8a5e\uff1a</p> <pre><code>stcd keys add dev0\n{\n  \"name\": \"dev0\",\n  \"type\": \"local\",\n  \"address\": \"dst1n253dl2tgyhxjm592p580c38r4dn8023ctv28d\",\n  \"pubkey\": '{\"@type\":\"/ethermint.crypto.v1.ethsecp256k1.PubKey\",\"key\":\"ArJhve4v5HkLm+F7ViASU/rAGx7YrwU4+XKV2MNJt+Cq\"}',\n  \"mnemonic\": \"\"\n}\n\n**Important** write this mnemonic phrase in a safe place.\nIt is the only way to recover your account if you ever forget your password.\n\n# &lt;24 word mnemonic phrase&gt;\n</code></pre> <p>\u8981\u6062\u5fa9\u5bc6\u9470\uff1a</p> <pre><code>$ stcd keys add dev0-restored --recover\n&gt; Enter your bip39 mnemonic\nbanner genuine height east ghost oak toward reflect asset marble else explain foster car nest make van divide twice culture announce shuffle net peanut\n{\n  \"name\": \"dev0-restored\",\n  \"type\": \"local\",\n  \"address\": \"dst1n253dl2tgyhxjm592p580c38r4dn8023ctv28d\",\n  \"pubkey\": '{\"@type\":\"/ethermint.crypto.v1.ethsecp256k1.PubKey\",\"key\":\"ArJhve4v5HkLm+F7ViASU/rAGx7YrwU4+XKV2MNJt+Cq\"}'\n}\n</code></pre>"},{"location":"protocol/key-management/#_2","title":"\u5bc6\u9470\u5c0e\u51fa","text":""},{"location":"protocol/key-management/#tendermint-","title":"Tendermint-\u79c1\u9470\u683c\u5f0f","text":"<p>\u8981\u5099\u4efd\u6b64\u985e\u4e0d\u5e36\u52a9\u8a18\u8a5e\u7684\u5bc6\u9470\uff0c\u8acb\u57f7\u884c\u4ee5\u4e0b\u64cd\u4f5c\uff1a</p> <pre><code>stcd keys export dev0\nEnter passphrase to decrypt your key:\nEnter passphrase to encrypt the exported key:\n-----BEGIN TENDERMINT PRIVATE KEY-----\nkdf: bcrypt\nsalt: 14559BB13D881A86E0F4D3872B8B2C82\ntype: secp256k1\n\n# &lt;Tendermint private key&gt;\n-----END TENDERMINT PRIVATE KEY-----\n\n$ echo \"\\\n-----BEGIN TENDERMINT PRIVATE KEY-----\nkdf: bcrypt\nsalt: 14559BB13D881A86E0F4D3872B8B2C82\ntype: secp256k1\n\n# &lt;Tendermint private key&gt;\n-----END TENDERMINT PRIVATE KEY-----\" &gt; dev0.export\n</code></pre>"},{"location":"protocol/key-management/#ethereum-","title":"Ethereum-\u79c1\u9470\u683c\u5f0f","text":"<p>\u6ce8\u610f: \u9019\u4e9b\u985e\u578b\u7684\u5bc6\u9470\u8207 MetaMask \u517c\u5bb9</p> <p>\u8981\u5099\u4efd\u6b64\u985e\u4e0d\u5e36\u52a9\u8a18\u8a5e\u7684\u5bc6\u9470\uff0c\u8acb\u57f7\u884c\u4ee5\u4e0b\u64cd\u4f5c\uff1a</p> <pre><code>stcd keys unsafe-export-eth-key dev0 &gt; dev0.export\n**WARNING** this is an unsafe way to export your unencrypted private key, are you sure? [y/N]: y\nEnter keyring passphrase:\n</code></pre>"},{"location":"protocol/key-management/#_3","title":"\u5bc6\u9470\u5c0e\u5165","text":""},{"location":"protocol/key-management/#tendermint-_1","title":"Tendermint-\u79c1\u9470\u683c\u5f0f","text":"<pre><code>$ stcd keys import dev0-imported ./dev0.export\nEnter passphrase to decrypt your key:\n</code></pre>"},{"location":"protocol/key-management/#ethereum-_1","title":"Ethereum-\u79c1\u9470\u683c\u5f0f","text":"<pre><code>$ stcd keys unsafe-import-eth-key dev0-imported ./dev0.export\nEnter passphrase to encrypt your key:\n</code></pre>"},{"location":"protocol/key-management/#_4","title":"\u9a57\u8b49","text":"<p>Verify that your key has been restored using the following command:</p> <pre><code>$ stcd keys list\n[\n  {\n    \"name\": \"dev0-imported\",\n    \"type\": \"local\",\n    \"address\": \"dst1n253dl2tgyhxjm592p580c38r4dn8023ctv28d\",\n    \"pubkey\": '{\"@type\":\"/ethermint.crypto.v1.ethsecp256k1.PubKey\",\"key\":\"ArJhve4v5HkLm+F7ViASU/rAGx7YrwU4+XKV2MNJt+Cq\"}'\n  },\n  {\n    \"name\": \"dev0-restored\",\n    \"type\": \"local\",\n    \"address\": \"dst1n253dl2tgyhxjm592p580c38r4dn8023ctv28d\",\n    \"pubkey\": '{\"@type\":\"/ethermint.crypto.v1.ethsecp256k1.PubKey\",\"key\":\"ArJhve4v5HkLm+F7ViASU/rAGx7YrwU4+XKV2MNJt+Cq\"}'\n  },\n  {\n    \"name\": \"dev0\",\n    \"type\": \"local\",\n    \"address\": \"dst1n253dl2tgyhxjm592p580c38r4dn8023ctv28d\",\n    \"pubkey\": '{\"@type\":\"/ethermint.crypto.v1.ethsecp256k1.PubKey\",\"key\":\"ArJhve4v5HkLm+F7ViASU/rAGx7YrwU4+XKV2MNJt+Cq\"}'\n  }\n]\n</code></pre>"},{"location":"protocol/keyring/","title":"\u5bc6\u9470\u74b0 Keyring","text":"<p>\u4f7f\u7528 CLI \u5bc6\u9470\u74b0\u5275\u5efa\u3001\u5c0e\u5165\u3001\u5c0e\u51fa\u548c\u522a\u9664\u5bc6\u9470\u3002</p> <p>\u5bc6\u9470\u74b0\u4fdd\u5b58\u7528\u65bc\u8207\u7bc0\u9ede\u4ea4\u4e92\u7684\u79c1\u9470/\u516c\u9470\u5c0d\u3002\u4f8b\u5982\uff0c\u5728\u904b\u884c\u7bc0\u9ede\u4e4b\u524d\u9700\u8981\u8a2d\u7f6e\u4e00\u500b\u9a57\u8b49\u5668\u5bc6\u9470\uff0c\u9019\u6a23\u624d\u80fd\u6b63\u78ba\u5730\u5c0d\u584a\u9032\u884c\u7c3d\u540d\u3002\u79c1\u9470\u53ef\u4ee5\u5b58\u5132\u5728\u4e0d\u540c\u7684\u4f4d\u7f6e\uff0c\u7a31\u70ba\"backends\"\uff0c\u4f8b\u5982\u6587\u4ef6\u6216\u64cd\u4f5c\u7cfb\u7d71\u81ea\u5df1\u7684\u5bc6\u9470\u5b58\u5132\u3002</p> <p>\ud83d\udce3 \u63d0\u793a\uff1a \u5982\u679c\u60a8\u9700\u8981\u5fa9\u7fd2\u79c1\u9470\u548c\u5bc6\u9470\u7ba1\u7406\uff0c\u8acb\u53c3\u8003\u6211\u5011\u7684\u5bc6\u9470\u7ba1\u7406\u3002</p>"},{"location":"protocol/keyring/#_1","title":"\u6dfb\u52a0\u5bc6\u9470","text":"<p>\u60a8\u53ef\u4ee5\u4f7f\u7528\u4ee5\u4e0b\u547d\u4ee4\u4f86\u7372\u53d6<code>keys</code>\u547d\u4ee4\u7684\u5e6b\u52a9\u4ee5\u53ca\u6709\u95dc\u7279\u5b9a\u5b50\u547d\u4ee4\u7684\u66f4\u591a\u4fe1\u606f\uff0c \u5206\u5225\uff1a</p> <pre><code>stcd keys\n</code></pre> <pre><code>stcd keys [command] --help\n</code></pre> <p>\u8981\u5728\u5bc6\u9470\u74b0\u4e2d\u5275\u5efa\u65b0\u5bc6\u9470\uff0c\u8acb\u904b\u884c\u5e36\u6709 <code>&lt;key_name&gt;</code> \u53c3\u6578\u7684 <code>add</code> \u5b50\u547d\u4ee4\u3002\u60a8\u5c07\u5fc5\u9808\u63d0\u4f9b\u5bc6\u78bc \u5c0d\u65bc\u65b0\u751f\u6210\u7684\u5bc6\u9470\u3002\u9019\u500b\u5bc6\u9470\u5c07\u5728\u4e0b\u4e00\u7bc0\u4e2d\u4f7f\u7528\u3002</p> <pre><code>stcd keys add dev0\n\n# Put the generated address in a variable for later use.\nMY_VALIDATOR_ADDRESS=$(stcd keys show dev0 -a)\n</code></pre> <p>\u6b64\u547d\u4ee4\u751f\u6210\u4e00\u500b\u65b0\u7684 24 \u5b57\u52a9\u8a18\u8a5e\uff0c\u4e26\u5c07\u5176\u6301\u4e45\u5316\u5230\u76f8\u95dc\u5f8c\u7aef\uff0c\u4e26\u8f38\u51fa\u6709\u95dc\u5bc6\u9470\u5c0d\u7684\u4fe1\u606f\u3002\u5982\u679c\u9019\u500b\u5bc6\u9470\u5c0d\u5c07\u88ab\u7528\u4f86\u4fdd\u5b58\u6709\u50f9\u503c\u7684\u4ee3\u5e63\uff0c\u4e00\u5b9a\u8981\u628a\u52a9\u8a18\u8a5e\u5beb\u5728\u5b89\u5168\u7684\u5730\u65b9\uff01</p> <p>\u9ed8\u8a8d\u60c5\u6cc1\u4e0b\uff0c\u5bc6\u9470\u74b0\u751f\u6210\u4e00\u500b<code>eth_secp256k1</code>\u5bc6\u9470\u3002\u5bc6\u9470\u74b0\u9084\u652f\u6301<code>ed25519</code>\u5bc6\u9470\uff0c\u53ef\u4ee5\u901a\u904e\u50b3\u905e<code>--algo</code>\u6a19\u8a8c\u4f86\u5275\u5efa\u3002\u9470\u5319\u5708\u7576\u7136\u53ef\u4ee5\u540c\u6642\u6301\u6709\u9019\u5169\u7a2e\u985e\u578b\u7684\u9470\u5319\u3002</p> <p>\ud83d\udce3 \u63d0\u793a\uff1a\u8207\u516c\u9470\u95dc\u806f\u7684\u4ee5\u592a\u574a\u5730\u5740\u53ef\u4ee5\u901a\u904e\u7372\u53d6<code>eth_secp256k1</code>\u985e\u578b\u7684\u5b8c\u6574\u4ee5\u592a\u574a\u516c\u9470\u3001\u8a08\u7b97<code>Keccak-256</code>\u54c8\u5e0c\u4e26\u622a\u65b7\u524d\u5341\u4e8c\u500b\u5b57\u7bc0\u4f86\u5c0e\u51fa\u3002</p> <p>\ud83d\udea8 \u5371\u96aa\uff1a\u7531\u65bc\u8207\u4ee5\u592a\u574a\u4ea4\u6613\u7684\u517c\u5bb9\u6027\u554f\u984c\uff0cDaodst \u4e0d\u652f\u6301 Cosmos <code>secp256k1</code> \u5bc6\u9470\u3002</p>"},{"location":"protocol/keyring/#_2","title":"\u5bc6\u9470\u74b0\u5f8c\u7aef","text":""},{"location":"protocol/keyring/#os","title":"OS","text":"<p>\ud83d\udce3 \u63d0\u793a\uff1a <code>os</code> \u662f\u9ed8\u8a8d\u9078\u9805\uff0c\u56e0\u70ba\u64cd\u4f5c\u7cfb\u7d71\u7684\u9ed8\u8a8d\u6191\u64da\u7ba1\u7406\u5668\u65e8\u5728\u6eff\u8db3\u7528\u6236\u6700\u5e38\u898b\u7684\u9700\u6c42\uff0c\u4e26\u5728\u4e0d\u5f71\u97ff\u5b89\u5168\u6027\u7684\u60c5\u6cc1\u4e0b\u70ba\u4ed6\u5011\u63d0\u4f9b\u8212\u9069\u7684\u9ad4\u9a57\u3002</p> <p><code>os</code> \u5f8c\u7aef\u4f9d\u8cf4\u64cd\u4f5c\u7cfb\u7d71\u7279\u5b9a\u7684\u9ed8\u8a8d\u503c\u4f86\u5b89\u5168\u5730\u8655\u7406\u5bc6\u9470\u5b58\u5132\u3002\u901a\u5e38\uff0c\u64cd\u4f5c\u7cfb\u7d71\u7684\u6191\u8b49\u5b50\u7cfb\u7d71\u6839\u64da\u7528\u6236\u7684\u5bc6\u78bc\u7b56\u7565\u8655\u7406\u5bc6\u78bc\u63d0\u793a\u3001\u79c1\u9470\u5b58\u5132\u548c\u7528\u6236\u6703\u8a71\u3002\u4ee5\u4e0b\u662f\u6700\u6d41\u884c\u7684\u64cd\u4f5c\u7cfb\u7d71\u53ca\u5176\u5404\u81ea\u7684\u5bc6\u78bc\u7ba1\u7406\u5668\u7684\u5217\u8868\uff1a</p> <ul> <li>macOS (since Mac OS 8.6): Keychain</li> <li>Windows: \u6191\u64da\u7ba1\u7406 API</li> <li>GNU/Linux:</li> <li>libsecret</li> <li>kwallet</li> </ul> <p>\u4f7f\u7528 GNOME \u4f5c\u70ba\u9ed8\u8a8d\u684c\u9762\u74b0\u5883\u7684 GNU/Linux \u767c\u884c\u7248\u901a\u5e38\u5e36\u6709 Seahorse\u3002 \u57fa\u65bc KDE \u7684\u767c\u884c\u7248\u7684\u7528\u6236\u901a\u5e38\u6703\u7372\u5f97 KDE \u9322\u5305\u7ba1\u7406\u5668\u3002 \u524d\u8005\u5be6\u969b\u4e0a\u662f\u4e00\u500b\u65b9\u4fbf\u7684 <code>libsecret</code> \u524d\u7aef\uff0c\u800c\u5f8c\u8005\u662f\u4e00\u500b <code>kwallet</code> \u5ba2\u6236\u7aef\u3002</p> <p>\u7121\u982d\u74b0\u5883\u7684\u63a8\u85a6\u5f8c\u7aef\u662f <code>file</code> \u548c <code>pass</code>\u3002</p>"},{"location":"protocol/keyring/#file","title":"File","text":"<p><code>file</code> \u5c07\u52a0\u5bc6\u7684\u5bc6\u9470\u74b0\u5b58\u5132\u5728\u61c9\u7528\u7a0b\u5e8f\u7684\u914d\u7f6e\u76ee\u9304\u4e2d\u3002\u6bcf\u6b21\u8a2a\u554f\u6b64\u5bc6\u9470\u74b0\u6642\u90fd\u6703\u8acb\u6c42\u5bc6\u78bc\uff0c\u9019\u53ef\u80fd\u6703\u5728\u55ae\u500b\u547d\u4ee4\u4e2d\u591a\u6b21\u51fa\u73fe\uff0c\u5f9e\u800c\u5c0e\u81f4\u91cd\u8907\u7684\u5bc6\u78bc\u63d0\u793a\u3002\u5982\u679c\u4f7f\u7528 bash \u8173\u672c\u901a\u904e <code>file</code> \u9078\u9805\u57f7\u884c\u547d\u4ee4\uff0c\u60a8\u53ef\u80fd\u5e0c\u671b\u5c0d\u591a\u500b\u63d0\u793a\u4f7f\u7528\u4ee5\u4e0b\u683c\u5f0f\uff1a</p> <pre><code># assuming that KEYPASSWD is set in the environment\nyes $KEYPASSWD | stcd keys add me\nyes $KEYPASSWD | stcd keys show me\n# start stcd with keyring-backend flag\nstcd --keyring-backend=file start\n</code></pre> <p>\ud83d\udce3 \u63d0\u793a\uff1a\u7b2c\u4e00\u6b21\u5c07\u5bc6\u9470\u6dfb\u52a0\u5230\u7a7a\u5bc6\u9470\u74b0\u6642\uff0c\u7cfb\u7d71\u5c07\u63d0\u793a\u60a8\u8f38\u5165\u5bc6\u78bc\u5169\u6b21\u3002</p>"},{"location":"protocol/keyring/#pass","title":"Pass","text":"<p><code>pass</code> \u5f8c\u7aef\u4f7f\u7528 pass \u5be6\u7528\u7a0b\u5e8f\u4f86\u7ba1\u7406\u5bc6\u9470\u7684\u654f\u611f\u6578\u64da\u548c\u5143\u6578\u64da\u7684\u78c1\u76e4\u52a0\u5bc6\u3002\u5bc6\u9470\u5b58\u5132\u5728\u7279\u5b9a\u65bc\u61c9\u7528\u7a0b\u5e8f\u7684\u76ee\u9304\u4e2d\u7684\u201cgpg\u201d\u52a0\u5bc6\u6587\u4ef6\u4e2d\u3002 <code>pass</code> \u9069\u7528\u65bc\u6700\u6d41\u884c\u7684 UNIX \u64cd\u4f5c\u7cfb\u7d71\u4ee5\u53ca GNU/Linux \u767c\u884c\u7248\u3002\u6709\u95dc\u5982\u4f55\u4e0b\u8f09\u548c\u5b89\u88dd\u5b83\u7684\u4fe1\u606f\uff0c\u8acb\u53c3\u95b1\u5176\u624b\u518a\u9801\u3002</p> <p>\ud83d\udce3 \u63d0\u793a\uff1a<code>pass</code> \u4f7f\u7528 GnuPG \u9032\u884c\u52a0\u5bc6\u3002 <code>gpg</code> \u5728\u57f7\u884c\u6642\u81ea\u52d5\u8abf\u7528 <code>gpg-agent</code> \u5b88\u8b77\u9032\u7a0b\uff0c\u5b83\u8655\u7406 GnuPG \u6191\u8b49\u7684\u7de9\u5b58\u3002\u6709\u95dc\u5982\u4f55\u914d\u7f6e\u7de9\u5b58\u53c3\u6578\uff08\u4f8b\u5982\u6191\u64da TTL \u548c\u5bc6\u78bc\u904e\u671f\u6642\u9593\uff09\u7684\u66f4\u591a\u4fe1\u606f\uff0c\u8acb\u53c3\u95b1 <code>gpg-agent</code> \u624b\u518a\u9801\u3002</p> <p>\u5fc5\u9808\u5728\u9996\u6b21\u4f7f\u7528\u4e4b\u524d\u8a2d\u7f6e\u5bc6\u78bc\u5b58\u5132\uff1a</p> <pre><code>pass init &lt;GPG_KEY_ID&gt;\n</code></pre> <p>\u5c07 <code>&lt;GPG_KEY_ID&gt;</code> \u66ff\u63db\u70ba\u60a8\u7684 GPG \u5bc6\u9470 ID\u3002\u60a8\u53ef\u4ee5\u4f7f\u7528\u60a8\u7684\u500b\u4eba GPG \u5bc6\u9470\u6216\u60a8\u53ef\u80fd\u60f3\u5c08\u9580\u7528\u4f86\u52a0\u5bc6\u5bc6\u78bc\u5b58\u5132\u7684\u66ff\u4ee3\u5bc6\u9470\u3002</p>"},{"location":"protocol/keyring/#kwallet","title":"Kwallet","text":"<p><code>kwallet</code> \u5f8c\u7aef\u4f7f\u7528 <code>KDE Wallet Manager</code>\uff0c\u5b83\u9ed8\u8a8d\u5b89\u88dd\u5728\u4ee5 KDE \u4f5c\u70ba\u9ed8\u8a8d\u684c\u9762\u74b0\u5883\u7684 GNU/Linux \u767c\u884c\u7248\u4e0a\u3002\u66f4\u591a\u8acb\u53c3\u8003KWallet\u624b\u518a\u4fe1\u606f\u3002</p>"},{"location":"protocol/keyring/#testing","title":"Testing","text":"<p><code>test</code> \u5f8c\u7aef\u662f <code>file</code> \u5f8c\u7aef\u7684\u7121\u5bc6\u78bc\u8b8a\u9ad4\u3002\u5bc6\u9470\u4ee5\u672a\u52a0\u5bc6\u7684\u5f62\u5f0f\u5b58\u5132\u5728\u78c1\u76e4\u4e0a\u3002\u6b64\u5bc6\u9470\u74b0\u50c5\u7528\u65bc\u6e2c\u8a66\u76ee\u7684\u3002\u4f7f\u7528\u98a8\u96aa\u81ea\u8ca0\uff01</p> <p>\ud83d\udea8 \u5371\u96aa\uff1a\u6c38\u9060\u4e0d\u8981\u4f7f\u7528 <code>test</code> \u9375\u63a7\u5f8c\u7aef\u5275\u5efa\u60a8\u7684\u4e3b\u7db2\u9a57\u8b49\u5668\u5bc6\u9470\u3002\u9019\u6a23\u505a\u53ef\u80fd\u6703\u5c0e\u81f4 \u901a\u904e<code>eth_sendTransaction</code>JSON-RPC \u7aef\u9ede\u9060\u7a0b\u8a2a\u554f\u60a8\u7684\u8cc7\u91d1\uff0c\u5f9e\u800c\u9020\u6210\u8cc7\u91d1\u640d\u5931\u3002</p>"},{"location":"protocol/keyring/#memory","title":"Memory","text":"<p><code>memory</code> \u5f8c\u7aef\u5c07\u5bc6\u9470\u5b58\u5132\u5728\u5167\u5b58\u4e2d\u3002\u7a0b\u5e8f\u9000\u51fa\u5f8c\uff0c\u5bc6\u9470\u5c07\u7acb\u5373\u522a\u9664\u3002</p> <p>\ud83d\udea8 \u5371\u96aa\uff1a\u50c5\u4f9b\u6e2c\u8a66\u4e4b\u7528\u3002 <code>memory</code> \u5f8c\u7aef\u4e0d\u63a8\u85a6\u7528\u65bc\u751f\u7522\u74b0\u5883\u3002\u4f7f\u7528\u98a8\u96aa\u81ea\u8ca0\uff01</p>"},{"location":"protocol/multsign/","title":"\u591a\u7c3d","text":"<p>\u4e86\u89e3\u5982\u4f55\u4f7f\u7528\u5bc6\u9470\u74b0\u591a\u91cd\u7c3d\u540d\u751f\u6210\u3001\u7c3d\u7f72\u548c\u5ee3\u64ad\u4ea4\u6613\u3002</p> <p>\u591a\u91cd\u7c3d\u540d\u8cec\u6236\u662f\u4e00\u7a2e\u5e36\u6709\u7279\u6b8a\u5bc6\u9470\u7684 Dst \u8cec\u6236\uff0c\u9700\u8981\u591a\u500b\u7c3d\u540d\u624d\u80fd\u7c3d\u7f72\u4ea4\u6613\u3002 \u9019\u5c0d\u65bc\u63d0\u9ad8\u5e33\u6236\u7684\u5b89\u5168\u6027\u6216\u9700\u8981\u591a\u65b9\u540c\u610f\u624d\u80fd\u9032\u884c\u4ea4\u6613\u5f88\u6709\u7528\u3002 \u53ef\u4ee5\u901a\u904e\u6307\u5b9a\u4ee5\u4e0b\u5167\u5bb9\u4f86\u5275\u5efa\u591a\u91cd\u7c3d\u540d\u5e33\u6236\uff1a</p> <ul> <li>\u6240\u9700\u7c3d\u540d\u7684\u95be\u503c\u6578\u91cf</li> <li>\u53c3\u8207\u7c3d\u540d\u7684\u516c\u9470</li> </ul> <p>\u8981\u4f7f\u7528\u591a\u91cd\u7c3d\u540d\u8cec\u6236\u7c3d\u540d\uff0c\u4ea4\u6613\u5fc5\u9808\u7531\u70ba\u8a72\u8cec\u6236\u6307\u5b9a\u7684\u4e0d\u540c\u5bc6\u9470\u55ae\u7368\u7c3d\u540d\u3002\u7136\u5f8c\uff0c\u7c3d\u540d\u5c07\u88ab\u7d44\u5408\u6210\u4e00\u500b\u591a\u91cd\u7c3d\u540d\uff0c\u53ef\u7528\u65bc\u7c3d\u7f72\u4ea4\u6613\u3002\u5982\u679c\u5b58\u5728\u7684\u7c3d\u540d\u6578\u91cf\u5c11\u65bc\u6240\u9700\u7684\u95be\u503c\u6578\u91cf\uff0c\u5247\u7531\u6b64\u7522\u751f\u7684\u591a\u91cd\u7c3d\u540d\u88ab\u8996\u70ba\u7121\u6548\u3002</p>"},{"location":"protocol/multsign/#_1","title":"\u751f\u6210\u591a\u7c3d\u5bc6\u9470\u5c0d","text":"<pre><code>stcd keys add --multisig=name1,name2,name3[...] --multisig-threshold=K new_key_name\n</code></pre> <p><code>K</code> \u662f\u5fc5\u9808\u7c3d\u7f72\u5e36\u6709\u516c\u9470\u5730\u5740\u4f5c\u70ba\u7c3d\u540d\u8005\u7684\u4ea4\u6613\u7684\u6700\u5c0f\u79c1\u9470\u6578\u91cf\u3002</p> <p><code>--multisig</code> \u6a19\u8a8c\u5fc5\u9808\u5305\u542b\u516c\u9470\u7684\u540d\u7a31\uff0c\u9019\u4e9b\u516c\u9470\u5c07\u7d44\u5408\u6210\u4e00\u500b\u516c\u9470\uff0c\u8a72\u516c\u9470\u5c07\u5728\u672c\u5730\u6578\u64da\u5eab\u4e2d\u751f\u6210\u4e26\u5b58\u5132\u70ba <code>new_key_name</code>\u3002</p> <p>\u901a\u904e <code>--multisig</code> \u63d0\u4f9b\u7684\u6240\u6709\u540d\u7a31\u5fc5\u9808\u5df2\u7d93\u5b58\u5728\u65bc\u672c\u5730\u6578\u64da\u5eab\u4e2d\u3002</p> <p>\u9664\u975e\u8a2d\u7f6e\u4e86\u6a19\u8a8c <code>--nosort</code>\uff0c\u5426\u5247\u5728\u547d\u4ee4\u884c\u4e0a\u63d0\u4f9b\u9375\u7684\u9806\u5e8f\u7121\u95dc\u7dca\u8981\uff0c\u5373\u4ee5\u4e0b\u547d\u4ee4\u751f\u6210\u5169\u500b\u76f8\u540c\u7684\u9375\uff1a</p> <pre><code>stcd keys add --multisig=p1,p2,p3 --multisig-threshold=2 multisig_address\nstcd keys add --multisig=p2,p3,p1 --multisig-threshold=2 multisig_address\n</code></pre> <p>\u591a\u91cd\u7c3d\u540d\u5730\u5740\u4e5f\u53ef\u4ee5\u5373\u6642\u751f\u6210\u4e26\u901a\u904e which \u547d\u4ee4\u6253\u5370\uff1a</p> <pre><code>stcd keys show --multisig-threshold=K name1 name2 name3 [...]\n</code></pre>"},{"location":"protocol/multsign/#_2","title":"\u7c3d\u540d\u4ea4\u6613","text":""},{"location":"protocol/multsign/#step-1","title":"Step 1: \u5275\u5efa\u591a\u7c3d\u5bc6\u9470","text":"<p>\u5047\u8a2d\u60a8\u6709 <code>test1</code> \u548c <code>test2</code> \u60f3\u8981\u4f7f\u7528 <code>test3</code> \u5275\u5efa\u4e00\u500b\u591a\u91cd\u7c3d\u540d\u5e33\u6236\u3002</p> <p>\u9996\u5148\u5c07 <code>test3</code> \u7684\u516c\u9470\u5c0e\u5165\u60a8\u7684\u5bc6\u9470\u74b0\u3002</p> <pre><code>stcd keys add \\\n    test3 \\\n    --pubkey=dstpub1addwnpepqgcxazmq6wgt2j4rdfumsfwla0zfk8e5sws3p3zg5dkm9007hmfysxas0u2\n</code></pre> <p>\u751f\u6210\u5177\u6709 2/3 \u95be\u503c\u7684\u591a\u91cd\u7c3d\u540d\u5bc6\u9470\u3002</p> <pre><code>stcd keys add \\\n    multi \\\n    --multisig=test1,test2,test3 \\\n    --multisig-threshold=2\n</code></pre> <p>\u4f60\u53ef\u4ee5\u770b\u5230\u5b83\u7684\u5730\u5740\u548c\u8a73\u7d30\u4fe1\u606f\uff1a</p> <pre><code>stcd keys show multi\n\n- name: multi\n  type: multi\n  address: dst1e0fx0q9meawrcq7fmma9x60gk35lpr4xk3884m\n  pubkey: dstpub1ytql0csgqgfzd666axrjzq3mxw59ys6yqcd3ydjvhgs0uzs6kdk5fp4t73gmkl8t6y02yfq7tvfzd666axrjzq3sd69kp5usk492x6nehqjal67ynv0nfqapzrzy3gmdk27la0kjfqfzd666axrjzq6utqt639ka2j3xkncgk65dup06t297ccljmxhvhu3rmk92u3afjuyz9dg9\n  mnemonic: \"\"\n  threshold: 0\n  pubkeys: []\n</code></pre> <p>\u8b93\u6211\u5011\u5411\u591a\u91cd\u7c3d\u540d\u9322\u5305\u6dfb\u52a0 10 \u500b DST\uff1a</p> <pre><code>stcd tx bank send \\\n    test1 \\\n    dst1e0fx0q9meawrcq7fmma9x60gk35lpr4xk3884m \\\n    10000000000000000000dst \\\n    --chain-id=daodst_7000-1 \\\n    --gas=auto \\\n    --fees=1000000dst \\\n    --broadcast-mode=block\n</code></pre>"},{"location":"protocol/multsign/#step-2","title":"Step 2: \u5275\u5efa\u591a\u7c3d\u4ea4\u6613","text":"<p>\u6211\u5011\u60f3\u5f9e\u6211\u5011\u7684\u591a\u91cd\u7c3d\u540d\u8cec\u6236\u767c\u9001 5 \u500b DST \u5230 <code>dst1rgjxswhuxhcrhmyxlval0qa70vxwvqn2e0srft</code>\u3002</p> <pre><code>stcd tx bank send \\\n    dst1rgjxswhuxhcrhmyxlval0qa70vxwvqn2e0srft \\\n    dst157g6rn6t6k5rl0dl57zha2wx72t633axqyvvwq \\\n    5000000000000000000dst \\\n    --gas=200000 \\\n    --fees=1000000dst \\\n    --chain-id=daodst_7000-1 \\\n    --generate-only &gt; unsignedTx.json\n</code></pre> <p>\u6587\u4ef6 <code>unsignedTx.json</code> \u5305\u542b\u4ee5 JSON \u7de8\u78bc\u7684\u672a\u7c3d\u540d\u4ea4\u6613\u3002</p> <pre><code>{\n  \"body\": {\n    \"messages\": [\n      {\n        \"@type\": \"/cosmos.bank.v1beta1.MsgSend\",\n        \"from_address\": \"dst1rgjxswhuxhcrhmyxlval0qa70vxwvqn2e0srft\",\n        \"to_address\": \"dst157g6rn6t6k5rl0dl57zha2wx72t633axqyvvwq\",\n        \"amount\": [\n          {\n            \"denom\": \"dst\",\n            \"amount\": \"5000000000000000000\"\n          }\n        ]\n      }\n    ],\n    \"memo\": \"\",\n    \"timeout_height\": \"0\",\n    \"extension_options\": [],\n    \"non_critical_extension_options\": []\n  },\n  \"auth_info\": {\n    \"signer_infos\": [],\n    \"fee\": {\n      \"amount\": [\n        {\n          \"denom\": \"dst\",\n          \"amount\": \"1000000\"\n        }\n      ],\n      \"gas_limit\": \"200000\",\n      \"payer\": \"\",\n      \"granter\": \"\"\n    }\n  },\n  \"signatures\": []\n}\n</code></pre>"},{"location":"protocol/multsign/#step-3","title":"Step 3: \u55ae\u7368\u7c3d\u540d","text":"<p>\u4f7f\u7528 <code>test1</code> \u548c <code>test2</code> \u7c3d\u540d\u4e26\u5275\u5efa\u500b\u4eba\u7c3d\u540d\u3002</p> <pre><code>stcd tx sign \\\n    unsignedTx.json \\\n    --multisig=dst1e0fx0q9meawrcq7fmma9x60gk35lpr4xk3884m \\\n    --from=test1 \\\n    --output-document=test1sig.json \\\n    --chain-id=daodst_7000-1\n</code></pre> <pre><code>stcd tx sign \\\n    unsignedTx.json \\\n    --multisig=dst1e0fx0q9meawrcq7fmma9x60gk35lpr4xk3884m \\\n    --from=test2 \\\n    --output-document=test2sig.json \\\n    --chain-id=daodst_7000-1\n</code></pre>"},{"location":"protocol/multsign/#step-4","title":"Step 4: \u5275\u5efa\u591a\u91cd\u7c3d\u540d","text":"<p>\u7d50\u5408\u7c3d\u540d\u4f86\u7c3d\u7f72\u4ea4\u6613\u3002</p> <pre><code>stcd tx multisign \\\n    unsignedTx.json \\\n    multi \\\n    test1sig.json test2sig.json \\\n    --output-document=signedTx.json \\\n    --chain-id=daodst_7000-1\n</code></pre> <p>TX \u73fe\u5df2\u7c3d\u7f72\uff1a</p> <pre><code>{\n  \"body\": {\n    \"messages\": [\n      {\n        \"@type\": \"/cosmos.bank.v1beta1.MsgSend\",\n        \"from_address\": \"dst1rgjxswhuxhcrhmyxlval0qa70vxwvqn2e0srft\",\n        \"to_address\": \"dst157g6rn6t6k5rl0dl57zha2wx72t633axqyvvwq\",\n        \"amount\": [\n          {\n            \"denom\": \"dst\",\n            \"amount\": \"5000000000000000000\"\n          }\n        ]\n      }\n    ],\n    \"memo\": \"\",\n    \"timeout_height\": \"0\",\n    \"extension_options\": [],\n    \"non_critical_extension_options\": []\n  },\n  \"auth_info\": {\n    \"signer_infos\": [\n      {\n        \"public_key\": {\n          \"@type\": \"/cosmos.crypto.multisig.LegacyAminoPubKey\",\n          \"threshold\": 2,\n          \"public_keys\": [\n            {\n              \"@type\": \"/cosmos.crypto.secp256k1.PubKey\",\n              \"key\": \"ApCzSG8k7Tr4aM6e4OJRExN7cNtvH21L9azbh+uRrvt4\"\n            },\n            {\n              \"@type\": \"/cosmos.crypto.secp256k1.PubKey\",\n              \"key\": \"Ah91erz8ChNanqLe9ea948rvAiXMCRlR5Ka7EE/c0xUK\"\n            },\n            {\n              \"@type\": \"/cosmos.crypto.secp256k1.PubKey\",\n              \"key\": \"A0OjtIUCFJM3AobJ9HJTWKP9RZV2+WPcwVjLgsAidrZ/\"\n            }\n          ]\n        },\n        \"mode_info\": {\n          \"multi\": {\n            \"bitarray\": {\n              \"extra_bits_stored\": 3,\n              \"elems\": \"wA==\"\n            },\n            \"mode_infos\": [\n              {\n                \"single\": {\n                  \"mode\": \"SIGN_MODE_LEGACY_AMINO_JSON\"\n                }\n              },\n              {\n                \"single\": {\n                  \"mode\": \"SIGN_MODE_LEGACY_AMINO_JSON\"\n                }\n              }\n            ]\n          }\n        },\n        \"sequence\": \"1\"\n      }\n    ],\n    \"fee\": {\n      \"amount\": [\n        {\n          \"denom\": \"dst\",\n          \"amount\": \"1000000\"\n        }\n      ],\n      \"gas_limit\": \"200000\",\n      \"payer\": \"\",\n      \"granter\": \"\"\n    }\n  },\n  \"signatures\": [\n    \"CkCEeIbeGc+I1ipZuhp/0KhVNnWAv2tTlvgo5x61lzk1KHmLPV38m/YFurrFt5cm5+fqIXrn+FlOjrJuzBhw8ogYCkCawm9mpXsBHk0CFsE5618fVnvScEkfrzW0c2jCcjqV8EPuj3ut74UWzZyQkwtJGxUWtro9EgnGsB7Di1Gzizst\"\n  ]\n}\n</code></pre>"},{"location":"protocol/multsign/#step-5","title":"Step 5: \u5ee3\u64ad\u4ea4\u6613","text":"<pre><code>stcd tx broadcast signedTx.json \\\n    --chain-id=daodst_7000-1 \\\n    --broadcast-mode=block\n</code></pre>"},{"location":"protocol/pending/","title":"\u7b49\u5f85\u968a\u5217","text":"<p>\u7576\u4e00\u7b46\u4ea4\u6613\u88ab\u63d0\u4ea4\u5230\u4ee5\u592a\u574a\u7db2\u7d61\u6642\uff0c\u5b83\u9996\u5148\u9032\u5165\u5f85\u8655\u7406\u72c0\u614b\uff0c\u7b49\u5f85\u7bc0\u9ede\u57f7\u884c\u3002</p> <p>\u5982\u679c\u4ea4\u6613\u4e2d\u7684 gas \u50f9\u683c\u8a2d\u7f6e\u5f97\u975e\u5e38\u4f4e\u4e26\u4e14\u7bc0\u9ede\u6b63\u5fd9\u65bc\u8655\u7406\u5176\u4ed6\u66f4\u9ad8 gas \u50f9\u683c\u7684\u4ea4\u6613\uff0c\u5247\u4ea4\u6613\u53ef\u80fd\u6703\u5728\u66f4\u9577\u7684\u6642\u9593\u5167\u8655\u65bc\u5f85\u8655\u7406\u72c0\u614b\u3002</p> <p>\u5728\u639b\u8d77\u72c0\u614b\u671f\u9593\uff0c\u5141\u8a31\u4ea4\u6613\u767c\u8d77\u8005\u96a8\u6642\u66f4\u6539\u4ea4\u6613\u5b57\u6bb5\u3002</p> <p>\u4ed6\u5011\u53ef\u4ee5\u901a\u904e\u767c\u9001\u5177\u6709\u76f8\u540c\u96a8\u6a5f\u6578\u7684\u53e6\u4e00\u7b46\u4ea4\u6613\u4f86\u505a\u5230\u9019\u4e00\u9ede\u3002</p>"},{"location":"protocol/pending/#_1","title":"\u5148\u6c7a\u689d\u4ef6\u95b1\u8b80","text":"<ul> <li>Cosmos SDK Mempool</li> </ul>"},{"location":"protocol/pending/#daodst-ethereum","title":"Daodst \u5c0d\u6bd4 Ethereum","text":"<p>\u5728\u4ee5\u592a\u574a\u4e2d\uff0c\u5f85\u8655\u7406\u7684\u5340\u584a\u662f\u5728\u7926\u5de5\u6392\u968a\u7b49\u5f85\u751f\u7522\u6642\u751f\u6210\u7684\u3002</p> <p>\u9019\u4e9b\u672a\u6c7a\u5340\u584a\u5305\u62ec\u7926\u5de5\u6839\u64da\u652f\u4ed8\u7684\u6700\u9ad8 gas \u734e\u52f5\u6311\u9078\u51fa\u7684\u672a\u6c7a\u4ea4\u6613\u3002</p> <p>\u9019\u7a2e\u6a5f\u5236\u7684\u5b58\u5728\u662f\u56e0\u70ba\u5728\u4ee5\u592a\u574a\u7db2\u7d61\u4e0a\u4e0d\u53ef\u80fd\u5be6\u73fe\u5340\u584a\u6700\u7d42\u6027\u3002</p> <p>\u584a\u4ee5\u6982\u7387\u78ba\u5b9a\u6027\u63d0\u4ea4\uff0c\u9019\u610f\u5473\u8457\u96a8\u8457\u6642\u9593\uff08\u548c\u584a\uff09\u7684\u6d41\u901d\uff0c\u4ea4\u6613\u548c\u584a\u8b8a\u5f97\u4e0d\u592a\u53ef\u80fd\u88ab\u9084\u539f\u3002</p> <p>Daodst \u5728\u9019\u65b9\u9762\u7684\u8a2d\u8a08\u5b8c\u5168\u4e0d\u540c\uff0c\u56e0\u70ba\u6c92\u6709\u201c\u5f85\u5b9a\u72c0\u614b\u201d\u7684\u6982\u5ff5\u3002</p> <p>Daodst \u4f7f\u7528 Tendermint Core BFT \u5171\u8b58\uff0c\u70ba\u4ea4\u6613\u63d0\u4f9b\u5373\u6642\u7d42\u7d50\u6027\u3002</p> <p>\u51fa\u65bc\u9019\u500b\u539f\u56e0\uff0cEthermint \u4e0d\u9700\u8981\u639b\u8d77\u72c0\u614b\u6a5f\u5236\uff0c\u56e0\u70ba\u6240\u6709\uff08\u5982\u679c\u4e0d\u662f\u5927\u591a\u6578\uff09\u4ea4\u6613\u90fd\u5c07\u63d0\u4ea4\u5230\u4e0b\u4e00\u500b\u5340\u584a\uff08Cosmos \u93c8\u4e0a\u7684\u5e73\u5747\u5340\u584a\u6642\u9593\u7d04\u70ba 8 \u79d2\uff09\u3002</p> <p>\u7136\u800c\uff0c\u9019\u6703\u5c0e\u81f4\u4e00\u4e9b\u8207\u4ee5\u592a\u574a Web3 \u517c\u5bb9\u7684\u67e5\u8a62\u51fa\u73fe\u554f\u984c\uff0c\u9019\u4e9b\u67e5\u8a62\u53ef\u80fd\u6703\u9032\u5165\u639b\u8d77\u72c0\u614b\u3002</p> <p>\u8207\u4ee5\u592a\u574a\u7684\u53e6\u4e00\u500b\u986f\u8457\u5340\u5225\u662f\uff0c\u5340\u584a\u662f\u7531\u9a57\u8b49\u8005\u6216\u5340\u584a\u751f\u7522\u8005\u751f\u6210\u7684\uff0c\u4ed6\u5011\u4ee5\u5148\u9032\u5148\u51fa (FIFO) \u7684\u65b9\u5f0f\u5c07\u672c\u5730\u5167\u5b58\u6c60\u4e2d\u7684\u4ea4\u6613\u5305\u542b\u5230\u5340\u584a\u4e2d\u3002</p> <p>Daodst \u4e0a\u7684\u4ea4\u6613\u4e0d\u80fd\u5f9e Tendermint \u7bc0\u9ede mempool \u4e2d\u6392\u5e8f\u6216\u6311\u9078\u51fa\u4f86\u3002</p>"},{"location":"protocol/pending/#pending","title":"Pending \u72c0\u614b\u968a\u5217","text":"<p>Daodst \u5c07\u9032\u884c\u67e5\u8a62\uff0c\u4ee5\u8aaa\u660e\u7bc0\u9ede\u4ea4\u6613\u5167\u5b58\u6c60\u4e2d\u5b58\u5728\u7684\u4efb\u4f55\u672a\u78ba\u8a8d\u4ea4\u6613\u3002</p> <p>\u9032\u884c\u7684\u639b\u8d77\u72c0\u614b\u67e5\u8a62\u5c07\u662f\u4e3b\u89c0\u7684\uff0c\u4e26\u4e14\u5c07\u5728\u76ee\u6a19\u7bc0\u9ede\u7684\u5167\u5b58\u6c60\u4e0a\u9032\u884c\u67e5\u8a62\u3002</p> <p>\u56e0\u6b64\uff0c\u5c0d\u65bc\u5169\u500b\u4e0d\u540c\u7bc0\u9ede\u7684\u76f8\u540c\u67e5\u8a62\uff0c\u639b\u8d77\u72c0\u614b\u5c07\u4e0d\u76f8\u540c\u3002</p> <p> JSON-RPC Calls on Pending Transactions </p> <ul> <li><code>eth_getBalance</code></li> <li><code>eth_getTransactionCount</code></li> <li><code>eth_getBlockTransactionCountByNumber</code></li> <li><code>eth_getBlockByNumber</code></li> <li><code>eth_getTransactionByHash</code></li> <li><code>eth_getTransactionByBlockNumberAndIndex</code></li> <li><code>eth_sendTransaction</code></li> </ul>"},{"location":"protocol/state-migrate/","title":"\u72c0\u614b\u5c0e\u5165\u5c0e\u51fa","text":"<p>Daodst \u53ef\u4ee5\u5c07\u6574\u500b\u61c9\u7528\u7a0b\u5e8f\u72c0\u614b\u8f49\u5132\u5230\u4e00\u500b JSON \u6587\u4ef6\u4e2d\u3002 \u9664\u4e86 \u5347\u7d1a\uff0c\u9019\u5c0d\u65bc\u5728\u6307\u5b9a\u9ad8\u5ea6\u624b\u52d5\u5206\u6790\u72c0\u614b\u5f88\u6709\u7528\u3002</p>"},{"location":"protocol/state-migrate/#_1","title":"\u5c0e\u51fa\u72c0\u614b","text":"<p>\u5c0e\u51fa\u72c0\u614b\uff1a</p> <pre><code>stcd export &gt; new_genesis.json\n</code></pre> <p>\u60a8\u9084\u53ef\u4ee5\u5f9e\u7279\u5b9a\u9ad8\u5ea6\u5c0e\u51fa\u72c0\u614b\uff08\u5728\u8655\u7406\u8a72\u9ad8\u5ea6\u7684\u584a\u7d50\u675f\u6642\uff09\uff1a</p> <pre><code>stcd export --height [height] &gt; new_genesis.json\n</code></pre> <p>\u5982\u679c\u60a8\u8a08\u5283\u5f9e\u5c0e\u51fa\u72c0\u614b\u958b\u59cb\u4e00\u500b\u9ad8\u5ea6\u70ba 0\uff08\u5373\u5275\u4e16\u7d00\uff09\u7684\u65b0\u7db2\u7d61\uff0c\u8acb\u4f7f\u7528 <code>--for-zero-height</code> \u6a19\u8a8c\u5c0e\u51fa\uff1a</p> <pre><code>stcd export --height [height] --for-zero-height &gt; new_genesis.json\n</code></pre>"},{"location":"protocol/state-migrate/#_2","title":"\u624b\u52d5\u9077\u79fb\u72c0\u614b","text":"<p>\u5982\u679c\u4f60\u60f3\u624b\u52d5\u9077\u79fb\u72c0\u614b\uff0c\u4f8b\u5982\u7528\u65bc\u672c\u5730\u6e2c\u8a66\u76ee\u7684\u3002 \u8acb\u6ce8\u610f\uff0c\u5c0d\u65bc\u5e38\u898f\u93c8\u5347\u7d1a\uff0c\u4e0d\u9700\u8981\u624b\u52d5\u72c0\u614b\u9077\u79fb\u3002</p> <p>\u5c07\u72c0\u614b\u5c0e\u51fa\u5230 json \u6587\u4ef6\u5f8c\uff0c\u60a8\u53ef\u4ee5\u5c07\u820a\u7684 <code>genesis.json</code> \u66ff\u63db\u70ba <code>new_genesis.json</code></p> <pre><code>cp -f genesis.json new_genesis.json\nmv new_genesis.json genesis.json\n</code></pre> <p>\u6b64\u6642\uff0c\u60a8\u53ef\u80fd\u60f3\u8981\u904b\u884c\u4e00\u500b\u8173\u672c\u4f86\u5c07\u5c0e\u51fa\u7684\u5275\u4e16\u7d00\u66f4\u65b0\u70ba\u8207\u60a8\u7684\u65b0\u7248\u672c\u517c\u5bb9\u7684\u5275\u4e16\u72c0\u614b\u3002</p> <p>\u60a8\u53ef\u4ee5\u4f7f\u7528 <code>migrate</code> \u547d\u4ee4\u5f9e\u7d66\u5b9a\u7248\u672c\u9077\u79fb\u5230\u4e0b\u4e00\u500b\u7248\u672c\uff08\u4f8b\u5982\uff1a<code>v0.X.X</code> \u5230 <code>v1.X.X</code>\uff09\uff1a</p> <pre><code>stcd migrate TARGET_VERSION GENESIS_FILE --chain-id=&lt;new_chain_id&gt; --genesis-time=&lt;yyyy-mm-ddThh:mm:ssZ&gt;\n</code></pre>"},{"location":"protocol/transfer/","title":"\u4ea4\u6613","text":"<p>\u4ea4\u6613\u662f\u6307\u7531\u8cec\u6236\u767c\u8d77\u7684\u6539\u8b8a\u5340\u584a\u93c8\u72c0\u614b\u7684\u52d5\u4f5c\u3002\u70ba\u4e86\u6709\u6548\u5730\u57f7\u884c\u72c0\u614b\u66f4\u6539\uff0c\u6bcf\u7b46\u4ea4\u6613\u90fd\u6703\u5ee3\u64ad\u5230\u6574\u500b\u7db2\u7d61\u3002</p> <p>\u4efb\u4f55\u7bc0\u9ede\u90fd\u53ef\u4ee5\u5ee3\u64ad\u8acb\u6c42\u5728\u5340\u584a\u93c8\u72c0\u614b\u6a5f\u4e0a\u57f7\u884c\u7684\u4ea4\u6613\uff1b\u767c\u751f\u9019\u7a2e\u60c5\u6cc1\u5f8c\uff0c\u9a57\u8b49\u5668\u5c07\u9a57\u8b49\u3001\u57f7\u884c\u4ea4\u6613\u4e26\u5c07\u7522\u751f\u7684\u72c0\u614b\u66f4\u6539\u50b3\u64ad\u5230\u7db2\u7d61\u7684\u5176\u9918\u90e8\u5206\u3002</p> <p>\u70ba\u4e86\u8655\u7406\u6bcf\u7b46\u4ea4\u6613\uff0c\u7db2\u7d61\u4e0a\u7684\u8a08\u7b97\u8cc7\u6e90\u90fd\u6703\u88ab\u6d88\u8017\u3002\u56e0\u6b64\uff0c<code>gas</code>\u7684\u6982\u5ff5\u662f\u4f5c\u70ba\u9a57\u8b49\u8005\u8655\u7406\u4ea4\u6613\u6240\u9700\u7684\u8a08\u7b97\u7684\u53c3\u8003\u800c\u51fa\u73fe\u7684\u3002</p> <p>\u7528\u6236\u5fc5\u9808\u70ba\u6b64\u8a08\u7b97\u4ed8\u8cbb\uff0c\u6240\u6709\u4ea4\u6613\u90fd\u9700\u8981\u76f8\u95dc\u8cbb\u7528\u3002\u8a72\u8cbb\u7528\u662f\u6839\u64da\u57f7\u884c\u4ea4\u6613\u6240\u9700\u7684 gas \u548c gas \u50f9\u683c\u8a08\u7b97\u7684\u3002</p> <p>\u6b64\u5916\uff0c\u4ea4\u6613\u9700\u8981\u4f7f\u7528\u767c\u9001\u65b9\u7684\u79c1\u9470\u9032\u884c\u7c3d\u540d\u3002\u9019\u8b49\u660e\u4ea4\u6613\u53ea\u80fd\u4f86\u81ea\u767c\u4ef6\u4eba\uff0c\u800c\u4e0d\u662f\u6b3a\u8a50\u6027\u767c\u9001\u3002</p> <p>\u7c21\u800c\u8a00\u4e4b\uff0c\u5c07\u7c3d\u540d\u4ea4\u6613\u63d0\u4ea4\u5230\u7db2\u7d61\u5f8c\u7684\u4ea4\u6613\u751f\u547d\u9031\u671f\u5982\u4e0b\uff1a</p> <ul> <li>\u4ea4\u6613\u54c8\u5e0c\u662f\u52a0\u5bc6\u751f\u6210\u7684\u3002</li> <li>\u8a72\u4ea4\u6613\u88ab\u5ee3\u64ad\u5230\u7db2\u7d61\u4e26\u6dfb\u52a0\u5230\u7531\u6240\u6709\u5176\u4ed6\u672a\u6c7a\u7db2\u7d61\u4ea4\u6613\u7d44\u6210\u7684\u4ea4\u6613\u6c60\u4e2d\u3002</li> <li>\u9a57\u8b49\u8005\u5fc5\u9808\u9078\u64c7\u4f60\u7684\u4ea4\u6613\u4e26\u5c07\u5176\u5305\u542b\u5728\u4e00\u500b\u584a\u4e2d\uff0c\u4ee5\u9a57\u8b49\u4ea4\u6613\u4e26\u8a8d\u70ba\u5b83\u201c\u6210\u529f\u201d\u3002</li> </ul> <p>\u95dc\u65bc\u4ea4\u6613\u751f\u547d\u9031\u671f\u7684\u66f4\u8a73\u7d30\u89e3\u91cb\uff0c\u8acb\u53c3\u898b\u76f8\u61c9\u90e8\u5206\u3002</p> <p>\u4ea4\u6613\u54c8\u5e0c\u662f\u4e00\u500b\u552f\u4e00\u6a19\u8b58\u7b26\uff0c\u53ef\u7528\u65bc\u6aa2\u67e5\u4ea4\u6613\u4fe1\u606f\uff0c\u4f8b\u5982\uff0c\u767c\u51fa\u7684\u4e8b\u4ef6\u662f\u5426\u6210\u529f\u3002</p> <p>\u4ea4\u6613\u53ef\u80fd\u56e0\u5404\u7a2e\u539f\u56e0\u800c\u5931\u6557\u3002\u4f8b\u5982\uff0c\u63d0\u4f9b\u7684 gas \u6216\u8cbb\u7528\u53ef\u80fd\u4e0d\u8db3\u3002\u6b64\u5916\uff0c\u4ea4\u6613\u9a57\u8b49\u53ef\u80fd\u6703\u5931\u6557\u3002</p> <p>\u6bcf\u7b46\u4ea4\u6613\u90fd\u6709\u7279\u5b9a\u7684\u689d\u4ef6\uff0c\u5fc5\u9808\u6eff\u8db3\u9019\u4e9b\u689d\u4ef6\u624d\u80fd\u88ab\u8996\u70ba\u6709\u6548\u3002\u4e00\u500b\u5ee3\u6cdb\u7684\u9a57\u8b49\u662f\u767c\u9001\u8005\u662f\u4ea4\u6613\u7c3d\u540d\u8005\u3002</p> <p>\u5728\u9019\u7a2e\u60c5\u6cc1\u4e0b\uff0c\u5982\u679c\u60a8\u5728\u767c\u4ef6\u4eba\u5730\u5740\u8207\u7c3d\u540d\u8005\u5730\u5740\u4e0d\u540c\u7684\u5730\u65b9\u767c\u9001\u4ea4\u6613\uff0c\u5373\u4f7f\u8cbb\u7528\u8db3\u5920\uff0c\u4ea4\u6613\u4e5f\u6703\u5931\u6557\u3002</p> <p>\u5982\u4eca\uff0c\u4ea4\u6613\u4e0d\u50c5\u53ef\u4ee5\u5728\u63d0\u4ea4\u7684\u93c8\u4e0a\u9032\u884c\u72c0\u614b\u8f49\u63db\uff0c\u9084\u53ef\u4ee5\u5728\u53e6\u4e00\u689d\u5340\u584a\u93c8\u4e0a\u9032\u884c\u4ea4\u6613\u3002</p> <p>\u93c8\u9593\u4ea4\u6613\u53ef\u4ee5\u901a\u904e \u5340\u584a\u93c8\u9593\u901a\u4fe1\u5354\u8b70 (IBC) \u5be6\u73fe\u3002</p> <p>\u5728\u4e0b\u9762\u7684\u90e8\u5206\u4e2d\u627e\u5230\u66f4\u8a73\u7d30\u7684\u89e3\u91cb\u3002</p>"},{"location":"protocol/transfer/#_1","title":"\u4ea4\u6613\u985e\u578b","text":"<p>Daodst \u652f\u6301\u5169\u7a2e\u4ea4\u6613\u985e\u578b\uff1a</p> <ol> <li>Cosmos \u4ea4\u6613</li> <li>Ethereum \u4ea4\u6613</li> </ol> <p>\u9019\u662f\u53ef\u80fd\u7684\uff0c\u56e0\u70ba Daodst \u4f7f\u7528 Cosmos-SDK \u4e26\u5be6\u73fe\u4e86 \u4ee5\u592a\u574a\u865b\u64ec\u6a5f \u4f5c\u70ba\u4e00\u500b\u6a21\u584a\u3002</p> <p>\u901a\u904e\u9019\u7a2e\u65b9\u5f0f\uff0cDaodst \u63d0\u4f9b\u4e86\u4ee5\u592a\u574a\u548c Cosmos \u93c8\u7d44\u5408\u7684\u7279\u6027\u548c\u529f\u80fd\uff0c\u7b49\u7b49\u3002</p> <p>\u5118\u7ba1\u9019\u5169\u7a2e\u4ea4\u6613\u985e\u578b\u4e2d\u5305\u542b\u7684\u5927\u90e8\u5206\u4fe1\u606f\u76f8\u4f3c\uff0c\u4f46\u5b83\u5011\u4e4b\u9593\u5b58\u5728\u5dee\u7570\u3002</p> <p>\u4e00\u500b\u91cd\u8981\u7684\u5340\u5225\u662f\uff0cCosmos \u4ea4\u6613\u5141\u8a31\u5728\u540c\u4e00\u4ea4\u6613\u4e2d\u767c\u9001\u591a\u689d\u6d88\u606f\u3002</p> <p>\u76f8\u53cd\uff0c\u4ee5\u592a\u574a\u4ea4\u6613\u5247\u6c92\u6709\u9019\u7a2e\u53ef\u80fd\u3002</p> <p>\u70ba\u4e86\u5c07\u9019\u5169\u7a2e\u985e\u578b\u7d50\u5408\u5728\u4e00\u8d77\uff0cDaodst \u5c07\u4ee5\u592a\u574a\u4ea4\u6613\u5be6\u73fe\u70ba\u55ae\u500b <code>sdk.Msg</code> \u5305\u542b\u5728 <code>auth.StdTx</code> \u4e2d\u3002</p> <p>\u6b64\u6d88\u606f\u4e2d\u5305\u542b\u6240\u6709\u76f8\u95dc\u7684\u4ee5\u592a\u574a\u4ea4\u6613\u4fe1\u606f\u3002</p> <p>\u9019\u5305\u62ec\u7c3d\u540d\u3001\u6c23\u9ad4\u3001\u6709\u6548\u8f09\u8377\u7b49\u3002</p> <p>\u5728\u4ee5\u4e0b\u90e8\u5206\u4e2d\u627e\u5230\u6709\u95dc\u9019\u5169\u7a2e\u985e\u578b\u7684\u66f4\u591a\u4fe1\u606f\u3002</p>"},{"location":"protocol/transfer/#cosmos","title":"Cosmos \u4ea4\u6613","text":"<p>\u5728 Cosmos \u93c8\u4e0a\uff0c\u4e8b\u52d9\u7531\u4e0a\u4e0b\u6587\u4e2d\u4fdd\u5b58\u7684\u5143\u6578\u64da\u548c\u901a\u904e\u6a21\u584a\u7684 Protobuf Msg \u670d\u52d9 \u89f8\u767c\u6a21\u584a\u5167\u72c0\u614b\u66f4\u6539\u7684 <code>sdk.Msg</code> \u7d44\u6210/\u6d88\u606f\u670d\u52d9\uff09\u3002</p> <p>\u7576\u7528\u6236\u60f3\u8981\u8207\u61c9\u7528\u7a0b\u5e8f\u4ea4\u4e92\u4e26\u66f4\u6539\u72c0\u614b\uff08\u4f8b\u5982\u767c\u9001\u786c\u5e63\uff09\u6642\uff0c\u4ed6\u5011\u6703\u5275\u5efa\u4ea4\u6613\u3002 Cosmos \u4ea4\u6613\u53ef\u4ee5\u6709\u591a\u500b <code>sdk.Msg</code>\u3002 \u5728\u5c07\u4ea4\u6613\u5ee3\u64ad\u5230\u7db2\u7d61\u4e4b\u524d\uff0c\u5fc5\u9808\u4f7f\u7528\u8207\u9069\u7576\u5e33\u6236\u95dc\u806f\u7684\u79c1\u9470\u5c0d\u5176\u4e2d\u7684\u6bcf\u4e00\u500b\u9032\u884c\u7c3d\u540d\u3002</p> <p>\u4e00\u7b46 Cosmos \u4ea4\u6613\u5305\u62ec\u4ee5\u4e0b\u4fe1\u606f\uff1a</p> <ul> <li><code>Msgs</code>\uff1a\u4e00\u7d44\u6d88\u606f\uff08<code>sdk.Msg</code>\uff09</li> <li><code>GasLimit</code>\uff1a\u7528\u6236\u9078\u64c7\u7684\u9078\u9805\uff0c\u7528\u65bc\u8a08\u7b97\u4ed6\u5011\u9700\u8981\u652f\u4ed8\u591a\u5c11 gas</li> <li><code>FeeAmount</code>\uff1a\u7528\u6236\u9858\u610f\u652f\u4ed8\u7684\u6700\u5927\u8cbb\u7528</li> <li><code>TimeoutHeight</code>\uff1a\u4ea4\u6613\u6709\u6548\u7684\u5340\u584a\u9ad8\u5ea6</li> <li><code>Signatures</code>\uff1a\u4f86\u81ea tx \u7684\u6240\u6709\u7c3d\u540d\u8005\u7684\u7c3d\u540d\u6578\u7d44</li> <li><code>Memo</code>\uff1a\u8207\u4ea4\u6613\u4e00\u8d77\u767c\u9001\u7684\u8a3b\u91cb\u6216\u8a55\u8ad6</li> </ul> <p>\u8981\u63d0\u4ea4 Cosmos \u4ea4\u6613\uff0c\u7528\u6236\u5fc5\u9808\u4f7f\u7528\u63d0\u4f9b\u7684\u5ba2\u6236\u7aef\u4e4b\u4e00\u3002</p>"},{"location":"protocol/transfer/#ethereum","title":"Ethereum \u4ea4\u6613","text":"<p>\u4ee5\u592a\u574a\u4ea4\u6613\u662f\u6307\u7531 EOA\uff08\u5916\u90e8\u64c1\u6709\u7684\u8cec\u6236\uff0c\u7531\u4eba\u7ba1\u7406\uff09\u767c\u8d77\u7684\u64cd\u4f5c\uff0c\u800c\u4e0d\u662f\u5167\u90e8\u667a\u80fd\u5408\u7d04\u8abf\u7528\u3002 \u4ee5\u592a\u574a\u4ea4\u6613\u6703\u6539\u8b8a EVM \u7684\u72c0\u614b\uff0c\u56e0\u6b64\u5fc5\u9808\u5ee3\u64ad\u5230\u6574\u500b\u7db2\u7d61\u3002</p> <p>\u4ee5\u592a\u574a\u4ea4\u6613\u4e5f\u9700\u8981\u8cbb\u7528\uff0c\u7a31\u70ba <code>gas</code>\u3002 (EIP-1559) \u5f15\u5165\u4e86\u57fa\u672c\u8cbb\u7528\u7684\u6982\u5ff5\uff0c\u4ee5\u53ca\u512a\u5148\u8cbb\u7528\uff0c\u4ee5\u6fc0\u52f5\u7926\u5de5\u5c07\u7279\u5b9a\u4ea4\u6613\u5305\u542b\u5728\u5340\u584a\u4e2d.</p> <p>\u4ee5\u592a\u574a\u4ea4\u6613\u5206\u70ba\u5e7e\u985e\uff1a</p> <ul> <li>\u5e38\u898f\u4ea4\u6613\uff1a\u5f9e\u4e00\u500b\u8cec\u6236\u5230\u53e6\u4e00\u500b\u8cec\u6236\u7684\u4ea4\u6613</li> <li>\u5408\u7d04\u90e8\u7f72\u4ea4\u6613\uff1a\u6c92\u6709 <code>to</code> \u5730\u5740\u7684\u4ea4\u6613\uff0c\u5408\u7d04\u4ee3\u78bc\u5728 <code>data</code> \u5b57\u6bb5\u4e2d\u767c\u9001</li> <li>\u5408\u7d04\u7684\u57f7\u884c\uff1a\u8207\u90e8\u7f72\u7684\u667a\u80fd\u5408\u7d04\u4ea4\u4e92\u7684\u4ea4\u6613\uff0c\u5176\u4e2d <code>to</code> \u5730\u5740\u662f\u667a\u80fd\u5408\u7d04\u5730\u5740</li> </ul> <p>\u4ee5\u592a\u574a\u4ea4\u6613\u5305\u62ec\u4ee5\u4e0b\u4fe1\u606f\uff1a</p> <ul> <li><code>recipient</code>: \u63a5\u6536\u5730\u5740</li> <li><code>signature</code>: \u767c\u4ef6\u4eba\u7684\u7c3d\u540d</li> <li><code>nonce</code>\uff1a\u4f86\u81ea\u8cec\u6236\u7684 tx \u7de8\u865f\u7684\u8a08\u6578\u5668</li> <li><code>value</code>\uff1a\u8981\u8f49\u79fb\u7684 ETH \u6578\u91cf\uff08\u4ee5 wei \u70ba\u55ae\u4f4d\uff09</li> <li><code>data</code>\uff1a\u5305\u62ec\u4efb\u610f\u6578\u64da\u3002\u5728\u90e8\u7f72\u667a\u80fd\u5408\u7d04\u6216\u9032\u884c\u667a\u80fd\u5408\u7d04\u65b9\u6cd5\u8abf\u7528\u6642\u4f7f\u7528</li> <li><code>gasLimit</code>\uff1a\u8981\u6d88\u8017\u7684\u6700\u5927\u6c23\u9ad4\u91cf</li> <li><code>maxPriorityFeePerGas</code>\uff1a\u4f5c\u70ba\u9a57\u8b49\u8005\u5c0f\u8cbb\u7684 mas gas</li> <li><code>maxFeePerGas</code>\uff1a\u70ba tx \u652f\u4ed8\u7684\u6700\u5927 gas \u91cf</li> </ul> <p>\u6709\u95dc\u4ee5\u592a\u574a\u4ea4\u6613\u548c\u4ea4\u6613\u751f\u547d\u9031\u671f\u7684\u66f4\u591a\u4fe1\u606f\uff0c\u8f49\u5230\u6b64\u8655\u3002</p> <p>Daodst \u652f\u6301\u4ee5\u4e0b\u4ee5\u592a\u574a\u4ea4\u6613\u3002</p> <p>\ud83d\udce3 \u63d0\u793a : \u9ed8\u8a8d\u60c5\u6cc1\u4e0b\u4e0d\u652f\u6301\u672a\u53d7\u4fdd\u8b77\u7684\u907a\u7559\u4e8b\u52d9\u3002 :::</p> <ul> <li>\u52d5\u614b\u8cbb\u7528\u4ea4\u6613\uff08EIP-1559\uff09</li> <li>\u8a2a\u554f\u5217\u8868\u4ea4\u6613\uff08EIP-2930\uff09</li> <li>\u907a\u7559\u4ea4\u6613\uff08EIP-2718\uff09</li> </ul> <p>Daodst\u80fd\u8db3\u5920\u901a\u4ee5\u592a\u574a\u4ea4\u6613\u5305\u5728<code>sdk.Msg</code>\u4e0a\u4f86\u8655\u7406\u5b83\u5011\u3002 Daodst \u901a\u904e\u4f7f\u7528 <code>MsgEthereumTx</code> \u4f86\u5be6\u73fe\u9019\u4e00\u9ede\u3002 \u6b64\u6d88\u606f\u5c07\u4ee5\u592a\u574a\u4ea4\u6613\u5c01\u88dd\u70baSDK\u6d88\u606f\uff0c\u4e26\u5305\u542b\u5fc5\u9808\u7684\u4ea4\u6613\u6578\u64da\u5b57\u6bb5\u3002</p> <p>\u95dc\u65bc<code>MsgEthereumTx</code> \u7684\u4e00\u500b\u8aaa\u660e\u662f\u5b83\u540c\u6642\u5be6\u73fe\u4e86<code>sdk.Msg</code> \u548c<code>sdk.Tx</code> \u63a5\u53e3\uff08\u4e00\u822cSDK\u6d88\u606f\u53ea\u51fa\u73fe\u5728\u524d\u8005\uff0c\u800c\u5f8c\u8005\u662f\u4e00\u7d44\u6d88\u606f\u5728\u525d\u843d\u3002</p> <p>\u9019\u6a23\u505a\u7684\u539f\u56e0\u662f\u56e0\u70ba <code>MsgEthereumTx</code> \u4e0d\u80fd\u5305\u542b\u5728 <code>auth.StdTx</code>\uff08SDK \u7684\u6a19\u6e96\u4ea4\u6613\u985e\u578b\uff09\u4e2d\uff0c\u56e0\u70ba\u5b83\u4f7f\u7528 Geth \u7684\u4ee5\u592a\u574a\u767c\u9001\u800c\u4e0d\u662f Cosmos SDK `\u5728\u6b0a\u6756An\u4e2d\u3002</p>"},{"location":"protocol/transfer/#_2","title":"\u93c8\u9593\u4ea4\u6613","text":"<p>\u8de8\u93c8\u4ea4\u6613\u662f\u6307\u6578\u5b57\u8cc7\u7522\u6216\u6578\u64da\u5728\u5169\u500b\u6216\u591a\u500b\u4e0d\u540c\u5340\u584a\u934a\u7db2\u7d61\u4e4b\u9593\u7684\u8f49\u79fb\u3002</p> <p>\u6bcf\u500b\u5340\u584a\u934a\u7db2\u7d61\u90fd\u6709\u81ea\u5df1\u7368\u7279\u7684\u5354\u8b70\u548c\u6578\u64da\u7d50\u69cb\uff0c\u56e0\u6b64\u5f88\u96e3\u5c07\u8cc7\u7522\u6216\u6578\u64da\u5f9e\u4e00\u500b\u5340\u584a\u93c8\u76f4\u63a5\u8f49\u79fb\u5230\u53e6\u4e00\u500b\u5340\u584a\u93c8\u3002 \u8de8\u93c8\u4ea4\u6613\u5141\u8a31\u901a\u904e\u4f7f\u7528\u4e2d\u4ecb\u6a5f\u88fd\u6216\u5354\u8b70\u5728\u4e0d\u540c\u5340\u584a\u93c8\u4e4b\u9593\u50b3\u8f38\u8cc7\u7522\u548c\u6578\u64da\u3002</p> <p>\u4e00\u7a2e\u9019\u6a23\u7684\u6a5f\u5236\u662f\u8de8\u93c8\u6a4b\uff0c\u5b83\u5145\u7576\u4e0d\u540c\u5340\u584a\u93c8\u4e4b\u9593\u7684\u9023\u63a5\u5668\uff0c\u5be6\u73fe\u8cc7\u7522\u6216\u6578\u64da\u7684\u50b3\u8f38\u3002</p> <p>\u8de8\u93c8\u6a4b\u901a\u5e38\u9700\u8981\u67d0\u7a2e\u5f62\u5f0f\u7684\u4fe1\u4efb\u6216\u5171\u8b58\u6a5f\u5236\u4f86\u78ba\u4fdd\u4ea4\u6613\u7684\u5b89\u5168\u6027\u548c\u5b8c\u6574\u6027\u3002</p> <p>\u53e6\u4e00\u7a2e\u53ef\u80fd\u6027\u662f\u4f7f\u7528 IBC\uff08\u5340\u584a\u93c8\u9593\u901a\u4fe1\uff09 \u5354\u8b70\u3002</p> <p>\u8981\u4f7f\u7528 IBC \u9032\u884c\u8de8\u93c8\u4ea4\u6613\uff0c\u7528\u6236\u9700\u8981\uff1a</p> <ul> <li>\u9078\u64c7\u7528\u6236\u60f3\u8981\u5728\u5176\u9593\u50b3\u8f38\u8cc7\u7522\u6216\u6578\u64da\u7684\u6e90\u548c\u76ee\u6a19\u5340\u584a\u934a\u7db2\u7d61\u3002</li> <li>\u78ba\u4fdd\u5169\u500b\u5340\u584a\u934a\u7db2\u7d61\u90fd\u5be6\u73fe\u4e86 IBC \u5354\u8b70</li> <li>\u78ba\u4fdd\u4f7f\u7528 IBC \u5728\u5169\u500b\u5340\u584a\u934a\u7db2\u7d61\u4e4b\u9593\u5efa\u7acb\u9023\u63a5\u548c\u901a\u9053</li> <li>\u555f\u52d5\u8cc7\u7522\u6216\u6578\u64da\u7684\u8f49\u79fb\uff1a\u9019\u662f\u901a\u904e IBC \u901a\u9053\u5f9e\u6e90\u5340\u584a\u93c8\u5411\u76ee\u6a19\u5340\u584a\u93c8\u767c\u9001\u4ea4\u6613\u4f86\u5b8c\u6210\u7684</li> </ul> <p>\u96a8\u8457\u4e0d\u540c\u5340\u584a\u934a\u7db2\u7d61\u548c\u61c9\u7528\u7a0b\u5e8f\u6578\u91cf\u7684\u6301\u7e8c\u589e\u9577\uff0c\u8de8\u93c8\u4ea4\u6613\u8b8a\u5f97\u8d8a\u4f86\u8d8a\u91cd\u8981\u3002 \u5b83\u5011\u652f\u6301\u4e0d\u540c\u5340\u584a\u934a\u7db2\u7d61\u7684\u4e92\u64cd\u4f5c\u6027\uff0c\u5f9e\u800c\u5728\u6578\u5b57\u8cc7\u7522\u548c\u6578\u64da\u7684\u50b3\u8f38\u4e2d\u5be6\u73fe\u66f4\u5927\u7684\u9748\u6d3b\u6027\u548c\u6548\u7387\u3002</p>"},{"location":"protocol/transfer/#_3","title":"\u4ea4\u6613\u6191\u8b49","text":"<p>\u4ea4\u6613\u6536\u64da\u986f\u793a\u4ee5\u592a\u574a\u5ba2\u6236\u7aef\u8fd4\u56de\u7684\u6578\u64da\u4ee5\u8868\u793a\u7279\u5b9a\u4ea4\u6613\u7684\u7d50\u679c\uff0c\u5305\u62ec\u4ea4\u6613\u7684\u54c8\u5e0c\u503c\u3001\u5340\u584a\u7de8\u865f\u3001\u4f7f\u7528\u7684\u6c23\u9ad4\u91cf\uff0c\u4ee5\u53ca\u5728\u90e8\u7f72\u667a\u80fd\u5408\u7d04\u7684\u60c5\u6cc1\u4e0b\uff0c\u5408\u7ea6\u5730\u5740\u3002 \u6b64\u5916\uff0c\u5b83\u9084\u5305\u62ec\u4f86\u81ea\u667a\u80fd\u5408\u7d04\u4e2d\u767c\u51fa\u7684\u4e8b\u4ef6\u7684\u81ea\u5b9a\u7fa9\u4fe1\u606f\u3002</p> <p>\u6536\u64da\u5305\u542b\u4ee5\u4e0b\u4fe1\u606f\uff1a</p> <ul> <li><code>transactionHash</code>\uff1a\u4ea4\u6613\u7684\u54c8\u5e0c\u503c\u3002</li> <li><code>transactionIndex</code>\uff1a\u5340\u584a\u4e2d\u4ea4\u6613\u7d22\u5f15\u4f4d\u7f6e\u7684\u6574\u6578\u3002</li> <li><code>blockHash</code>\uff1a\u8a72\u4ea4\u6613\u6240\u5728\u5340\u584a\u7684\u54c8\u5e0c\u503c\u3002</li> <li><code>blockNumber</code>\uff1a\u8a72\u4ea4\u6613\u6240\u5728\u7684\u5340\u584a\u7de8\u865f\u3002</li> <li><code>from</code>\uff1a\u767c\u4ef6\u4eba\u7684\u5730\u5740\u3002</li> <li><code>to</code>: \u63a5\u6536\u8005\u7684\u5730\u5740\u3002\u7576\u5b83\u662f\u5408\u7d04\u5275\u5efa\u4ea4\u6613\u6642\u70ba null\u3002</li> <li><code>cumulativeGasUsed</code>\uff1a\u5728\u5340\u584a\u4e2d\u57f7\u884c\u6b64\u4ea4\u6613\u6642\u4f7f\u7528\u7684\u6c23\u9ad4\u7e3d\u91cf\u3002</li> <li><code>effectiveGasPrice</code>\uff1a\u57fa\u672c\u8cbb\u7528\u548c\u6bcf\u55ae\u4f4d gas \u652f\u4ed8\u7684\u5c0f\u8cbb\u7684\u7e3d\u548c\u3002</li> <li><code>gasUsed</code>\uff1a\u50c5\u6b64\u7279\u5b9a\u4ea4\u6613\u4f7f\u7528\u7684\u6c23\u9ad4\u91cf\u3002</li> <li><code>contractAddress</code>\uff1a\u5275\u5efa\u7684\u5408\u7d04\u5730\u5740\uff0c\u5982\u679c\u4ea4\u6613\u662f\u5408\u7d04\u5275\u5efa\uff0c\u5426\u5247\u70ba\u7a7a\u3002</li> <li><code>logs</code>\uff1a\u6b64\u4e8b\u52d9\u751f\u6210\u7684\u65e5\u8a8c\u5c0d\u50cf\u6578\u7d44\u3002</li> <li><code>logsBloom</code>\uff1a\u7528\u65bc\u8f15\u5ba2\u6236\u7aef\u7684 Bloom \u904e\u6ffe\u5668\uff0c\u7528\u65bc\u5feb\u901f\u6aa2\u7d22\u76f8\u95dc\u65e5\u8a8c\u3002</li> <li><code>type</code>\uff1a\u4ea4\u6613\u985e\u578b\u7684\u6574\u6578\uff0c\u820a\u4ea4\u6613\u70ba 0x00\uff0c\u8a2a\u554f\u5217\u8868\u985e\u578b\u70ba 0x01\uff0c   0x02 \u7528\u65bc\u52d5\u614b\u8cbb\u7528\u3002\u5b83\u4e5f\u8fd4\u56de\u3002</li> <li><code>root</code>\uff1a\u4e8b\u52d9\u72c0\u614b\u6839\uff08\u62dc\u5360\u5ead\u4e4b\u524d\uff09</li> <li><code>status</code>\uff1a1\uff08\u6210\u529f\uff09\u6216 0\uff08\u5931\u6557\uff09</li> </ul>"},{"location":"protocol/stcd/","title":"CLI","text":"<p><code>stcd</code> \u662f\u4e00\u9ad4\u5316\u547d\u4ee4\u884c\u754c\u9762 (CLI)\u3002\u5b83\u5141\u8a31\u60a8\u904b\u884c Daodst \u93c8\u7bc0\u9ede\u3001\u7ba1\u7406\u9322\u5305\u4e26\u901a\u904e\u67e5\u8a62\u548c\u4ea4\u6613\u8207 Daodst \u7db2\u7d61\u4ea4\u4e92\u3002\u672c\u7c21\u4ecb\u5c07\u89e3\u91cb\u5982\u4f55\u5c07 <code>stcd</code> \u4e8c\u9032\u88fd\u6587\u4ef6\u5b89\u88dd\u5230\u60a8\u7684\u7cfb\u7d71\u4e0a\uff0c\u4e26\u901a\u904e\u4e00\u4e9b\u7c21\u55ae\u7684\u793a\u4f8b\u6307\u5c0e\u60a8\u5982\u4f55\u4f7f\u7528 stcd\u3002</p>"},{"location":"protocol/stcd/#_1","title":"\u5148\u6c7a\u689d\u4ef6","text":""},{"location":"protocol/stcd/#go","title":"Go","text":"<p>Daodst \u662f\u4f7f\u7528 Go \u7248\u672c <code>1.20+</code> \u69cb\u5efa\u7684\u3002\u6aa2\u67e5\u4f60\u7684\u7248\u672c\uff1a</p> <pre><code>go version\n</code></pre> <p>\u5b89\u88dd\u6b63\u78ba\u7684\u7248\u672c\u5f8c\uff0c\u901a\u904e\u904b\u884c\u4ee5\u4e0b\u547d\u4ee4\u4e26\u5c07\u5176\u6dfb\u52a0\u5230 shell \u555f\u52d5\u8173\u672c\u4e2d\uff0c\u78ba\u8a8d\u60a8\u7684 <code>GOPATH</code> \u5df2\u6b63\u78ba\u914d\u7f6e\uff1a</p> <pre><code>export PATH=$PATH:$(go env GOPATH)/bin\n</code></pre>"},{"location":"protocol/stcd/#jq","title":"jq","text":"<p>Daodst \u8173\u672c\u4f7f\u7528 jq \u7248\u672c <code>1.6+</code>\u3002\u6aa2\u67e5\u4f60\u7684\u7248\u672c\uff1a</p> <pre><code>jq --version\n</code></pre>"},{"location":"protocol/stcd/#_2","title":"\u5b89\u88dd","text":"<p>\u60a8\u53ef\u4ee5\u5f9e\u6e90\u4ee3\u78bc\u69cb\u5efa\u5b89\u88dd <code>stcd</code> \u4e8c\u9032\u88fd\u6587\u4ef6\u3002</p>"},{"location":"protocol/stcd/#_3","title":"\u5f9e\u6e90\u4ee3\u78bc\u69cb\u5efa","text":"<p>\u4f7f\u7528 <code>git</code> \u5f9e\u6e90\u4ee3\u78bc\u514b\u9686\u548c\u69cb\u5efa Daodst\u3002 <code>&lt;tag&gt;</code> \u662f\u6307 Github \u4e0a\u7684\u767c\u5e03\u6a19\u7c64\u3002\u6700\u65b0\u7684Daodst  \u7248\u672c </p> <pre><code>git clone https://github.com/daodst/blockchain.git\ncd blockchain\ngit fetch\ngit checkout &lt;tag&gt;\nmake install\n</code></pre> <p>\u5b89\u88dd\u5b8c\u6210\u5f8c\uff0c\u6aa2\u67e5 stcd \u4e8c\u9032\u88fd\u6587\u4ef6\u662f\u5426\u5df2\u6210\u529f\u5b89\u88dd\uff1a</p> <pre><code>stcd version\n</code></pre> <p>\ud83d\udce3 \u63d0\u793a\uff1a \u5982\u679c\u8fd4\u56de <code>stcd: command not found</code> \u932f\u8aa4\u6d88\u606f\uff0c\u8acb\u78ba\u8a8d\u60a8\u5df2\u6b63\u78ba\u914d\u7f6e Go\u3002</p>"},{"location":"protocol/stcd/#daodst","title":"\u904b\u884c Daodst \u7bc0\u9ede","text":"<p>\u8981\u719f\u6089 Daodst\uff0c\u60a8\u53ef\u4ee5\u904b\u884c\u4e00\u500b\u672c\u5730\u5340\u584a\u93c8\u7bc0\u9ede\u4f86\u751f\u6210\u584a\u4e26\u516c\u958b EVM \u548c Cosmos \u7aef\u9ede\u3002\u9019\u5141\u8a31\u60a8\u5728\u672c\u5730\u90e8\u7f72\u667a\u80fd\u5408\u7d04\u4e26\u8207\u4e4b\u4ea4\u4e92\u6216\u6e2c\u8a66\u6838\u5fc3\u5354\u8b70\u529f\u80fd\u3002</p> <p>\u901a\u904e\u5728\u5b58\u5132\u5eab\u7684\u57fa\u76ee\u9304\u4e2d\u57f7\u884c <code>local_node.sh</code> \u8173\u672c\u4f86\u904b\u884c\u672c\u5730\u7bc0\u9ede\uff1a</p> <pre><code>./local_node.sh\n</code></pre> <p>\u8a72\u8173\u672c\u5b58\u5132\u7bc0\u9ede\u914d\u7f6e\uff0c\u5305\u62ec <code>~/.tmp-stcd/config/config.toml</code> \u4e0b\u7684\u672c\u5730\u9ed8\u8a8d\u7aef\u9ede\u3002 \u5982\u679c\u60a8\u4e4b\u524d\u904b\u884c\u904e\u8a72\u8173\u672c\uff0c\u8a72\u8173\u672c\u5141\u8a31\u60a8\u8986\u84cb\u73fe\u6709\u914d\u7f6e\u4e26\u555f\u52d5\u4e00\u500b\u65b0\u7684\u672c\u5730\u7bc0\u9ede\u3002</p> <p>\u7bc0\u9ede\u904b\u884c\u5f8c\uff0c\u60a8\u5c07\u770b\u5230\u5b83\u5728\u672c\u5730 Daodst \u5340\u584a\u93c8\u4e2d\u9a57\u8b49\u548c\u751f\u6210\u584a\uff1a</p> <pre><code>12:59PM INF executed block height=1 module=state num_invalid_txs=0 num_valid_txs=0 server=node\n# ...\n1:00PM INF indexed block exents height=7 module=txindex server=node\n</code></pre> <p>\u6709\u95dc\u5982\u4f55\u81ea\u5b9a\u7fa9\u672c\u5730\u7bc0\u9ede\u7684\u66f4\u591a\u4fe1\u606f\uff0c\u8acb\u8f49\u5230 \u55ae\u7bc0\u9ede \u9801\u9762\u3002</p>"},{"location":"protocol/stcd/#stcd","title":"\u4f7f\u7528 <code>stcd</code>","text":"<p>\u5b89\u88dd <code>stcd</code> \u4e8c\u9032\u88fd\u6587\u4ef6\u5f8c\uff0c\u60a8\u53ef\u4ee5\u4f7f\u7528\u4ee5\u4e0b\u547d\u4ee4\u904b\u884c\u547d\u4ee4\uff1a</p> <pre><code>stcd [command]\n</code></pre> <p>\u9084\u6709\u4e00\u500b <code>-h</code>, <code>--help</code> \u547d\u4ee4\u53ef\u7528</p> <pre><code>stcd -h\n</code></pre> <p>\u53ef\u4ee5\u540c\u6642\u7dad\u8b77\u591a\u500b\u7bc0\u9ede\u914d\u7f6e\u3002\u8981\u6307\u5b9a\u914d\u7f6e\uff0c\u8acb\u4f7f\u7528 <code>--home</code> \u6a19\u8a18\u3002\u5728\u4ee5\u4e0b\u793a\u4f8b\u4e2d\uff0c\u6211\u5011\u5c07\u4f7f\u7528\u4f4d\u65bc<code>~/.tmp-stcd</code>\u7684\u672c\u5730\u7bc0\u9ede\u7684\u9ed8\u8a8d\u914d\u7f6e\u3002</p>"},{"location":"protocol/stcd/#_4","title":"\u7ba1\u7406\u9322\u5305","text":"<p>\u60a8\u53ef\u4ee5\u4f7f\u7528 stcd \u4e8c\u9032\u88fd\u6587\u4ef6\u4f86\u7ba1\u7406\u60a8\u7684\u9322\u5305\uff0c\u4ee5\u5b58\u5132\u79c1\u9470\u4e26\u901a\u904e CLI \u7c3d\u7f72\u4ea4\u6613\u3002\u8981\u67e5\u770b\u6240\u6709\u5bc6\u9470\uff0c\u8acb\u4f7f\u7528\uff1a</p> <pre><code>stcd keys list \\\n--home ~/.tmp-stcd \\\n--keyring-backend test\n\n# Example Output:\n# - address: dst19xnmslvl0pcmydu4m52h2gf0std5ee5pfgpyuf\n#   name: dev0\n#   pubkey: '{\"@type\":\"/ethermint.crypto.v1.ethsecp256k1.PubKey\",\"key\":\"AzKouyoUL0UUS1qRUZdqyVsTPkCAFWwxx3+BTOw36nKp\"}'\n#   type: local\n</code></pre> <p>\u60a8\u53ef\u4ee5\u4f7f\u7528 <code>$NAME</code> \u751f\u6210\u4e00\u500b\u65b0\u7684\u5bc6\u9470/\u52a9\u8a18\u7b26\uff1a</p> <pre><code>stcd keys add [name] \\\n--home ~/.tmp-stcd \\\n--keyring-backend test\n</code></pre> <p>\u5c07\u60a8\u7684 daodst \u5bc6\u9470\u5c0e\u51fa\u70ba\u4ee5\u592a\u574a\u79c1\u9470\u7528\u65bc [Metamask] \u4f8b\u5982\uff09\uff1a</p> <pre><code>stcd keys unsafe-export-eth-key [name] \\\n--home ~/.tmp-stcd \\\n--keyring-backend test\n</code></pre> <p>\u6709\u95dc\u53ef\u7528\u9375\u547d\u4ee4\u7684\u66f4\u591a\u4fe1\u606f\uff0c\u8acb\u4f7f\u7528 <code>--help</code> \u6a19\u8a8c</p> <pre><code>stcd keys -h\n</code></pre> <p>\ud83d\udce3 \u63d0\u793a\uff1a \u6709\u95dc Keyring \u53ca\u5176\u5f8c\u7aef\u9078\u9805\u7684\u66f4\u591a\u4fe1\u606f\uff0c\u8acb\u55ae\u64ca \u6b64\u8655\u3002 :::</p>"},{"location":"protocol/stcd/#_5","title":"\u8207\u7db2\u7d61\u4e92\u52d5","text":"<p>\u60a8\u53ef\u4ee5\u4f7f\u7528 stcd \u5728\u5340\u584a\u93c8\u4e0a\u67e5\u8a62\u4fe1\u606f\u6216\u63d0\u4ea4\u4ea4\u6613\u3002\u67e5\u8a62\u548c\u4ea4\u6613\u662f\u60a8\u901a\u904e Tendermint RPC \u767c\u9001\u5230 Daodst \u7bc0\u9ede\u7684\u8acb\u6c42\u3002</p> <p>\ud83d\udce3 \ud83d\udc49 \u8981\u4f7f\u7528 CLI\uff0c\u60a8\u9700\u8981\u70ba <code>--node</code> \u6a19\u8a8c\u63d0\u4f9b Tendermint RPC \u5730\u5740\u3002 \u5728 [Networks]\u9801\u9762\u4e2d\u67e5\u627e\u6e2c\u8a66\u7db2\u548c\u4e3b\u7db2\u7684\u516c\u958b\u53ef\u7528\u5730\u5740\u3002</p>"},{"location":"protocol/stcd/#_6","title":"\u8a2d\u7f6e\u7db2\u7d61\u914d\u7f6e","text":"<p>\u5728\u672c\u5730\u8a2d\u7f6e\u4e2d\uff0c\u7bc0\u9ede\u8a2d\u7f6e\u70ba<code>tcp://localhost:26657</code>\u3002\u60a8\u53ef\u4ee5\u4f7f\u7528\u4ee5\u4e0b\u65b9\u5f0f\u67e5\u770b\u60a8\u7684\u7bc0\u9ede\u914d\u7f6e\uff1a</p> <pre><code>stcd config \\\n--home ~/.tmp-stcd\n# Example Output\n# {\n#   \"chain-id\": \"daodst_7000-1\",\n#   \"keyring-backend\": \"test\",\n#   \"output\": \"text\",\n#   \"node\": \"tcp://localhost:26657\",\n#   \"broadcast-mode\": \"sync\"\n# }\n</code></pre> <p>\u60a8\u53ef\u4ee5\u901a\u904e\u66f4\u6539\u7aef\u9ede\u4f86\u8a2d\u7f6e\u7bc0\u9ede\u914d\u7f6e\u4ee5\u5c07\u8acb\u6c42\u767c\u9001\u5230\u4e0d\u540c\u7684\u7db2\u7d61\uff1a</p> <pre><code>stcd config node [tendermint-rpc-endpoint] \\\n--home ~/.tmp-stcd\n</code></pre> <p>\u6b64\u8655 \u4e86\u89e3\u66f4\u591a\u7bc0\u9ede\u914d\u7f6e\u3002</p>"},{"location":"protocol/stcd/#_7","title":"\u67e5\u8a62","text":"<p>\u60a8\u53ef\u4ee5\u4f7f\u7528<code>stcd query</code>\uff08\u7c21\u7a31<code>stcd q</code>\uff09\u67e5\u8a62\u5340\u584a\u93c8\u4e0a\u7684\u4fe1\u606f\u3002\u6309\u5176\u67e5\u770b\u8cec\u6236\u9918\u984d \u5b58\u5132\u5728\u9280\u884c\u6a21\u584a\u4e2d\u7684\u5730\u5740\uff0c\u4f7f\u7528\uff1a</p> <pre><code>stcd q bank balances [adress] \\\n--home ~/.tmp-stcd\n# # Example Output:\n# balances:\n# - amount: \"99999000000000000000002500\"\n#   denom: dst\n</code></pre> <p>\u8981\u67e5\u770b\u5176\u4ed6\u53ef\u7528\u7684\u67e5\u8a62\u547d\u4ee4\uff0c\u8acb\u4f7f\u7528\uff1a</p> <pre><code># for all Queries\nstcd q\n\n# for querying commands in the bank module\nstcd q bank\n</code></pre>"},{"location":"protocol/stcd/#_8","title":"\u4ea4\u6613","text":"<p>\u60a8\u53ef\u4ee5\u4f7f\u7528<code>stcd tx</code>\u5411\u7db2\u7d61\u63d0\u4ea4\u4ea4\u6613\u3002\u9019\u5728\u4e00\u500b\u547d\u4ee4\u4e2d\u5275\u5efa\u3001\u7c3d\u540d\u548c\u5ee3\u64ad tx\u3002\u8981\u4f7f\u7528 bank \u6a21\u584a\u5c07\u4ee4\u724c\u5f9e\u5bc6\u9470\u74b0\u4e2d\u7684\u5e33\u6236\u767c\u9001\u5230\u53e6\u4e00\u500b\u5730\u5740\uff0c\u8acb\u4f7f\u7528\uff1a</p> <pre><code>stcd tx bank send [from_key_or_address] [to_address] [amount] \\\n--home ~/.tmp-stcd \\\n--fees 50000000000dst \\\n-b block\n\n# Example Output:\n# ...\n# txhash: 7BA2618295B789CC24BB13E654D9187CDD264F61FC446EB756EAC07AF3E7C40A\n</code></pre> <p>\u8981\u67e5\u770b\u5176\u4ed6\u53ef\u7528\u7684\u4e8b\u52d9\u547d\u4ee4\uff0c\u8acb\u4f7f\u7528\uff1a</p> <pre><code># for all transaction commands\nstcd tx\n\n# for Bank transaction subcommands\nstcd tx bank\n</code></pre> <p>\u73fe\u5728\u60a8\u5df2\u7d93\u4e86\u89e3\u77ad\u5982\u4f55\u904b\u884c Daodst \u7db2\u7d61\u4e26\u8207\u4e4b\u4ea4\u4e92\u7684\u57fa\u790e\u77e5\u8b58\uff0c\u8acb\u8f49\u5230 \u914d\u7f6e \u9032\u884c\u9032\u4e00\u6b65\u7684\u81ea\u5b9a\u7fa9\u3002</p>"},{"location":"protocol/stcd/command/","title":"CLI \u547d\u4ee4","text":""},{"location":"protocol/stcd/command/#cli_1","title":"CLI \u6a19\u8a8c","text":"<p>\u4e0b\u9762\u5217\u51fa\u4e86 stcd \u7684\u5e38\u7528\u6a19\u8a8c\u5217\u8868\uff1a</p> \u9078\u9805 \u8aaa\u660e \u985e\u578b \u9ed8\u8a8d\u503c <code>--chain-id</code> \u5168\u93c8ID <code>string</code> <code>\"\"</code> <code>--home</code> \u914d\u7f6e\u548c\u6578\u64da\u76ee\u9304 <code>string</code> <code>\u4e8c\u9032\u88fd\u6587\u4ef6\u6240\u5728\u76ee\u9304/.stcd</code> <code>--keyring-backend</code> \u9078\u64c7\u5bc6\u9470\u74b0\u7684\u5f8c\u7aef <code>string</code> <code>\"os\"</code> <code>--output</code> \u8f38\u51fa\u683c\u5f0f <code>string</code> <code>\"text\"</code> <code>--node</code> Tendermint RPC \u63a5\u53e3\u5730\u5740 <code>&lt;host&gt;:&lt;port&gt;</code> <code>\"tcp://localhost:26657\"</code> <code>--from</code> \u7528\u65bc\u7c3d\u540d\u7684\u5e33\u6236\u7684\u540d\u7a31\u6216\u5730\u5740 <code>string</code> <code>\"\"</code>"},{"location":"protocol/stcd/command/#_1","title":"\u547d\u4ee4\u5217\u8868","text":"<p>\u5e38\u7528\u7684 <code>stcd</code> \u547d\u4ee4\u5217\u8868\u3002\u60a8\u53ef\u4ee5\u4f7f\u7528 <code>stcd -h</code> \u547d\u4ee4\u7372\u53d6\u5b8c\u6574\u5217\u8868\u3002</p> \u547d\u4ee4 \u8aaa\u660e \u5b50\u547d\u4ee4 (example) <code>keys</code> \u5bc6\u9470\u7ba1\u7406 <code>list</code>, <code>show</code>, <code>add</code>, <code>add --recover</code>, <code>delete</code> <code>tx</code> \u4ea4\u6613\u5b50\u547d\u4ee4 <code>bank send</code>, <code>ibc-transfer transfer</code>, <code>distribution withdraw-all-rewards</code> <code>query</code> \u67e5\u8a62\u5b50\u547d\u4ee4 <code>bank balance</code>, <code>staking validators</code>, <code>gov proposals</code> <code>tendermint</code> Tendermint \u5b50\u547d\u4ee4 <code>show-address</code>, <code>show-node-id</code>, <code>version</code> <code>config</code> Client \u914d\u7f6e <code>init</code> \u521d\u59cb\u5316daodst <code>daemon</code> \u555f\u52d5daodst <code>version</code> Daodst\u7248\u672c <code>validate-genesis</code> \u9a57\u8b49\u5275\u4e16\u6587\u4ef6 <code>status</code> Query \u9060\u7a0b\u7bc0\u9ede\u72c0\u614b"},{"location":"protocol/stcd/config/","title":"\u914d\u7f6e","text":"<p>\uff03 \u914d\u7f6e</p> <p>\u4ee5\u4e0b\u9801\u9762\u5c07\u6307\u5c0e\u60a8\u5b8c\u6210\u7bc0\u9ede\u548c\u5ba2\u6236\u7aef\u7684\u914d\u7f6e\u3002 \u8a72\u7bc0\u9ede\u7528\u65bc\u904b\u884c\u5340\u584a\u934a\u7db2\u7d61\u3001\u751f\u7522\u5340\u584a\u548c\u9a57\u8b49\u4ea4\u6613\u3002 \u5ba2\u6236\u7aef\u7528\u4f5c\u7db2\u95dc\uff0c\u901a\u904e\u767c\u9001\u4ea4\u6613\u548c\u67e5\u8a62\u72c0\u614b\u8207\u5340\u584a\u934a\u7db2\u7d61\u9032\u884c\u4ea4\u4e92\u3002 \u6b64\u5916\uff0c\u6211\u5011\u9084\u4ecb\u7d39\u4e86 \u904b\u884c JSON-RPC \u670d\u52d9\u5668\u3002</p> <p>\u9019\u4e9b\u914d\u7f6e\u6703\u5f71\u97ff\u7bc0\u9ede\u7684\u6027\u80fd\u3001\u5b89\u5168\u6027\u548c\u529f\u80fd\u3002 \u56e0\u6b64\uff0c\u4e86\u89e3\u4e26\u6b63\u78ba\u914d\u7f6e\u60a8\u7684\u7bc0\u9ede\u548c\u5ba2\u6236\u7aef\u81f3\u95dc\u91cd\u8981\u3002</p>"},{"location":"protocol/stcd/config/#_1","title":"\u914d\u7f6e\u548c\u6578\u64da\u76ee\u9304","text":"<p>\u9ed8\u8a8d\u60c5\u6cc1\u4e0b\uff0c\u60a8\u7684\u914d\u7f6e\u548c\u6578\u64da\u5b58\u5132\u5728\u4f4d\u65bc ~/.stcd \u76ee\u9304\u7684\u6587\u4ef6\u593e\u4e2d\u3002 \u60a8\u53ef\u4ee5\u4f7f\u7528 <code>--home</code> \u6a19\u8a8c\u8f15\u9b06\u66f4\u6539\u9ed8\u8a8d\u76ee\u9304\u3002 \u8acb\u52d9\u5fc5\u6ce8\u610f\uff0c\u60a8\u53ef\u4ee5\u6709\u591a\u500b\u4e3b\u76ee\u9304\uff0c\u6bcf\u500b\u4e3b\u76ee\u9304\u4ee3\u8868\u4e0d\u540c\u7684\u5340\u584a\u93c8\u3002</p> <pre><code>.                                   # ~/.stcd\n  \u251c\u2500\u2500 data/                           # Contains the databases used by the node.\n  \u2514\u2500\u2500 config/\n      \u251c\u2500\u2500 app.toml                   # Application-related configuration file.\n      \u251c\u2500\u2500 config.toml                # Tendermint-related configuration file.\n      \u251c\u2500\u2500 genesis.json               # The genesis file.\n      \u251c\u2500\u2500 node_key.json              # Private key to use for node authentication in the p2p protocol.\n      \u2514\u2500\u2500 priv_validator_key.json    # Private key to use as a validator in the consensus protocol.\n</code></pre> <p>\u6307\u5b9a<code>stcd</code>\u914d\u7f6e\u548c\u6578\u64da\u5b58\u5132\u76ee\u9304\uff1b\u60a8\u53ef\u4ee5\u4f7f\u7528\u5168\u5c40\u6a19\u8a8c <code>--home &lt;directory&gt;</code> \u66f4\u65b0\u5b83\u3002</p>"},{"location":"protocol/stcd/config/#_2","title":"\u7bc0\u9ede\u914d\u7f6e","text":"<p>Cosmos SDK \u5728 <code>~/.stcd/config</code> \u4e2d\u81ea\u52d5\u751f\u6210\u5169\u500b\u914d\u7f6e\u6587\u4ef6\uff1a</p> <ul> <li><code>config.toml</code>\uff1a\u7528\u65bc\u914d\u7f6e Tendermint\uff0c\u5728 Tendermint \u7684\u6587\u6a94 \u4e2d\u4e86\u89e3\u66f4\u591a\u4fe1\u606f\uff0c- <code>app.toml</code> \uff1a\u7531 Cosmos SDK \u751f\u6210\uff0c\u7528\u65bc\u914d\u7f6e\u60a8\u7684\u61c9\u7528\u7a0b\u5e8f\uff0c\u4f8b\u5982\u72c0\u614b\u4fee\u526a\u7b56\u7565\u3001\u9059\u6e2c\u3001gRPC \u548c REST \u670d\u52d9\u5668\u914d\u7f6e\u3001\u72c0\u614b\u540c\u6b65\u3001JSON-RPC \u7b49\u3002</li> </ul> <p>\u9019\u5169\u500b\u6587\u4ef6\u90fd\u6709\u5927\u91cf\u8a55\u8ad6\uff0c\u8acb\u76f4\u63a5\u53c3\u8003\u5b83\u5011\u4ee5\u8abf\u6574\u60a8\u7684\u7bc0\u9ede\u3002</p> <p>\u4e00\u500b\u8981\u8abf\u6574\u7684\u793a\u4f8b\u914d\u7f6e\u662f <code>app.toml</code> \u4e2d\u7684 <code>minimum-gas-prices</code> \u5b57\u6bb5\uff0c\u5b83\u5b9a\u7fa9\u4e86\u9a57\u8b49\u7bc0\u9ede\u9858\u610f\u63a5\u53d7\u7684\u7528\u65bc\u8655\u7406\u4ea4\u6613\u7684\u6700\u5c0f\u6578\u91cf\u3002\u9019\u662f\u4e00\u7a2e\u53cd\u5783\u573e\u90f5\u4ef6\u6a5f\u5236\uff0c\u5b83\u5c07\u62d2\u7d55\u4f4e\u65bc\u6700\u4f4e gas \u50f9\u683c\u7684\u50b3\u5165\u4ea4\u6613\u3002</p> <p>\u5982\u679c\u5b83\u662f\u7a7a\u7684\uff0c\u8acb\u78ba\u4fdd\u4f7f\u7528\u4e00\u4e9b\u503c\u7de8\u8f2f\u8a72\u5b57\u6bb5\uff0c\u4f8b\u5982<code>0dst</code>\uff0c\u5426\u5247\u7bc0\u9ede\u5c07\u5728\u555f\u52d5\u6642\u505c\u6b62\u3002</p> <pre><code> # The minimum gas prices a validator is willing to accept for processing a\n # transaction. A transaction's fees must meet the minimum of any denomination\n # specified in this config (e.g. 0.25token1;0.0001token2).\n minimum-gas-prices = \"0dst\"\n</code></pre>"},{"location":"protocol/stcd/config/#_3","title":"\u72c0\u614b\u4fee\u526a","text":"<p>\u4fee\u526a\u72c0\u614b\u6709\u56db\u7a2e\u7b56\u7565\u3002\u9019\u4e9b\u7b56\u7565\u53ea\u9069\u7528\u65bc\u72c0\u614b\uff0c\u4e0d\u9069\u7528\u65bc\u584a\u5b58\u5132\u3002 \u8981\u8a2d\u7f6e\u4fee\u526a\uff0c\u8acb\u8abf\u6574 <code>~/.stcd/config/app.toml</code> \u6587\u4ef6\u4e2d\u7684 <code>pruning</code> \u53c3\u6578\u3002 \u4ee5\u4e0b\u4fee\u526a\u72c0\u614b\u8a2d\u7f6e\u53ef\u7528\uff1a</p> <ul> <li><code>everything</code>\uff1a\u4fee\u526a\u7576\u524d\u72c0\u614b\u4ee5\u5916\u7684\u6240\u6709\u4fdd\u5b58\u72c0\u614b\u3002</li> <li><code>nothing</code>\uff1a\u4fdd\u5b58\u6240\u6709\u72c0\u614b\uff0c\u4e0d\u522a\u9664\u4efb\u4f55\u5167\u5bb9\u3002</li> <li><code>default</code>\uff1a\u4fdd\u5b58\u6700\u5f8c 100 \u500b\u72c0\u614b\u548c\u6bcf 10,000 \u500b\u584a\u7684\u72c0\u614b\u3002</li> <li><code>custom</code>\uff1a\u4f7f\u7528 <code>pruning-keep-recent</code>\u3001<code>pruning-keep-every</code> \u548c <code>pruning-interval</code> \u53c3\u6578\u6307\u5b9a\u4fee\u526a\u8a2d\u7f6e\u3002</li> </ul> <p>\u9ed8\u8a8d\u60c5\u6cc1\u4e0b\uff0c\u6bcf\u500b\u7bc0\u9ede\u90fd\u8655\u65bc<code>default</code> \u6a21\u5f0f\uff0c\u9019\u662f\u5927\u591a\u6578\u74b0\u5883\u7684\u63a8\u85a6\u8a2d\u7f6e\u3002 \u5982\u679c\u4f60\u60f3\u6539\u8b8a\u4f60\u7684\u7bc0\u9ede\u4fee\u526a\u7b56\u7565\uff0c\u90a3\u9ebc\u4f60\u5fc5\u9808\u5728\u7bc0\u9ede\u521d\u59cb\u5316\u6642\u9019\u6a23\u505a\u3002\u5728\u555f\u52d5 <code>daodst</code> \u6642\u50b3\u905e\u4e00\u500b\u6a19\u8a8c\u5c07\u59cb\u7d42\u8986\u84cb <code>app.toml</code> \u6587\u4ef6\u4e2d\u7684\u8a2d\u7f6e\uff0c\u5982\u679c\u60a8\u60f3\u5c07\u7bc0\u9ede\u66f4\u6539\u70ba <code>everything</code> \u6a21\u5f0f\uff0c\u90a3\u9ebc\u60a8\u53ef\u4ee5\u5728\u8abf\u7528\u6642\u50b3\u905e <code>--pruning everything</code> \u6a19\u8a8c<code>stcd stc-start</code>\u3002</p> <p>\ud83d\udea8 \u5371\u96aa\uff1a \u7576\u4f60\u4fee\u526a\u72c0\u614b\u6642\uff0c\u4f60\u5c07\u7121\u6cd5\u67e5\u8a62\u5df2\u88ab\u4fee\u526a\u6389\u7684\u9ad8\u5ea6\u3002</p>"},{"location":"protocol/stcd/config/#_4","title":"\u5ba2\u6236\u7aef\u914d\u7f6e","text":"<p>\u6211\u5011\u53ef\u4ee5\u4f7f\u7528 <code>stcd config</code> \u547d\u4ee4\u67e5\u770b\u9ed8\u8a8d\u7684\u5ba2\u6236\u7aef\u914d\u7f6e\u8a2d\u7f6e\uff1a</p> <pre><code>stcd config\n{\n \"chain-id\": \"\",\n \"keyring-backend\": \"os\",\n \"output\": \"text\",\n \"node\": \"tcp://localhost:26657\",\n \"broadcast-mode\": \"sync\"\n}\n</code></pre> <p>\u6211\u5011\u53ef\u4ee5\u6839\u64da\u81ea\u5df1\u7684\u9078\u64c7\u5c0d\u9ed8\u8a8d\u8a2d\u7f6e\u9032\u884c\u66f4\u6539\uff0c\u56e0\u6b64\u5b83\u5141\u8a31\u7528\u6236\u4e00\u6b21\u6027\u9810\u5148\u8a2d\u7f6e\u6240\u6709\u914d\u7f6e\uff0c\u9019\u6a23\u4e4b\u5f8c\u5c31\u53ef\u4ee5\u4f7f\u7528\u76f8\u540c\u7684\u914d\u7f6e\u4e86\u3002</p> <p>\u4f8b\u5982\uff0c\u53ef\u4ee5\u4f7f\u7528\u4ee5\u4e0b\u547d\u4ee4\u5c07\u93c8\u6a19\u8b58\u7b26\u5f9e\u7a7a\u767d\u540d\u7a31\u66f4\u6539\u70ba <code>daodst_7000-1</code>\uff1a</p> <pre><code>stcd config \"chain-id\" daodst_7000-1\nstcd config\n{\n \"chain-id\": \"daodst_7000-1\",\n \"keyring-backend\": \"os\",\n \"output\": \"text\",\n \"node\": \"tcp://localhost:26657\",\n \"broadcast-mode\": \"sync\"\n}\n</code></pre> <p>\u53ef\u4ee5\u7528\u540c\u6a23\u7684\u65b9\u5f0f\u66f4\u6539\u5176\u4ed6\u503c\u3002</p> <p>\u6216\u8005\uff0c\u6211\u5011\u53ef\u4ee5\u76f4\u63a5\u5728 client.toml \u7684\u4e00\u500b\u5730\u65b9\u66f4\u6539\u914d\u7f6e\u503c\u3002</p> <p>\u5728\u6211\u5011\u5b89\u88dddaodst\u7684\u6587\u4ef6\u593e\u4e2d\u7684<code>.stcd/config/client.toml</code>\u8def\u5f91\u4e0b\uff1a</p> <pre><code>############################################################################\n### Client Configuration ###\n\n############################################################################\n\n# The network chain ID\n\nchain-id = \"daodst_7000-1\"\n\n# The keyring's backend, where the keys are stored (os|file|kwallet|pass|test|memory)\n\nkeyring-backend = \"os\"\n\n# CLI output format (text|json)\n\noutput = \"number\"\n\n# &lt;host&gt;:&lt;port&gt; to Tendermint RPC interface for this chain\n\nnode = \"tcp://localhost:26657\"\n\n# Transaction broadcasting mode (sync|async|block)\n\nbroadcast-mode = \"sync\"\n</code></pre> <p>\u5728 <code>client.toml</code> \u4e2d\u9032\u884c\u5fc5\u8981\u7684\u66f4\u6539\u5f8c\uff0c\u7136\u5f8c\u4fdd\u5b58\u3002\u6bd4\u5982\u6211\u5011\u76f4\u63a5\u628achain-id\u5f9e<code>daodst_7000-1</code>\u6539\u6210<code>daodst_7000-2</code>\uff0c\u8f38\u51fa\u6210number\uff0c\u6703\u77ac\u9593\u8b8a\u5982\u4e0b\u5716\u3002</p> <pre><code>stcd config\n{\n \"chain-id\": \"daodst_7000-2\",\n \"keyring-backend\": \"os\",\n \"output\": \"number\",\n \"node\": \"tcp://localhost:26657\",\n \"broadcast-mode\": \"sync\"\n}\n</code></pre>"},{"location":"protocol/stcd/config/#json-rpc","title":"\u904b\u884c JSON-RPC \u670d\u52d9\u5668","text":"<p>\u672c\u7bc0\u4ecb\u7d39\u555f\u7528 JSON-RPC \u670d\u52d9\u5668\u7684\u6b65\u9a5f\u3002 JSON-RPC \u5728\u591a\u7a2e\u50b3\u8f38\u4e0a\u63d0\u4f9b\u3002 Daodst \u652f\u6301\u57fa\u65bc HTTP \u548c WebSocket \u7684 JSON-RPC\u3002 \u5c31\u8981\u6c42\u800c\u8a00\uff0c\u6211\u5011\u5efa\u8b70\u4f7f\u7528\u81f3\u5c11 8 \u6838 CPU \u548c 64GB RAM \u7684\u670d\u52d9\u5668\u3002 \u60a8\u5fc5\u9808\u5728\u9632\u706b\u7246\u4e0a\u6253\u958b\u7aef\u53e3 8545 \u548c 8546\u3002</p> <p>\ud83d\udce3 \u63d0\u793a\uff1a\u9664\u975e\u60a8\u7684\u7bc0\u9ede\u5728\u672c\u5730\u5b58\u5132\u5340\u584a\u93c8\u7684\u6574\u500b\u526f\u672c\uff0c\u5426\u5247\u60a8\u4e0d\u80fd\u4f7f\u7528\u6240\u6709 JSON RPC \u65b9\u6cd5\u3002\u60a8\u9700\u8981\u6211\u5011\u7db2\u7d61\u7684\u6a94\u6848/\u5feb\u7167\u55ce\uff1f\u8f49\u5230\u672c\u7bc0\u3002</p>"},{"location":"protocol/stcd/config/#_5","title":"\u555f\u7528\u670d\u52d9\u5668","text":"<p>\u8981\u555f\u7528 RPC \u670d\u52d9\u5668\uff0c\u8acb\u4f7f\u7528\u4ee5\u4e0b\u6a19\u8a8c\uff08\u9ed8\u8a8d\u8a2d\u7f6e\u70ba true\uff09\u3002</p> <pre><code>stcd start --json-rpc.enable\n</code></pre>"},{"location":"protocol/stcd/config/#_6","title":"\u5b9a\u7fa9\u547d\u540d\u7a7a\u9593","text":"<p><code>Eth</code>\u3001<code>Net</code> \u548c <code>Web3</code> \u547d\u540d\u7a7a\u9593\u9ed8\u8a8d\u555f\u7528\uff0c\u4f46\u5c0d\u65bc JSON-RPC\uff0c\u60a8\u9700\u8981\u6dfb\u52a0\u66f4\u591a\u547d\u540d\u7a7a\u9593\u3002 \u70ba\u4e86\u555f\u7528\u5176\u4ed6\u547d\u540d\u7a7a\u9593\uff0c\u8acb\u7de8\u8f2f app.toml \u6587\u4ef6\u3002</p> <pre><code># API defines a list of JSON-RPC namespaces that should be enabled\n# Example: \"eth,txpool,personal,net,debug,web3\"\napi = \"eth,net,web3,txpool,debug,personal\"\n</code></pre>"},{"location":"protocol/stcd/config/#gas","title":"\u8a2d\u7f6e\u4e00\u500b Gas \u91cf","text":"<p><code>eth_call</code> \u548c <code>eth_estimateGas</code> \u70ba DoS \u4fdd\u8b77\u5b9a\u7fa9\u4e86\u4e00\u500b\u5168\u5c40 gas cap over rpc\u3002\u60a8\u53ef\u4ee5\u901a\u904e\u5728 app.toml \u4e2d\u50b3\u905e\u81ea\u5b9a\u7fa9\u503c\u4f86\u8986\u84cb\u9ed8\u8a8d\u7684 gas cap \u503c 25,000,000\uff1a</p> <pre><code># GasCap sets a cap on gas that can be used in eth_call/estimateGas (0=infinite). Default: 25,000,000.\ngas-cap = 25000000\n</code></pre>"},{"location":"protocol/stcd/config/#cors","title":"CORS","text":"<p>\u5982\u679c\u5f9e\u700f\u89bd\u5668\u8a2a\u554f RPC\uff0c\u5247\u9700\u8981\u4f7f\u7528\u9069\u7576\u7684\u57df\u96c6\u555f\u7528 CORS\u3002\u5426\u5247\uff0cJavaScript \u8abf\u7528\u53d7\u540c\u6e90\u7b56\u7565\u9650\u5236\uff0c\u8acb\u6c42\u5c07\u5931\u6557\u3002</p> <p>\u53ef\u4ee5\u5f9e <code>app.toml</code> \u66f4\u65b0 CORS \u8a2d\u7f6e</p> <pre><code>###############################################################################\n###                           API Configuration                             ###\n###############################################################################\n\n[api]\n\n# ...\n\n# EnableUnsafeCORS defines if CORS should be enabled (unsafe - use it at your own risk).\nenabled-unsafe-cors = true # default false\n</code></pre>"},{"location":"protocol/stcd/config/#_7","title":"\u4fee\u526a","text":"<p>\u70ba\u4e86\u4f7f\u6240\u6709\u65b9\u6cd5\u6b63\u5e38\u5de5\u4f5c\uff0c\u60a8\u7684\u7bc0\u9ede\u5fc5\u9808\u662f\u5b58\u6a94\u7684\uff08\u5728\u672c\u5730\u5b58\u5132\u5340\u584a\u93c8\u7684\u6574\u500b\u526f\u672c\uff09\u3002\u5fc5\u9808\u7981\u7528\u4fee\u526a\u3002 \u4fee\u526a\u8a2d\u7f6e\u53ef\u4ee5\u5f9e <code>app.toml</code> \u66f4\u65b0</p> <pre><code>###############################################################################\n###                           Base Configuration                            ###\n###############################################################################\n\n# The minimum gas prices a validator is willing to accept for processing a\n# transaction. A transaction's fees must meet the minimum of any denomination\n# specified in this config (e.g. 0.25token1;0.0001token2).\n\n# ...\n\n# default: the last 100 states are kept in addition to every 500th state; pruning at 10 block intervals\n# nothing: all historic states will be saved, nothing will be deleted (i.e. archiving node)\n# everything: all saved states will be deleted, storing only the current state; pruning at 10 block intervals\n# custom: allow pruning options to be manually specified through 'pruning-keep-recent', 'pruning-keep-every', &gt;\npruning = \"nothing\"\npruning-keep-recent = \"0\"\npruning-keep-every = \"0\"\npruning-interval = \"0\"\n</code></pre>"},{"location":"protocol/stcd/config/#websocket","title":"WebSocket \u670d\u52d9\u5668","text":"<p>Websocket \u662f\u4e00\u7a2e\u96d9\u5411\u50b3\u8f38\u5354\u8b70\u3002 Websocket \u9023\u63a5\u7531\u5ba2\u6236\u7aef\u548c\u670d\u52d9\u5668\u7dad\u8b77\uff0c\u76f4\u5230\u5b83\u88ab\u4e00\u500b\u986f\u5f0f\u7d42\u6b62\u3002\u5927\u591a\u6578\u73fe\u4ee3\u700f\u89bd\u5668\u90fd\u652f\u6301 Websocket\uff0c\u9019\u610f\u5473\u8457\u5b83\u6709\u5f88\u597d\u7684\u5de5\u5177\u3002</p> <p>\u56e0\u70ba Websocket \u662f\u96d9\u5411\u7684\uff0c\u670d\u52d9\u5668\u53ef\u4ee5\u5c07\u4e8b\u4ef6\u63a8\u9001\u7d66\u5ba2\u6236\u7aef\u3002\u9019\u4f7f\u5f97 Websocket \u6210\u70ba\u6d89\u53ca\u4e8b\u4ef6\u8a02\u95b1\u7684\u7528\u4f8b\u7684\u4e0d\u932f\u9078\u64c7\u3002 Websocket \u7684\u53e6\u4e00\u500b\u597d\u8655\u662f\u5728\u63e1\u624b\u904e\u7a0b\u4e4b\u5f8c\uff0c\u55ae\u500b\u6d88\u606f\u7684\u958b\u92b7\u5f88\u4f4e\uff0c\u975e\u5e38\u9069\u5408\u767c\u9001\u5927\u91cf\u8acb\u6c42\u3002 \u53ef\u4ee5\u5f9e <code>app.toml</code> \u555f\u7528 WebSocket \u670d\u52d9\u5668</p> <pre><code># Address defines the EVM WebSocket server address to bind to.\nws-address = \"0.0.0.0:8546\"\n</code></pre>"},{"location":"protocol/stcd/single-node/","title":"\u55ae\u7bc0\u9ede","text":"<p>\u5728\u6b64\u9801\u9762\u4e4b\u5f8c\uff0c\u60a8\u53ef\u4ee5\u624b\u52d5\u6216\u4f7f\u7528\u5df2\u7d93\u6e96\u5099\u597d\u7684\u81ea\u52d5\u5316\u8173\u672c\u904b\u884c\u55ae\u7bc0\u9ede\u672c\u5730\u7db2\u7d61\u3002\u904b\u884c\u55ae\u7bc0\u9ede\u8a2d\u7f6e\u5c0d\u65bc\u60f3\u8981\u6e2c\u8a66\u5176\u61c9\u7528\u7a0b\u5e8f\u548c\u5354\u8b70\u529f\u80fd\u7684\u958b\u767c\u4eba\u54e1\u975e\u5e38\u6709\u7528\uff0c\u56e0\u70ba\u5b83\u7684\u7c21\u55ae\u6027\u548c\u901f\u5ea6\u3002\u5c0d\u65bc\u66f4\u8907\u96dc\u7684\u8a2d\u7f6e\uff0c\u8acb\u53c3\u8003\u591a\u7bc0\u9ede\u8a2d\u7f6e\u9801\u9762\u3002</p>"},{"location":"protocol/stcd/single-node/#_2","title":"\u5148\u6c7a\u689d\u4ef6","text":"<ul> <li>\u5b89\u88dd</li> </ul>"},{"location":"protocol/stcd/single-node/#_3","title":"\u81ea\u52d5\u5316\u8173\u672c","text":"<p>\u555f\u52d5\u672c\u5730 Daodst \u7bc0\u9ede\u7684\u6700\u7c21\u55ae\u65b9\u6cd5\u662f\u4f7f\u7528\u63d0\u4f9b\u7684\u5e6b\u52a9\u8173\u672c\uff0c\u5b83\u5c07\u70ba\u6e2c\u8a66\u76ee\u7684\u5275\u5efa\u4e00\u500b\u5408\u7406\u7684\u9ed8\u8a8d\u914d\u7f6e\uff1a</p> <pre><code>$ local_node.sh\n...\n</code></pre> <p>\ud83d\udce3 \u63d0\u793a :  <code>$install_path</code> \u7528\u4f86\u8868\u793a\u60a8\u5b89\u88dd <code>stcd</code> \u4e8c\u9032\u88fd\u7a0b\u5e8f\u7684\u8def\u5f91</p> <p>\ud83d\udce3 \u63d0\u793a\uff1a \u70ba\u4e86\u907f\u514d\u8986\u84cb\u751f\u7522\u4e2d\u4f7f\u7528\u7684\u771f\u5be6\u7bc0\u9ede\u7684\u4efb\u4f55\u6578\u64da\uff0c\u6c7a\u5b9a\u5c07\u81ea\u52d5\u751f\u6210\u7684\u6e2c\u8a66\u914d\u7f6e\u5b58\u5132\u5728 <code>~/.tmp-stcd</code> \u800c\u4e0d\u662f\u9ed8\u8a8d\u7684 <code>$install_path/.stcd</code> \u3002</p> <p>\u4f7f\u7528<code>local_node.sh</code>\u8173\u672c\u6642\uff0c\u6709\u5fc5\u8981\u4f7f\u7528<code>--home ~/.tmp-stcd</code>\u6a19\u8a8c\u64f4\u5c55\u6240\u6709\u4ee5\u672c\u5730\u6e2c\u8a66\u7bc0\u9ede\u70ba\u76ee\u6a19\u7684<code>stcd</code>\u547d\u4ee4\u3002\u9019\u662f\u5f37\u5236\u6027\u7684\uff0c\u56e0\u70ba <code>home</code> \u76ee\u9304\u4e0d\u80fd\u5b58\u5132\u5728 <code>stcd</code> \u914d\u7f6e\u4e2d\uff0c\u9019\u53ef\u4ee5\u5728\u4e0b\u9762\u7684\u8f38\u51fa\u4e2d\u770b\u5230\u3002\u70ba\u4e86\u4fbf\u65bc\u4f7f\u7528\uff0c\u5c07\u6b64\u76ee\u9304\u8def\u5f91\u5c0e\u51fa\u70ba\u74b0\u5883\u8b8a\u91cf\u53ef\u80fd\u662f\u660e\u667a\u7684\uff1a</p> <pre><code>$ export TMP=$HOME/.tmp-stcd`\n$ stcd config --home $TMP\n{\n\"chain-id\": \"daodst_7000-1\",\n\"keyring-backend\": \"test\",\n\"output\": \"text\",\n\"node\": \"tcp://localhost:26657\",\n\"broadcast-mode\": \"sync\"\n}\n</code></pre> <p>\u60a8\u53ef\u4ee5\u901a\u904e\u66f4\u6539\u914d\u7f6e\u8b8a\u91cf\u4f86\u81ea\u5b9a\u7fa9\u672c\u5730\u7bc0\u9ede\u8173\u672c\u3002 \u6709\u95dc\u53ef\u8abf\u6574\u5167\u5bb9\u7684\u60f3\u6cd5\uff0c\u8acb\u53c3\u95b1\u4ee5\u4e0b\u8173\u672c\u6458\u9304\uff1a</p> <pre><code># Customize the name of your keys, the chain-id, moniker of the node, keyring backend, and more\nKEYS[0]=\"dev0\"\nKEYS[1]=\"dev1\"\nKEYS[2]=\"dev2\"\nCHAINID=\"daodst_7000-1\"\nMONIKER=\"localtestnet\"\n# Remember to change to other types of keyring like 'file' in-case exposing to outside world,\n# otherwise your balance will be wiped quickly\n# The keyring test does not require private key to steal tokens from you\nKEYRING=\"test\"\nKEYALGO=\"eth_secp256k1\"\nLOGLEVEL=\"info\"\n# Set dedicated home directory for the daodst instance\nHOMEDIR=\"$HOME/.tmp-stcd\"\n# to trace evm\n#TRACE=\"--trace\"\nTRACE=\"\"\n\n[...]\n\n  # Adjust this set a different maximum gas limit\n  jq '.consensus_params[\"block\"][\"max_gas\"]=\"10000000\"' \"$GENESIS\" &gt;\"$TMP_GENESIS\" &amp;&amp; mv \"$TMP_GENESIS\" \"$GENESIS\"\n\n[...]\n\n</code></pre>"},{"location":"protocol/stcd/single-node/#_4","title":"\u624b\u52d5\u90e8\u7f72","text":"<p>\u672c\u6307\u5357\u5e6b\u52a9\u60a8\u5275\u5efa\u55ae\u500b\u9a57\u8b49\u5668\u7bc0\u9ede\uff0c\u8a72\u7bc0\u9ede\u5728\u672c\u5730\u904b\u884c\u7db2\u7d61\u4ee5\u7528\u65bc\u6e2c\u8a66\u548c\u5176\u4ed6\u958b\u767c\u76f8\u95dc\u7528\u9014\u3002</p>"},{"location":"protocol/stcd/single-node/#_5","title":"\u521d\u59cb\u5316\u93c8","text":"<p>\u5728\u5be6\u969b\u904b\u884c\u7bc0\u9ede\u4e4b\u524d\uff0c\u6211\u5011\u9700\u8981\u521d\u59cb\u5316\u93c8\uff0c\u6700\u91cd\u8981\u7684\u662f\u5b83\u7684\u5275\u4e16\u6587\u4ef6\u3002\u9019\u662f\u901a\u904e <code>init</code> \u5b50\u547d\u4ee4\u5b8c\u6210\u7684\uff1a</p> <pre><code>$MONIKER=testing\n$KEY=dev0\n$CHAINID=\"daodst_7000-1\"\n\n# The argument $MONIKER is the custom username of your node, it should be human-readable.\nstcd init $MONIKER --chain-id=$CHAINID\n</code></pre> <p>\ud83d\udce3 \u63d0\u793a\uff1a \u60a8\u53ef\u4ee5\u7a0d\u5f8c\u901a\u904e\u66f4\u65b0 <code>config.toml</code> \u6587\u4ef6\u4f86 \u4fee\u6539 \u9019\u500b moniker \u3002</p> <p>\u4e0a\u9762\u7684\u547d\u4ee4\u5275\u5efa\u4e86\u60a8\u7684\u7bc0\u9ede\u548c\u9a57\u8b49\u5668\u904b\u884c\u6240\u9700\u7684\u6240\u6709\u914d\u7f6e\u6587\u4ef6\uff0c\u4ee5\u53ca\u4e00\u500b\u9ed8\u8a8d\u7684\u5275\u4e16\u6587\u4ef6\uff0c\u5b83\u5b9a\u7fa9\u4e86\u7db2\u7d61\u7684\u521d\u59cb\u72c0\u614b\u3002\u9ed8\u8a8d\u60c5\u6cc1\u4e0b\uff0c\u6240\u6709\u9019\u4e9b\u914d\u7f6e\u6587\u4ef6 \u90fd\u5728<code>~/.stcd</code> \u4e2d\uff0c\u4f46\u60a8\u53ef\u4ee5\u901a\u904e\u50b3\u905e<code>--home</code> \u6a19\u8a8c\u4f86\u8986\u84cb\u6b64\u6587\u4ef6\u593e\u7684\u4f4d\u7f6e\u3002</p>"},{"location":"protocol/stcd/single-node/#_6","title":"\u5275\u4e16\u7a0b\u5e8f","text":""},{"location":"protocol/stcd/single-node/#_7","title":"\u6dfb\u52a0\u5275\u4e16\u8cec\u6236","text":"<p>\u5728\u555f\u52d5\u93c8\u4e4b\u524d\uff0c\u60a8\u9700\u8981\u4f7f\u7528 keyring \u7528\u81f3\u5c11\u4e00\u500b\u5e33\u6236\u586b\u5145\u72c0\u614b\uff1a</p> <pre><code>stcd keys add my_validator\n</code></pre> <p>\u5275\u5efa\u672c\u5730\u5e33\u6236\u5f8c\uff0c\u7e7c\u7e8c\u5728\u93c8\u7684\u5275\u4e16\u6587\u4ef6\u4e2d\u70ba\u5176\u6388\u4e88\u4e00\u4e9b<code>dst</code>\u4ee4\u724c\u3002\u9019\u6a23\u505a\u9084\u5c07\u78ba\u4fdd\u60a8\u7684\u93c8\u77e5\u9053\u6b64\u5e33\u6236\u7684\u5b58\u5728\uff1a</p> <pre><code>stcd add-genesis-account my_validator 10000000000dst\n</code></pre> <p>\u73fe\u5728\u60a8\u7684\u5e33\u6236\u5df2\u7d93\u6709\u4e86\u4e00\u4e9b\u4ee3\u5e63\uff0c\u60a8\u9700\u8981\u5411\u60a8\u7684\u93c8\u6dfb\u52a0\u4e00\u500b\u9a57\u8b49\u5668\u3002</p> <p>\u5c0d\u65bc\u672c\u6307\u5357\uff0c\u60a8\u5c07\u6dfb\u52a0\u672c\u5730\u7bc0\u9ede\uff08\u901a\u904e\u4e0a\u9762\u7684<code>init</code>\u547d\u4ee4\u5275\u5efa\uff09\u4f5c\u70ba\u93c8\u7684\u9a57\u8b49\u5668\u3002 \u9a57\u8b49\u5668\u53ef\u4ee5\u5728\u93c8\u9996\u6b21\u555f\u52d5\u4e4b\u524d\u901a\u904e\u5275\u4e16\u6587\u4ef6\u4e2d\u5305\u542b\u7684\u7a31\u70ba<code>gentx</code>\u7684\u7279\u6b8a\u4ea4\u6613\u4f86\u8072\u660e\uff1a</p> <pre><code># Create a gentx\n# NOTE: this command lets you set the number of coins.\n# Make sure this account has some coins with the genesis.app_state.staking.params.bond_denom denom\nstcd add-genesis-account my_validator 1000000000dst,10000000000fm\n</code></pre> <p><code>gentx</code> \u505a\u4e09\u4ef6\u4e8b\uff1a</p> <ol> <li>\u5c07\u60a8\u5275\u5efa\u7684<code>validator</code>\u8cec\u6236\u8a3b\u518a\u70ba\u9a57\u8b49\u8005\u64cd\u4f5c\u8005\u8cec\u6236\uff08\u5373\u63a7\u5236\u9a57\u8b49\u8005\u7684\u8cec\u6236\uff09\u3002</li> <li>\u81ea\u884c\u59d4\u8a17\u6240\u63d0\u4f9b\u7684<code>amount</code>\u7684\u8cea\u62bc\u4ee3\u5e63\u3002</li> <li>\u5c07\u64cd\u4f5c\u54e1\u5e33\u6236\u8207\u5c07\u7528\u65bc\u7c3d\u7f72\u5340\u584a\u7684 Tendermint \u7bc0\u9ede\u516c\u9470\u95dc\u806f\u8d77\u4f86\u3002\u5982\u679c\u672a\u63d0\u4f9b <code>--pubkey</code> \u6a19\u8a8c\uff0c\u5247\u9ed8\u8a8d\u70ba\u901a\u904e\u4e0a\u9762\u7684 <code>stcd init</code> \u547d\u4ee4\u5275\u5efa\u7684\u672c\u5730\u7bc0\u9ede pubkey\u3002</li> </ol> <p>\u6709\u95dc <code>gentx</code> \u7684\u66f4\u591a\u4fe1\u606f\uff0c\u8acb\u4f7f\u7528\u4ee5\u4e0b\u547d\u4ee4\uff1a</p> <pre><code>stcd gentx --help\n</code></pre>"},{"location":"protocol/stcd/single-node/#gentx","title":"\u6536\u96c6<code>gentx</code>","text":"<p>\u9ed8\u8a8d\u60c5\u6cc1\u4e0b\uff0c\u5275\u4e16\u6587\u4ef6\u4e0d\u5305\u542b\u4efb\u4f55 <code>gentxs</code>\u3002 <code>gentx</code> \u662f\u4e00\u7a2e\u4ea4\u6613\uff0c\u5b83\u5c07\u5b58\u5728\u65bc <code>accounts</code> \u4e0b\u7684\u5275\u4e16\u6587\u4ef6\u4e2d\u7684\u8cea\u62bc\u4ee4\u724c\u7d81\u5b9a\u5230\u9a57\u8b49\u5668\uff0c\u672c\u8cea\u4e0a\u662f\u5728\u5275\u4e16\u6642\u5275\u5efa\u4e00\u500b\u9a57\u8b49\u5668\u3002 \u4e00\u65e6\u4f5c\u70ba\u6709\u6548 <code>gentx</code> \u63a5\u6536\u8005\u7684 2/3 \u4ee5\u4e0a\u7684\u9a57\u8b49\u5668\uff08\u6309\u6295\u7968\u6b0a\u52a0\u6b0a\uff09\u5728 <code>genesis_time</code> \u4e4b\u5f8c\u4e0a\u7dda\uff0c\u8a72\u93c8\u5c31\u6703\u555f\u52d5\u3002</p> <p>\u53ef\u4ee5\u624b\u52d5\u5c07 <code>gentx</code> \u6dfb\u52a0\u5230\u5275\u4e16\u6587\u4ef6\uff0c\u6216\u901a\u904e\u4ee5\u4e0b\u547d\u4ee4\uff1a</p> <pre><code># Add the gentx to the genesis file\nstcd collect-gentxs\n</code></pre> <p>\u6b64\u547d\u4ee4\u6703\u5c07\u5b58\u5132\u5728 <code>~/.stcd/config/gentx</code> \u4e2d\u7684\u6240\u6709 <code>gentxs</code> \u6dfb\u52a0\u5230\u5275\u4e16\u6587\u4ef6\u4e2d\u3002</p>"},{"location":"protocol/stcd/single-node/#daemon","title":"daemon \u904b\u884c\u55ae\u7bc0\u9ede","text":"<p>\u6700\u5f8c\uff0c\u6aa2\u67e5 <code>genesis.json</code> \u6587\u4ef6\u7684\u6b63\u78ba\u6027\uff1a</p> <pre><code>stcd validate-genesis\n</code></pre> <p>\u73fe\u5728\u4e00\u5207\u90fd\u5df2\u8a2d\u7f6e\u597d\uff0c\u60a8\u7d42\u65bc\u53ef\u4ee5\u555f\u52d5\u60a8\u7684\u7bc0\u9ede\u4e86\uff1a</p> <pre><code>stcd daemon\n</code></pre> <p>\ud83d\udce3 \u63d0\u793a\uff1a \u8981\u5728\u904b\u884c\u7bc0\u9ede\u6642\u6aa2\u67e5\u6240\u6709\u53ef\u7528\u7684\u53ef\u81ea\u5b9a\u7fa9\u9078\u9805\uff0c\u8acb\u4f7f\u7528 --help \u6a19\u8a8c\u3002</p> <p>\u4f60\u61c9\u8a72\u770b\u5230\u584a\u9032\u4f86\u4e86\u3002</p> <p>\u524d\u9762\u7684\u547d\u4ee4\u5141\u8a31\u60a8\u904b\u884c\u55ae\u500b\u7bc0\u9ede\u3002\u9019\u5c0d\u65bc\u4e0b\u4e00\u7bc0\u95dc\u65bc\u8207\u8a72\u7bc0\u9ede\u4ea4\u4e92\u7684\u90e8\u5206\u4f86\u8aaa\u5df2\u7d93\u8db3\u5920\u4e86\uff0c \u4f46\u60a8\u53ef\u80fd\u5e0c\u671b\u540c\u6642\u904b\u884c\u591a\u500b\u7bc0\u9ede\uff0c\u4e26\u67e5\u770b\u5b83\u5011\u4e4b\u9593\u5982\u4f55\u9054\u6210\u5171\u8b58\u3002</p> <p>\u7136\u5f8c\uff0c\u60a8\u53ef\u4ee5\u4f7f\u7528 <code>Ctrl+C</code> \u505c\u6b62\u7bc0\u9ede\u3002</p>"},{"location":"protocol/stcd/single-node/#_8","title":"\u9032\u4e00\u6b65\u914d\u7f6e","text":""},{"location":"protocol/stcd/single-node/#_9","title":"\u5bc6\u9470\u7ba1\u7406","text":"<p>\u6bcf\u6b21\u904b\u884c\u5177\u6709\u76f8\u540c\u5bc6\u9470\u7684\u7bc0\u9ede\uff1a\u5c07 <code>./local_node.sh</code> \u4e2d\u7684 <code>stcd keys add $KEY</code> \u66ff\u63db\u70ba\uff1a</p> <pre><code>echo \"your mnemonic here\" | stcd keys add $KEY --recover\n</code></pre> <p>\ud83d\udce3 \u63d0\u793a\uff1a Daodst \u76ee\u524d\u652f\u630112\u500b\u55ae\u8a5e\u7684\u52a9\u8a18\u8a5e\u3002 :::</p> <p>\u60a8\u53ef\u4ee5\u4f7f\u7528\u4ee5\u4e0b\u65b9\u6cd5\u751f\u6210\u65b0\u7684\u5bc6\u9470/\u52a9\u8a18\u7b26\uff1a</p> <pre><code>stcd keys add $KEY\n</code></pre> <p>\u5c07\u60a8\u7684 Daodst \u5bc6\u9470\u5c0e\u51fa\u70ba\u4ee5\u592a\u574a\u79c1\u9470\uff08\u7528\u65bc Metamask \u4f8b\u5982\uff09\uff1a</p> <pre><code>stcd keys unsafe-export-eth-key $KEY\n</code></pre> <p>\u6709\u95dc\u53ef\u7528\u9375\u547d\u4ee4\u7684\u66f4\u591a\u4fe1\u606f\uff0c\u8acb\u4f7f\u7528 <code>--help</code> \u6a19\u8a8c</p> <pre><code>stcd keys -h\n</code></pre>"},{"location":"protocol/stcd/single-node/#keyring","title":"Keyring \u5f8c\u7aef\u9078\u9805","text":"<p>\u4e0a\u9762\u7684\u8aaa\u660e\u5305\u62ec\u4f7f\u7528 <code>test</code> \u4f5c\u70ba <code>keyring-backend</code> \u7684\u547d\u4ee4\u3002 \u9019\u662f\u4e00\u500b\u4e0d\u5b89\u5168\u7684\u5bc6\u9470\u74b0\uff0c\u4e0d\u9700\u8981\u8f38\u5165\u5bc6\u78bc\uff0c\u4e0d\u61c9\u5728\u751f\u7522\u4e2d\u4f7f\u7528\u3002 \u5426\u5247\uff0cDaodst \u652f\u6301\u4f7f\u7528\u6587\u4ef6\u6216\u64cd\u4f5c\u7cfb\u7d71\u5bc6\u9470\u74b0\u5f8c\u7aef\u9032\u884c\u5bc6\u9470\u5b58\u5132\u3002 \u8981\u5275\u5efa\u548c\u4f7f\u7528\u6587\u4ef6\u5b58\u5132\u5bc6\u9470\u800c\u4e0d\u662f\u9ed8\u8a8d\u70ba\u64cd\u4f5c\u7cfb\u7d71\u5bc6\u9470\u74b0\uff0c\u8acb\u5c07\u6a19\u8a8c <code>--keyring-backend file</code> \u6dfb\u52a0\u5230\u4efb\u4f55\u76f8\u95dc\u547d\u4ee4\uff0c\u5bc6\u78bc\u63d0\u793a\u5c07\u901a\u904e\u547d\u4ee4\u884c\u51fa\u73fe\u3002 \u9019\u4e5f\u53ef\u4ee5\u4fdd\u5b58\u70ba CLI \u914d\u7f6e\u9078\u9805\uff1a</p> <pre><code>stcd config keyring-backend file\n</code></pre> <p>\ud83d\udce3 \u63d0\u793a\uff1a \u6709\u95dc Keyring \u53ca\u5176\u5f8c\u7aef\u9078\u9805\u7684\u66f4\u591a\u4fe1\u606f\uff0c\u8acb\u55ae\u64ca \u6b64\u8655\u3002</p>"},{"location":"protocol/stcd/single-node/#_10","title":"\u555f\u7528\u8ddf\u8e2a","text":"<p>\u8981\u5728\u904b\u884c\u7bc0\u9ede\u6642\u555f\u7528\u8ddf\u8e2a\uff0c\u8acb\u5c07 <code>local_node.sh</code> \u8173\u672c\u7684\u6700\u5f8c\u4e00\u884c\u4fee\u6539\u70ba\u4ee5\u4e0b\u547d\u4ee4\uff0c \u5728\u54ea\u88e1\uff1a</p> <ul> <li><code>$TRACER</code> \u662f EVM \u8ddf\u8e2a\u5668\u985e\u578b\uff0c\u7528\u65bc\u5f9e EVM \u4e8b\u52d9\u200b\u200b\u57f7\u884c\u4e2d\u6536\u96c6\u57f7\u884c\u8ddf\u8e2a\uff08\u4f8b\u5982 <code>json|struct|access_list|markdown</code>\uff09</li> <li><code>$TRACESTORE</code> \u662f\u5305\u542b KVStore \u8ddf\u8e2a\u7684\u8f38\u51fa\u6587\u4ef6\uff08\u4f8b\u5982 <code>store.txt</code>\uff09</li> </ul> <pre><code>stcd start --evm.tracer $TRACER --tracestore $TRACESTORE --pruning=nothing $TRACE --log_level $LOGLEVEL --minimum-gas-prices=0.0001dst --json-rpc.api eth,txpool,personal,net,debug,web3\n</code></pre>"},{"location":"protocol/stcd/single-node/#_11","title":"\u5f9e\u93c8\u4e2d\u6e05\u9664\u6578\u64da","text":""},{"location":"protocol/stcd/single-node/#_12","title":"\u91cd\u7f6e\u6578\u64da","text":"<p>\u6216\u8005\uff0c\u60a8\u53ef\u4ee5\u91cd\u7f6e\u5340\u584a\u93c8\u6578\u64da\u5eab\uff0c\u522a\u9664\u7bc0\u9ede\u7684\u5730\u5740\u7c3f\u6587\u4ef6\uff0c\u4e26\u5c07 <code>priv_validator.json</code> \u91cd\u7f6e\u70ba\u5275\u4e16\u72c0\u614b\u3002</p> <p>\ud83d\udce3 \u63d0\u793a\uff1a \u5982\u679c\u60a8\u904b\u884c\u7684\u662f\u9a57\u8b49\u5668\u7bc0\u9ede\uff0c\u8acb\u5728\u57f7\u884c <code>stcd unsafe-reset-all</code> \u6642\u59cb\u7d42\u5c0f\u5fc3\u3002 \u5982\u679c\u60a8\u4e0d\u5207\u63db <code>chain-id</code>\uff0c\u5247\u6c38\u9060\u4e0d\u8981\u4f7f\u7528\u6b64\u547d\u4ee4\u3002</p> <p>\ud83d\udea8 \u5371\u96aa\uff1a\u78ba\u4fdd\u6bcf\u500b\u7bc0\u9ede\u90fd\u6709\u4e00\u500b\u552f\u4e00\u7684 <code>priv_validator.json</code>\u3002 \u4e0d\u8981\u5c07 <code>priv_validator.json</code> \u5f9e\u820a\u7bc0\u9ede\u8907\u88fd\u5230\u591a\u500b\u65b0\u7bc0\u9ede\u3002\u4f7f\u7528\u76f8\u540c\u7684 <code>priv_validator.json</code> \u904b\u884c\u5169\u500b\u7bc0\u9ede\u5c07\u5c0e\u81f4\u60a8\u7522\u751f \u96d9\u91cd\u7c3d\u540d \u4e26\u4e14\u5c07\u88ab \u6c38\u4e45\u76e3\u7981 !</p> <p>\ud83d\udce3 \u63d0\u793a :  <code>$install_path</code> \u7528\u4f86\u8868\u793a\u60a8\u5b89\u88dd <code>stcd</code> \u4e8c\u9032\u88fd\u7a0b\u5e8f\u7684\u8def\u5f91</p> <p>\u9996\u5148\uff0c\u522a\u9664\u904e\u6642\u7684\u6587\u4ef6\u4e26\u91cd\u7f6e\u6578\u64da\u3002</p> <pre><code>rm $install_path/.stcd/config/addrbook.json $install_path/.stcd/config/genesis.json\nstcd tendermint unsafe-reset-all --home .stcd\n</code></pre> <p>\u60a8\u7684\u7bc0\u9ede\u73fe\u5728\u8655\u65bc\u539f\u59cb\u72c0\u614b\uff0c\u540c\u6642\u4fdd\u7559\u539f\u59cb\u7684 <code>priv_validator.json</code> \u548c <code>config.toml</code>\u3002 \u5982\u679c\u60a8\u4e4b\u524d\u8a2d\u7f6e\u4e86\u4efb\u4f55\u54e8\u5175\u7bc0\u9ede\u6216\u5b8c\u6574\u7bc0\u9ede\uff0c\u60a8\u7684\u7bc0\u9ede\u4ecd\u5c07\u5617\u8a66\u9023\u63a5\u5230\u5b83\u5011\uff0c\u4f46\u5982\u679c\u5b83\u5011\u9084\u6c92\u6709\u5347\u7d1a\uff0c\u5247\u53ef\u80fd\u6703\u5931\u6557\u3002</p>"},{"location":"protocol/stcd/single-node/#_13","title":"\u522a\u9664\u6578\u64da","text":"<p>\u4e8c\u9032\u5236\u6578\u64da\u6703\u9ed8\u8a8d\u5b58\u5132\u5728 <code>$install_path/.stcd</code>\uff0c\u8981\u522a\u9664\u73fe\u6709\u7684\u4e8c\u9032\u88fd\u6587\u4ef6\u548c\u914d\u7f6e\uff0c\u8acb\u904b\u884c\uff1a</p> <pre><code>rm -rf $install_path/.stcd\n</code></pre> <p>\u8981\u6e05\u9664\u5bc6\u9470\u5b58\u5132\u4ee5\u5916\u7684\u6240\u6709\u6578\u64da\uff08\u5982\u679c\u9078\u64c7\u4e86keyring\u5f8c\u7aef\uff09\uff0c\u7136\u5f8c\u60a8\u53ef\u4ee5\u5f9e\u4e0a\u9762\u91cd\u65b0\u904b\u884c\u5b8c\u6574\u7bc0\u9ede\u5b89\u88dd\u547d\u4ee4\u4ee5\u518d\u6b21\u555f\u52d5\u7bc0\u9ede\u3002</p>"},{"location":"protocol/stcd/single-node/#tps","title":"\u6bcf\u79d2\u8a18\u9304\u4ea4\u6613 (TPS)","text":"<p>\u70ba\u4e86\u7372\u5f97\u6bcf\u79d2\u4e8b\u52d9\u7684\u7d2f\u9032\u503c\uff0c\u6211\u5011\u4f7f\u7528 Prometheus \u8fd4\u56de\u503c\u3002 Prometheus \u5c0e\u51fa\u5668\u5728\u5730\u5740 http://localhost:8877 \u904b\u884c\uff0c\u56e0\u6b64\u8acb\u5c07\u6b64\u90e8\u5206\u6dfb\u52a0\u5230\u60a8\u7684 Prometheus \u5b89\u88dd config.yaml \u6587\u4ef6\u4e2d\uff0c\u5982\u4e0b\u6240\u793a</p> <pre><code>global:\nscrape_interval: 10s\n\nexternal_labels:\n  monitor: 'daodst'\n\nscrape_configs:\n- job_name: 'daodst'\n\n  scrape_interval: 10s\n\n  static_configs:\n    - targets: ['localhost:8877']\n</code></pre> <p>\u7136\u5f8c\u50cf\u9019\u6a23\u904b\u884c Prometheus</p> <pre><code>prometheus --config.file=prom_config.yaml\n</code></pre> <p>\u7136\u5f8c\u8a2a\u554f\u4f4d\u65bc http://localhost:9090/ \u7684 Prometheus \u5100\u8868\u677f\uff0c\u7136\u5f8c\u5c0e\u822a\u5230\u8868\u9054\u5f0f\u5340\u57df\u4e26\u8f38\u5165\u4ee5\u4e0b\u8868\u9054\u5f0f</p> <pre><code>rate(daodst_transactions_processed[1m])\n</code></pre> <p>\u9019\u5c07\u986f\u793a\u8655\u7406\u7684\u4ea4\u6613\u901f\u5ea6\u3002</p> <p>\ud83d\udce3 \u63d0\u793a\uff1a Daodst \u76ee\u524d\u652f\u6301 12\u500b\u55ae\u8a5e\u7684\u52a9\u8a18\u8a5e\u3002</p>"},{"location":"upgrade/","title":"\u6982\u8ff0","text":"<p>\u4e86\u89e3\u5982\u4f55\u7ba1\u7406\u5b8c\u6574\u7bc0\u9ede\u548c\u9a57\u8b49\u7bc0\u9ede\u7684\u93c8\u5347\u7d1a\u3002\u6709 3 \u7a2e\u4e0d\u540c\u7684\u5347\u7d1a\u985e\u5225\uff1a</p> <ul> <li>\u8a08\u5283\u5167\u6216\u8a08\u5283\u5916\uff1a\u934a\u5f0f\u5347\u7d1a\u53ef\u4ee5\u901a\u904e\u5347\u7d1a\u5efa\u8b70\u8a08\u5283\u5b89\u6392\u5728\u7d66\u5b9a\u9ad8\u5ea6\u3002</li> <li>\u4e2d\u65b7\u6216\u975e\u4e2d\u65b7\uff1a\u5347\u7d1a\u53ef\u4ee5\u662f API \u6216\u72c0\u614b\u6a5f\u4e2d\u65b7\uff0c\u9019\u6703\u5f71\u97ff\u5411\u5f8c\u517c\u5bb9\u6027\u3002   \u70ba\u4e86\u89e3\u6c7a\u9019\u500b\u554f\u984c\uff0c\u9700\u8981\u9077\u79fb\u61c9\u7528\u7a0b\u5e8f\u72c0\u614b\u6216\u5275\u4e16\u6587\u4ef6\u4ee5\u6e96\u5099\u5347\u7d1a\u3002</li> <li>\u6578\u64da\u91cd\u7f6e\u5347\u7d1a\uff1a\u4e00\u4e9b\u5347\u7d1a\u9700\u8981\u5b8c\u5168\u6578\u64da\u91cd\u7f6e\u624d\u80fd\u6e05\u7406\u72c0\u614b\u3002\u9019\u6709\u6642\u6703\u767c\u751f\u5728\u56de\u6efe\u6216\u786c\u5206\u53c9\u7684\u60c5\u6cc1\u4e0b\u3002</li> </ul> <p>\u6b64\u5916\uff0c\u9a57\u8b49\u8005\u53ef\u4ee5\u6839\u64da\u81ea\u5df1\u7684\u504f\u597d\u9078\u64c7\u5982\u4f55\u7ba1\u7406\u5347\u7d1a\uff1a</p> <ul> <li>\u81ea\u52d5\u6216\u624b\u52d5\u5347\u7d1a\uff1a\u9a57\u8b49\u8005\u53ef\u4ee5\u904b\u884c <code>cosmovisor</code> \u9032\u7a0b\u4f86\u81ea\u52d5\u57f7\u884c\u5347\u7d1a\u6216\u624b\u52d5\u57f7\u884c\u5347\u7d1a\u3002</li> </ul>"},{"location":"upgrade/#_2","title":"\u8a08\u5283\u5347\u7d1a","text":"<p>\u8a08\u5283\u5347\u7d1a\u662f\u4f7f\u7528 \u5347\u7d1a\u6a21\u584a \u908f\u8f2f\u7684\u5354\u8abf\u8a08\u5283\u5347\u7d1a\u3002 \u9019\u6709\u52a9\u65bc\u5c07 Daodst \u9806\u5229\u5347\u7d1a\u5230\u65b0\u7684\uff08\u4e2d\u65b7\u7684\uff09\u8edf\u4ef6\u7248\u672c\uff0c\u56e0\u70ba\u5b83\u6703\u81ea\u52d5\u8655\u7406\u65b0\u7248\u672c\u7684\u72c0\u614b\u9077\u79fb\u3002</p>"},{"location":"upgrade/#_3","title":"\u6cbb\u7406\u63d0\u6848","text":""},{"location":"upgrade/#_4","title":"\u6cbb\u7406\u63d0\u6848","text":"<p>\u6cbb\u7406\u63d0\u6848\u662f\u4e00\u7a2e\u4f7f\u7528<code>SoftwareProposal</code> \u5728\u7d66\u5b9a\u9ad8\u5ea6\u6216\u6642\u9593\u5354\u8abf\u5347\u7d1a\u7684\u6a5f\u5236\u3002</p> <p>\ud83d\udce3 \u63d0\u793a\uff1a \u6240\u6709\u6cbb\u7406\u63d0\u6848\uff0c\u5305\u62ec\u8edf\u4ef6\u5347\u7d1a\uff0c\u90fd\u9700\u8981\u7b49\u5f85\u6295\u7968\u671f\u7d50\u675f\u5f8c\u624d\u80fd\u57f7\u884c\u5347\u7d1a\u3002\u63d0\u4ea4\u8edf\u4ef6\u5347\u7d1a\u5efa\u8b70\u6642\u8acb\u8003\u616e\u6b64\u6301\u7e8c\u6642\u9593\u3002</p> <p>\u5982\u679c\u63d0\u6848\u901a\u904e\uff0c\u5247\u91dd\u5c0d\u7279\u5b9a\u5347\u7d1a\u908f\u8f2f\u4ee5\u9077\u79fb\u72c0\u614b\u7684\u5347\u7d1a<code>\u8a08\u5283</code>\u5c07\u6301\u4e45\u4fdd\u5b58\u5230\u5340\u584a\u93c8\u72c0\u614b\uff0c\u4e26\u5728\u7d66\u5b9a\u7684\u5347\u7d1a\u9ad8\u5ea6\u9032\u884c\u8abf\u5ea6\u3002\u901a\u904e\u66f4\u65b0\u65b0\u63d0\u6848\u4e2d\u7684<code>Plan.Height</code>\u53ef\u4ee5\u5ef6\u9072\u6216\u52a0\u5feb\u5347\u7d1a\u3002</p>"},{"location":"upgrade/#_5","title":"\u786c\u5206\u53c9","text":"<p>\u4e00\u7a2e\u7279\u6b8a\u985e\u578b\u7684\u8a08\u5283\u5347\u7d1a\u662f \u786c\u5206\u53c9\u3002\u8207\u6cbb\u7406\u63d0\u6848\u76f8\u53cd\uff0c\u786c\u5206\u53c9\u4e0d\u9700\u8981\u7b49\u5f85\u6574\u500b\u6295\u7968\u671f\u3002 \u9019\u4f7f\u5b83\u5011\u6210\u70ba\u5354\u8abf\u5b89\u5168\u6f0f\u6d1e\u548c\u88dc\u4e01\u7684\u7406\u60f3\u9078\u64c7\u3002</p> <p>\u5347\u7d1a\uff08\u5206\u53c9\uff09\u584a\u9ad8\u5ea6\u5728\u61c9\u7528\u7a0b\u5e8f\u7684<code>BeginBlock</code>\u4e2d\u8a2d\u7f6e\uff08\u5373\u5728\u70ba\u584a\u8655\u7406\u4e8b\u52d9\u4e4b\u524d\uff09\u3002 \u4e00\u65e6\u5340\u584a\u93c8\u9054\u5230\u8a72\u9ad8\u5ea6\uff0c\u5b83\u6703\u81ea\u52d5\u70ba\u76f8\u540c\u9ad8\u5ea6\u5b89\u6392\u5347\u7d1a\u201c\u8a08\u5283\u201d\uff0c\u7136\u5f8c\u89f8\u767c\u5347\u7d1a\u904e\u7a0b\u3002 \u5347\u7d1a\u5f8c\uff0c\u584a\u64cd\u4f5c\uff08<code>BeginBlock</code>\u3001\u4e8b\u52d9\u8655\u7406\u548c\u72c0\u614b<code>Commit</code>\uff09\u7e7c\u7e8c\u6b63\u5e38\u9032\u884c\u3002</p> <p>\ud83d\udce3 \u63d0\u793a\uff1a \u70ba\u4e86\u57f7\u884c\u5347\u7d1a\u786c\u5206\u53c9\uff0c\u9700\u8981\u9996\u5148\u4f7f\u7528<code>BeginBlock</code>\u5347\u7d1a\u8abf\u5ea6\u908f\u8f2f\u767c\u5e03\u88dc\u4e01\u7248\u672c\u3002 \u5728 +2/3 \u7684\u9a57\u8b49\u8005\u5347\u7d1a\u5230\u65b0\u7684\u88dc\u4e01\u7248\u672c\u5f8c\uff0c\u4ed6\u5011\u7684\u7bc0\u9ede\u5c07\u81ea\u52d5\u505c\u6b62\u4f75\u5347\u7d1a\u4e8c\u9032\u88fd\u6587\u4ef6\u3002</p>"},{"location":"upgrade/#_6","title":"\u8a08\u5283\u5916\u5347\u7d1a","text":"<p>\u8a08\u5283\u5916\u5347\u7d1a\u662f\u6307\u6240\u6709\u9a57\u8b49\u8005\u90fd\u9700\u8981\u5728\u904e\u7a0b\u4e2d\u7684\u540c\u4e00\u6642\u523b\u512a\u96c5\u5730\u505c\u6b62\u548c\u95dc\u9589\u5176\u7bc0\u9ede\u7684\u5347\u7d1a\u3002 \u9019\u53ef\u4ee5\u901a\u904e\u5728\u904b\u884c <code>stcd start</code> \u547d\u4ee4\u6642\u8a2d\u7f6e <code>--halt-height</code> \u6a19\u8a8c\u4f86\u5b8c\u6210\u3002</p> <p>\u5982\u679c\u5728\u8a08\u5283\u5916\u5347\u7d1a\u671f\u9593\u767c\u751f\u91cd\u5927\u66f4\u6539\uff08\u898b\u4e0b\u6587\uff09\uff0c\u9a57\u8b49\u8005\u5c07\u9700\u8981\u5728\u91cd\u65b0\u555f\u52d5\u5176\u7bc0\u9ede\u4e4b\u524d\u9077\u79fb\u72c0\u614b\u548c\u8d77\u6e90\u3002</p> <p>\ud83d\udce3 \u63d0\u793a\uff1a \u8a08\u5283\u5916\u5347\u7d1a\u7684\u4e3b\u8981\u8003\u616e\u662f\u9700\u8981\u5c0e\u51fa\u5275\u4e16\u72c0\u614b\u4e26\u4e14\u9700\u8981[\u91cd\u7f6e]\uff08#data-reset-upgrades\uff09\u5340\u584a\u93c8\u6578\u64da\u3002 \u9019\u4e3b\u8981\u5f71\u97ff\u57fa\u790e\u8a2d\u65bd\u63d0\u4f9b\u5546\u3001\u5de5\u5177\u548c\u5ba2\u6236\u7aef\uff0c\u5982\u5340\u584a\u700f\u89bd\u5668\u548c\u5ba2\u6236\u7aef\uff0c\u5b83\u5011\u5fc5\u9808\u4f7f\u7528\u5b58\u6a94\u7bc0\u9ede\u4f86\u70ba\u5347\u7d1a\u524d\u7684\u9ad8\u5ea6\u63d0\u4f9b\u67e5\u8a62\u670d\u52d9\u3002</p>"},{"location":"upgrade/#_7","title":"\u7834\u58de\u6027\u548c\u975e\u7834\u58de\u6027\u5347\u7d1a","text":"<p>\u6839\u64da\u76f8\u61c9\u8edf\u4ef6\u767c\u5e03\u7248\u672c\u7684\u8a9e\u7fa9\u7248\u672c\u63a7\u5236(Semver)\uff0c\u5347\u7d1a\u53ef\u4ee5\u5206\u70ba\u4e2d\u65b7\u6216\u975e\u4e2d\u65b7/releases)(\u5373<code>vX.Y.Z</code>):</p> <ul> <li>\u4e3b\u8981\u7248\u672c (<code>X</code>)\uff1a\u5411\u5f8c\u4e0d\u517c\u5bb9\u7684 API \u548c\u72c0\u614b\u6a5f\u4e2d\u65b7\u66f4\u6539\u3002</li> <li>\u6b21\u8981\u7248\u672c (<code>Y</code>)\uff1a\u65b0\u7684\u5411\u5f8c\u517c\u5bb9\u529f\u80fd\u3002\u9019\u4e9b\u4e5f\u53ef\u80fd\u662f\u72c0\u614b\u6a5f\u4e2d\u65b7\u3002</li> <li>\u88dc\u4e01\u7248\u672c (<code>Z</code>)\uff1a\u5411\u5f8c\u517c\u5bb9\u7684\u932f\u8aa4\u4fee\u5fa9\u3001\u5c0f\u7684\u91cd\u69cb\u548c\u6539\u9032\u3002</li> </ul>"},{"location":"upgrade/#_8","title":"\u4e3b\u8981\u7248\u672c","text":"<p>\u5982\u679c\u60a8\u8981\u5347\u7d1a\u5230\u7684\u65b0\u7248\u672c\u6709\u91cd\u5927\u66f4\u6539\uff0c\u60a8\u5c07\u5fc5\u9808\uff1a</p> <ul> <li>\u9077\u79fb\u5275\u4e16JSON</li> <li>\u9077\u79fb\u61c9\u7528\u72c0\u614b</li> <li>\u91cd\u555f\u7bc0\u9ede</li> </ul> <p>\u9700\u8981\u9019\u6a23\u505a\u4ee5\u9632\u6b62\u96d9\u91cd\u7c3d\u540d\u6216\u5728\u5171\u8b58\u671f\u9593\u505c\u6b62\u93c8\u3002</p> <p>\u8981\u5347\u7d1a\u5275\u4e16\u6587\u4ef6\uff0c\u60a8\u53ef\u4ee5\u5f9e\u53ef\u4fe1\u4f86\u6e90\u7372\u53d6\u5b83\uff0c\u4e5f\u53ef\u4ee5\u4f7f\u7528 <code>stcd export</code> \u547d\u4ee4\u5c07\u5176\u5c0e\u51fa\u5230\u672c\u5730\u3002</p>"},{"location":"upgrade/#_9","title":"\u6b21\u8981\u7248\u672c","text":"<p>\u5982\u679c\u60a8\u8981\u5347\u7d1a\u5230\u7684\u65b0\u7248\u672c\u6709\u91cd\u5927\u66f4\u6539\uff0c\u60a8\u5c07\u5fc5\u9808\uff1a</p> <ul> <li>\u9077\u79fb\u72c0\u614b\uff08\u5982\u679c\u9069\u7528\uff09</li> <li>\u91cd\u555f\u7bc0\u9ede</li> </ul>"},{"location":"upgrade/#_10","title":"\u88dc\u4e01\u7248\u672c","text":"<p>\u70ba\u4e86\u66f4\u65b0\u88dc\u4e01\uff1a</p> <ul> <li>\u505c\u6b62\u7bc0\u9ede</li> <li>\u624b\u52d5\u4e0b\u8f09\u65b0\u7248\u672c\u7684\u4e8c\u9032\u88fd\u6587\u4ef6</li> <li>\u91cd\u555f\u7bc0\u9ede</li> </ul>"},{"location":"upgrade/#_11","title":"\u6578\u64da\u91cd\u7f6e\u5347\u7d1a","text":"<p>\u6578\u64da\u91cd\u7f6e\u5347\u7d1a\u8981\u6c42\u7bc0\u9ede\u904b\u71df\u5546\u5b8c\u5168\u91cd\u7f6e\u5340\u584a\u93c8\u72c0\u614b\u4e26\u5f9e\u4e7e\u6de8\u72c0\u614b\u91cd\u65b0\u555f\u52d5\u5176\u7bc0\u9ede\uff0c\u4f46\u4f7f\u7528\u76f8\u540c\u7684\u9a57\u8b49\u5668\u5bc6\u9470\u3002</p>"},{"location":"upgrade/#_12","title":"\u81ea\u52d5\u6216\u624b\u52d5\u5347\u7d1a","text":"<p>\u5c0d\u65bc\u6bcf\u500b\u65b0\u8edf\u4ef6\u7248\u672c\uff0c\u6211\u5011\u5f37\u70c8\u5efa\u8b70\u5168\u7bc0\u9ede\u548c\u9a57\u8b49\u5668\u64cd\u4f5c\u54e1\u57f7\u884c\u8edf\u4ef6\u5347\u7d1a\u3002</p> <p>\u60a8\u53ef\u4ee5\u901a\u904e\u4ee5\u4e0b\u4efb\u4e00\u65b9\u5f0f\u5347\u7d1a\u60a8\u7684\u7bc0\u9ede\uff1a</p> <ul> <li>\u81ea\u52d5 \u5347\u7d1a\u8edf\u4ef6\u7248\u672c\u4e26\u5728\u5347\u7d1a\u767c\u751f\u5f8c\u91cd\u65b0\u555f\u52d5\u7bc0\u9ede\uff0c\u6216\u8005</li> <li>\u4e0b\u8f09\u65b0\u7684\u4e8c\u9032\u88fd\u6587\u4ef6\u4e26\u57f7\u884c\u624b\u52d5\u5347\u7d1a</li> </ul> <p>\u6309\u7167\u4e0a\u9762\u9078\u9805\u4e2d\u7684\u93c8\u63a5\u4e86\u89e3\u5982\u4f55\u6839\u64da\u60a8\u7684\u9996\u9078\u9078\u9805\u5347\u7d1a\u60a8\u7684\u7bc0\u9ede\u3002</p>"},{"location":"upgrade/auto/","title":"\u81ea\u52d5\u5347\u7d1a","text":"<p>\u6211\u5011\u5f37\u70c8\u5efa\u8b70\u9a57\u8b49\u8005\u4f7f\u7528 Cosmovisor \u4f86\u904b\u884c\u4ed6\u5011\u7684\u7bc0\u9ede\u3002 \u9019\u5c07\u4f7f\u4f4e\u505c\u6a5f\u6642\u9593\u7684\u5347\u7d1a\u66f4\u52a0\u9806\u66a2\uff0c\u56e0\u70ba\u9a57\u8b49\u8005\u4e0d\u5fc5\u5728\u5347\u7d1a\u671f\u9593 \u624b\u52d5\u5347\u7d1a \u4e8c\u9032\u88fd\u6587\u4ef6\u3002 \u76f8\u53cd\uff0c\u7528\u6236\u53ef\u4ee5\u9810\u5b89\u88dd\u65b0\u7684\u4e8c\u9032\u88fd\u6587\u4ef6\uff0cCosmovisor \u5c07\u6839\u64da\u93c8\u4e0a\u8edf\u4ef6\u5347\u7d1a\u5efa\u8b70\u81ea\u52d5\u66f4\u65b0\u5b83\u5011\u3002</p> <p><code>cosmovisor</code> \u662f Cosmos SDK \u61c9\u7528\u7a0b\u5e8f\u4e8c\u9032\u88fd\u6587\u4ef6\u7684\u5c0f\u578b\u6d41\u7a0b\u7ba1\u7406\u5668\uff0c\u7528\u65bc\u76e3\u63a7\u50b3\u5165\u93c8\u5347\u7d1a\u63d0\u6848\u7684\u6cbb\u7406\u6a21\u584a\u3002</p> <p>\u5982\u679c\u5b83\u770b\u5230\u4e00\u500b\u63d0\u6848\u88ab\u6279\u51c6\uff0ccosmovisor \u53ef\u4ee5\u81ea\u52d5\u4e0b\u8f09\u65b0\u7684\u4e8c\u9032\u88fd\u6587\u4ef6\uff0c\u505c\u6b62\u7576\u524d\u7684\u4e8c\u9032\u88fd\u6587\u4ef6\uff0c\u5f9e\u820a\u7684\u4e8c\u9032\u88fd\u6587\u4ef6\u5207\u63db\u5230\u65b0\u7684\u4e8c\u9032\u88fd\u6587\u4ef6\uff0c\u6700\u5f8c\u7528\u65b0\u7684\u4e8c\u9032\u88fd\u6587\u4ef6\u91cd\u555f\u7bc0\u9ede\u3002</p>"},{"location":"upgrade/auto/#_2","title":"\u5148\u6c7a\u689d\u4ef6","text":"<ul> <li>\u5b89\u88c5 Cosmovisor</li> </ul>"},{"location":"upgrade/auto/#1-cosmovisor","title":"1. \u914d\u7f6e Cosmovisor","text":"<p>\ud83d\udce3 \u63d0\u793a :  <code>$install_path</code> \u7528\u6765\u8868\u793a\u60a8\u5b89\u88c5 <code>stcd</code> \u4e8c\u8fdb\u5236\u7a0b\u5e8f\u7684\u8def\u5f84</p> <p>\u8a2d\u7f6e Cosmovisor \u74b0\u5883\u8b8a\u91cf\u3002\u6211\u5011\u5efa\u8b70\u5728\u60a8\u7684 <code>.profile</code> \u4e2d\u8a2d\u7f6e\u9019\u4e9b\uff0c\u4ee5\u4fbf\u5728\u6bcf\u500b\u6703\u8a71\u4e2d\u81ea\u52d5\u8a2d\u7f6e\u3002</p> <pre><code>echo \"# Setup Cosmovisor\" &gt;&gt; ~/.profile\necho \"export DAEMON_NAME=stcd\" &gt;&gt; ~/.profile\necho \"export DAEMON_HOME=$install_path/.stcd\" &gt;&gt; ~/.profile\nsource ~/.profile\n</code></pre> <p>\u5728\u6b64\u4e4b\u5f8c\uff0c\u60a8\u5fc5\u9808\u5728\u60a8\u7684 <code>DAEMON_HOME</code> \u76ee\u9304 (<code>$install_path/.stcd</code>) \u4e2d\u70ba <code>cosmosvisor</code> \u5275\u5efa\u5fc5\u8981\u7684\u6587\u4ef6\u593e\uff0c\u4e26\u8907\u5236\u7576\u524d\u7684\u4e8c\u9032\u88fd\u6587\u4ef6\u3002</p> <pre><code>mkdir -p $install_path/.stcd/cosmovisor\nmkdir -p $install_path/.stcd/cosmovisor/genesis\nmkdir -p $install_path/.stcd/cosmovisor/genesis/bin\nmkdir -p $install_path/.stcd/cosmovisor/upgrades\n\ncp $GOPATH/bin/stcd $install_path/.stcd/cosmovisor/genesis/bin\n</code></pre> <p>\u8981\u6aa2\u67e5\u60a8\u662f\u5426\u6b63\u78ba\u57f7\u884c\u6b64\u64cd\u4f5c\uff0c\u8acb\u78ba\u4fdd\u60a8\u7684 <code>cosmovisor</code> \u548c <code>stcd</code> \u7248\u672c\u76f8\u540c\uff1a</p> <pre><code>cosmovisor run version\nstcd version\n</code></pre>"},{"location":"upgrade/auto/#2-daodst","title":"2. \u4e0b\u8f09 Daodst \u7248\u672c","text":""},{"location":"upgrade/auto/#_3","title":"\u624b\u52d5\u4e0b\u8f09","text":"<p>Cosmovisor \u5c07\u4e0d\u65b7\u8f2a\u8a62 <code>$DAEMON_HOME/data/upgrade-info.json</code> \u4ee5\u7372\u53d6\u65b0\u7684\u5347\u7d1a\u8aaa\u660e\u3002</p> <ol> <li>\u4e0b\u8f09\uff08\u672a\u5b89\u88dd\uff09\u65b0\u7248\u672c\u7684\u4e8c\u9032\u88fd\u6587\u4ef6</li> <li>\u5c07\u5176\u653e\u5728<code>$DAEMON_HOME/cosmovisor/upgrades/&lt;name&gt;/bin</code>\u4e0b\uff0c\u5176\u4e2d<code>&lt;name&gt;</code>\u662f\u8edf\u4ef6\u5347\u7d1a\u8a08\u5283\u4e2d\u6307\u5b9a\u7684\u5347\u7d1a\u7684 URI \u7de8\u78bc\u540d\u7a31\u3002</li> </ol> <p>\u8303\u4f8b: \u5c0d\u65bc\u540d\u70ba<code>v3.0.0</code>\u7684<code>\u8a08\u5283</code>\u4ee5\u53ca\u4ee5\u4e0b<code>upgrade-info.json</code>\uff1a</p> <pre><code>{\n    \"binaries\": {\n        \"linux/arm64\": \"https://github.com/daodst/blockchain/releases/download/v3.0.0/daodst_3.0.0_Linux_arm64.tar.gz\",\n        \"linux/amd64\": \"https://github.com/daodst/blockchain/releases/download/v3.0.0/daodst_3.0.0_Linux_amd64.tar.gz\",\n        \"windows/x86_64\": \"https://github.com/daodst/blockchain/releases/download/v3.0.0/daodst_3.0.0_Windows_x86_64.zip\"\n    }\n}\n</code></pre> <p>\u4f60\u7684 <code>cosmovisor/</code> \u76ee\u9304\u61c9\u8a72\u662f\u9019\u6a23\u7684\uff1a</p> <pre><code>cosmovisor/\n\u251c\u2500\u2500 current/   # either genesis or upgrades/&lt;name&gt;\n\u251c\u2500\u2500 genesis\n\u2502   \u2514\u2500\u2500 bin\n\u2502       \u2514\u2500\u2500 stcd\n\u2514\u2500\u2500 upgrades\n    \u2514\u2500\u2500 v3.0.0\n        \u251c\u2500\u2500 bin\n        \u2502   \u2514\u2500\u2500 stcd\n        \u2514\u2500\u2500 upgrade-info.json\n</code></pre>"},{"location":"upgrade/auto/#_4","title":"\u81ea\u52d5\u4e0b\u8f09","text":"<p>\u26a0\ufe0f\u6ce8\u610f : \u81ea\u52d5\u4e0b\u8f09\u4e0d\u6703\u63d0\u524d\u9a57\u8b49\u4e8c\u9032\u88fd\u6587\u4ef6\u662f\u5426\u53ef\u7528\u3002\u5982\u679c\u4e0b\u8f09\u4e8c\u9032\u88fd\u6587\u4ef6\u6709\u4efb\u4f55\u554f\u984c\uff0c<code>cosmovisor</code> \u5c07\u505c\u6b62\u4e26\u4e14\u4e0d\u6703\u91cd\u65b0\u555f\u52d5\u93c8\uff08\u9019\u53ef\u80fd\u6703\u5c0e\u81f4\u5b83\u505c\u6b62\uff09\u3002</p> <p>\u53ef\u4ee5\u8b93 Cosmovisor \u81ea\u52d5\u4e0b\u8f09 \u65b0\u7684\u4e8c\u9032\u88fd\u6587\u4ef6\u3002 \u9a57\u8b49\u8005\u53ef\u4ee5\u4f7f\u7528\u81ea\u52d5\u4e0b\u8f09\u9078\u9805\u4f86\u9632\u6b62\u5347\u7d1a\u904e\u7a0b\u4e2d\u4e0d\u5fc5\u8981\u7684\u505c\u6a5f\u3002</p> <p>\u4e00\u65e6\u93c8\u5728\u5efa\u8b70\u7684 upgrade-height \u8655\u505c\u6b62\uff0c\u6b64\u9078\u9805\u5c07\u4f7f\u7528\u5347\u7d1a\u4e8c\u9032\u88fd\u6587\u4ef6\u81ea\u52d5\u91cd\u555f\u93c8\u3002</p> <p>\u6b64\u9078\u9805\u7684\u4e3b\u8981\u597d\u8655\u662f\u9a57\u8b49\u8005\u53ef\u4ee5\u63d0\u524d\u6e96\u5099\u5347\u7d1a\u4e8c\u9032\u88fd\u6587\u4ef6\uff0c\u7136\u5f8c\u5728\u5347\u7d1a\u6642\u653e\u9b06\u3002</p> <p>\u8981\u8a2d\u7f6e\u81ea\u52d5\u4e0b\u8f09\u4f7f\u7528\u8a2d\u7f6e\u4ee5\u4e0b\u74b0\u5883\u8b8a\u91cf\uff1a</p> <pre><code>echo \"export DAEMON_ALLOW_DOWNLOAD_BINARIES=true\" &gt;&gt; ~/.profile\n</code></pre>"},{"location":"upgrade/auto/#3","title":"3. \u555f\u52d5\u4f60\u7684\u7bc0\u9ede","text":"<p>\u73fe\u5728\u4e00\u5207\u90fd\u5df2\u8a2d\u7f6e\u4e26\u6e96\u5099\u5c31\u7dd2\uff0c\u60a8\u53ef\u4ee5\u555f\u52d5\u60a8\u7684\u7bc0\u9ede\u3002</p> <pre><code>cosmovisor run start\n</code></pre> <p>\u60a8\u5c07\u9700\u8981\u4e00\u4e9b\u65b9\u6cd5\u4f86\u4fdd\u6301\u9032\u7a0b\u59cb\u7d42\u904b\u884c\u3002\u5982\u679c\u4f60\u5728 linux \u4e0a\uff0c\u4f60\u53ef\u4ee5\u901a\u904e\u5275\u5efa\u4e00\u500b\u670d\u52d9\u4f86\u505a\u5230\u9019\u4e00\u9ede\u3002</p> <pre><code>sudo tee /etc/systemd/system/stcd.service &gt; /dev/null &lt;&lt;EOF\n[Unit]\nDescription=Daodst Chain Daemon\nAfter=network-online.target\n\n[Service]\nUser=$USER\nExecStart=$(which cosmovisor) start\nRestart=always\nRestartSec=3\nLimitNOFILE=infinity\n\nEnvironment=\"DAEMON_HOME=$HOME/.stcd\"\nEnvironment=\"DAEMON_NAME=stcd\"\nEnvironment=\"DAEMON_ALLOW_DOWNLOAD_BINARIES=false\"\nEnvironment=\"DAEMON_RESTART_AFTER_UPGRADE=true\"\n\n[Install]\nWantedBy=multi-user.target\nEOF\n</code></pre> <p>\u7136\u5f8c\u66f4\u65b0\u4e26\u555f\u52d5\u7bc0\u9ede</p> <pre><code>sudo -S systemctl daemon-reload\nsudo -S systemctl enable stcd\nsudo -S systemctl start stcd\n</code></pre> <p>\u60a8\u53ef\u4ee5\u4f7f\u7528\u4ee5\u4e0b\u65b9\u5f0f\u6aa2\u67e5\u72c0\u614b\uff1a</p> <pre><code>systemctl status stcd\n</code></pre>"},{"location":"upgrade/hard-fork/","title":"\u786c\u5206\u53c9\u5347\u7d1a","text":"<p>\u6b63\u5e38\u5347\u7d1a\u7a0b\u5e8f\u7684\u91cd\u5927\u9650\u5236\u4e4b\u4e00 \u793e\u533a\u6cbb\u7406 \u662f\u5b83\u9700\u8981\u7b49\u5f85\u6574\u500b\u6295\u7968\u671f\u3002</p> <p>\u6b64\u6301\u7e8c\u6642\u9593\u4f7f\u5176\u4e0d\u9069\u5408\u6d89\u53ca\u5b89\u5168\u6f0f\u6d1e\u6216\u5176\u4ed6\u95dc\u9375\u7d44\u4ef6\u88dc\u4e01\u7684\u81ea\u52d5\u5347\u7d1a\u3002</p> <p>\u4f7f\u7528\u6cbb\u7406\u7684\u4e00\u7a2e\u66f4\u5feb\u7684\u66ff\u4ee3\u65b9\u6cd5\u662f\u5275\u5efa\u786c\u5206\u53c9\u7a0b\u5e8f\u3002 \u6b64\u904e\u7a0b\u81ea\u52d5\u61c9\u7528\u5347\u7d1a\u8a08\u5283\u7684\u66f4\u6539\uff0c\u5141\u8a31\u5b83\u5011\u5728\u7d66\u5b9a\u7684\u5340\u584a\u9ad8\u5ea6\u57f7\u884c\uff0c\u800c\u7121\u9700\u5275\u5efa\u6cbb\u7406\u63d0\u6848\u3002</p> <p>\u5354\u8abf\u5347\u7d1a\u7684\u9ad8\u7d1a\u7b56\u7565\u5982\u4e0b\uff1a</p> <ul> <li>\u6f0f\u6d1e\u4fee\u5fa9\u5728\u5305\u542b\u91cd\u5927\u66f4\u6539\u7684\u79c1\u6709\u5206\u652f\u4e0a\u3002</li> <li>\u9700\u8981\u5275\u5efa\u4e00\u500b\u65b0\u7684\u88dc\u4e01\u7248\u672c\uff08\u4f8b\u5982 <code>v8.0.0</code> -&gt; <code>v8.0.1</code>\uff09\uff0c\u5176\u4e2d\u5305\u542b\u786c\u5206\u53c9\u908f\u8f2f\u4e26\u57f7\u884c\u5347\u7d1a\u5230\u4e0b\u4e00\u500b\u4e2d\u65b7\u7248\u672c\uff08\u4f8b\u5982 <code>v9.0.0</code>\uff09\u9810\u5b9a\u7fa9\u584a\u9ad8\u5ea6\u3002</li> <li>\u9a57\u8b49\u8005\u5c07\u4ed6\u5011\u7684\u7bc0\u9ede\u5347\u7d1a\u5230\u88dc\u4e01\u7248\u672c\uff08\u4f8b\u5982<code>v8.0.1</code>\uff09\u3002 \u70ba\u4e86\u6210\u529f\u57f7\u884c\u786c\u5206\u53c9\uff0c\u91cd\u8981\u7684\u662f\u6709\u8db3\u5920\u591a\u7684\u9a57\u8b49\u8005\u5347\u7d1a\u5230\u88dc\u4e01\u7248\u672c\uff0c\u9019\u6a23\u4ed6\u5011\u81f3\u5c11\u4f54\u9a57\u8b49\u8005\u7e3d\u6295\u7968\u6b0a\u7684 2/3\u3002</li> <li>\u5347\u7d1a\u6642\u9593\u524d\u4e00\u5c0f\u6642\uff08\u5c0d\u61c9\u5347\u7d1a\u5340\u584a\u9ad8\u5ea6\uff09\uff0c\u767c\u5e03\u5305\u542b\u6f0f\u6d1e\u4fee\u5fa9\u7684\u65b0\u4e3b\u7248\u672c\uff08\u5982<code>v9.0.0</code>\uff09\u3002</li> </ul> <p>\u26a0\ufe0f\u6ce8\u610f : \u767c\u5e03\u9700\u8981\u63d0\u524d 1 \u5c0f\u6642\u5275\u5efa\uff0c\u56e0\u70ba\u5275\u5efa\u767c\u5e03\u4e8c\u9032\u88fd\u6587\u4ef6\u5927\u7d04\u9700\u8981 30 \u5206\u9418\uff0c\u9a57\u8b49\u8005\u9700\u8981\u7de9\u885d\u6642\u9593\u4f86\u4e0b\u8f09\u5b83\u5011\u4e26\u66f4\u65b0\u5b83\u5011\u7684\u8a2d\u7f6e\u3002</p>"},{"location":"upgrade/list/","title":"\u5347\u7d1a\u6e05\u55ae","text":"<p>\u6aa2\u67e5\u6bcf\u500b\u4e3b\u7db2\u548c\u6e2c\u8a66\u7db2\u5347\u7d1a\u7684\u8a73\u7d30\u4fe1\u606f\u548c\u8981\u6c42\u3002</p>"},{"location":"upgrade/list/#_2","title":"\u4e3b\u7db2","text":"\u7248\u672c \u8a08\u5283 \u4e2d\u65ad \u6578\u64da\u91cd\u7f6e \u50c5\u624b\u52d5\u5347\u7d1a \u5347\u7d1a\u9ad8\u5ea6 <code>v1.0.0</code> (genesis) <code>N/A</code> <code>N/A</code> <code>N/A</code> \u274c 1"},{"location":"upgrade/list/#_3","title":"\u6e2c\u8a66\u7db2","text":"\u7248\u672c \u8a08\u5283 \u4e2d\u65ad \u6578\u64da\u91cd\u7f6e \u50c5\u624b\u52d5\u5347\u7d1a \u5347\u7d1a\u9ad8\u5ea6 <code>v1.0.0-beta1</code> (genesis) <code>N/A</code> <code>N/A</code> <code>N/A</code> \u274c 1"},{"location":"upgrade/manual/","title":"\u624b\u52d5\u5347\u7d1a","text":"<p>\u4e86\u89e3\u5982\u4f55\u624b\u52d5\u5347\u7d1a\u60a8\u7684\u7bc0\u9ede\u3002</p>"},{"location":"upgrade/manual/#_2","title":"\u5148\u6c7a\u689d\u4ef6","text":"<ul> <li>\u5b89\u88c5 stcd</li> </ul>"},{"location":"upgrade/manual/#1-daodst","title":"1. \u5347\u7d1a Daodst \u7248\u672c","text":"<p>\u5728\u5347\u7d1a Daodst \u7248\u672c\u4e4b\u524d\u3002\u4f7f\u7528 <code>Ctrl/Cmd+C</code> \u505c\u6b62\u60a8\u7684 daodst \u5be6\u4f8b\u3002</p> <p>\u63a5\u4e0b\u4f86\uff0c\u5c07\u8edf\u4ef6\u5347\u7d1a\u5230\u6240\u9700\u7684\u767c\u884c\u7248\u672c\u3002\u67e5\u770b Daodst \u767c\u5e03\u9801\u9762 \u6709\u95dc\u6bcf\u500b\u7248\u672c\u7684\u8a73\u7d30\u4fe1\u606f\u3002</p> <p>\u26a0\ufe0f\u6ce8\u610f : \u78ba\u4fdd\u5b89\u88dd\u7684\u7248\u672c\u8207\u60a8\u6b63\u5728\u904b\u884c\u7684\u7db2\u7d61\uff08\u4e3b\u7db2\u6216\u6e2c\u8a66\u7db2\uff09\u6240\u9700\u7684\u7248\u672c\u76f8\u5339\u914d\u3002</p> <pre><code>cd blockchain\ngit fetch --all &amp;&amp; git checkout &lt;new_version&gt;\nmake install\n</code></pre> <p>\ud83d\udce3 \u63d0\u793a :  \u5982\u679c\u60a8\u5728\u9019\u4e00\u6b65\u9047\u5230\u554f\u984c\uff0c\u8acb\u6aa2\u67e5\u60a8\u662f\u5426\u5b89\u88dd\u4e86\u6700\u65b0\u7a69\u5b9a\u7248\u672c\u7684 Golang\u3002</p> <p>\u4f7f\u7528 <code>version</code> \u547d\u4ee4\u9a57\u8b49\u60a8\u662f\u5426\u5df2\u5728\u7cfb\u7d71\u4e0a\u6210\u529f\u5b89\u88dd Daodst\uff1a</p> <pre><code>$ stcd version --long\n\nname: daodst\nserver_name: daodst\nversion: 3.0.0\ncommit: \nbuild_tags: \ngo: go version go1.20 darwin/amd64\n...\n</code></pre> <p>\ud83d\udce3 \u63d0\u793a :  \u5982\u679c\u8edf\u4ef6\u7248\u672c\u4e0d\u5339\u914d\uff0c\u8acb\u6aa2\u67e5\u60a8\u7684 <code>$PATH</code> \u4ee5\u78ba\u4fdd\u6b63\u78ba\u7684 <code>stcd</code> \u6b63\u5728\u904b\u884c\u3002</p>"},{"location":"upgrade/manual/#2","title":"2. \u66ff\u63db\u5275\u4e16\u7d00\u6587\u4ef6","text":"<p>\ud83d\udce3 \u63d0\u793a :  \u60a8\u53ef\u4ee5\u5728\u4ee5\u4e0b\u5b58\u5132\u5eab\u4e2d\u627e\u5230\u4e3b\u7db2\u6216\u6e2c\u8a66\u7db2\u7684\u6700\u65b0 <code>genesis.json</code> \u6587\u4ef6\uff1a</p> <ul> <li>\u4e3b\u7db2: github.com/daodst/mainnet</li> <li>\u6e2c\u8a66\u7db2: github.com/daodst/testnets</li> </ul> <p>\u5c07\u65b0\u7684\u5275\u4e16\u8a18\u4fdd\u5b58\u70ba<code>new_genesis.json</code>\u3002\u7136\u5f8c\uff0c\u5c07\u4f4d\u65bc <code>config/</code> \u76ee\u9304\u4e2d\u7684\u820a <code>genesis.json</code> \u66ff\u63db\u70ba <code>new_genesis.json</code>\uff1a</p> <pre><code>cd $install_path/.stcd/config\ncp -f genesis.json new_genesis.json\nmv new_genesis.json genesis.json\n</code></pre> <p>\ud83d\udce3 \u63d0\u793a :  </p> <p>\u6211\u5011\u5efa\u8b70\u4f7f\u7528 <code>sha256sum</code> \u4f86\u6aa2\u67e5\u4e0b\u8f09\u7684\u8d77\u6e90\u8207\u9810\u671f\u8d77\u6e90\u7684\u54c8\u5e0c\u503c\u3002</p> <pre><code>cd ~/.stcd/config\necho \"&lt;expected_hash&gt;  genesis.json\" | sha256sum -c\n</code></pre> <p>:::</p>"},{"location":"upgrade/manual/#3","title":"3. \u6578\u64da\u91cd\u7f6e","text":"<p>\u26a0\ufe0f\u6ce8\u610f :  \u5982\u679c\u60a8\u8981\u5347\u7d1a\u7684\u7248\u672c\u9700\u8981\u6578\u64da\u91cd\u7f6e\uff08\u786c\u5206\u53c9\uff09\uff0c\u8acb\u6aa2\u67e5 \u6b64\u8655\u3002\u5982\u679c\u4e0d\u662f\u9019\u7a2e\u60c5\u6cc1\uff0c\u60a8\u53ef\u4ee5\u8df3\u5230\u91cd\u65b0\u555f\u52d5\u3002</p> <p>\u522a\u9664\u904e\u6642\u7684\u6587\u4ef6\u4e26\u91cd\u7f6e\u6578\u64da\uff1a</p> <pre><code>rm $install_path/.stcd/config/addrbook.json\nstcd tendermint unsafe-reset-all --home $install_path/.stcd\n</code></pre> <p>\u60a8\u7684\u7bc0\u9ede\u73fe\u5728\u8655\u65bc\u539f\u59cb\u72c0\u614b\uff0c\u540c\u6642\u4fdd\u7559\u539f\u59cb\u7684 <code>priv_validator.json</code> \u548c <code>config.toml</code>\u3002\u5982\u679c\u60a8\u4e4b\u524d\u8a2d\u7f6e\u4e86\u4efb\u4f55\u54e8\u5175\u7bc0\u9ede\u6216\u5b8c\u6574\u7bc0\u9ede\uff0c\u60a8\u7684\u7bc0\u9ede\u4ecd\u5c07\u5617\u8a66\u9023\u63a5\u5230\u5b83\u5011\uff0c\u4f46\u5982\u679c\u5b83\u5011\u9084\u6c92\u6709\u5347\u7d1a\uff0c\u5247\u53ef\u80fd\u6703\u5931\u6557\u3002</p> <p>\ud83d\udea8 \u91cd\u8981\u7684 \ud83d\udea8</p> <p>\u78ba\u4fdd\u6bcf\u500b\u7bc0\u9ede\u90fd\u6709\u4e00\u500b\u552f\u4e00\u7684 <code>priv_validator.json</code>\u3002 \u4e0d\u8981\u5c07 <code>priv_validator.json</code> \u5f9e\u820a\u7bc0\u9ede\u8907\u88fd\u5230\u591a\u500b\u65b0\u7bc0\u9ede\u3002 \u4f7f\u7528\u76f8\u540c\u7684 <code>priv_validator.json</code> \u904b\u884c\u5169\u500b\u7bc0\u9ede\u5c07\u5c0e\u81f4\u60a8\u96d9\u91cd\u7c3d\u540d\u3002</p>"},{"location":"upgrade/manual/#4","title":"4. \u91cd\u555f\u7bc0\u9ede","text":"<p>\u8981\u5728\u65b0\u5275\u4e16\u66f4\u65b0\u5f8c\u91cd\u65b0\u555f\u52d5\u7bc0\u9ede\uff0c\u8acb\u4f7f\u7528<code>daemon</code>\u547d\u4ee4\uff1a</p> <pre><code>stcd daemon\n</code></pre>"},{"location":"upgrade/rollback/","title":"\u56de\u6efe","text":"<p>\ud83d\udce3 \u63d0\u793a :  <code>$install_path</code> \u7528\u6765\u8868\u793a\u60a8\u5b89\u88c5 <code>stcd</code> \u4e8c\u8fdb\u5236\u7a0b\u5e8f\u7684\u8def\u5f84</p> <p>\u4e86\u89e3\u5982\u4f55\u5728\u93c8\u5347\u7d1a\u5931\u6557\u7684\u60c5\u6cc1\u4e0b\u56de\u6efe\u93c8\u7248\u672c\u3002</p> <p>\u70ba\u4e86\u6062\u5fa9\u4ee5\u524d\u7684\u93c8\u7248\u672c\uff0c\u9a57\u8b49\u8005\u5fc5\u9808\u6062\u5fa9\u4ee5\u4e0b\u6578\u64da\uff1a</p> <ul> <li>\u5305\u542b\u4e0a\u4e00\u689d\u93c8\u72c0\u614b\u7684\u6578\u64da\u5eab\uff08\u9ed8\u8a8d\u5728 <code>$install_path/.stcd/data</code> \u4e2d\uff09</li> <li>\u9a57\u8b49\u5668\u7684 <code>priv_validator_state.json</code> \u6587\u4ef6\uff08\u9ed8\u8a8d\u4e5f\u5728 <code>$install_path/.stcd/data</code> \u4e2d\uff09</li> </ul> <p>\u5982\u679c\u9a57\u8b49\u8005\u4e0d\u64c1\u6709\u4ed6\u5011\u7684\u6578\u64da\u5eab\u6578\u64da\uff0c\u5247\u53e6\u4e00\u500b\u9a57\u8b49\u8005\u61c9\u8a72\u5171\u4eab\u6578\u64da\u5eab\u7684\u526f\u672c\u3002\u9a57\u8b49\u8005\u5c07\u80fd\u5920\u4e0b\u8f09\u6578\u64da\u526f\u672c\u4e26\u5728\u555f\u52d5\u5176\u7bc0\u9ede\u4e4b\u524d\u5c0d\u5176\u9032\u884c\u9a57\u8b49\u3002</p> <p>\u5982\u679c\u9a57\u8b49\u8005\u6c92\u6709\u5099\u4efd\u7684<code>priv_validator_state.json</code> \u6587\u4ef6\uff0c\u90a3\u9ebc\u9019\u4e9b\u9a57\u8b49\u8005\u5c07\u4e0d\u6703\u5728\u4ed6\u5011\u7684\u7b2c\u4e00\u500b\u5340\u584a\u4e0a\u6709\u96d9\u91cd\u7c3d\u540d\u4fdd\u8b77\u3002</p>"},{"location":"upgrade/rollback/#_2","title":"\u6062\u5fa9\u72b6\u6001\u7a0b\u5e8f","text":"<ul> <li> <p>\u9996\u5148\uff0c\u505c\u6b62\u4f60\u7684\u7bc0\u9ede\u3002</p> </li> <li> <p>\u7136\u5f8c\uff0c\u5c07\u5099\u4efd\u6578\u64da\u76ee\u9304\u7684\u5167\u5bb9\u8907\u88fd\u56de<code>$DAODST_HOME/data</code>\u76ee\u9304\uff08\u9ed8\u8a8d\u60c5\u6cc1\u4e0b\u61c9\u70ba<code>$install_path/.stcd/data</code>\uff09</p> </li> </ul> <pre><code># Assumes backup is stored in \"backup\" directory\nrm -rf $install_path/.stcd/data\nmv backup/.stcd/data $install_path/.stcd/data\n</code></pre> <ul> <li>\u63a5\u4e0b\u4f86\uff0c\u5b89\u88dd\u4ee5\u524d\u7248\u672c\u7684 Daodst\u3002</li> </ul> <pre><code># from daodst directory\ngit checkout &lt;prev_version&gt;\nmake install\n## verify version\nstcd version --long\n</code></pre> <ul> <li>\u6700\u5f8c\uff0c\u555f\u52d5\u7bc0\u9ede\u3002</li> </ul> <pre><code>stcd daemon\n</code></pre>"},{"location":"upgrade/template/","title":"\u5347\u7d1a\u63d0\u6848\u5167\u5bb9\u6a21\u677f","text":"<p>\u5347\u7d1a\u5305\u62ec\u4e09\u90e8\u5206\u5167\u5bb9\uff0c\u7db2\u95dc\u5ba2\u6236\u7aef\u5347\u7d1a\u3001\u4e3b\u93c8\u7bc0\u9ede\u5347\u7d1a\u3001APP\u5347\u7d1a\u3002\u7db2\u95dc\u548c\u4e3b\u93c8\u5206\u70balinux\u548cwindows\u5169\u500b\u7248\u672c\uff0c\u53ea\u652f\u630164\u4f4d\u7cfb\u7d71\u3002 \u5347\u7d1a\u6587\u4ef6\u5305\u9700\u8981\u9032\u884csha256\u7de8\u78bc\uff0c\u7136\u5f8c\u6309\u7167\u7d66\u5b9a\u7684\u683c\u5f0f\u62fc\u63a5\u5230\u4e0b\u8f09\u93c8\u63a5\u4e0a\uff0c\u7528\u65bc\u6587\u4ef6\u7684\u6709\u6548\u6027\u6821\u9a57\u3002 upgrade_script \u8173\u672c\u9069\u7528\u65bc\u5347\u7d1a\u9664\u5ba2\u6236\u7aef\u5916\u9700\u8981\u984d\u5916\u8655\u7406\u7684\u6578\u64da\u6216\u7a0b\u5e8f\u3002</p> <p>\u57f7\u884csha256\u547d\u4ee4:</p> <pre><code>sha256sum file\n#output:    \n27a1ed5d502d4148f837f2a74c6d87b574ce52391fda253618e60486e0304c5b  file\n</code></pre> <ul> <li>\u7db2\u95dc\u5ba2\u6236\u7aef\u5347\u7d1a\u63d0\u6848\u5167\u5bb9:</li> </ul> <pre><code>{\n  \"gateway\": {\n        \"version\": \"22.09.07\",\n        \"binaries\": {\n            \"linux/amd64\": {\n                \"url\": \"https://example.com/daodst.zip?checksum=sha256:aec070645fe53ee3b3763059376134f058cc337247c978add178b6ccdfb0019f\",\n                \"size\": 123877163\n            },\n            \"windows/amd64\": {\n                \"url\": \"https://example.com/daodst.zip?checksum=sha256:aec070645fe53ee3b3763059376134f058cc337247c978add178b6ccdfb0019f\",\n                \"size\": 123877163\n            }\n        }\n    }\n\n}\n</code></pre> <ul> <li>\u4e3b\u93c8\u7bc0\u9ede\u5347\u7d1a\u63d0\u6848\u5167\u5bb9:</li> </ul> <pre><code>{\n  \"blockchain\": {\n        \"version\": \"22.10.08\",\n        \"binaries\": {\n            \"linux/amd64\": {\n                \"url\": \"https://example.com/daodst.zip?checksum=sha256:aec070645fe53ee3b3763059376134f058cc337247c978add178b6ccdfb0019f\",\n                \"size\": 123877163\n            },\n            \"windows/amd64\": {\n                \"url\": \"https://example.com/daodst.zip?checksum=sha256:aec070645fe53ee3b3763059376134f058cc337247c978add178b6ccdfb0019f\",\n                \"size\": 123877163\n            }\n        }\n    }\n}\n</code></pre> <ul> <li>APP\u5347\u7d1a\u63d0\u6848\u5167\u5bb9:</li> </ul> <pre><code>{\n    \"app\": {\n        \"version\": \"22.09.07\",\n        \"binaries\": {\n            \"android\": {\n                \"url\": \"https://example.com/gaia.zip?checksum=sha256:aec070645fe53ee3b3763059376134f058cc337247c978add178b6ccdfb0019f\",\n                \"size\": 123877163\n            }\n        }\n    }\n}\n</code></pre> <p>\u652f\u6301\u4e00\u6b21\u63d0\u6848\u5347\u7d1a\u591a\u500b\u7a0b\u5e8f:</p> <pre><code>{\n  \"gateway\": {\n        \"version\": \"22.09.07\",\n        \"binaries\": {\n            \"linux/amd64\": {\n                \"url\": \"https://example.com/gaia.zip?checksum=sha256:aec070645fe53ee3b3763059376134f058cc337247c978add178b6ccdfb0019f\",\n                \"size\": 123877163\n            },\n            \"windows/amd64\": {\n                \"url\": \"https://example.com/gaia.zip?checksum=sha256:aec070645fe53ee3b3763059376134f058cc337247c978add178b6ccdfb0019f\",\n                \"size\": 123877163\n            }\n        }\n    },\n  \"blockchain\": {\n        \"version\": \"22.10.08\",\n        \"binaries\": {\n            \"linux/amd64\": {\n                \"url\": \"https://example.com/gaia.zip?checksum=sha256:aec070645fe53ee3b3763059376134f058cc337247c978add178b6ccdfb0019f\",\n                \"size\": 123877163\n            },\n            \"windows/amd64\": {\n                \"url\": \"https://example.com/gaia.zip?checksum=sha256:aec070645fe53ee3b3763059376134f058cc337247c978add178b6ccdfb0019f\",\n                \"size\": 123877163\n            }\n        }\n    },\n    \"app\": {\n        \"version\": \"22.09.07\",\n        \"binaries\": {\n            \"android\": {\n                \"url\": \"https://example.com/gaia.zip?checksum=sha256:aec070645fe53ee3b3763059376134f058cc337247c978add178b6ccdfb0019f\",\n                \"size\": 123877163\n            }\n        }\n    }\n}\n</code></pre>"}]}