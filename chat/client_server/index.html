
<!doctype html>
<html lang="en" class="no-js">
  <head>
    
      <meta charset="utf-8">
      <meta name="viewport" content="width=device-width,initial-scale=1">
      
      
      
      
        <link rel="prev" href="../chat_doc/">
      
      
        <link rel="next" href="../server_server/">
      
      
      <link rel="icon" href="../../assets/images/favicon.png">
      <meta name="generator" content="mkdocs-1.5.3, mkdocs-material-9.4.4">
    
    
      
        <title>å®¢æˆ¶ç«¯-æœå‹™ç«¯API - DAODSTæ–‡æª”</title>
      
    
    
      <link rel="stylesheet" href="../../assets/stylesheets/main.bd3936ea.min.css">
      
      


    
    
      
    
    
      
        
        
        <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
        <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Roboto:300,300i,400,400i,700,700i%7CRoboto+Mono:400,400i,700,700i&display=fallback">
        <style>:root{--md-text-font:"Roboto";--md-code-font:"Roboto Mono"}</style>
      
    
    
    <script>__md_scope=new URL("../..",location),__md_hash=e=>[...e].reduce((e,_)=>(e<<5)-e+_.charCodeAt(0),0),__md_get=(e,_=localStorage,t=__md_scope)=>JSON.parse(_.getItem(t.pathname+"."+e)),__md_set=(e,_,t=localStorage,a=__md_scope)=>{try{t.setItem(a.pathname+"."+e,JSON.stringify(_))}catch(e){}}</script>
    
      

    
    
    
  </head>
  
  
    <body dir="ltr">
  
    
    
      <script>var palette=__md_get("__palette");if(palette&&"object"==typeof palette.color)for(var key of Object.keys(palette.color))document.body.setAttribute("data-md-color-"+key,palette.color[key])</script>
    
    <input class="md-toggle" data-md-toggle="drawer" type="checkbox" id="__drawer" autocomplete="off">
    <input class="md-toggle" data-md-toggle="search" type="checkbox" id="__search" autocomplete="off">
    <label class="md-overlay" for="__drawer"></label>
    <div data-md-component="skip">
      
        
        <a href="#-" class="md-skip">
          Skip to content
        </a>
      
    </div>
    <div data-md-component="announce">
      
    </div>
    
    
      

<header class="md-header" data-md-component="header">
  <nav class="md-header__inner md-grid" aria-label="Header">
    <a href="../.." title="DAODSTæ–‡æª”" class="md-header__button md-logo" aria-label="DAODSTæ–‡æª”" data-md-component="logo">
      
  
  <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 8a3 3 0 0 0 3-3 3 3 0 0 0-3-3 3 3 0 0 0-3 3 3 3 0 0 0 3 3m0 3.54C9.64 9.35 6.5 8 3 8v11c3.5 0 6.64 1.35 9 3.54 2.36-2.19 5.5-3.54 9-3.54V8c-3.5 0-6.64 1.35-9 3.54Z"/></svg>

    </a>
    <label class="md-header__button md-icon" for="__drawer">
      
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M3 6h18v2H3V6m0 5h18v2H3v-2m0 5h18v2H3v-2Z"/></svg>
    </label>
    <div class="md-header__title" data-md-component="header-title">
      <div class="md-header__ellipsis">
        <div class="md-header__topic">
          <span class="md-ellipsis">
            DAODSTæ–‡æª”
          </span>
        </div>
        <div class="md-header__topic" data-md-component="header-topic">
          <span class="md-ellipsis">
            
              å®¢æˆ¶ç«¯-æœå‹™ç«¯API
            
          </span>
        </div>
      </div>
    </div>
    
    
      <div class="md-header__option">
  <div class="md-select">
    
    <button class="md-header__button md-icon" aria-label="Select language">
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="m12.87 15.07-2.54-2.51.03-.03A17.52 17.52 0 0 0 14.07 6H17V4h-7V2H8v2H1v2h11.17C11.5 7.92 10.44 9.75 9 11.35 8.07 10.32 7.3 9.19 6.69 8h-2c.73 1.63 1.73 3.17 2.98 4.56l-5.09 5.02L4 19l5-5 3.11 3.11.76-2.04M18.5 10h-2L12 22h2l1.12-3h4.75L21 22h2l-4.5-12m-2.62 7 1.62-4.33L19.12 17h-3.24Z"/></svg>
    </button>
    <div class="md-select__inner">
      <ul class="md-select__list">
        
          <li class="md-select__item">
            <a href="https://zh-tw.docs.daodst.com" hreflang="zh" class="md-select__link">
              ä¸­æ–‡
            </a>
          </li>
        
          <li class="md-select__item">
            <a href="https://docs.daodst.com" hreflang="en" class="md-select__link">
              English
            </a>
          </li>
        
      </ul>
    </div>
  </div>
</div>
    
    
      <label class="md-header__button md-icon" for="__search">
        
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.516 6.516 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5Z"/></svg>
      </label>
      <div class="md-search" data-md-component="search" role="dialog">
  <label class="md-search__overlay" for="__search"></label>
  <div class="md-search__inner" role="search">
    <form class="md-search__form" name="search">
      <input type="text" class="md-search__input" name="query" aria-label="Search" placeholder="Search" autocapitalize="off" autocorrect="off" autocomplete="off" spellcheck="false" data-md-component="search-query" required>
      <label class="md-search__icon md-icon" for="__search">
        
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.516 6.516 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5Z"/></svg>
        
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11h12Z"/></svg>
      </label>
      <nav class="md-search__options" aria-label="Search">
        
        <button type="reset" class="md-search__icon md-icon" title="Clear" aria-label="Clear" tabindex="-1">
          
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M19 6.41 17.59 5 12 10.59 6.41 5 5 6.41 10.59 12 5 17.59 6.41 19 12 13.41 17.59 19 19 17.59 13.41 12 19 6.41Z"/></svg>
        </button>
      </nav>
      
    </form>
    <div class="md-search__output">
      <div class="md-search__scrollwrap" data-md-scrollfix>
        <div class="md-search-result" data-md-component="search-result">
          <div class="md-search-result__meta">
            Initializing search
          </div>
          <ol class="md-search-result__list" role="presentation"></ol>
        </div>
      </div>
    </div>
  </div>
</div>
    
    
  </nav>
  
</header>
    
    <div class="md-container" data-md-component="container">
      
      
        
          
            
<nav class="md-tabs" aria-label="Tabs" data-md-component="tabs">
  <div class="md-grid">
    <ul class="md-tabs__list">
      
        
  
  
  
    
    
      <li class="md-tabs__item">
        <a href="../../protocol/account/" class="md-tabs__link">
          
  
  ğŸ”å”è­°

        </a>
      </li>
    
  

      
        
  
  
  
    
    
      <li class="md-tabs__item">
        <a href="../../modules_accounts/" class="md-tabs__link">
          
  
  ğŸ§±æ¨¡å¡Š

        </a>
      </li>
    
  

      
        
  
  
  
    
    
      
  
  
  
    
    
      <li class="md-tabs__item">
        <a href="../../gateway/run/" class="md-tabs__link">
          
  
  ğŸ°ç¶²é—œå’Œé©—è­‰å™¨

        </a>
      </li>
    
  

    
  

      
        
  
  
    
  
  
    
    
      <li class="md-tabs__item md-tabs__item--active">
        <a href="../installation/" class="md-tabs__link">
          
  
  ğŸ“èŠå¤©

        </a>
      </li>
    
  

      
        
  
  
  
    
    
      
  
  
  
    
    
      <li class="md-tabs__item">
        <a href="../../window/introduce/" class="md-tabs__link">
          
  
  âœˆï¸è·¨éˆ

        </a>
      </li>
    
  

    
  

      
        
  
  
  
    <li class="md-tabs__item">
      <a href="../../faq/" class="md-tabs__link">
        
  
    
  
  ğŸ“‹å¸¸è¦‹å•é¡Œ

      </a>
    </li>
  

      
    </ul>
  </div>
</nav>
          
        
      
      <main class="md-main" data-md-component="main">
        <div class="md-main__inner md-grid">
          
            
              
              <div class="md-sidebar md-sidebar--primary" data-md-component="sidebar" data-md-type="navigation" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    


  


<nav class="md-nav md-nav--primary md-nav--lifted" aria-label="Navigation" data-md-level="0">
  <label class="md-nav__title" for="__drawer">
    <a href="../.." title="DAODSTæ–‡æª”" class="md-nav__button md-logo" aria-label="DAODSTæ–‡æª”" data-md-component="logo">
      
  
  <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 8a3 3 0 0 0 3-3 3 3 0 0 0-3-3 3 3 0 0 0-3 3 3 3 0 0 0 3 3m0 3.54C9.64 9.35 6.5 8 3 8v11c3.5 0 6.64 1.35 9 3.54 2.36-2.19 5.5-3.54 9-3.54V8c-3.5 0-6.64 1.35-9 3.54Z"/></svg>

    </a>
    DAODSTæ–‡æª”
  </label>
  
  <ul class="md-nav__list" data-md-scrollfix>
    
      
      
  
  
  
    
    
    
    
    
      
      
    
    <li class="md-nav__item md-nav__item--section md-nav__item--nested">
      
        
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_1" >
        
          
          <label class="md-nav__link" for="__nav_1" id="__nav_1_label" tabindex="">
            
  
  <span class="md-ellipsis">
    ğŸ”å”è­°
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_1_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_1">
            <span class="md-nav__icon md-icon"></span>
            ğŸ”å”è­°
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
    <li class="md-nav__item">
      <a href="../../protocol/account/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    æŠ€è¡“æ¶æ§‹
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
    
    
    
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_1_2" >
        
          
          <label class="md-nav__link" for="__nav_1_2" id="__nav_1_2_label" tabindex="0">
            
  
  <span class="md-ellipsis">
    å‘½ä»¤è¡Œç•Œé¢
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_1_2_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_1_2">
            <span class="md-nav__icon md-icon"></span>
            å‘½ä»¤è¡Œç•Œé¢
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
    <li class="md-nav__item">
      <a href="../../protocol/stcd/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    å®‰è£
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
    <li class="md-nav__item">
      <a href="../../protocol/stcd/config/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    é…ç½®
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
    <li class="md-nav__item">
      <a href="../../protocol/stcd/single-node/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    å–®ç¯€é»
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
    <li class="md-nav__item">
      <a href="../../protocol/stcd/command/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    CLIå‘½ä»¤
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
  
    <li class="md-nav__item">
      <a href="../../protocol/account/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    å¸³è™Ÿ
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
    <li class="md-nav__item">
      <a href="../../protocol/chainid/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    éˆID
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
    <li class="md-nav__item">
      <a href="../../protocol/encode/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    ç·¨ç¢¼
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
    <li class="md-nav__item">
      <a href="../../protocol/gas/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Gaså’Œæ‰‹çºŒè²»
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
    <li class="md-nav__item">
      <a href="../../protocol/keyring/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    å¯†é‘°ç’°
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
    <li class="md-nav__item">
      <a href="../../protocol/key-management/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    å¯†é‘°ç®¡ç†
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
    <li class="md-nav__item">
      <a href="../../protocol/state-migrate/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    ç‹€æ…‹å°å…¥å°å‡º
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
    <li class="md-nav__item">
      <a href="../../protocol/pending/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    ç­‰å¾…éšŠåˆ—
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
    <li class="md-nav__item">
      <a href="../../protocol/multsign/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    å¤šç°½
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
    <li class="md-nav__item">
      <a href="../../protocol/coin/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    ä»£å¹£
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
    <li class="md-nav__item">
      <a href="../../protocol/transfer/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    äº¤æ˜“
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
  
    
    
    
    
    
      
      
    
    <li class="md-nav__item md-nav__item--section md-nav__item--nested">
      
        
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_2" >
        
          
          <label class="md-nav__link" for="__nav_2" id="__nav_2_label" tabindex="">
            
  
  <span class="md-ellipsis">
    ğŸ§±æ¨¡å¡Š
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_2_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_2">
            <span class="md-nav__icon md-icon"></span>
            ğŸ§±æ¨¡å¡Š
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
    <li class="md-nav__item">
      <a href="../../modules_accounts/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    æ¨¡å¡Šè³¬è™Ÿ
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
    <li class="md-nav__item">
      <a href="../../evm/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    ä»¥å¤ªåŠè™›æ“¬æ©Ÿ
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
    <li class="md-nav__item">
      <a href="../" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    èŠå¤©
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
    <li class="md-nav__item">
      <a href="../../gateway/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    ç¶²é—œ
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
    <li class="md-nav__item">
      <a href="../../dao.md" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    å»ä¸­å¿ƒåŒ–ç»„ç»‡
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
    <li class="md-nav__item">
      <a href="../../contract/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    åˆç´„
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
    <li class="md-nav__item">
      <a href="../../pledge/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    èŠå¤©è³ªæŠ¼
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
    <li class="md-nav__item">
      <a href="../../auth/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    èªè­‰
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
    <li class="md-nav__item">
      <a href="../../bank/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    éŠ€è¡Œ
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
    <li class="md-nav__item">
      <a href="../../gov/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    æ²»ç†
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
    <li class="md-nav__item">
      <a href="../../mint/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    é‘„é€ 
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
    <li class="md-nav__item">
      <a href="../../distribute/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    åˆ†é…
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
    <li class="md-nav__item">
      <a href="../../slashing/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    å‰Šæ¸›
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
    <li class="md-nav__item">
      <a href="../../staking/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    DPOSè³ªæŠ¼
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
  
    
    
    
    
    
      
      
    
    <li class="md-nav__item md-nav__item--section md-nav__item--nested">
      
        
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_3" >
        
          
          <label class="md-nav__link" for="__nav_3" id="__nav_3_label" tabindex="">
            
  
  <span class="md-ellipsis">
    ğŸ°ç¶²é—œå’Œé©—è­‰å™¨
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_3_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_3">
            <span class="md-nav__icon md-icon"></span>
            ğŸ°ç¶²é—œå’Œé©—è­‰å™¨
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
    
    
    
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_3_1" >
        
          
          <label class="md-nav__link" for="__nav_3_1" id="__nav_3_1_label" tabindex="0">
            
  
  <span class="md-ellipsis">
    è¨­ç½®å’Œé…å¯˜
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_3_1_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_3_1">
            <span class="md-nav__icon md-icon"></span>
            è¨­ç½®å’Œé…å¯˜
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
    <li class="md-nav__item">
      <a href="../../gateway/run/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    é‹è¡Œé©—è­‰ç¯€é»
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
    <li class="md-nav__item">
      <a href="../../gateway/validator/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    ç®¡ç†é©—è­‰å™¨
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
    <li class="md-nav__item">
      <a href="../../gateway/config/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    é…å¯˜
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
    <li class="md-nav__item">
      <a href="../../gateway/disk-usage/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    ç¡¬ç¢Ÿä½¿ç”¨å„ªåŒ–
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
    <li class="md-nav__item">
      <a href="../../gateway/state-sync/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    ç‹€æ…‹åŒæ­¥
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
    <li class="md-nav__item">
      <a href="../../gateway/mempool/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    è¨˜æ†¶é«”æ± 
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
    <li class="md-nav__item">
      <a href="../../gateway/faq/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    å¸¸è¦‹å•é¡Œ
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
  
    
    
    
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_3_2" >
        
          
          <label class="md-nav__link" for="__nav_3_2" id="__nav_3_2_label" tabindex="0">
            
  
  <span class="md-ellipsis">
    å®‰å…¨
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_3_2_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_3_2">
            <span class="md-nav__icon md-icon"></span>
            å®‰å…¨
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
    <li class="md-nav__item">
      <a href="../../gateway/security/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    æª¢æŸ¥æ¸…å–®
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
    <li class="md-nav__item">
      <a href="../../gateway/safe-node/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    å“¨å…µç¯€é»
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
  
    
    
    
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_3_3" >
        
          
          <label class="md-nav__link" for="__nav_3_3" id="__nav_3_3_label" tabindex="0">
            
  
  <span class="md-ellipsis">
    é™ç´š
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_3_3_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_3_3">
            <span class="md-nav__icon md-icon"></span>
            é™ç´š
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
    <li class="md-nav__item">
      <a href="../../upgrade/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    æ¦‚è¿°
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
    <li class="md-nav__item">
      <a href="../../upgrade/list/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    å‡ç´šæ¸…å–®
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
    <li class="md-nav__item">
      <a href="../../upgrade/hard-fork/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    ç¡¬åˆ†å‰å‡ç´š
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
    <li class="md-nav__item">
      <a href="../../upgrade/auto/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    è‡ªå‹•å‡ç´š
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
    <li class="md-nav__item">
      <a href="../../upgrade/manual/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    æ‰‹å‹•å‡ç´š
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
    <li class="md-nav__item">
      <a href="../../upgrade/rollback/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    å›æ»¾
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
    <li class="md-nav__item">
      <a href="../../upgrade/template/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    ææ¡ˆæ¨¡æ¿
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
  
    <li class="md-nav__item">
      <a href="../../gateway/testnet/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    æ¸¬è©¦ç¶²
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
    <li class="md-nav__item">
      <a href="../../gateway/mainnet/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    ä¸»ç¶²
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
    
    
    
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_3_6" >
        
          
          <label class="md-nav__link" for="__nav_3_6" id="__nav_3_6_label" tabindex="0">
            
  
  <span class="md-ellipsis">
    ç¶²é—œæ“ä½œæŒ‡å—
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_3_6_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_3_6">
            <span class="md-nav__icon md-icon"></span>
            ç¶²é—œæ“ä½œæŒ‡å—
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
    <li class="md-nav__item">
      <a href="../../gateway/guide-linux/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    æ“ä½œæŒ‡å—(linux)
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
    <li class="md-nav__item">
      <a href="../../gateway/guide-win/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    æ“ä½œæŒ‡å—(win)
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
    <li class="md-nav__item">
      <a href="../../gateway/key-backup/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    é‡‘é‘°å‚™ä»½å’Œæ¢å¾©
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
    <li class="md-nav__item">
      <a href="../../ttts/ttts/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    ç¿»è¯‘å’Œæ–‡æœ¬è½¬è¯­éŸ³æœåŠ¡
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
    
  
  
    
    
    
    
    
      
      
    
    <li class="md-nav__item md-nav__item--active md-nav__item--section md-nav__item--nested">
      
        
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_4" checked>
        
          
          <label class="md-nav__link" for="__nav_4" id="__nav_4_label" tabindex="">
            
  
  <span class="md-ellipsis">
    ğŸ“èŠå¤©
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_4_label" aria-expanded="true">
          <label class="md-nav__title" for="__nav_4">
            <span class="md-nav__icon md-icon"></span>
            ğŸ“èŠå¤©
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
    <li class="md-nav__item">
      <a href="../installation/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    å®‰è£å•Ÿå‹•
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
    <li class="md-nav__item">
      <a href="../chat_doc/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    æ–‡æª”
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
    
  
  
    <li class="md-nav__item md-nav__item--active">
      
      <input class="md-nav__toggle md-toggle" type="checkbox" id="__toc">
      
      
        
      
      
        <label class="md-nav__link md-nav__link--active" for="__toc">
          
  
  <span class="md-ellipsis">
    å®¢æˆ¶ç«¯-æœå‹™ç«¯API
  </span>
  

          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <a href="./" class="md-nav__link md-nav__link--active">
        
  
  <span class="md-ellipsis">
    å®¢æˆ¶ç«¯-æœå‹™ç«¯API
  </span>
  

      </a>
      
        

<nav class="md-nav md-nav--secondary" aria-label="Table of contents">
  
  
  
    
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      Table of contents
    </label>
    <ul class="md-nav__list" data-md-component="toc" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#1" class="md-nav__link">
    1.æ¥å£æ ‡å‡†
  </a>
  
    <nav class="md-nav" aria-label="1.æ¥å£æ ‡å‡†">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#11" class="md-nav__link">
    1.1 æ ‡å‡†é”™è¯¯å“åº”
  </a>
  
    <nav class="md-nav" aria-label="1.1 æ ‡å‡†é”™è¯¯å“åº”">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#111" class="md-nav__link">
    1.1.1 å¸¸è§é”™è¯¯
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#112" class="md-nav__link">
    1.1.2 å…¶ä»–é”™è¯¯ä»£ç 
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#12" class="md-nav__link">
    1.2 äº¤æ˜“æ ‡è¯†ç¬¦
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#2" class="md-nav__link">
    2.ç½‘é¡µæµè§ˆå™¨å®¢æˆ·ç«¯
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#3" class="md-nav__link">
    3.æœåŠ¡å™¨å‘ç°
  </a>
  
    <nav class="md-nav" aria-label="3.æœåŠ¡å™¨å‘ç°">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#31-well-known-uri" class="md-nav__link">
    3.1 Well-known URI
  </a>
  
    <nav class="md-nav" aria-label="3.1 Well-known URI">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#get-well-knownmatrixclient" class="md-nav__link">
    GET /.well-known/matrix/client
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#get-_matrixclientversions" class="md-nav__link">
    GET /_matrix/client/versions
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#4" class="md-nav__link">
    4. å®¢æˆ·ç«¯èº«ä»½éªŒè¯
  </a>
  
    <nav class="md-nav" aria-label="4. å®¢æˆ·ç«¯èº«ä»½éªŒè¯">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#41" class="md-nav__link">
    4.1 ä½¿ç”¨è®¿é—®ä»¤ç‰Œ
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#42" class="md-nav__link">
    4.2 è®¿é—®ä»¤ç‰Œå’Œè®¾å¤‡ä¹‹é—´çš„å…³ç³»
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#43" class="md-nav__link">
    4.3 åˆ·æ–°è®¿é—®ä»¤ç‰Œ
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#44" class="md-nav__link">
    4.4 è½¯æ³¨é”€
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#45-api" class="md-nav__link">
    4.5 ç”¨æˆ·äº¤äº’å¼èº«ä»½éªŒè¯ API
  </a>
  
    <nav class="md-nav" aria-label="4.5 ç”¨æˆ·äº¤äº’å¼èº«ä»½éªŒè¯ API">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#451" class="md-nav__link">
    4.5.1 æ¦‚è¿°
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#452-rest-api-api" class="md-nav__link">
    4.5.2 REST API ä¸­çš„ç”¨æˆ·äº¤äº’å¼ API
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#453" class="md-nav__link">
    4.5.3 ä¾‹
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#454" class="md-nav__link">
    4.5.4 èº«ä»½éªŒè¯ç±»å‹
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#455" class="md-nav__link">
    4.5.5 åå¤‡
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#46" class="md-nav__link">
    4.6 ç™»å½•
  </a>
  
    <nav class="md-nav" aria-label="4.6 ç™»å½•">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#get-_matrixclientv3login" class="md-nav__link">
    GET /_matrix/client/v3/login
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#post-_matrixclientv3login" class="md-nav__link">
    POST /_matrix/client/v3/login
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#post-_matrixclientv3refresh" class="md-nav__link">
    POST /_matrix/client/v3/refresh
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#post-_matrixclientv3logout" class="md-nav__link">
    POST /_matrix/client/v3/logout
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#post-_matrixclientv3logoutall" class="md-nav__link">
    POST /_matrix/client/v3/logout/all
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#47" class="md-nav__link">
    4.7 å¸æˆ·æ³¨å†Œå’Œç®¡ç†
  </a>
  
    <nav class="md-nav" aria-label="4.7 å¸æˆ·æ³¨å†Œå’Œç®¡ç†">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#post-_matrixclientv3accountdeactivate" class="md-nav__link">
    POST /_matrix/client/v3/account/deactivate
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#post-_matrixclientv3accountpassword" class="md-nav__link">
    POST /_matrix/client/v3/account/password
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#post-_matrixclientv3accountpasswordemailrequesttoken" class="md-nav__link">
    POST /_matrix/client/v3/account/password/email/requestToken
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#post-_matrixclientv3accountpasswordmsisdnrequesttoken" class="md-nav__link">
    POST /_matrix/client/v3/account/password/msisdn/requestToken
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#post-_matrixclientv3register" class="md-nav__link">
    POST /_matrix/client/v3/register
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#get-_matrixclientv3registeravailable" class="md-nav__link">
    GET /_matrix/client/v3/register/available
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#post-_matrixclientv3registeremailrequesttoken" class="md-nav__link">
    POST /_matrix/client/v3/register/email/requestToken
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#post-_matrixclientv3registermsisdnrequesttoken" class="md-nav__link">
    POST /_matrix/client/v3/register/msisdn/requestToken
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#48" class="md-nav__link">
    4.8 æ·»åŠ å¸³æˆ¶ç®¡ç†è¯ç¹«è³‡è¨Š
  </a>
  
    <nav class="md-nav" aria-label="4.8 æ·»åŠ å¸³æˆ¶ç®¡ç†è¯ç¹«è³‡è¨Š">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#post-_matrixclientv3account3pidunbind" class="md-nav__link">
    POST /_matrix/client/v3/account/3pid/unbind
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#49" class="md-nav__link">
    4.9 å¾€ä¾†å¸³æˆ¶è³‡è¨Š
  </a>
  
    <nav class="md-nav" aria-label="4.9 å¾€ä¾†å¸³æˆ¶è³‡è¨Š">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#get-_matrixclientv3accountwhoami" class="md-nav__link">
    GET /_matrix/client/v3/account/whoami
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#491" class="md-nav__link">
    4.9.1 æœ‰é—œèº«ä»½ä¼ºæœå™¨çš„èªªæ˜
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#5" class="md-nav__link">
    5. èƒ½åŠ›å”å•†
  </a>
  
    <nav class="md-nav" aria-label="5. èƒ½åŠ›å”å•†">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#get-_matrixclientv3capabilities" class="md-nav__link">
    GET /_matrix/client/v3/capabilities
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#51-mchange_password" class="md-nav__link">
    5.1 m.change_passwordèƒ½åŠ›
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#52-mroom_versions" class="md-nav__link">
    5.2 m.room_versionsèƒ½åŠ›
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#53-mset_displayname" class="md-nav__link">
    5.3 m.set_displaynameèƒ½åŠ›
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#54-mset_avatar_url" class="md-nav__link">
    5.4 m.set_avatar_urlèƒ½åŠ›
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#55-m3pid_changes" class="md-nav__link">
    5.5 m.3pid_changesèƒ½åŠ›
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#6" class="md-nav__link">
    6 æ¿¾æ³¢
  </a>
  
    <nav class="md-nav" aria-label="6 æ¿¾æ³¢">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#61" class="md-nav__link">
    6.1 æ‡¶äººè£è¼‰å®¤æˆå“¡
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#62" class="md-nav__link">
    6.2 ä»‹é¢é€£æ¥é»
  </a>
  
    <nav class="md-nav" aria-label="6.2 ä»‹é¢é€£æ¥é»">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#post-_matrixclientv3useruseridfilter" class="md-nav__link">
    POST /_matrix/client/v3/user/{userId}/filter
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#get-_matrixclientv3useruseridfilterfilterid" class="md-nav__link">
    GET /_matrix/client/v3/user/{userId}/filter/{filterId}
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#7" class="md-nav__link">
    7 äº‹ä»¶
  </a>
  
    <nav class="md-nav" aria-label="7 äº‹ä»¶">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#71" class="md-nav__link">
    7.1 æˆ¿é–“æ´»å‹•çš„é¡å‹
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#72" class="md-nav__link">
    7.2 æœƒè­°å®¤äº‹ä»¶æ ¼å¼
  </a>
  
    <nav class="md-nav" aria-label="7.2 æœƒè­°å®¤äº‹ä»¶æ ¼å¼">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#clientevent" class="md-nav__link">
    ClientEvent
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#73" class="md-nav__link">
    7.3 å‰é›¢ç‹€æ…‹
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#74" class="md-nav__link">
    7.4 å¤§å°é™åˆ¶
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#75" class="md-nav__link">
    7.5 æœƒè­°å®¤æ´»å‹•
  </a>
  
    <nav class="md-nav" aria-label="7.5 æœƒè­°å®¤æ´»å‹•">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#mroomcanonical_alias" class="md-nav__link">
    m.room.canonical_alias
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#mroomcreate" class="md-nav__link">
    m.room.create
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#mroomjoin_rules" class="md-nav__link">
    m.room.join_rules
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#mroommember" class="md-nav__link">
    m.room.member
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#mroompower_levels" class="md-nav__link">
    m.room.power_levels
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#751" class="md-nav__link">
    7.5.1 æ­·å²äº‹ä»¶
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#76" class="md-nav__link">
    7.6 åŒæ­¥
  </a>
  
    <nav class="md-nav" aria-label="7.6 åŒæ­¥">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#get-_matrixclientv3sync" class="md-nav__link">
    GET /_matrix/client/v3/sync
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#77" class="md-nav__link">
    7.7 ç²å–èŠå¤©å®¤çš„äº‹ä»¶
  </a>
  
    <nav class="md-nav" aria-label="7.7 ç²å–èŠå¤©å®¤çš„äº‹ä»¶">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#get-_matrixclientv3roomsroomideventeventid" class="md-nav__link">
    GET /_matrix/client/v3/rooms/{roomId}/event/{eventId}
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#get-_matrixclientv3roomsroomidjoined_members" class="md-nav__link">
    GET /_matrix/client/v3/rooms/{roomId}/joined_members
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#get-_matrixclientv3roomsroomidmembers" class="md-nav__link">
    GET /_matrix/client/v3/rooms/{roomId}/members
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#get-_matrixclientv3roomsroomidstate" class="md-nav__link">
    GET /_matrix/client/v3/rooms/{roomId}/state
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#get-_matrixclientv3roomsroomidstateeventtypestatekey" class="md-nav__link">
    GET /_matrix/client/v3/rooms/{roomId}/state/{eventType}/{stateKey}
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#get-_matrixclientv3roomsroomidmessages" class="md-nav__link">
    GET /_matrix/client/v3/rooms/{roomId}/messages
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#get-_matrixclientv1roomsroomidtimestamp_to_event" class="md-nav__link">
    GET /_matrix/client/v1/rooms/{roomId}/timestamp_to_event
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#78" class="md-nav__link">
    7.8 å°‡äº‹ä»¶ç™¼é€åˆ°èŠå¤©å®¤
  </a>
  
    <nav class="md-nav" aria-label="7.8 å°‡äº‹ä»¶ç™¼é€åˆ°èŠå¤©å®¤">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#put-_matrixclientv3roomsroomidstateeventtypestatekey" class="md-nav__link">
    PUT /_matrix/client/v3/rooms/{roomId}/state/{eventType}/{stateKey}
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#put-_matrixclientv3roomsroomidsendeventtypetxnid" class="md-nav__link">
    PUT /_matrix/client/v3/rooms/{roomId}/send/{eventType}/{txnId}
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#79" class="md-nav__link">
    7.9 å¯†æ–‡
  </a>
  
    <nav class="md-nav" aria-label="7.9 å¯†æ–‡">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#791" class="md-nav__link">
    7.9.1 äº‹ä»¶
  </a>
  
    <nav class="md-nav" aria-label="7.9.1 äº‹ä»¶">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#mroomredaction" class="md-nav__link">
    m.room.redaction
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#792" class="md-nav__link">
    7.9.2 å®¢æˆ¶ç«¯è¡Œç‚º
  </a>
  
    <nav class="md-nav" aria-label="7.9.2 å®¢æˆ¶ç«¯è¡Œç‚º">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#put-_matrixclientv3roomsroomidredacteventidtxnid" class="md-nav__link">
    PUT /_matrix/client/v3/rooms/{roomId}/redact/{eventId}/{txnId}
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#710" class="md-nav__link">
    7.10 åœ¨äº‹ä»¶ä¹‹é–“å½¢æˆé—œä¿‚
  </a>
  
    <nav class="md-nav" aria-label="7.10 åœ¨äº‹ä»¶ä¹‹é–“å½¢æˆé—œä¿‚">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#mrelates_to" class="md-nav__link">
    m.relates_to
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#7101" class="md-nav__link">
    7.10.1 é—œä¿‚é¡å‹
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#7102" class="md-nav__link">
    7.10.2 å­äº‹ä»¶çš„èšåˆ
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#7103" class="md-nav__link">
    7.10.3 é—œä¿‚ä»‹é¢
  </a>
  
    <nav class="md-nav" aria-label="7.10.3 é—œä¿‚ä»‹é¢">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#get-_matrixclientv1roomsroomidrelationseventid" class="md-nav__link">
    GET /_matrix/client/v1/rooms/{roomId}/relations/{eventId}
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#get-_matrixclientv1roomsroomidrelationseventidreltype" class="md-nav__link">
    GET /_matrix/client/v1/rooms/{roomId}/relations/{eventId}/{relType}
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#get-_matrixclientv1roomsroomidrelationseventidreltypeeventtype" class="md-nav__link">
    GET /_matrix/client/v1/rooms/{roomId}/relations/{eventId}/{relType}/{eventType}
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#8" class="md-nav__link">
    8 æˆ¿é–“
  </a>
  
    <nav class="md-nav" aria-label="8 æˆ¿é–“">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#81" class="md-nav__link">
    8.1 é¡å‹
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#82" class="md-nav__link">
    8.2 å‰µé€ 
  </a>
  
    <nav class="md-nav" aria-label="8.2 å‰µé€ ">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#post-_matrixclientv3createroom" class="md-nav__link">
    POST /_matrix/client/v3/createRoom
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#get-_matrixclientv3directoryroomroomalias" class="md-nav__link">
    GET /_matrix/client/v3/directory/room/{roomAlias}
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#put-_matrixclientv3directoryroomroomalias" class="md-nav__link">
    PUT /_matrix/client/v3/directory/room/{roomAlias}
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#delete-_matrixclientv3directoryroomroomalias" class="md-nav__link">
    DELETE /_matrix/client/v3/directory/room/{roomAlias}
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#get-_matrixclientv3roomsroomidaliases" class="md-nav__link">
    GET /_matrix/client/v3/rooms/{roomId}/aliases
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#84" class="md-nav__link">
    8.4 è¨±å¯æ¬Š
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#85" class="md-nav__link">
    8.5 æª”å®¤æˆå“¡è³‡æ ¼
  </a>
  
    <nav class="md-nav" aria-label="8.5 æª”å®¤æˆå“¡è³‡æ ¼">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#get-_matrixclientv3joined_rooms" class="md-nav__link">
    GET /_matrix/client/v3/joined_rooms
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#851" class="md-nav__link">
    8.5.1 é€£æ¥æˆ¿é–“
  </a>
  
    <nav class="md-nav" aria-label="8.5.1 é€£æ¥æˆ¿é–“">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#post-_matrixclientv3roomsroomidinvite" class="md-nav__link">
    POST /_matrix/client/v3/rooms/{roomId}/invite
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#post-_matrixclientv3joinroomidoralias" class="md-nav__link">
    POST /_matrix/client/v3/join/{roomIdOrAlias}
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#post-_matrixclientv3roomsroomidjoin" class="md-nav__link">
    POST /_matrix/client/v3/rooms/{roomId}/join
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#852" class="md-nav__link">
    8.5.2 é›¢é–‹æˆ¿é–“
  </a>
  
    <nav class="md-nav" aria-label="8.5.2 é›¢é–‹æˆ¿é–“">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#post-_matrixclientv3roomsroomidforget" class="md-nav__link">
    POST /_matrix/client/v3/rooms/{roomId}/forget
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#post-_matrixclientv3roomsroomidleave" class="md-nav__link">
    POST /_matrix/client/v3/rooms/{roomId}/leave
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#post-_matrixclientv3roomsroomidkick" class="md-nav__link">
    POST /_matrix/client/v3/rooms/{roomId}/kick
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#86" class="md-nav__link">
    8.6 åˆ—å‡ºæˆ¿é–“
  </a>
  
    <nav class="md-nav" aria-label="8.6 åˆ—å‡ºæˆ¿é–“">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#get-_matrixclientv3directorylistroomroomid" class="md-nav__link">
    GET /_matrix/client/v3/directory/list/room/{roomId}
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#put-_matrixclientv3directorylistroomroomid" class="md-nav__link">
    PUT /_matrix/client/v3/directory/list/room/{roomId}
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#get-_matrixclientv3publicrooms" class="md-nav__link">
    GET /_matrix/client/v3/publicRooms
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#9" class="md-nav__link">
    9 ç”¨æˆ¶æ•¸æ“š
  </a>
  
    <nav class="md-nav" aria-label="9 ç”¨æˆ¶æ•¸æ“š">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#91" class="md-nav__link">
    9.1 ç”¨æˆ¶ç›®éŒ„
  </a>
  
    <nav class="md-nav" aria-label="9.1 ç”¨æˆ¶ç›®éŒ„">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#post-_matrixclientv3user_directorysearch" class="md-nav__link">
    POST /_matrix/client/v3/user_directory/search
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#92" class="md-nav__link">
    9.2 é…ç½® æª”
  </a>
  
    <nav class="md-nav" aria-label="9.2 é…ç½® æª”">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#get-_matrixclientv3profileuserid" class="md-nav__link">
    GET /_matrix/client/v3/profile/{userId}
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#get-_matrixclientv3profileuseridavatar_url" class="md-nav__link">
    GET /_matrix/client/v3/profile/{userId}/avatar_url
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#put-_matrixclientv3profileuseridavatar_url" class="md-nav__link">
    PUT /_matrix/client/v3/profile/{userId}/avatar_url
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#get-_matrixclientv3profileuseriddisplayname" class="md-nav__link">
    GET /_matrix/client/v3/profile/{userId}/displayname
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#put-_matrixclientv3profileuseriddisplayname" class="md-nav__link">
    PUT /_matrix/client/v3/profile/{userId}/displayname
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#921" class="md-nav__link">
    9.2.1 å€‹äººè³‡æ–™è³‡è¨Šè®Šæ›´äº‹ä»¶
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#10" class="md-nav__link">
    10 å®‰å…¨
  </a>
  
    <nav class="md-nav" aria-label="10 å®‰å…¨">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#101" class="md-nav__link">
    10.1 é€Ÿç‡é™åˆ¶
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#11_1" class="md-nav__link">
    11 æ¨¡çµ„
  </a>
  
    <nav class="md-nav" aria-label="11 æ¨¡çµ„">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#111_1" class="md-nav__link">
    11.1 åŠŸèƒ½é…ç½®æª”
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#112_1" class="md-nav__link">
    11.2 å³æ™‚é€šè¨Š
  </a>
  
    <nav class="md-nav" aria-label="11.2 å³æ™‚é€šè¨Š">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#1121" class="md-nav__link">
    11.2.1 äº‹ä»¶
  </a>
  
    <nav class="md-nav" aria-label="11.2.1 äº‹ä»¶">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#mroommessage" class="md-nav__link">
    m.room.message
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#1122" class="md-nav__link">
    11.2.2 å®¢æˆ¶ç«¯è¡Œç‚º
  </a>
  
    <nav class="md-nav" aria-label="11.2.2 å®¢æˆ¶ç«¯è¡Œç‚º">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#_1" class="md-nav__link">
    ç™¼é€æ¶ˆæ¯æ™‚çš„å»ºè­°
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#_2" class="md-nav__link">
    æœ¬åœ°å›è²
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#_3" class="md-nav__link">
    è¨ˆç®—ä½¿ç”¨è€…çš„é¡¯ç¤ºåç¨±
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#_4" class="md-nav__link">
    ä½¿ç”¨æ¶ˆæ¯é¡¯ç¤ºæˆå“¡èº«ä»½è³‡è¨Š
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#_5" class="md-nav__link">
    è¨ˆç®—èŠå¤©å®¤çš„é¡¯ç¤ºåç¨±
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#_6" class="md-nav__link">
    åŠ‡é€æ¶ˆæ¯
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#_7" class="md-nav__link">
    ä¼ºæœå™¨è¡Œç‚º
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#_8" class="md-nav__link">
    å®‰å…¨æ³¨æ„äº‹é …
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#113" class="md-nav__link">
    11.3 è±å¯Œçš„å›å¾©
  </a>
  
    <nav class="md-nav" aria-label="11.3 è±å¯Œçš„å›å¾©">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#_9" class="md-nav__link">
    è±å¯Œå›å¾©çš„å›é€€
  </a>
  
    <nav class="md-nav" aria-label="è±å¯Œå›å¾©çš„å›é€€">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#_10" class="md-nav__link">
    å‰é›¢å›é€€
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#mtextmnotice" class="md-nav__link">
    "m.text"ã€"m.notice"å’Œç„¡æ³•è­˜åˆ¥çš„æ¶ˆæ¯é¡å‹çš„å›é€€
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#memote" class="md-nav__link">
    "m.emote"çš„å›é€€
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#mimagemvideomaudiomfile" class="md-nav__link">
    "m.image"ã€"m.video"ã€"m.audio"å’Œ"m.file"çš„å›é€€
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#114-ip" class="md-nav__link">
    11.4 IP èªéŸ³
  </a>
  
    <nav class="md-nav" aria-label="11.4 IP èªéŸ³">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#1141" class="md-nav__link">
    11.4.1 äº‹ä»¶
  </a>
  
    <nav class="md-nav" aria-label="11.4.1 äº‹ä»¶">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#mcallanswer" class="md-nav__link">
    m.call.answer
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#_11" class="md-nav__link">
    å®¢æˆ¶ç«¯è¡Œç‚º
  </a>
  
    <nav class="md-nav" aria-label="å®¢æˆ¶ç«¯è¡Œç‚º">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#_12" class="md-nav__link">
    çœ©å…‰
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#1143" class="md-nav__link">
    11.4.3 ä¼ºæœå™¨è¡Œç‚º
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#1144" class="md-nav__link">
    11.4.4 å®‰å…¨æ³¨æ„äº‹é …
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#115" class="md-nav__link">
    11.5 éµå…¥é€šçŸ¥
  </a>
  
    <nav class="md-nav" aria-label="11.5 éµå…¥é€šçŸ¥">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#_13" class="md-nav__link">
    äº‹ä»¶
  </a>
  
    <nav class="md-nav" aria-label="äº‹ä»¶">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#mtyping" class="md-nav__link">
    m.typing
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#_14" class="md-nav__link">
    å®¢æˆ¶ç«¯è¡Œç‚º
  </a>
  
    <nav class="md-nav" aria-label="å®¢æˆ¶ç«¯è¡Œç‚º">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#put-_matrixclientv3roomsroomidtypinguserid" class="md-nav__link">
    PUT /_matrix/client/v3/rooms/{roomId}/typing/{userId}
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#_15" class="md-nav__link">
    å®‰å…¨æ³¨æ„äº‹é …
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#116" class="md-nav__link">
    11.6 æ”¶æ“š
  </a>
  
    <nav class="md-nav" aria-label="11.6 æ”¶æ“š">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#_16" class="md-nav__link">
    äº‹ä»¶
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#mreceipt" class="md-nav__link">
    m.receipt
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#_17" class="md-nav__link">
    å®¢æˆ¶ç«¯è¡Œç‚º
  </a>
  
    <nav class="md-nav" aria-label="å®¢æˆ¶ç«¯è¡Œç‚º">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#post-_matrixclientv3roomsroomidreceiptreceipttypeeventid" class="md-nav__link">
    POST /_matrix/client/v3/rooms/{roomId}/receipt/{receiptType}/{eventId}
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#_18" class="md-nav__link">
    ç§äººå·²è®€å›åŸ·
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#_19" class="md-nav__link">
    ç·šç¨‹å¼è®€å›åŸ·
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#_20" class="md-nav__link">
    ä¼ºæœå™¨è¡Œç‚º
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#_21" class="md-nav__link">
    å®‰å…¨æ³¨æ„äº‹é …
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
    </ul>
  
</nav>
      
    </li>
  

              
            
              
                
  
  
  
    <li class="md-nav__item">
      <a href="../server_server/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    æœå‹™ç«¯-æœå‹™ç«¯API
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
    <li class="md-nav__item">
      <a href="../customise_doc/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    å®šåˆ¶
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
    <li class="md-nav__item">
      <a href="../voip_signaling/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    å‘¼å«æµç¨‹
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
    <li class="md-nav__item">
      <a href="../optional_cfg/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    å¯é¸é…ç½®*
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
    <li class="md-nav__item">
      <a href="../faq/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    å¸¸è¦‹å•é¡Œ
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
  
    
    
    
    
    
      
      
    
    <li class="md-nav__item md-nav__item--section md-nav__item--nested">
      
        
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_5" >
        
          
          <label class="md-nav__link" for="__nav_5" id="__nav_5_label" tabindex="">
            
  
  <span class="md-ellipsis">
    âœˆï¸è·¨éˆ
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_5_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_5">
            <span class="md-nav__icon md-icon"></span>
            âœˆï¸è·¨éˆ
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
    
    
    
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_5_1" >
        
          
          <label class="md-nav__link" for="__nav_5_1" id="__nav_5_1_label" tabindex="0">
            
  
  <span class="md-ellipsis">
    è³£å®¶è·¨éˆæ¡Œé¢ç¨‹åº
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_5_1_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_5_1">
            <span class="md-nav__icon md-icon"></span>
            è³£å®¶è·¨éˆæ¡Œé¢ç¨‹åº
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
    <li class="md-nav__item">
      <a href="../../window/introduce/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    ä»‹ç´¹
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
    <li class="md-nav__item">
      <a href="../../window/info/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    ä½¿ç”¨èªªæ˜
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
  
    <li class="md-nav__item">
      <a href="../../faq/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    ğŸ“‹å¸¸è¦‹å•é¡Œ
  </span>
  

      </a>
    </li>
  

    
  </ul>
</nav>
                  </div>
                </div>
              </div>
            
            
              
              <div class="md-sidebar md-sidebar--secondary" data-md-component="sidebar" data-md-type="toc" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    

<nav class="md-nav md-nav--secondary" aria-label="Table of contents">
  
  
  
    
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      Table of contents
    </label>
    <ul class="md-nav__list" data-md-component="toc" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#1" class="md-nav__link">
    1.æ¥å£æ ‡å‡†
  </a>
  
    <nav class="md-nav" aria-label="1.æ¥å£æ ‡å‡†">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#11" class="md-nav__link">
    1.1 æ ‡å‡†é”™è¯¯å“åº”
  </a>
  
    <nav class="md-nav" aria-label="1.1 æ ‡å‡†é”™è¯¯å“åº”">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#111" class="md-nav__link">
    1.1.1 å¸¸è§é”™è¯¯
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#112" class="md-nav__link">
    1.1.2 å…¶ä»–é”™è¯¯ä»£ç 
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#12" class="md-nav__link">
    1.2 äº¤æ˜“æ ‡è¯†ç¬¦
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#2" class="md-nav__link">
    2.ç½‘é¡µæµè§ˆå™¨å®¢æˆ·ç«¯
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#3" class="md-nav__link">
    3.æœåŠ¡å™¨å‘ç°
  </a>
  
    <nav class="md-nav" aria-label="3.æœåŠ¡å™¨å‘ç°">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#31-well-known-uri" class="md-nav__link">
    3.1 Well-known URI
  </a>
  
    <nav class="md-nav" aria-label="3.1 Well-known URI">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#get-well-knownmatrixclient" class="md-nav__link">
    GET /.well-known/matrix/client
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#get-_matrixclientversions" class="md-nav__link">
    GET /_matrix/client/versions
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#4" class="md-nav__link">
    4. å®¢æˆ·ç«¯èº«ä»½éªŒè¯
  </a>
  
    <nav class="md-nav" aria-label="4. å®¢æˆ·ç«¯èº«ä»½éªŒè¯">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#41" class="md-nav__link">
    4.1 ä½¿ç”¨è®¿é—®ä»¤ç‰Œ
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#42" class="md-nav__link">
    4.2 è®¿é—®ä»¤ç‰Œå’Œè®¾å¤‡ä¹‹é—´çš„å…³ç³»
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#43" class="md-nav__link">
    4.3 åˆ·æ–°è®¿é—®ä»¤ç‰Œ
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#44" class="md-nav__link">
    4.4 è½¯æ³¨é”€
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#45-api" class="md-nav__link">
    4.5 ç”¨æˆ·äº¤äº’å¼èº«ä»½éªŒè¯ API
  </a>
  
    <nav class="md-nav" aria-label="4.5 ç”¨æˆ·äº¤äº’å¼èº«ä»½éªŒè¯ API">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#451" class="md-nav__link">
    4.5.1 æ¦‚è¿°
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#452-rest-api-api" class="md-nav__link">
    4.5.2 REST API ä¸­çš„ç”¨æˆ·äº¤äº’å¼ API
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#453" class="md-nav__link">
    4.5.3 ä¾‹
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#454" class="md-nav__link">
    4.5.4 èº«ä»½éªŒè¯ç±»å‹
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#455" class="md-nav__link">
    4.5.5 åå¤‡
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#46" class="md-nav__link">
    4.6 ç™»å½•
  </a>
  
    <nav class="md-nav" aria-label="4.6 ç™»å½•">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#get-_matrixclientv3login" class="md-nav__link">
    GET /_matrix/client/v3/login
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#post-_matrixclientv3login" class="md-nav__link">
    POST /_matrix/client/v3/login
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#post-_matrixclientv3refresh" class="md-nav__link">
    POST /_matrix/client/v3/refresh
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#post-_matrixclientv3logout" class="md-nav__link">
    POST /_matrix/client/v3/logout
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#post-_matrixclientv3logoutall" class="md-nav__link">
    POST /_matrix/client/v3/logout/all
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#47" class="md-nav__link">
    4.7 å¸æˆ·æ³¨å†Œå’Œç®¡ç†
  </a>
  
    <nav class="md-nav" aria-label="4.7 å¸æˆ·æ³¨å†Œå’Œç®¡ç†">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#post-_matrixclientv3accountdeactivate" class="md-nav__link">
    POST /_matrix/client/v3/account/deactivate
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#post-_matrixclientv3accountpassword" class="md-nav__link">
    POST /_matrix/client/v3/account/password
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#post-_matrixclientv3accountpasswordemailrequesttoken" class="md-nav__link">
    POST /_matrix/client/v3/account/password/email/requestToken
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#post-_matrixclientv3accountpasswordmsisdnrequesttoken" class="md-nav__link">
    POST /_matrix/client/v3/account/password/msisdn/requestToken
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#post-_matrixclientv3register" class="md-nav__link">
    POST /_matrix/client/v3/register
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#get-_matrixclientv3registeravailable" class="md-nav__link">
    GET /_matrix/client/v3/register/available
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#post-_matrixclientv3registeremailrequesttoken" class="md-nav__link">
    POST /_matrix/client/v3/register/email/requestToken
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#post-_matrixclientv3registermsisdnrequesttoken" class="md-nav__link">
    POST /_matrix/client/v3/register/msisdn/requestToken
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#48" class="md-nav__link">
    4.8 æ·»åŠ å¸³æˆ¶ç®¡ç†è¯ç¹«è³‡è¨Š
  </a>
  
    <nav class="md-nav" aria-label="4.8 æ·»åŠ å¸³æˆ¶ç®¡ç†è¯ç¹«è³‡è¨Š">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#post-_matrixclientv3account3pidunbind" class="md-nav__link">
    POST /_matrix/client/v3/account/3pid/unbind
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#49" class="md-nav__link">
    4.9 å¾€ä¾†å¸³æˆ¶è³‡è¨Š
  </a>
  
    <nav class="md-nav" aria-label="4.9 å¾€ä¾†å¸³æˆ¶è³‡è¨Š">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#get-_matrixclientv3accountwhoami" class="md-nav__link">
    GET /_matrix/client/v3/account/whoami
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#491" class="md-nav__link">
    4.9.1 æœ‰é—œèº«ä»½ä¼ºæœå™¨çš„èªªæ˜
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#5" class="md-nav__link">
    5. èƒ½åŠ›å”å•†
  </a>
  
    <nav class="md-nav" aria-label="5. èƒ½åŠ›å”å•†">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#get-_matrixclientv3capabilities" class="md-nav__link">
    GET /_matrix/client/v3/capabilities
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#51-mchange_password" class="md-nav__link">
    5.1 m.change_passwordèƒ½åŠ›
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#52-mroom_versions" class="md-nav__link">
    5.2 m.room_versionsèƒ½åŠ›
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#53-mset_displayname" class="md-nav__link">
    5.3 m.set_displaynameèƒ½åŠ›
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#54-mset_avatar_url" class="md-nav__link">
    5.4 m.set_avatar_urlèƒ½åŠ›
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#55-m3pid_changes" class="md-nav__link">
    5.5 m.3pid_changesèƒ½åŠ›
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#6" class="md-nav__link">
    6 æ¿¾æ³¢
  </a>
  
    <nav class="md-nav" aria-label="6 æ¿¾æ³¢">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#61" class="md-nav__link">
    6.1 æ‡¶äººè£è¼‰å®¤æˆå“¡
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#62" class="md-nav__link">
    6.2 ä»‹é¢é€£æ¥é»
  </a>
  
    <nav class="md-nav" aria-label="6.2 ä»‹é¢é€£æ¥é»">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#post-_matrixclientv3useruseridfilter" class="md-nav__link">
    POST /_matrix/client/v3/user/{userId}/filter
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#get-_matrixclientv3useruseridfilterfilterid" class="md-nav__link">
    GET /_matrix/client/v3/user/{userId}/filter/{filterId}
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#7" class="md-nav__link">
    7 äº‹ä»¶
  </a>
  
    <nav class="md-nav" aria-label="7 äº‹ä»¶">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#71" class="md-nav__link">
    7.1 æˆ¿é–“æ´»å‹•çš„é¡å‹
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#72" class="md-nav__link">
    7.2 æœƒè­°å®¤äº‹ä»¶æ ¼å¼
  </a>
  
    <nav class="md-nav" aria-label="7.2 æœƒè­°å®¤äº‹ä»¶æ ¼å¼">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#clientevent" class="md-nav__link">
    ClientEvent
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#73" class="md-nav__link">
    7.3 å‰é›¢ç‹€æ…‹
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#74" class="md-nav__link">
    7.4 å¤§å°é™åˆ¶
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#75" class="md-nav__link">
    7.5 æœƒè­°å®¤æ´»å‹•
  </a>
  
    <nav class="md-nav" aria-label="7.5 æœƒè­°å®¤æ´»å‹•">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#mroomcanonical_alias" class="md-nav__link">
    m.room.canonical_alias
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#mroomcreate" class="md-nav__link">
    m.room.create
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#mroomjoin_rules" class="md-nav__link">
    m.room.join_rules
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#mroommember" class="md-nav__link">
    m.room.member
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#mroompower_levels" class="md-nav__link">
    m.room.power_levels
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#751" class="md-nav__link">
    7.5.1 æ­·å²äº‹ä»¶
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#76" class="md-nav__link">
    7.6 åŒæ­¥
  </a>
  
    <nav class="md-nav" aria-label="7.6 åŒæ­¥">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#get-_matrixclientv3sync" class="md-nav__link">
    GET /_matrix/client/v3/sync
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#77" class="md-nav__link">
    7.7 ç²å–èŠå¤©å®¤çš„äº‹ä»¶
  </a>
  
    <nav class="md-nav" aria-label="7.7 ç²å–èŠå¤©å®¤çš„äº‹ä»¶">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#get-_matrixclientv3roomsroomideventeventid" class="md-nav__link">
    GET /_matrix/client/v3/rooms/{roomId}/event/{eventId}
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#get-_matrixclientv3roomsroomidjoined_members" class="md-nav__link">
    GET /_matrix/client/v3/rooms/{roomId}/joined_members
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#get-_matrixclientv3roomsroomidmembers" class="md-nav__link">
    GET /_matrix/client/v3/rooms/{roomId}/members
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#get-_matrixclientv3roomsroomidstate" class="md-nav__link">
    GET /_matrix/client/v3/rooms/{roomId}/state
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#get-_matrixclientv3roomsroomidstateeventtypestatekey" class="md-nav__link">
    GET /_matrix/client/v3/rooms/{roomId}/state/{eventType}/{stateKey}
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#get-_matrixclientv3roomsroomidmessages" class="md-nav__link">
    GET /_matrix/client/v3/rooms/{roomId}/messages
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#get-_matrixclientv1roomsroomidtimestamp_to_event" class="md-nav__link">
    GET /_matrix/client/v1/rooms/{roomId}/timestamp_to_event
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#78" class="md-nav__link">
    7.8 å°‡äº‹ä»¶ç™¼é€åˆ°èŠå¤©å®¤
  </a>
  
    <nav class="md-nav" aria-label="7.8 å°‡äº‹ä»¶ç™¼é€åˆ°èŠå¤©å®¤">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#put-_matrixclientv3roomsroomidstateeventtypestatekey" class="md-nav__link">
    PUT /_matrix/client/v3/rooms/{roomId}/state/{eventType}/{stateKey}
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#put-_matrixclientv3roomsroomidsendeventtypetxnid" class="md-nav__link">
    PUT /_matrix/client/v3/rooms/{roomId}/send/{eventType}/{txnId}
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#79" class="md-nav__link">
    7.9 å¯†æ–‡
  </a>
  
    <nav class="md-nav" aria-label="7.9 å¯†æ–‡">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#791" class="md-nav__link">
    7.9.1 äº‹ä»¶
  </a>
  
    <nav class="md-nav" aria-label="7.9.1 äº‹ä»¶">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#mroomredaction" class="md-nav__link">
    m.room.redaction
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#792" class="md-nav__link">
    7.9.2 å®¢æˆ¶ç«¯è¡Œç‚º
  </a>
  
    <nav class="md-nav" aria-label="7.9.2 å®¢æˆ¶ç«¯è¡Œç‚º">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#put-_matrixclientv3roomsroomidredacteventidtxnid" class="md-nav__link">
    PUT /_matrix/client/v3/rooms/{roomId}/redact/{eventId}/{txnId}
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#710" class="md-nav__link">
    7.10 åœ¨äº‹ä»¶ä¹‹é–“å½¢æˆé—œä¿‚
  </a>
  
    <nav class="md-nav" aria-label="7.10 åœ¨äº‹ä»¶ä¹‹é–“å½¢æˆé—œä¿‚">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#mrelates_to" class="md-nav__link">
    m.relates_to
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#7101" class="md-nav__link">
    7.10.1 é—œä¿‚é¡å‹
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#7102" class="md-nav__link">
    7.10.2 å­äº‹ä»¶çš„èšåˆ
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#7103" class="md-nav__link">
    7.10.3 é—œä¿‚ä»‹é¢
  </a>
  
    <nav class="md-nav" aria-label="7.10.3 é—œä¿‚ä»‹é¢">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#get-_matrixclientv1roomsroomidrelationseventid" class="md-nav__link">
    GET /_matrix/client/v1/rooms/{roomId}/relations/{eventId}
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#get-_matrixclientv1roomsroomidrelationseventidreltype" class="md-nav__link">
    GET /_matrix/client/v1/rooms/{roomId}/relations/{eventId}/{relType}
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#get-_matrixclientv1roomsroomidrelationseventidreltypeeventtype" class="md-nav__link">
    GET /_matrix/client/v1/rooms/{roomId}/relations/{eventId}/{relType}/{eventType}
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#8" class="md-nav__link">
    8 æˆ¿é–“
  </a>
  
    <nav class="md-nav" aria-label="8 æˆ¿é–“">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#81" class="md-nav__link">
    8.1 é¡å‹
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#82" class="md-nav__link">
    8.2 å‰µé€ 
  </a>
  
    <nav class="md-nav" aria-label="8.2 å‰µé€ ">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#post-_matrixclientv3createroom" class="md-nav__link">
    POST /_matrix/client/v3/createRoom
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#get-_matrixclientv3directoryroomroomalias" class="md-nav__link">
    GET /_matrix/client/v3/directory/room/{roomAlias}
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#put-_matrixclientv3directoryroomroomalias" class="md-nav__link">
    PUT /_matrix/client/v3/directory/room/{roomAlias}
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#delete-_matrixclientv3directoryroomroomalias" class="md-nav__link">
    DELETE /_matrix/client/v3/directory/room/{roomAlias}
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#get-_matrixclientv3roomsroomidaliases" class="md-nav__link">
    GET /_matrix/client/v3/rooms/{roomId}/aliases
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#84" class="md-nav__link">
    8.4 è¨±å¯æ¬Š
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#85" class="md-nav__link">
    8.5 æª”å®¤æˆå“¡è³‡æ ¼
  </a>
  
    <nav class="md-nav" aria-label="8.5 æª”å®¤æˆå“¡è³‡æ ¼">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#get-_matrixclientv3joined_rooms" class="md-nav__link">
    GET /_matrix/client/v3/joined_rooms
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#851" class="md-nav__link">
    8.5.1 é€£æ¥æˆ¿é–“
  </a>
  
    <nav class="md-nav" aria-label="8.5.1 é€£æ¥æˆ¿é–“">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#post-_matrixclientv3roomsroomidinvite" class="md-nav__link">
    POST /_matrix/client/v3/rooms/{roomId}/invite
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#post-_matrixclientv3joinroomidoralias" class="md-nav__link">
    POST /_matrix/client/v3/join/{roomIdOrAlias}
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#post-_matrixclientv3roomsroomidjoin" class="md-nav__link">
    POST /_matrix/client/v3/rooms/{roomId}/join
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#852" class="md-nav__link">
    8.5.2 é›¢é–‹æˆ¿é–“
  </a>
  
    <nav class="md-nav" aria-label="8.5.2 é›¢é–‹æˆ¿é–“">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#post-_matrixclientv3roomsroomidforget" class="md-nav__link">
    POST /_matrix/client/v3/rooms/{roomId}/forget
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#post-_matrixclientv3roomsroomidleave" class="md-nav__link">
    POST /_matrix/client/v3/rooms/{roomId}/leave
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#post-_matrixclientv3roomsroomidkick" class="md-nav__link">
    POST /_matrix/client/v3/rooms/{roomId}/kick
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#86" class="md-nav__link">
    8.6 åˆ—å‡ºæˆ¿é–“
  </a>
  
    <nav class="md-nav" aria-label="8.6 åˆ—å‡ºæˆ¿é–“">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#get-_matrixclientv3directorylistroomroomid" class="md-nav__link">
    GET /_matrix/client/v3/directory/list/room/{roomId}
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#put-_matrixclientv3directorylistroomroomid" class="md-nav__link">
    PUT /_matrix/client/v3/directory/list/room/{roomId}
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#get-_matrixclientv3publicrooms" class="md-nav__link">
    GET /_matrix/client/v3/publicRooms
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#9" class="md-nav__link">
    9 ç”¨æˆ¶æ•¸æ“š
  </a>
  
    <nav class="md-nav" aria-label="9 ç”¨æˆ¶æ•¸æ“š">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#91" class="md-nav__link">
    9.1 ç”¨æˆ¶ç›®éŒ„
  </a>
  
    <nav class="md-nav" aria-label="9.1 ç”¨æˆ¶ç›®éŒ„">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#post-_matrixclientv3user_directorysearch" class="md-nav__link">
    POST /_matrix/client/v3/user_directory/search
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#92" class="md-nav__link">
    9.2 é…ç½® æª”
  </a>
  
    <nav class="md-nav" aria-label="9.2 é…ç½® æª”">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#get-_matrixclientv3profileuserid" class="md-nav__link">
    GET /_matrix/client/v3/profile/{userId}
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#get-_matrixclientv3profileuseridavatar_url" class="md-nav__link">
    GET /_matrix/client/v3/profile/{userId}/avatar_url
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#put-_matrixclientv3profileuseridavatar_url" class="md-nav__link">
    PUT /_matrix/client/v3/profile/{userId}/avatar_url
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#get-_matrixclientv3profileuseriddisplayname" class="md-nav__link">
    GET /_matrix/client/v3/profile/{userId}/displayname
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#put-_matrixclientv3profileuseriddisplayname" class="md-nav__link">
    PUT /_matrix/client/v3/profile/{userId}/displayname
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#921" class="md-nav__link">
    9.2.1 å€‹äººè³‡æ–™è³‡è¨Šè®Šæ›´äº‹ä»¶
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#10" class="md-nav__link">
    10 å®‰å…¨
  </a>
  
    <nav class="md-nav" aria-label="10 å®‰å…¨">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#101" class="md-nav__link">
    10.1 é€Ÿç‡é™åˆ¶
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#11_1" class="md-nav__link">
    11 æ¨¡çµ„
  </a>
  
    <nav class="md-nav" aria-label="11 æ¨¡çµ„">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#111_1" class="md-nav__link">
    11.1 åŠŸèƒ½é…ç½®æª”
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#112_1" class="md-nav__link">
    11.2 å³æ™‚é€šè¨Š
  </a>
  
    <nav class="md-nav" aria-label="11.2 å³æ™‚é€šè¨Š">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#1121" class="md-nav__link">
    11.2.1 äº‹ä»¶
  </a>
  
    <nav class="md-nav" aria-label="11.2.1 äº‹ä»¶">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#mroommessage" class="md-nav__link">
    m.room.message
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#1122" class="md-nav__link">
    11.2.2 å®¢æˆ¶ç«¯è¡Œç‚º
  </a>
  
    <nav class="md-nav" aria-label="11.2.2 å®¢æˆ¶ç«¯è¡Œç‚º">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#_1" class="md-nav__link">
    ç™¼é€æ¶ˆæ¯æ™‚çš„å»ºè­°
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#_2" class="md-nav__link">
    æœ¬åœ°å›è²
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#_3" class="md-nav__link">
    è¨ˆç®—ä½¿ç”¨è€…çš„é¡¯ç¤ºåç¨±
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#_4" class="md-nav__link">
    ä½¿ç”¨æ¶ˆæ¯é¡¯ç¤ºæˆå“¡èº«ä»½è³‡è¨Š
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#_5" class="md-nav__link">
    è¨ˆç®—èŠå¤©å®¤çš„é¡¯ç¤ºåç¨±
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#_6" class="md-nav__link">
    åŠ‡é€æ¶ˆæ¯
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#_7" class="md-nav__link">
    ä¼ºæœå™¨è¡Œç‚º
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#_8" class="md-nav__link">
    å®‰å…¨æ³¨æ„äº‹é …
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#113" class="md-nav__link">
    11.3 è±å¯Œçš„å›å¾©
  </a>
  
    <nav class="md-nav" aria-label="11.3 è±å¯Œçš„å›å¾©">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#_9" class="md-nav__link">
    è±å¯Œå›å¾©çš„å›é€€
  </a>
  
    <nav class="md-nav" aria-label="è±å¯Œå›å¾©çš„å›é€€">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#_10" class="md-nav__link">
    å‰é›¢å›é€€
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#mtextmnotice" class="md-nav__link">
    "m.text"ã€"m.notice"å’Œç„¡æ³•è­˜åˆ¥çš„æ¶ˆæ¯é¡å‹çš„å›é€€
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#memote" class="md-nav__link">
    "m.emote"çš„å›é€€
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#mimagemvideomaudiomfile" class="md-nav__link">
    "m.image"ã€"m.video"ã€"m.audio"å’Œ"m.file"çš„å›é€€
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#114-ip" class="md-nav__link">
    11.4 IP èªéŸ³
  </a>
  
    <nav class="md-nav" aria-label="11.4 IP èªéŸ³">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#1141" class="md-nav__link">
    11.4.1 äº‹ä»¶
  </a>
  
    <nav class="md-nav" aria-label="11.4.1 äº‹ä»¶">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#mcallanswer" class="md-nav__link">
    m.call.answer
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#_11" class="md-nav__link">
    å®¢æˆ¶ç«¯è¡Œç‚º
  </a>
  
    <nav class="md-nav" aria-label="å®¢æˆ¶ç«¯è¡Œç‚º">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#_12" class="md-nav__link">
    çœ©å…‰
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#1143" class="md-nav__link">
    11.4.3 ä¼ºæœå™¨è¡Œç‚º
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#1144" class="md-nav__link">
    11.4.4 å®‰å…¨æ³¨æ„äº‹é …
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#115" class="md-nav__link">
    11.5 éµå…¥é€šçŸ¥
  </a>
  
    <nav class="md-nav" aria-label="11.5 éµå…¥é€šçŸ¥">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#_13" class="md-nav__link">
    äº‹ä»¶
  </a>
  
    <nav class="md-nav" aria-label="äº‹ä»¶">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#mtyping" class="md-nav__link">
    m.typing
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#_14" class="md-nav__link">
    å®¢æˆ¶ç«¯è¡Œç‚º
  </a>
  
    <nav class="md-nav" aria-label="å®¢æˆ¶ç«¯è¡Œç‚º">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#put-_matrixclientv3roomsroomidtypinguserid" class="md-nav__link">
    PUT /_matrix/client/v3/rooms/{roomId}/typing/{userId}
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#_15" class="md-nav__link">
    å®‰å…¨æ³¨æ„äº‹é …
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#116" class="md-nav__link">
    11.6 æ”¶æ“š
  </a>
  
    <nav class="md-nav" aria-label="11.6 æ”¶æ“š">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#_16" class="md-nav__link">
    äº‹ä»¶
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#mreceipt" class="md-nav__link">
    m.receipt
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#_17" class="md-nav__link">
    å®¢æˆ¶ç«¯è¡Œç‚º
  </a>
  
    <nav class="md-nav" aria-label="å®¢æˆ¶ç«¯è¡Œç‚º">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#post-_matrixclientv3roomsroomidreceiptreceipttypeeventid" class="md-nav__link">
    POST /_matrix/client/v3/rooms/{roomId}/receipt/{receiptType}/{eventId}
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#_18" class="md-nav__link">
    ç§äººå·²è®€å›åŸ·
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#_19" class="md-nav__link">
    ç·šç¨‹å¼è®€å›åŸ·
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#_20" class="md-nav__link">
    ä¼ºæœå™¨è¡Œç‚º
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#_21" class="md-nav__link">
    å®‰å…¨æ³¨æ„äº‹é …
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
    </ul>
  
</nav>
                  </div>
                </div>
              </div>
            
          
          
            <div class="md-content" data-md-component="content">
              <article class="md-content__inner md-typeset">
                
                  


<h1 id="-">å®¢æˆ·ç«¯-æœåŠ¡å™¨æ¥å£</h1>
<hr />
<p>å®¢æˆ·ç«¯-æœåŠ¡å™¨ API å…è®¸å®¢æˆ·ç«¯ å‘é€æ¶ˆæ¯,æ§åˆ¶æˆ¿é—´å’ŒåŒæ­¥å¯¹è¯å†å²è®°å½•ã€‚æ˜¯çš„ æ—¨åœ¨æ”¯æŒä¸å­˜å‚¨çŠ¶æ€çš„è½»é‡çº§å®¢æˆ·ç«¯å’Œ æ ¹æ®éœ€è¦ä»æœåŠ¡å™¨å»¶è¿ŸåŠ è½½æ•°æ® - ä»¥åŠé‡é‡çº§æ•°æ® ç»´æŠ¤æœåŠ¡å™¨çŠ¶æ€çš„å®Œæ•´æœ¬åœ°æŒä¹…å‰¯æœ¬çš„å®¢æˆ·ç«¯ã€‚</p>
<h2 id="1">1.æ¥å£æ ‡å‡†</h2>
<p>Matrix ä¸­å®¢æˆ·ç«¯-æœåŠ¡å™¨é€šä¿¡çš„å¼ºåˆ¶åŸºçº¿æ˜¯ é€šè¿‡ HTTP API äº¤æ¢ JSON å¯¹è±¡ã€‚æ›´é«˜æ•ˆçš„è¿è¾“å¯èƒ½æ˜¯ å°†æ¥æŒ‡å®šä¸ºå¯é€‰æ‰©å±•ã€‚</p>
<p>å»ºè®®ä½¿ç”¨ HTTPS è¿›è¡Œé€šä¿¡ã€‚ä½¿ç”¨çº¯ HTTP ä¸æ˜¯ æ¨èçš„å¤–éƒ¨æµ‹è¯•ç¯å¢ƒã€‚</p>
<p>å®¢æˆ·ç«¯ä½¿ç”¨ä¸é€æ˜å­—ç¬¦ä¸²access_tokenè¿›è¡Œèº«ä»½éªŒè¯ã€‚</p>
<p>æ‰€æœ‰å’Œç«¯ç‚¹,é™¤äº† POST /_matrix/media/v3/upload å’Œ PUT /_matrix/media/v3/upload/{serverName}/{mediaId}, è¦æ±‚å®¢æˆ·ç«¯æä¾›åŒ…å«ï¼ˆå¯èƒ½ä¸ºç©ºï¼‰çš„è¯·æ±‚æ­£æ–‡POST
JSON å¯¹è±¡ã€‚å®¢æˆ·ç«¯åº”ä¸ºå…·æœ‰PUT JSON æ­£æ–‡çš„æ‰€æœ‰è¯·æ±‚æä¾›æ ‡å¤´Content-Type application/json,ä½†è¿™ä¸æ˜¯å¿…éœ€çš„ã€‚</p>
<p>åŒæ ·,æ‰€æœ‰ç«¯ç‚¹éƒ½è¦æ±‚æœåŠ¡å™¨è¿”å› JSON å¯¹è±¡, é™¤äº†å¯¹ GET /<em>matrix/media/v200/download/{serverName}/{mediaId} å’Œ GET /</em>
matrix/media/v3/thumbnail/{serverName}/{mediaId} çš„ 3 ä¸ªå“åº”ã€‚ æœåŠ¡å™¨å¿…é¡»åŒ…å«æ‰€æœ‰ JSON å“åº”çš„æ ‡å¤´ã€‚Content-Typeapplication/json</p>
<p>è¯·æ±‚æˆ–å“åº”ä¸­çš„æ‰€æœ‰ JSON æ•°æ®éƒ½å¿…é¡»ä½¿ç”¨ UTF-8 è¿›è¡Œç¼–ç ã€‚</p>
<p>å¦è¯·å‚é˜…é™„å½•ä¸­çš„çŸ©é˜µ API çº¦å®š,äº†è§£æ‰€æœ‰çŸ©é˜µ API åº”éµå¾ªçš„çº¦å®š, å’Œä¸‹é¢çš„ Web æµè§ˆå™¨å®¢æˆ·ç«¯ä»¥è·å–å…¶ä»– æœåŠ¡å™¨å“åº”çš„è¦æ±‚ã€‚</p>
<h3 id="11">1.1 æ ‡å‡†é”™è¯¯å“åº”</h3>
<p>åœ¨çŸ©é˜µAPIçº§åˆ«å‘ç”Ÿçš„ä»»ä½•é”™è¯¯éƒ½å¿…é¡»è¿”å›"æ ‡å‡†" é”™è¯¯å“åº”"ã€‚è¿™æ˜¯ä¸€ä¸ª JSON å¯¹è±¡,å¦‚ä¸‹æ‰€ç¤º:</p>
<pre><code class="language-json">{
  &quot;errcode&quot;: &quot;&lt;error code&gt;&quot;,
  &quot;error&quot;: &quot;&lt;error message&gt;&quot;
}
</code></pre>
<p>è¯¥å­—ç¬¦ä¸²å°†æ˜¯äººç±»å¯è¯»çš„é”™è¯¯æ¶ˆæ¯,é€šå¸¸ä¸º è§£é‡Šå‡ºäº†ä»€ä¹ˆé—®é¢˜çš„å¥å­ã€‚error</p>
<p>è¯¥å­—ç¬¦ä¸²å°†æ˜¯ä¸€ä¸ªå”¯ä¸€çš„å­—ç¬¦ä¸²,å¯ç”¨äºå¤„ç† é”™è¯¯æ¶ˆæ¯,ä¾‹å¦‚ .é”™è¯¯ä»£ç åº”å…·æœ‰å…¶å‘½åç©ºé—´ åœ¨æ‰€æœ‰å¤§å†™å­—æ¯ä¸­é¦–å…ˆ,ç„¶åæ˜¯å•ä¸ª.ä¾‹å¦‚,å¦‚æœæœ‰è‡ªå®šä¹‰ å‘½åç©ºé—´å’Œä»£ç ,é”™è¯¯ä»£ç åº” è‚–ã€‚ç”±æ­¤å®šä¹‰çš„é”™è¯¯ä»£ç 
è§„èŒƒåº”è¯¥å¼€å§‹ã€‚errcodeM_FORBIDDEN_com.mydomain.hereFORBIDDENCOM.MYDOMAIN.HERE_FORBIDDENM_</p>
<p>ä¸€äº›å®šä¹‰äº†é”™è¯¯ä¸­åº”è¯¥å­˜åœ¨çš„å…¶ä»–é”® å“åº”å¯¹è±¡,ä½†é”®å’Œå¿…é¡»å§‹ç»ˆå­˜åœ¨ã€‚errcodeerrorerrcode</p>
<p>é”™è¯¯é€šå¸¸æœ€å¥½ç”±å…¶é”™è¯¯ä»£ç è¡¨ç¤º,è€Œä¸æ˜¯ è¿”å›çš„ HTTP çŠ¶æ€ä»£ç ã€‚é‡åˆ°é”™è¯¯ç æ—¶, å®¢æˆ·ç«¯åº”é¦–é€‰ HTTP çŠ¶æ€ä»£ç ä½œä¸ºæ›´å¯é çš„å‚è€ƒ é—®é¢˜æ˜¯ä»€ä¹ˆã€‚ä¾‹å¦‚,å¦‚æœå®¢æˆ·ç«¯æ”¶åˆ°é”™è¯¯ çš„ä»£ç ,ä½†è¯·æ±‚ç»™å‡ºäº† 400 é”™è¯¯è¯·æ±‚çŠ¶æ€
ä»£ç ,å®¢æˆ·ç«¯åº”å°†é”™è¯¯è§†ä¸ºèµ„æºä¸æ˜¯ å‘ç°ã€‚ä½†æ˜¯,å¦‚æœå®¢æˆ·ç«¯æ”¶åˆ°é”™è¯¯ä»£ç  400 é”™è¯¯è¯·æ±‚,åˆ™å®¢æˆ·ç«¯åº”å‡å®š è¯·æ±‚æ— æ•ˆã€‚M_UNKNOWNM_NOT_FOUNDM_UNKNOWN</p>
<h4 id="111">1.1.1 å¸¸è§é”™è¯¯</h4>
<p>ä»»ä½• API ç«¯ç‚¹éƒ½å¯ä»¥è¿”å›è¿™äº›é”™è¯¯ä»£ç :</p>
<p>M_FORBIDDENç¦æ­¢è®¿é—®,ä¾‹å¦‚æœªç»è®¸å¯åŠ å…¥æˆ¿é—´,ç™»å½•å¤±è´¥ã€‚</p>
<p>M_UNKNOWN_TOKENæ— æ³•è¯†åˆ«æŒ‡å®šçš„è®¿é—®æˆ–åˆ·æ–°ä»¤ç‰Œã€‚</p>
<p>å…¶ä»–å“åº”å‚æ•° ä¸Šå¯èƒ½å­˜åœ¨ å“åº” 401 HTTP çŠ¶æ€ä»£ç ã€‚æŸ¥çœ‹è½¯æ³¨é”€ éƒ¨åˆ†äº†è§£æ›´å¤šä¿¡æ¯ã€‚soft_logout</p>
<p>M_MISSING_TOKENæ²¡æœ‰ä¸ºè¯·æ±‚æŒ‡å®šè®¿é—®ä»¤ç‰Œã€‚</p>
<p>M_BAD_JSONè¯·æ±‚åŒ…å«æœ‰æ•ˆçš„ JSON,ä½†æ ¼å¼ä»¥æŸç§æ–¹å¼ä¸æ­£ç¡®,ä¾‹å¦‚ ç¼ºå°‘å¿…éœ€çš„é”®,é”®çš„å€¼æ— æ•ˆã€‚</p>
<p>M_NOT_JSONè¯·æ±‚ä¸åŒ…å«æœ‰æ•ˆçš„ JSONã€‚</p>
<p>M_NOT_FOUNDæ‰¾ä¸åˆ°æ­¤è¯·æ±‚çš„èµ„æºã€‚</p>
<p>M_LIMIT_EXCEEDEDåœ¨çŸ­æ—¶é—´å†…å‘é€äº†å¤ªå¤šè¯·æ±‚ã€‚ç¨ç­‰ç‰‡åˆ» ç„¶åé‡è¯•ã€‚</p>
<p>M_UNRECOGNIZEDæœåŠ¡å™¨æ— æ³•ç†è§£è¯¥è¯·æ±‚ã€‚é¢„è®¡è¿™å°†è¿”å› 404 HTTP çŠ¶æ€ä»£ç ï¼ˆå¦‚æœç»ˆç»“ç‚¹æœªå®ç°ï¼‰æˆ– 405 HTTP çŠ¶æ€ ä»£ç ï¼ˆå¦‚æœç»ˆç»“ç‚¹å·²å®ç°,ä½†ä½¿ç”¨äº†ä¸æ­£ç¡®çš„ HTTP æ–¹æ³•ï¼‰ã€‚</p>
<p>M_UNKNOWNå‘ç”ŸæœªçŸ¥é”™è¯¯ã€‚</p>
<h4 id="112">1.1.2 å…¶ä»–é”™è¯¯ä»£ç </h4>
<p>ä»¥ä¸‹é”™è¯¯ä»£ç ç‰¹å®šäºæŸäº›ç»ˆç»“ç‚¹ã€‚</p>
<p>M_UNAUTHORIZEDè¯·æ±‚æœªæ­£ç¡®æˆæƒã€‚é€šå¸¸æ˜¯ç”±äºç™»å½•å¤±è´¥ã€‚</p>
<p>M_USER_DEACTIVATEDä¸è¯·æ±‚å…³è”çš„ç”¨æˆ·æ ‡è¯†å·²è¢«åœç”¨ã€‚é€šå¸¸ å¯¹äºè¯æ˜èº«ä»½éªŒè¯çš„ç»ˆç»“ç‚¹,ä¾‹å¦‚ ã€‚/login</p>
<p>M_USER_IN_USEå°è¯•æ³¨å†Œå·²å ç”¨çš„ç”¨æˆ· ID æ—¶é‡åˆ°æ­¤é—®é¢˜ã€‚</p>
<p>M_INVALID_USERNAMEå°è¯•æ³¨å†Œæ— æ•ˆçš„ç”¨æˆ· ID æ—¶é‡åˆ°ã€‚</p>
<p>M_ROOM_IN_USEå½“æä¾›ç»™ API çš„æˆ¿é—´åˆ«åå·²åœ¨ ä¸­æ—¶å‘é€ ç”¨ã€‚createRoom</p>
<p>M_INVALID_ROOM_STATEå½“æä¾›ç»™ API çš„åˆå§‹çŠ¶æ€æ— æ•ˆæ—¶å‘é€ã€‚createRoom</p>
<p>M_THREEPID_IN_USEå½“æä¾›ç»™ API çš„ä¸‰pid æ— æ³•ä½¿ç”¨æ—¶å‘é€,å› ä¸ºç›¸åŒ ä¸‰PIDå·²ç»åœ¨ä½¿ç”¨ä¸­ã€‚</p>
<p>M_THREEPID_NOT_FOUNDå½“æä¾›ç»™ API çš„ä¸‰ pid ç”±äºæ²¡æœ‰è®°å½•è€Œæ— æ³•ä½¿ç”¨æ—¶å‘é€ æ‰¾åˆ°äº†åŒ¹é…çš„ä¸‰çš®ã€‚</p>
<p>M_THREEPID_AUTH_FAILEDæ— æ³•å¯¹ç¬¬ä¸‰æ–¹æ ‡è¯†ç¬¦æ‰§è¡Œèº«ä»½éªŒè¯ã€‚</p>
<p>M_THREEPID_DENIEDæœåŠ¡å™¨ä¸å…è®¸ä½¿ç”¨æ­¤ç¬¬ä¸‰æ–¹æ ‡è¯†ç¬¦ã€‚è¿™å¯èƒ½ä¼šå‘ç”Ÿ ä¾‹å¦‚,å¦‚æœæœåŠ¡å™¨åªå…è®¸æ¥è‡ª ç‰¹å®šåŸŸã€‚</p>
<p>M_SERVER_NOT_TRUSTEDå®¢æˆ·ç«¯çš„è¯·æ±‚ä½¿ç”¨äº†ç¬¬ä¸‰æ–¹æœåŠ¡å™¨,ä¾‹å¦‚èº«ä»½æœåŠ¡å™¨, æ­¤æœåŠ¡å™¨ä¸ä¿¡ä»»ã€‚</p>
<p>M_UNSUPPORTED_ROOM_VERSIONå®¢æˆ·ç«¯åˆ›å»ºæˆ¿é—´çš„è¯·æ±‚ä½¿ç”¨äº† æœåŠ¡å™¨ä¸æ”¯æŒã€‚</p>
<p>M_INCOMPATIBLE_ROOM_VERSIONå®¢æˆ·ç«¯å°è¯•åŠ å…¥å…·æœ‰æœåŠ¡å™¨ç‰ˆæœ¬çš„æ–‡ä»¶å®¤ ä¸æ”¯æŒã€‚æ£€æŸ¥é”™è¯¯å“åº”çš„å±æ€§ å¯¹äºæˆ¿é—´çš„ç‰ˆæœ¬ã€‚room_version</p>
<p>M_BAD_STATEæ— æ³•æ‰§è¡Œè¯·æ±‚çš„çŠ¶æ€æ›´æ”¹,ä¾‹å¦‚å°è¯• å–æ¶ˆç¦æ­¢æœªè¢«ç¦æ­¢çš„ç”¨æˆ·ã€‚</p>
<p>M_GUEST_ACCESS_FORBIDDENå®¢æˆ¿æˆ–èµ„æºä¸å…è®¸å®¢äººè®¿é—®ã€‚</p>
<p>M_CAPTCHA_NEEDEDéœ€è¦éªŒè¯ç æ‰èƒ½å®Œæˆè¯·æ±‚ã€‚</p>
<p>M_CAPTCHA_INVALIDæä¾›çš„éªŒè¯ç ä¸é¢„æœŸä¸ç¬¦ã€‚</p>
<p>M_MISSING_PARAMè¯·æ±‚ä¸­ç¼ºå°‘å¿…éœ€å‚æ•°ã€‚</p>
<p>M_INVALID_PARAMæŒ‡å®šçš„å‚æ•°å…·æœ‰é”™è¯¯çš„å€¼ã€‚ä¾‹å¦‚, æœåŠ¡å™¨éœ€è¦ä¸€ä¸ªæ•´æ•°,è€Œæ˜¯æ”¶åˆ°ä¸€ä¸ªå­—ç¬¦ä¸²ã€‚</p>
<p>M_TOO_LARGEè¯·æ±‚æˆ–å®ä½“å¤ªå¤§ã€‚</p>
<p>M_EXCLUSIVEè¯·æ±‚çš„èµ„æºç”±åº”ç”¨ç¨‹åºæœåŠ¡ä¿ç•™,æˆ–è€… å‘å‡ºè¯·æ±‚çš„åº”ç”¨ç¨‹åºæœåŠ¡å°šæœªåˆ›å»ºèµ„æºã€‚</p>
<p>M_RESOURCE_LIMIT_EXCEEDEDæ— æ³•å®Œæˆè¯·æ±‚,å› ä¸ºä¸»æœåŠ¡å™¨å·²è¾¾åˆ° å¯¹å…¶æ–½åŠ çš„èµ„æºé™åˆ¶ã€‚ä¾‹å¦‚,å…±äº«ä¸­ä¿å­˜çš„å®¶åº­æœåŠ¡å™¨ å¦‚æœæ‰˜ç®¡ç¯å¢ƒä¹Ÿå¼€å§‹ä½¿ç”¨,åˆ™å¯èƒ½ä¼šè¾¾åˆ°èµ„æºé™åˆ¶ å¤§é‡å†…å­˜æˆ–ç£ç›˜ç©ºé—´ã€‚é”™è¯¯å¿…é¡»æœ‰ä¸€ä¸ªå­—æ®µ
ä¸ºæ”¶åˆ°é”™è¯¯çš„ç”¨æˆ·æä¾›ä¸€ä¸ªå¯ä»¥è”ç³»çš„åœ°æ–¹ã€‚ é€šå¸¸,æ­¤é”™è¯¯å°†å‡ºç°åœ¨å°è¯•ä¿®æ”¹çš„è·¯ç”±ä¸Š çŠ¶æ€ï¼ˆä¾‹å¦‚:å‘é€æ¶ˆæ¯,å¸æˆ·æ•°æ®ç­‰ï¼‰è€Œä¸æ˜¯è·¯ç”± ä»…è¯»å–çŠ¶æ€ï¼ˆä¾‹å¦‚:,è·å–å¸æˆ·æ•°æ®ç­‰ï¼‰ã€‚admin_contact/sync</p>
<p>M_CANNOT_LEAVE_SERVER_NOTICE_ROOMç”¨æˆ·æ— æ³•æ‹’ç»åŠ å…¥æœåŠ¡å™¨é€šçŸ¥å®¤çš„é‚€è¯·ã€‚ æœ‰å…³è¯¦ç»†ä¿¡æ¯,è¯·å‚é˜…æœåŠ¡å™¨é€šçŸ¥æ¨¡å—ã€‚</p>
<h3 id="12">1.2 äº¤æ˜“æ ‡è¯†ç¬¦</h3>
<p>å®¢æˆ·ç«¯-æœåŠ¡å™¨ API é€šå¸¸ç”¨äºæäº¤è¯·æ±‚ HTTP è·¯å¾„ä¸­å®¢æˆ·ç«¯ç”Ÿæˆçš„äº‹åŠ¡æ ‡è¯†ç¬¦ã€‚HTTP PUT</p>
<p>äº‹åŠ¡ ID çš„ç›®çš„æ˜¯å…è®¸ä¸»æœåŠ¡å™¨åŒºåˆ† æ¥è‡ªå…ˆå‰è¯·æ±‚çš„é‡æ–°ä¼ è¾“çš„æ–°è¯·æ±‚,ä»¥ä¾¿å®ƒå¯ä»¥å‘å‡º è¯·æ±‚å¹‚ç­‰ã€‚</p>
<p>äº¤æ˜“ ID åªèƒ½ç”¨äºæ­¤ç›®çš„ã€‚</p>
<p>ä»å®¢æˆ·ç«¯çš„è§’åº¦æ¥çœ‹,åœ¨è¯·æ±‚å®Œæˆå,åº”ä¸ºä¸‹ä¸€ä¸ªè¯·æ±‚æ›´æ”¹å€¼ï¼ˆæœªæŒ‡å®š how;a å»ºè®®å•è°ƒé€’å¢æ•´æ•°ï¼‰ã€‚{txnId}</p>
<p>å¦‚æœ äº‹åŠ¡ ID ä¸ä¸Šä¸€ä¸ªè¯·æ±‚ç›¸åŒ,å¹¶ä¸” HTTP è¯·æ±‚æ˜¯ç›¸åŒçš„ã€‚</p>
<p>å¦‚æœå·²è¯†åˆ«å‡ºé‡ä¼ ,åˆ™ä¸»æœåŠ¡å™¨åº”è¿”å› ä¸åŸå§‹è¯·æ±‚ç›¸åŒçš„ HTTP å“åº”ä»£ç å’Œå†…å®¹ã€‚ ä¾‹å¦‚,å°†è¿”å›ä¸€ä¸ª ä¸åŸå§‹è¯·æ±‚ å“åº”æ­£æ–‡ã€‚PUT /_
matrix/client/v3/rooms/{roomId}/send/{eventType}/{txnId}200 OKevent_id</p>
<p>é™¤äº† HTTP è·¯å¾„,äº‹åŠ¡ ID çš„ä½œç”¨åŸŸæ˜¯"å®¢æˆ·ç«¯" ä¼šè¯",å…¶ä¸­è¯¥ä¼šè¯ç”±ç‰¹å®šè®¿é—®ä»¤ç‰Œæ ‡è¯†ã€‚ åˆ·æ–°è®¿é—®ä»¤ç‰Œæ—¶, ä¿ç•™äº‹åŠ¡ ID çš„èŒƒå›´ã€‚è¿™æ„å‘³ç€å¦‚æœå®¢æˆ·ç«¯ ä»¤ç‰Œç”¨ä½œå…¶äº‹åŠ¡ ID,å°†ä»¤ç‰Œåˆ·æ–°ä¸º ,å¹¶å†æ¬¡ä½¿ç”¨å®ƒ,è¿™å°†è¢«å‡å®šä¸ºé‡å¤è¯·æ±‚
å¹¶è¢«å¿½ç•¥ã€‚å¦‚æœå®¢æˆ·ç«¯æ³¨é”€å¹¶åœ¨ å’Œ ä»¤ç‰Œä¹‹é—´é‡æ–°æ³¨é”€,åˆ™å¯ä»¥ä¸ºæ¯ä¸ªä»¤ç‰Œä½¿ç”¨ä¸€æ¬¡ã€‚ATXN1BTXN1ABTXN1</p>
<p>æŸäº› API ç«¯ç‚¹å¯èƒ½å…è®¸æˆ–è¦æ±‚ä½¿ç”¨è¯·æ±‚ æ²¡æœ‰äº¤æ˜“ IDã€‚å¦‚æœè¿™æ˜¯å¯é€‰çš„,å¼ºçƒˆå»ºè®®ä½¿ç”¨è¯·æ±‚ã€‚POSTPUT</p>
<h2 id="2">2.ç½‘é¡µæµè§ˆå™¨å®¢æˆ·ç«¯</h2>
<p>æœŸæœ›æŸäº›å®¢æˆ·ç«¯å°†è¢«å†™å…¥ä»¥è¿è¡Œæ˜¯ç°å®çš„ åœ¨ Web æµè§ˆå™¨æˆ–ç±»ä¼¼ç¯å¢ƒä¸­ã€‚åœ¨è¿™äº›æƒ…å†µä¸‹, ä¸»æœåŠ¡å™¨åº”å“åº”é£è¡Œå‰è¯·æ±‚å¹¶æä¾›è·¨æº æ‰€æœ‰è¯·æ±‚ä¸Šçš„èµ„æºå…±äº« ï¼ˆCORSï¼‰ æ ‡å¤´ã€‚</p>
<p>æœåŠ¡å™¨å¿…é¡»æœŸæœ›å®¢æˆ·ç«¯ä¼šé€šè¿‡è¯·æ±‚æ¥è¿‘å®ƒä»¬,ä»è€Œå…è®¸å®¢æˆ·ç«¯å‘ç° CORS æ ‡å¤´ã€‚æ‰€æœ‰ç«¯ç‚¹ åœ¨æ­¤è§„èŒƒä¸­æ”¯æŒè¯¥æ–¹æ³•,ä½†æ˜¯æœåŠ¡å™¨ åœ¨æ¥è¿‘ç«¯ç‚¹æ—¶,ä¸å¾—æ‰§è¡Œä¸ºç«¯ç‚¹å®šä¹‰çš„ä»»ä½•é€»è¾‘ ä¸è¯·æ±‚ã€‚OPTIONSOPTIONSOPTIONS</p>
<p>å½“å®¢æˆ·ç«¯å‘æœåŠ¡å™¨å‘å‡ºè¯·æ±‚æ—¶,æœåŠ¡å™¨åº” ä½¿ç”¨è¯¥è·¯ç”±çš„ CORS æ ‡å¤´è¿›è¡Œå“åº”ã€‚æ¨èçš„å¯æ›¿ä»£èµ„æºä¿æŠ¤è®¡åˆ’ æœåŠ¡å™¨åœ¨æ‰€æœ‰è¯·æ±‚ä¸Šè¿”å›çš„æ ‡å¤´åŒ…æ‹¬:</p>
<pre><code class="language-yaml">    Access-Control-Allow-Origin: *
    Access-Control-Allow-Methods: GET, POST, PUT, DELETE, OPTIONS
    Access-Control-Allow-Headers: X-Requested-With, Content-Type, Authorization
</code></pre>
<h2 id="3">3.æœåŠ¡å™¨å‘ç°</h2>
<p>ä¸ºäº†å…è®¸ç”¨æˆ·è¿æ¥åˆ°çŸ©é˜µæœåŠ¡å™¨è€Œæ— éœ€ æ˜¾å¼æŒ‡å®šä¸»æœåŠ¡å™¨çš„ URL æˆ–å…¶ä»–å‚æ•°,å®¢æˆ·ç«¯ åº”ä½¿ç”¨è‡ªåŠ¨å‘ç°æœºåˆ¶æ¥ç¡®å®šæœåŠ¡å™¨çš„ URL åŸºäºç”¨æˆ·çš„çŸ©é˜µ IDã€‚è‡ªåŠ¨å‘ç°åªèƒ½åœ¨ç™»å½•æ—¶å®Œæˆ æ—¶é—´ã€‚</p>
<p>åœ¨æœ¬èŠ‚ä¸­,ä»¥ä¸‹æœ¯è¯­å…·æœ‰ç‰¹å®šå«ä¹‰:</p>
<p>PROMPTä»ç”¨æˆ·é‚£é‡Œæ£€ç´¢ç‰¹å®šä¿¡æ¯çš„æ–¹å¼ é€‚åˆç°æœ‰çš„å®¢æˆ·ç«¯ç”¨æˆ·ä½“éªŒï¼ˆå¦‚æœå®¢æˆ·ç«¯æ˜¯ å€¾å‘äºè¿™æ ·åšã€‚å¦‚æœæ²¡æœ‰å¥½çš„ç”¨æˆ·,åˆ™å¯èƒ½ä¼šå‘ç”Ÿæ•…éšœ åœ¨è¿™ä¸€ç‚¹ä¸Š,è¿™æ–¹é¢çš„ç»éªŒæ˜¯å¯èƒ½çš„ã€‚</p>
<p>IGNOREåœæ­¢å½“å‰çš„è‡ªåŠ¨å‘ç°æœºåˆ¶ã€‚å¦‚æœæ²¡æœ‰æ›´å¤šçš„è‡ªåŠ¨å‘ç° æœºåˆ¶æ˜¯å¯ç”¨çš„,é‚£ä¹ˆå®¢æˆ·ç«¯å¯ä»¥ä½¿ç”¨å…¶ä»–æ–¹æ³• ç¡®å®šæ‰€éœ€çš„å‚æ•°,ä¾‹å¦‚æç¤ºç”¨æˆ·,æˆ– ä½¿ç”¨é»˜è®¤å€¼ã€‚</p>
<p>FAIL_PROMPTé€šçŸ¥ç”¨æˆ·è‡ªåŠ¨å‘ç°ç”±äºæ•°æ®æ— æ•ˆ/ç©ºå’Œå‚æ•°è€Œå¤±è´¥ã€‚PROMPT</p>
<p>FAIL_ERRORé€šçŸ¥ç”¨æˆ·è‡ªåŠ¨å‘ç°æœªè¿”å›ä»»ä½•å¯ç”¨çš„ URLã€‚åš ä¸è¦ç»§ç»­å½“å‰ç™»å½•è¿‡ç¨‹ã€‚æ­¤æ—¶, å·²è·å–æœ‰æ•ˆæ•°æ®,ä½†æ²¡æœ‰æœåŠ¡å™¨å¯ç”¨äºä¸ºå®¢æˆ·ç«¯æä¾›æœåŠ¡ã€‚ ä¸åº”å°è¯•è¿›ä¸€æ­¥çŒœæµ‹,ç”¨æˆ·åº”è¿›è¡Œ è®¤çœŸå†³å®šä¸‹ä¸€æ­¥è¯¥åšä»€ä¹ˆã€‚</p>
<h3 id="31-well-known-uri">3.1 Well-known URI</h3>
<p>è¯¥æ–¹æ³•ä½¿ç”¨é¢„å®šä½ç½®çš„ JSON æ–‡ä»¶æ¥ æŒ‡å®šå‚æ•°å€¼ã€‚æ­¤æ–¹æ³•çš„æµç¨‹å¦‚ä¸‹:.well-known</p>
<ol>
<li>é€šè¿‡æ‹†åˆ† ç¬¬ä¸€ä¸ªå†’å·å¤„çš„çŸ©é˜µ IDã€‚</li>
<li>ä»æœåŠ¡å™¨åç§°ä¸­æå–ä¸»æœºåã€‚</li>
<li>å‘ å‘å‡º GET è¯·æ±‚ã€‚https://hostname/.well-known/matrix/client<ol>
<li>å¦‚æœè¿”å›çš„çŠ¶æ€ä»£ç ä¸º 404,åˆ™ .IGNORE</li>
<li>å¦‚æœè¿”å›çš„çŠ¶æ€ä»£ç ä¸æ˜¯ 200,æˆ–è€…å“åº”æ­£æ–‡ä¸º ç©ºçš„,ç„¶å.FAIL_PROMPT</li>
<li>å°†å“åº”æ­£æ–‡è§£æä¸º JSON å¯¹è±¡<ol>
<li>å¦‚æœæ— æ³•è§£æå†…å®¹,åˆ™ .FAIL_PROMPT</li>
</ol>
</li>
<li>ä»å±æ€§ä¸­æå–å€¼ã€‚ æ­¤å€¼å°†ç”¨ä½œä¸»æœåŠ¡å™¨çš„åŸºæœ¬ URLã€‚base_urlm.homeserver<ol>
<li>å¦‚æœæœªæä¾›æ­¤å€¼,åˆ™ .FAIL_PROMPT</li>
</ol>
</li>
<li>éªŒè¯ä¸»æœåŠ¡å™¨åŸºæœ¬ URL:<ol>
<li>å°†å…¶è§£æä¸º URLã€‚å¦‚æœå®ƒä¸æ˜¯ URL,åˆ™ .FAIL_ERROR</li>
<li>å®¢æˆ·ç«¯åº”éªŒè¯ URL æ˜¯å¦æŒ‡å‘æœ‰æ•ˆçš„ ä¸»æœåŠ¡å™¨ åœ¨æ¥å—å®ƒä¹‹å‰,é€šè¿‡è¿æ¥åˆ° /_matrix/å®¢æˆ·ç«¯/ç‰ˆæœ¬ç«¯ç‚¹,ç¡®ä¿å®ƒ ä¸è¿”å›é”™è¯¯,å¹¶è§£æå’ŒéªŒè¯ æ•°æ®ç¬¦åˆé¢„æœŸçš„å“åº”æ ¼å¼ã€‚å¦‚æœæœ‰ä»»ä½•æ­¥éª¤ åœ¨éªŒè¯å¤±è´¥æ—¶,.éªŒè¯æ˜¯
   ä½œä¸ºé’ˆå¯¹é…ç½®é”™è¯¯çš„ç®€å•æ£€æŸ¥å®Œæˆ,åœ¨ ä»¥ç¡®ä¿å‘ç°çš„åœ°å€æŒ‡å‘ æœ‰æ•ˆçš„ä¸»æœåŠ¡å™¨ã€‚FAIL_ERROR</li>
<li>è¯·åŠ¡å¿…æ³¨æ„,è¯¥å€¼å¯èƒ½åŒ…æ‹¬ å°¾éš .æ¶ˆè´¹è€…åº”å‡†å¤‡å¥½å¤„ç†è¿™ä¸¤ç§æƒ…å†µã€‚base_url/</li>
</ol>
</li>
<li>å¦‚æœè¯¥å±æ€§å­˜åœ¨,è¯·æå–å€¼ä»¥ç”¨ä½œèº«ä»½æœåŠ¡å™¨çš„åŸºæœ¬ URLã€‚ æ­¤ URL çš„éªŒè¯æŒ‰ä¸Šè¿°æ­¥éª¤å®Œæˆ,ä½†ç”¨ä½œè¦è¿æ¥åˆ°çš„ç»ˆç»“ç‚¹ã€‚å¦‚æœè¯¥å±æ€§å­˜åœ¨,ä½†æ²¡æœ‰å€¼,åˆ™ .m.identity_serverbase_url/_
   matrix/identity/v2m.identity_serverbase_urlFAIL_PROMPT</li>
</ol>
</li>
</ol>
<h4 id="get-well-knownmatrixclient">GET /.well-known/matrix/client</h4>
<p>è·å–æœ‰å…³åŸŸçš„å‘ç°ä¿¡æ¯ã€‚è¯¥æ–‡ä»¶å¯èƒ½åŒ…æ‹¬ é™„åŠ é”®,å¿…é¡»éµå¾ª Java åŒ…å‘½åçº¦å®š, ä¾‹å¦‚.è¿™å¯ç¡®ä¿å±æ€§åç§° ä¸ºæ¯ä¸ªåº”ç”¨ç¨‹åºé€‚å½“åœ°å‘½å,å¹¶é™ä½ å†²çªã€‚com.example.myapp.property</p>
<p>è¯·æ³¨æ„,æ­¤ç»ˆç»“ç‚¹ä¸ä¸€å®šç”±ä¸»æœåŠ¡å™¨å¤„ç†, ä½†ç”±å¦ä¸€ä¸ªç½‘ç»œæœåŠ¡å™¨ä½¿ç”¨,ç”¨äºå‘ç°ä¸»æœåŠ¡å™¨ URLã€‚</p>
<p>å“åº”ç¤ºä¾‹:</p>
<pre><code class="language-yaml">    {
  &quot;m.homeserver&quot;: {
    &quot;base_url&quot;: &quot;https://daodst.example.com&quot;
  },
  &quot;m.identity_server&quot;: {
    &quot;base_url&quot;: &quot;https://identity.example.com&quot;
  },
  &quot;org.example.custom.property&quot;: {
    &quot;app_url&quot;: &quot;https://custom.app.example.org&quot;
  }
}
</code></pre>
<h4 id="get-_matrixclientversions">GET /_matrix/client/versions</h4>
<p>è·å–æœåŠ¡å™¨æ”¯æŒçš„è§„èŒƒç‰ˆæœ¬ã€‚</p>
<p>å€¼å°†é‡‡ç”¨å½¢å¼æˆ–å†å²æ¡ˆä¾‹ã€‚æœ‰å…³è¯¦ç»†ä¿¡æ¯,è¯·å‚é˜…è§„èŒƒç‰ˆæœ¬æ§åˆ¶ ä¿¡æ¯ã€‚vX.YrX.Y.Z</p>
<p>æœåŠ¡å™¨å¯èƒ½ä¼šé¢å¤–å…¬å¸ƒå…¶æ”¯æŒçš„å®éªŒæ€§åŠŸèƒ½ é€šè¿‡ã€‚è¿™äº›åŠŸèƒ½åº”å…·æœ‰å‘½åç©ºé—´,å¹¶ä¸” å¦‚æœéœ€è¦,å¯ä»¥é€‰æ‹©åœ¨å…¶åç§°ä¸­åŒ…å«ç‰ˆæœ¬ä¿¡æ¯ã€‚ æ­¤å¤„åˆ—å‡ºçš„åŠŸèƒ½ä¸é€‚ç”¨äºé€‰æ‹©æ€§åˆ‡æ¢çŸ©é˜µçš„å„ä¸ªéƒ¨åˆ† è§„èŒƒ,åº”ä»…ç”¨äºæ’­å‘å¯¹åŠŸèƒ½çš„æ”¯æŒ å°šæœªè¿›å…¥è§„èŒƒã€‚ä¾‹å¦‚,å½“å‰åŠŸèƒ½ã€‚
æ­£åœ¨è¿›è¡Œææ¡ˆæµç¨‹å¯èƒ½ä¼šå‡ºç°åœ¨è¿™é‡Œå¹¶æœ€ç»ˆè¢«é‡‡çº³ ä¸€æ—¦åŠŸèƒ½è¿›å…¥è§„èŒƒå¹¶ä¸”æœåŠ¡å™¨è®¤ä¸ºå®ƒ,å°±è„±ç¦»æ­¤åˆ—è¡¨ è¿™æ ·åšæ˜¯åˆç†çš„ã€‚æœåŠ¡å™¨å¯èƒ½å¸Œæœ›åœ¨æ­¤å¤„ä¿ç•™å¹¿å‘ŠåŠŸèƒ½ åœ¨å®ƒä»¬è¢«å‘å¸ƒåˆ°è§„èŒƒä¸­å,è®©å®¢æˆ·æœ‰æœºä¼š é€‚å½“å‡çº§ã€‚æ­¤å¤–,å®¢æˆ·ç«¯åº”é¿å…ä½¿ç”¨ä¸ç¨³å®š
ç¨³å®šç‰ˆæœ¬ä¸­çš„åŠŸèƒ½ã€‚unstable_features</p>
<p>å“åº”ç¤ºä¾‹:</p>
<pre><code class="language-json">    {
  &quot;unstable_features&quot;: {
    &quot;org.example.my_feature&quot;: true
  },
  &quot;versions&quot;: [
    &quot;r0.0.1&quot;,
    &quot;v1.1&quot;
  ]
}
</code></pre>
<h2 id="4">4. å®¢æˆ·ç«¯èº«ä»½éªŒè¯</h2>
<p>å¤§å¤šæ•° API ç«¯ç‚¹è¦æ±‚ç”¨æˆ·é€šè¿‡å‘ˆç°æ¥æ ‡è¯†è‡ªå·± ä»¥å‰ä»¥æŸ¥è¯¢å½¢å¼è·å¾—çš„å‡­æ® access_tokenå‚æ•°æˆ–é€šè¿‡æˆæƒæ ‡å¤´ Bearer $access_tokenã€‚ è®¿é—®ä»¤ç‰Œé€šå¸¸é€šè¿‡ç™»å½•æˆ–æ³¨å†Œè¿‡ç¨‹è·å–ã€‚è®¿é—®ä»¤ç‰Œ
å¯ä»¥è¿‡æœŸ;å¯ä»¥ä½¿ç”¨åˆ·æ–°ä»¤ç‰Œç”Ÿæˆæ–°çš„è®¿é—®ä»¤ç‰Œã€‚</p>
<h3 id="41">4.1 ä½¿ç”¨è®¿é—®ä»¤ç‰Œ</h3>
<p>è®¿é—®ä»¤ç‰Œå¯ä»¥é€šè¿‡ä¸¤ç§æ–¹å¼æä¾›,è¿™ä¸¤ç§æ–¹å¼éƒ½æ˜¯ä¸»æœåŠ¡å™¨ å¿…é¡»æ”¯æŒ:</p>
<pre><code>1. é€šè¿‡æŸ¥è¯¢å­—ç¬¦ä¸²å‚æ•° .access_token=TheTokenHere 
2. é€šè¿‡è¯·æ±‚æ ‡å¤´ .Authorization: Bearer TheTokenHere
</code></pre>
<p>é¼“åŠ±å®¢æˆ·å°½å¯èƒ½ä½¿ç”¨æ ‡å¤´ ä»¥é˜²æ­¢è®¿é—®ä»¤ç‰Œåœ¨è®¿é—®/HTTP æ—¥å¿—ä¸­æ³„éœ²ã€‚æŸ¥è¯¢ å­—ç¬¦ä¸²åº”ä»…åœ¨æ ‡å¤´ä¸º å®¢æˆ·ç«¯æ— æ³•è®¿é—®ã€‚AuthorizationAuthorization</p>
<p>å½“å‡­æ®éœ€è¦ä½†ç¼ºå¤±æˆ–æ— æ•ˆæ—¶,HTTP è°ƒç”¨å°† è¿”å›çŠ¶æ€ä¸º 401 å’Œé”™è¯¯ä»£ç ,æˆ–åˆ†åˆ«è¿”å›ã€‚è¯·æ³¨æ„,é”™è¯¯ä»£ç  å¯èƒ½æ„å‘³ç€ä»¥ä¸‹å››ç§æƒ…å†µä¹‹ä¸€:M_MISSING_TOKENM_UNKNOWN_TOKENM_UNKNOWN_TOKEN</p>
<pre><code>1. è®¿é—®ä»¤ç‰Œä»æœªæœ‰æ•ˆã€‚
2. è®¿é—®ä»¤ç‰Œå·²æ³¨é”€ã€‚
3. è®¿é—®ä»¤ç‰Œå·²è½¯æ³¨é”€ã€‚
4. [åœ¨ v1.3 ä¸­æ·»åŠ ] è®¿é—®ä»¤ç‰Œéœ€è¦åˆ·æ–°ã€‚
</code></pre>
<p>å½“å®¢æˆ·ç«¯æ”¶åˆ°é”™è¯¯ä»£ç  æ—¶,å®ƒåº”è¯¥:M_UNKNOWN_TOKEN</p>
<ul>
<li>å°è¯•åˆ·æ–°ä»¤ç‰Œï¼ˆå¦‚æœå®ƒæœ‰åˆ·æ–°ï¼‰ ä»¤ ç‰Œ;</li>
<li>å¦‚æœsoft_logoutè®¾ç½®ä¸º ,å®ƒå¯ä»¥æä¾› é‡æ–°ç™»å½•ç”¨æˆ·,ä¿ç•™ä»»ä½•å®¢æˆ·ç«¯çš„æŒä¹… ä¿¡æ¯;true</li>
<li>å¦åˆ™,å°†ç”¨æˆ·è§†ä¸ºå·²æ³¨é”€ã€‚</li>
</ul>
<h3 id="42">4.2 è®¿é—®ä»¤ç‰Œå’Œè®¾å¤‡ä¹‹é—´çš„å…³ç³»</h3>
<p>å®¢æˆ·ç«¯è®¾å¤‡ä¸è®¿é—®å¯†åˆ‡ç›¸å…³ ä»¤ç‰Œå’Œåˆ·æ–°ä»¤ç‰Œã€‚çŸ©é˜µæœåŠ¡å™¨åº”è®°å½•å“ªä¸ªè®¾å¤‡ æ¯ä¸ªè®¿é—®ä»¤ç‰Œå’Œåˆ·æ–°ä»¤ç‰Œéƒ½åˆ†é…ç»™,ä»¥ä¾¿ å¯ä»¥æ­£ç¡®å¤„ç†åç»­è¯·æ±‚ã€‚å½“åˆ·æ–°ä»¤ç‰Œä¸º ç”¨äºç”Ÿæˆæ–°çš„è®¿é—®ä»¤ç‰Œå’Œåˆ·æ–°ä»¤ç‰Œ,å³æ–°çš„è®¿é—® å’Œåˆ·æ–°ä»¤ç‰Œç°åœ¨ç»‘å®šåˆ°ä¸ åˆå§‹åˆ·æ–°ä»¤ç‰Œã€‚</p>
<p>é»˜è®¤æƒ…å†µä¸‹,ç™»å½•å’Œæ³¨å†Œè¿‡ç¨‹è‡ªåŠ¨ç”Ÿæˆæ–°çš„ .å®¢æˆ·ä¹Ÿå¯ä»¥è‡ªç”± ç”Ÿæˆè‡ªå·±çš„,æˆ–è€…,å‰ææ˜¯ç”¨æˆ·ä¿æŒä¸å˜, é‡ç”¨è®¾å¤‡:æ— è®ºå“ªç§æƒ…å†µ,å®¢æˆ·ç«¯éƒ½åº”ä¼ é€’ è¯·æ±‚æ­£æ–‡ã€‚å¦‚æœå®¢æˆ·ç«¯è®¾ç½® ,æœåŠ¡å™¨å°†
ä½¿ä»¥å‰åˆ†é…ç»™è¯¥è®¾å¤‡çš„ä»»ä½•è®¿é—®å’Œåˆ·æ–°ä»¤ç‰Œæ— æ•ˆã€‚device_iddevice_iddevice_iddevice_id</p>
<h3 id="43">4.3 åˆ·æ–°è®¿é—®ä»¤ç‰Œ</h3>
<p>è®¿é—®ä»¤ç‰Œå¯èƒ½ä¼šåœ¨ä¸€å®šæ—¶é—´åè¿‡æœŸã€‚ä»»ä½• HTTP è°ƒç”¨ ä½¿ç”¨è¿‡æœŸçš„è®¿é—®ä»¤ç‰Œå°†è¿”å›é”™è¯¯ä»£ç , æœ€å¥½å¸¦ .å½“å®¢æˆ·ç«¯æ”¶åˆ°æ­¤é”™è¯¯å¹¶ä¸” å…·æœ‰åˆ·æ–°ä»¤ç‰Œ,å®ƒåº”å°è¯•é€šè¿‡è°ƒç”¨ /refresh æ¥åˆ·æ–°è®¿é—®ä»¤ç‰Œã€‚å®¢æˆ·è¿˜å¯ä»¥åˆ·æ–°ä»–ä»¬çš„
éšæ—¶è®¿é—®ä»¤ç‰Œ,å³ä½¿å®ƒå°šæœªè¿‡æœŸã€‚å¦‚æœä»¤ç‰Œåˆ·æ–° æˆåŠŸå,å®¢æˆ·ç«¯åº”å°†æ–°ä»¤ç‰Œç”¨äºå°†æ¥çš„è¯·æ±‚,å¹¶ä¸”å¯ä»¥ ä½¿ç”¨æ–°ä»¤ç‰Œé‡è¯•ä»¥å‰å¤±è´¥çš„è¯·æ±‚ã€‚å½“è®¿é—®ä»¤ç‰Œ åˆ·æ–°å,å¯èƒ½ä¼šè¿”å›æ–°çš„åˆ·æ–°ä»¤ç‰Œ;å¦‚æœæ–°çš„åˆ·æ–°ä»¤ç‰Œæ˜¯ ç»™å®š,æ—§çš„åˆ·æ–°ä»¤ç‰Œå°†å¤±æ•ˆ,è€Œæ–°çš„åˆ·æ–°ä»¤ç‰Œå°†å¤±æ•ˆ
åº”åœ¨éœ€è¦åˆ·æ–°è®¿é—®ä»¤ç‰Œæ—¶ä½¿ç”¨ã€‚M_UNKNOWN_TOKENsoft_logout: true</p>
<p>æ—§çš„åˆ·æ–°ä»¤ç‰Œåœ¨æ–°çš„è®¿é—®ä»¤ç‰Œæˆ–åˆ·æ–°ä»¤ç‰Œä¹‹å‰ä¸€ç›´æœ‰æ•ˆ ,æ­¤æ—¶å°†åŠé”€æ—§çš„åˆ·æ–°ä»¤ç‰Œã€‚è¿™å¯ç¡®ä¿å¦‚æœ å®¢æˆ·ç«¯æ— æ³•æ¥æ”¶æˆ–ä¿ç•™æ–°ä»¤ç‰Œ,å®ƒå°†èƒ½å¤Ÿé‡å¤ åˆ·æ–°æ“ä½œã€‚</p>
<p>å¦‚æœä»¤ç‰Œåˆ·æ–°å¤±è´¥å¹¶ä¸”é”™è¯¯å“åº”åŒ…å«å±æ€§,åˆ™å®¢æˆ·ç«¯å¯ä»¥å°†å…¶è§†ä¸ºè½¯æ³¨é”€,å¹¶å°è¯•é€šè¿‡é‡æ–°ç™»å½•æ¥è·å–æ–°çš„è®¿é—®ä»¤ç‰Œã€‚å¦‚æœé”™è¯¯ å“åº”ä¸åŒ…å«å±æ€§,å®¢æˆ·ç«¯åº” å°†ç”¨æˆ·è§†ä¸ºå·²æ³¨é”€ã€‚soft_logout: truesoft_logout: true</p>
<p>ä¸æ”¯æŒåˆ·æ–°ä»¤ç‰Œçš„å®¢æˆ·ç«¯çš„å¤„ç†ç”±ä¸»æœåŠ¡å™¨å†³å®š; å®¢æˆ·ç«¯é€šè¿‡åœ¨ /login å’Œ /register ç»ˆç»“ç‚¹çš„è¯·æ±‚æ­£æ–‡ä¸­åŒ…å«å±æ€§æ¥æŒ‡ç¤ºå…¶å¯¹åˆ·æ–°ä»¤ç‰Œçš„æ”¯æŒã€‚ä¾‹å¦‚,å®¶åº­æœåŠ¡å™¨ å¯èƒ½å…è®¸ä½¿ç”¨æœªè¿‡æœŸçš„è®¿é—®ä»¤ç‰Œ,æˆ–è€…å¯èƒ½ä½¿è®¿é—®ä»¤ç‰Œè¿‡æœŸ
æ— è®ºå¦‚ä½•,å¹¶ä¾èµ–äºä¸æ”¯æŒçš„å®¢æˆ·ç«¯ä¸Šçš„è½¯æ³¨é”€è¡Œä¸º åˆ·æ–°ã€‚refresh_token: true</p>
<h3 id="44">4.4 è½¯æ³¨é”€</h3>
<p>å¦‚æœæœåŠ¡å™¨éœ€è¦,å®¢æˆ·ç«¯å¯ä»¥å¤„äº"è½¯æ³¨é”€"çŠ¶æ€ åœ¨ç»§ç»­ä¹‹å‰é‡æ–°è¿›è¡Œèº«ä»½éªŒè¯,ä½†ä¸å¸Œæœ›ä½¿ å®¢æˆ·ç«¯ä¼šè¯ã€‚æœåŠ¡å™¨æŒ‡ç¤ºå®¢æˆ·ç«¯å¤„äºè½¯æ³¨é”€çŠ¶æ€ é€šè¿‡åœ¨é”™è¯¯å“åº”ä¸­åŒ…å«å‚æ•°æ¥çŠ¶æ€;å‚æ•°é»˜è®¤ä¸º ã€‚å¦‚æœå‚æ•°è¢«çœç•¥æˆ–ä¸º ,è¿™æ„å‘³ç€æœåŠ¡å™¨å…·æœ‰
å·²é”€æ¯ä¼šè¯,å®¢æˆ·ç«¯ä¸åº”é‡ç”¨å®ƒã€‚ä¹Ÿå°±æ˜¯è¯´,ä»»ä½• å®¢æˆ·ç«¯æŒæœ‰çš„æŒä¹…çŠ¶æ€,ä¾‹å¦‚åŠ å¯†å¯†é’¥å’Œè®¾å¤‡ ä¿¡æ¯,ä¸å¾—é‡å¤ä½¿ç”¨,å¿…é¡»ä¸¢å¼ƒã€‚å¦‚æœæ˜¯,å®¢æˆ·ç«¯å¯ä»¥é‡ç”¨ä»»ä½•æŒä¹…çŠ¶æ€ã€‚soft_logout:
trueM_UNKNOWN_TOKENsoft_logoutfalsesoft_logoutfalsesoft_logouttrue</p>
<p>[åœ¨ v1.3 ä¸­æ›´æ”¹]</p>
<p>æ”¶åˆ°æ­¤ç±»å“åº”çš„å®¢æˆ·ç«¯å¯ä»¥å°è¯•åˆ·æ–°å…¶è®¿é—®ä»¤ç‰Œï¼ˆå¦‚æœå®ƒæœ‰åˆ·æ–°ï¼‰ ä»¤ç‰Œå¯ç”¨ã€‚å¦‚æœæ²¡æœ‰å¯ç”¨çš„åˆ·æ–°ä»¤ç‰Œ,æˆ–è€…æ­£åœ¨åˆ·æ–° å¤±è´¥,å®¢æˆ·ç«¯å¯ä»¥é€šè¿‡ æŒ‡å®šå®ƒå·²ç”¨äºç™»å½• API çš„è®¾å¤‡ IDã€‚soft_logout: true</p>
<h3 id="45-api">4.5 ç”¨æˆ·äº¤äº’å¼èº«ä»½éªŒè¯ API</h3>
<h4 id="451">4.5.1 æ¦‚è¿°</h4>
<p>æŸäº› API ç«¯ç‚¹éœ€è¦ä¸ç”¨æˆ·äº¤äº’çš„èº«ä»½éªŒè¯ã€‚ ä¸»æœåŠ¡å™¨å¯ä»¥æä¾›è®¸å¤šä¸åŒçš„èº«ä»½éªŒè¯æ–¹å¼,ä¾‹å¦‚ ä½œä¸ºç”¨æˆ·/å¯†ç èº«ä»½éªŒè¯,é€šè¿‡å•ç‚¹ç™»å½•æœåŠ¡å™¨ ï¼ˆSSOï¼‰ ç™»å½•ç­‰ã€‚ æ­¤è§„èŒƒæœªå®šä¹‰ä¸»æœåŠ¡å™¨åº”å¦‚ä½•æˆæƒ ä»–ä»¬çš„ç”¨æˆ·,è€Œæ˜¯å®šä¹‰äº†æ ‡å‡†æ¥å£
åº”éµå¾ªå®ç°,ä»¥ä¾¿ä»»ä½•å®¢æˆ·ç«¯éƒ½å¯ä»¥ç™»å½•åˆ°ä»»ä½• ä¸»æœåŠ¡å™¨ã€‚</p>
<p>è¯¥è¿‡ç¨‹é‡‡å–ä¸€ä¸ªæˆ–å¤šä¸ª"é˜¶æ®µ"çš„å½¢å¼ã€‚åœ¨æ¯ä¸ªé˜¶æ®µ å®¢æˆ·ç«¯ä¸ºç»™å®šçš„èº«ä»½éªŒè¯ç±»å‹æäº¤ä¸€ç»„æ•°æ®å¹¶ç­‰å¾… æ¥è‡ªæœåŠ¡å™¨çš„å“åº”,è¿™å°†æ˜¯æœ€ç»ˆæˆåŠŸæˆ– è¯·æ±‚æ‰§è¡Œå…¶ä»–é˜¶æ®µã€‚è¿™ç§äº¤æ¢ä¸€ç›´æŒç»­åˆ° æœ€åçš„æˆåŠŸã€‚</p>
<p>å¯¹äºæ¯ä¸ªç«¯ç‚¹,æœåŠ¡å™¨æä¾›ä¸€ä¸ªæˆ–å¤šä¸ªå®¢æˆ·ç«¯çš„"æµ" å¯ç”¨äºå¯¹è‡ªèº«è¿›è¡Œèº«ä»½éªŒè¯ã€‚æ¯ä¸ªæµç¨‹åŒ…æ‹¬ä¸€ç³»åˆ—é˜¶æ®µ, å¦‚ä¸Šæ‰€è¿°ã€‚å®¢æˆ·ç«¯å¯ä»¥è‡ªç”±é€‰æ‹©å®ƒéµå¾ªçš„æµç¨‹, ä½†æ˜¯,æµçš„å„ä¸ªé˜¶æ®µå¿…é¡»æŒ‰é¡ºåºå®Œæˆã€‚æœªèƒ½éµå¾ª æŒ‰é¡ºåºæ’åˆ—çš„æµå¿…é¡»äº§ç”Ÿ HTTP 401
å“åº”,å¦‚å®šä¹‰ ä¸‹é¢ã€‚å½“æµä¸­çš„æ‰€æœ‰é˜¶æ®µéƒ½å®Œæˆå,èº«ä»½éªŒè¯æ˜¯ å®Œæˆ,API è°ƒç”¨æˆåŠŸã€‚</p>
<h4 id="452-rest-api-api">4.5.2 REST API ä¸­çš„ç”¨æˆ·äº¤äº’å¼ API</h4>
<p>åœ¨æœ¬è§„èŒƒä¸­æè¿°çš„ REST API ä¸­,èº«ä»½éªŒè¯çš„å·¥ä½œæ–¹å¼ä¸º äº¤æ¢ JSON å­—å…¸çš„å®¢æˆ·ç«¯å’ŒæœåŠ¡å™¨ã€‚æœåŠ¡å™¨æŒ‡ç¤º é€šè¿‡ HTTP 401 æ­£æ–‡éœ€è¦å“ªäº›èº«ä»½éªŒè¯æ•°æ® å“åº”,å®¢æˆ·ç«¯é€šè¿‡è¯·æ±‚å‚æ•°æäº¤è¯¥èº«ä»½éªŒè¯æ•°æ®ã€‚auth</p>
<p>å®¢æˆ·ç«¯åº”é¦–å…ˆå‘å‡ºä¸å¸¦å‚æ•°çš„è¯·æ±‚ã€‚ ä¸»æœåŠ¡å™¨è¿”å›å¸¦æœ‰ JSON æ­£æ–‡çš„ HTTP 401 å“åº”,å¦‚ä¸‹æ‰€ç¤º:auth</p>
<pre><code>HTTP/1.1 401 Unauthorized
Content-Type: application/json
</code></pre>
<pre><code class="language-json">    {
  &quot;flows&quot;: [
    {
      &quot;stages&quot;: [
        &quot;example.type.foo&quot;,
        &quot;example.type.bar&quot;
      ]
    },
    {
      &quot;stages&quot;: [
        &quot;example.type.foo&quot;,
        &quot;example.type.baz&quot;
      ]
    }
  ],
  &quot;params&quot;: {
    &quot;example.type.baz&quot;: {
      &quot;example_key&quot;: &quot;foobar&quot;
    }
  },
  &quot;session&quot;: &quot;xxxxxx&quot;
}
</code></pre>
<p>é™¤äº† ä¹‹å¤–,æ­¤å¯¹è±¡è¿˜åŒ…å«ä¸€äº›é¢å¤–çš„ä¿¡æ¯:flows</p>
<ul>
<li>params:æ­¤éƒ¨åˆ†åŒ…å«å®¢æˆ·ç«¯å°†è¦æä¾›çš„ä»»ä½•ä¿¡æ¯ éœ€è¦çŸ¥é“æ‰èƒ½ä½¿ç”¨ç»™å®šç±»å‹çš„èº«ä»½éªŒè¯ã€‚å¯¹äºæ¯ä¸ª æä¾›çš„èº«ä»½éªŒè¯ç±»å‹,è¯¥ç±»å‹å¯èƒ½åœ¨æ­¤ç±»å‹ä¸­ä½œä¸ºå¯†é’¥å­˜åœ¨ å­—å…¸ã€‚ä¾‹å¦‚,OAuth å®¢æˆ·ç«¯ ID çš„å…¬å…±éƒ¨åˆ†å¯ä»¥æ˜¯ åœ¨è¿™é‡Œç»™å‡ºã€‚</li>
<li>session:è¿™æ˜¯å®¢æˆ·ç«¯å¿…é¡»ä¼ å›çš„ä¼šè¯æ ‡è¯†ç¬¦ åˆ°ä¸»æœåŠ¡å™¨ï¼ˆå¦‚æœæä¾›äº†ï¼‰,åœ¨éšåçš„èº«ä»½éªŒè¯å°è¯•ä¸­ åœ¨åŒä¸€ä¸ª API è°ƒç”¨ä¸­ã€‚</li>
</ul>
<p>ç„¶å,å®¢æˆ·ç«¯é€‰æ‹©ä¸€ä¸ªæµå¹¶å°è¯•å®Œæˆç¬¬ä¸€é˜¶æ®µã€‚ å®ƒé€šè¿‡é‡æ–°æäº¤ç›¸åŒçš„è¯·æ±‚å¹¶åœ¨æäº¤çš„å¯¹è±¡ä¸­æ·»åŠ å¯†é’¥æ¥å®ç°æ­¤ç›®çš„ã€‚æ­¤å­—å…¸åŒ…å«ä¸€ä¸ªé”®,å…¶å€¼æ˜¯èº«ä»½éªŒè¯ç±»å‹çš„åç§°,è¯¥ å®¢æˆ·ç«¯æ­£åœ¨å°è¯•å®Œæˆã€‚å®ƒè¿˜å¿…é¡»åŒ…å«ä¸€ä¸ªå¯†é’¥ ä½¿ç”¨ä¸»æœåŠ¡å™¨ç»™å‡ºçš„ä¼šè¯å¯†é’¥çš„å€¼ï¼ˆå¦‚æœ
é‰´äºã€‚å®ƒè¿˜åŒ…å«ä¾èµ–äºèº«ä»½éªŒè¯ç±»å‹çš„å…¶ä»–é”® ä¼å›¾ã€‚ä¾‹å¦‚,å¦‚æœå®¢æˆ·ç«¯æ­£åœ¨å°è¯•å®Œæˆèº«ä»½éªŒè¯ é”®å…¥ ,å®ƒå¯èƒ½ä¼šæäº¤å¦‚ä¸‹å†…å®¹:authtypesessionexample.type.foo</p>
<pre><code>POST /_matrix/client/v3/endpoint HTTP/1.1
Content-Type: application/json
</code></pre>
<pre><code class="language-json">{
  &quot;a_request_parameter&quot;: &quot;something&quot;,
  &quot;another_request_parameter&quot;: &quot;something else&quot;,
  &quot;auth&quot;: {
    &quot;type&quot;: &quot;example.type.foo&quot;,
    &quot;session&quot;: &quot;xxxxxx&quot;,
    &quot;example_credential&quot;: &quot;verypoorsharedsecret&quot;
  }
}
</code></pre>
<p>å¦‚æœä¸»æœåŠ¡å™¨è®¤ä¸ºèº«ä»½éªŒè¯å°è¯•æˆåŠŸ,ä½† ä»ç„¶éœ€è¦æ›´å¤šé˜¶æ®µæ‰èƒ½å®Œæˆ,å®ƒè¿”å›HTTPçŠ¶æ€401 ä»¥åŠä¸æœªå°è¯•èº«ä»½éªŒè¯æ—¶ç›¸åŒçš„å¯¹è±¡, æ·»åŠ å¯†é’¥,è¯¥å¯†é’¥æ˜¯èº«ä»½éªŒè¯ç±»å‹çš„æ•°ç»„ å®¢æˆ·ç«¯å·²æˆåŠŸå®Œæˆ:completed</p>
<pre><code>HTTP/1.1 401 Unauthorized
Content-Type: application/json
</code></pre>
<pre><code class="language-json">{
  &quot;completed&quot;: [
    &quot;example.type.foo&quot;
  ],
  &quot;flows&quot;: [
    {
      &quot;stages&quot;: [
        &quot;example.type.foo&quot;,
        &quot;example.type.bar&quot;
      ]
    },
    {
      &quot;stages&quot;: [
        &quot;example.type.foo&quot;,
        &quot;example.type.baz&quot;
      ]
    }
  ],
  &quot;params&quot;: {
    &quot;example.type.baz&quot;: {
      &quot;example_key&quot;: &quot;foobar&quot;
    }
  },
  &quot;session&quot;: &quot;xxxxxx&quot;
}
</code></pre>
<p>å„ä¸ªé˜¶æ®µå¯èƒ½éœ€è¦å¤šä¸ªè¯·æ±‚æ‰èƒ½å®Œæˆ,åœ¨ åœ¨è¿™ç§æƒ…å†µä¸‹,å“åº”å°†å¥½åƒè¯·æ±‚æœªç»èº«ä»½éªŒè¯ æ·»åŠ ç”±èº«ä»½éªŒè¯ç±»å‹å®šä¹‰çš„ä»»ä½•å…¶ä»–å¯†é’¥ã€‚</p>
<p>å¦‚æœä¸»æœåŠ¡å™¨ç¡®å®šæŸä¸ªé˜¶æ®µçš„å°è¯•ä¸æˆåŠŸ, ä½†å®¢æˆ·ç«¯å¯èƒ½ä¼šè¿›è¡Œç¬¬äºŒæ¬¡å°è¯•,å®ƒè¿”å›ç›¸åŒçš„ HTTP çŠ¶æ€ 401 å“åº”å¦‚ä¸Šæ‰€è¿°,å¹¶æ·»åŠ äº†æè¿°é”™è¯¯çš„æ ‡å‡†å’Œå­—æ®µã€‚ä¾‹å¦‚:errcodeerror</p>
<pre><code>HTTP/1.1 401 Unauthorized
Content-Type: application/json
</code></pre>
<pre><code class="language-json">{
  &quot;errcode&quot;: &quot;M_FORBIDDEN&quot;,
  &quot;error&quot;: &quot;Invalid password&quot;,
  &quot;completed&quot;: [
    &quot;example.type.foo&quot;
  ],
  &quot;flows&quot;: [
    {
      &quot;stages&quot;: [
        &quot;example.type.foo&quot;,
        &quot;example.type.bar&quot;
      ]
    },
    {
      &quot;stages&quot;: [
        &quot;example.type.foo&quot;,
        &quot;example.type.baz&quot;
      ]
    }
  ],
  &quot;params&quot;: {
    &quot;example.type.baz&quot;: {
      &quot;example_key&quot;: &quot;foobar&quot;
    }
  },
  &quot;session&quot;: &quot;xxxxxx&quot;
}
</code></pre>
<p>å¦‚æœè¯·æ±‚ç”±äºèº«ä»½éªŒè¯ä»¥å¤–çš„åŸå› è€Œå¤±è´¥,åˆ™æœåŠ¡å™¨ è¿”å›æ ‡å‡†æ ¼å¼çš„é”™è¯¯æ¶ˆæ¯ã€‚ä¾‹å¦‚:</p>
<pre><code>HTTP/1.1 400 Bad request
Content-Type: application/json
</code></pre>
<pre><code class="language-json">{
  &quot;errcode&quot;: &quot;M_EXAMPLE_ERROR&quot;,
  &quot;error&quot;: &quot;Something was wrong&quot;
}
</code></pre>
<p>å¦‚æœå®¢æˆ·ç«¯å·²å®Œæˆæµçš„æ‰€æœ‰é˜¶æ®µ,åˆ™ä¸»æœåŠ¡å™¨ æ‰§è¡Œ API è°ƒç”¨å¹¶æ­£å¸¸è¿”å›ç»“æœã€‚å·²å®Œæˆçš„é˜¶æ®µ å®¢æˆ·ç«¯æ— æ³•é‡è¯•,å› æ­¤æœåŠ¡å™¨å¿…é¡»è¿”å› 401 åŒ…å«å·²å®Œæˆé˜¶æ®µçš„å“åº”,æˆ– API è°ƒç”¨çš„ç»“æœï¼ˆå¦‚æœå…¨éƒ¨ï¼‰ å½“å®¢æˆ·ç«¯é‡è¯•é˜¶æ®µæ—¶,é˜¶æ®µå·²å®Œæˆã€‚</p>
<p>æŸäº›èº«ä»½éªŒè¯ç±»å‹å¯ä»¥é€šè¿‡ çŸ©é˜µå®¢æˆ·ç«¯,ä¾‹å¦‚,å¯ä»¥å®Œæˆç”µå­é‚®ä»¶ç¡®è®¤ å½“ç”¨æˆ·å•å‡»ç”µå­é‚®ä»¶ä¸­çš„é“¾æ¥æ—¶ã€‚åœ¨è¿™ç§æƒ…å†µä¸‹,å®¢æˆ·ç«¯ ä½¿ç”¨ä»…åŒ…å«ä¼šè¯å¯†é’¥çš„èº«ä»½éªŒè¯å­—å…¸é‡è¯•è¯·æ±‚ã€‚ å¯¹æ­¤çš„å“åº”å°†ä¸å®¢æˆ·ç«¯å°è¯•ç›¸åŒ æ­£å¸¸å®Œæˆèº«ä»½éªŒè¯çŠ¶æ€,å³è¯·æ±‚å°†
å®Œæˆæˆ–è¯·æ±‚èº«ä»½éªŒè¯,æ˜¯å¦å­˜åœ¨è¯¥èº«ä»½éªŒè¯ç±»å‹ åœ¨"å·²å®Œæˆ"æ•°ç»„ä¸­æŒ‡ç¤ºè¯¥é˜¶æ®µæ˜¯å¦å®Œæˆã€‚</p>
<h4 id="453">4.5.3 ä¾‹</h4>
<p>åœ¨é«˜çº§åˆ«ä¸Š,å¯¹ API è°ƒç”¨å‘å‡ºçš„è¯·æ±‚å®Œæˆèº«ä»½éªŒè¯ å…·æœ‰ä¸‰ä¸ªé˜¶æ®µçš„æµå°†ç±»ä¼¼äºä¸‹å›¾:</p>
<pre><code>    _______________________
    |       Stage 0         |
    | No auth               |
    |  ___________________  |
    | |_Request_1_________| | &lt;-- Returns &quot;session&quot; key which is used throughout.
    |_______________________|
             |
             |
    _________V_____________
    |       Stage 1         |
    | type: &quot;&lt;auth type1&gt;&quot;  |
    |  ___________________  |
    | |_Request_1_________| |
    |_______________________|
             |
             |
    _________V_____________
    |       Stage 2         |
    | type: &quot;&lt;auth type2&gt;&quot;  |
    |  ___________________  |
    | |_Request_1_________| |
    |  ___________________  |
    | |_Request_2_________| |
    |  ___________________  |
    | |_Request_3_________| |
    |_______________________|
             |
             |
    _________V_____________
    |       Stage 3         |
    | type: &quot;&lt;auth type3&gt;&quot;  |
    |  ___________________  |
    | |_Request_1_________| | &lt;-- Returns API response
    |_______________________|
</code></pre>
<h4 id="454">4.5.4 èº«ä»½éªŒè¯ç±»å‹</h4>
<p>æ­¤è§„èŒƒå®šä¹‰äº†ä»¥ä¸‹èº«ä»½éªŒè¯ç±»å‹:</p>
<ul>
<li>m.login.password</li>
<li>m.login.recaptcha</li>
<li>m.login.sso</li>
<li>m.login.email.identity</li>
<li>m.login.msisdn</li>
<li>m.login.dummy</li>
<li>m.login.registration_token</li>
</ul>
<h4 id="455">4.5.5 åå¤‡</h4>
<p>ä¸èƒ½æœŸæœ›å®¢æˆ·èƒ½å¤ŸçŸ¥é“å¦‚ä½•å¤„ç†æ¯ä¸ª å•ä¸€ç™»å½•ç±»å‹ã€‚å¦‚æœå®¢æˆ·ç«¯ä¸çŸ¥é“å¦‚ä½•å¤„ç†ç»™å®šçš„ç™»å½• ç±»å‹,å®ƒå¯ä»¥å°†ç”¨æˆ·å®šå‘åˆ°å…·æœ‰å›é€€ URL çš„ Web æµè§ˆå™¨ é¡µé¢,å…è®¸ç”¨æˆ·åœ¨å¸¦å¤–å®Œæˆè¯¥ç™»å½•æ­¥éª¤ åœ¨ä»–ä»¬çš„ç½‘ç»œæµè§ˆå™¨ä¸­ã€‚å®ƒåº”è¯¥æ‰“å¼€çš„ URL æ˜¯:</p>
<pre><code>/_matrix/client/v3/auth/&lt;auth type&gt;/fallback/web?session=&lt;session ID&gt;
</code></pre>
<p>å…¶ä¸­ æ˜¯å®ƒæ­£åœ¨å°è¯•çš„é˜¶æ®µçš„ç±»å‹åç§°,æ˜¯ä¸»æœåŠ¡å™¨æä¾›çš„ä¼šè¯çš„ IDã€‚auth typesession ID</p>
<p>è¿™å¿…é¡»è¿”å›å¯ä»¥æ‰§è¡Œæ­¤èº«ä»½éªŒè¯çš„ HTML é¡µé¢ é˜¶æ®µã€‚æ­¤é¡µé¢å¿…é¡»ä½¿ç”¨ä»¥ä¸‹ JavaScript åœ¨ èº«ä»½éªŒè¯å·²å®Œæˆ:</p>
<pre><code class="language-js">if (window.onAuthDone) {
    window.onAuthDone();
} else if (window.opener &amp;&amp; window.opener.postMessage) {
    window.opener.postMessage(&quot;authDone&quot;, &quot;*&quot;);
}
</code></pre>
<p>è¿™å…è®¸å®¢æˆ·ç«¯å®‰æ’åœ¨åµŒå…¥å¼æµè§ˆå™¨ä¸­å®šä¹‰å…¨å±€å‡½æ•°,æˆ–ä½¿ç”¨HTML5è·¨æ–‡æ¡£ æ¶ˆæ¯ä¼ é€’ API, åˆ° æ¥æ”¶èº«ä»½éªŒè¯é˜¶æ®µå·²å®Œæˆçš„é€šçŸ¥ã€‚onAuthDone</p>
<p>å®¢æˆ·ç«¯æ”¶åˆ°èº«ä»½éªŒè¯é˜¶æ®µçš„é€šçŸ¥å å·²å®Œæˆ,å®ƒåº”è¯¥ä½¿ç”¨èº«ä»½éªŒè¯å­—å…¸é‡æ–°æäº¤è¯·æ±‚ ä»…ä½¿ç”¨ä¼šè¯ ID:</p>
<pre><code class="language-json">{
  &quot;session&quot;: &quot;&lt;session ID&gt;&quot;
}
</code></pre>
<p>4.5.6 æ ‡è¯†ç¬¦ç±»å‹</p>
<p>æŸäº›èº«ä»½éªŒè¯æœºåˆ¶ä½¿ç”¨ç”¨æˆ·æ ‡è¯†ç¬¦å¯¹è±¡æ¥æ ‡è¯† ä¸€ä¸ªç”¨æˆ·ã€‚ç”¨æˆ·æ ‡è¯†ç¬¦å¯¹è±¡æœ‰ä¸€ä¸ªå­—æ®µæ¥æŒ‡ç¤º æ­£åœ¨ä½¿ç”¨çš„æ ‡è¯†ç¬¦ç±»å‹,å¹¶ä¸”æ ¹æ®ç±»å‹,å…·æœ‰å…¶ä»– æä¾›æ ‡è¯†ç”¨æˆ·æ‰€éœ€ä¿¡æ¯çš„å­—æ®µ,å¦‚æ‰€è¿° ä¸‹é¢ã€‚type</p>
<p>æ­¤è§„èŒƒå®šä¹‰äº†ä»¥ä¸‹æ ‡è¯†ç¬¦ç±»å‹:</p>
<ul>
<li>m.id.user</li>
<li>m.id.thirdparty</li>
<li>m.id.phone</li>
</ul>
<h3 id="46">4.6 ç™»å½•</h3>
<p>å®¢æˆ·ç«¯å¯ä»¥ä½¿ç”¨ API è·å–è®¿é—®ä»¤ç‰Œã€‚/login</p>
<p>è¯·æ³¨æ„,æ­¤ç»ˆç»“ç‚¹å½“å‰ä¸ä½¿ç”¨ç”¨æˆ·äº¤äº’å¼èº«ä»½éªŒè¯ åŸæ–™è¯ã€‚</p>
<p>å¯¹äºç®€å•çš„ç”¨æˆ·å/å¯†ç ç™»å½•,å®¢æˆ·ç«¯åº”æäº¤è¯·æ±‚,å¦‚ä¸‹æ‰€ç¤º:/login</p>
<pre><code class="language-json">{
  &quot;type&quot;: &quot;m.login.password&quot;,
  &quot;identifier&quot;: {
    &quot;type&quot;: &quot;m.id.user&quot;,
    &quot;user&quot;: &quot;&lt;user_id or user localpart&gt;&quot;
  },
  &quot;password&quot;: &quot;&lt;password&gt;&quot;
}
</code></pre>
<p>æˆ–è€…,å®¢æˆ·ç«¯å¯ä»¥ä½¿ç”¨ç»‘å®šåˆ°ç”¨æˆ·å¸æˆ·çš„ 3PID ä¸»æœåŠ¡å™¨ä½¿ç”¨ /account/3pid API è€Œä¸æ˜¯æ˜¾å¼æä¾›,å¦‚ä¸‹æ‰€ç¤º:user</p>
<pre><code class="language-json">{
  &quot;type&quot;: &quot;m.login.password&quot;,
  &quot;identifier&quot;: {
    &quot;medium&quot;: &quot;&lt;The medium of the third-party identifier&gt;&quot;,
    &quot;address&quot;: &quot;&lt;The canonicalised third-party address of the user&gt;&quot;
  },
  &quot;password&quot;: &quot;&lt;password&gt;&quot;
}
</code></pre>
<p>å¦‚æœä¸»æœåŠ¡å™¨ä¸çŸ¥é“æä¾›çš„ 3PID, ä¸»æœåŠ¡å™¨å¿…é¡»å“åº” ã€‚403 Forbidden</p>
<p>è¦ä½¿ç”¨ç™»å½•ä»¤ç‰Œç™»å½•,å®¢æˆ·ç«¯åº”æäº¤è¯·æ±‚ å¦‚ä¸‹:/login</p>
<pre><code>{
&quot;type&quot;: &quot;m.login.token&quot;,
&quot;token&quot;: &quot;&lt;login token&gt;&quot;
}
</code></pre>
<p>å¿…é¡»å¯¹ç”¨æˆ· ID è¿›è¡Œç¼–ç ,å› ä¸ºæ²¡æœ‰å…¶ä»–æ ‡è¯† è¯·æ±‚ä¸­çš„æ•°æ®ã€‚åœ¨ä»¤ç‰Œæ— æ•ˆçš„æƒ…å†µä¸‹,ä¸»æœåŠ¡å™¨å¿…é¡» å“åº” å’Œé”™è¯¯ä»£ç  ã€‚token403 ForbiddenM_FORBIDDEN</p>
<p>å¦‚æœä¸»æœåŠ¡å™¨æ’­å‘ä¸ºå¯è¡Œçš„æµ,å¹¶ä¸” å®¢æˆ·ç«¯æ”¯æŒå®ƒ,å®¢æˆ·ç«¯åº”å°†ç”¨æˆ·é‡å®šå‘åˆ°ç«¯ç‚¹,ä»¥ä¾¿é€šè¿‡ SSO ç™»å½•å®¢æˆ·ç«¯ã€‚èº«ä»½éªŒè¯å å®Œæˆå,å®¢æˆ·ç«¯å°†éœ€è¦æäº¤åŒ¹é…çš„è¯·æ±‚ã€‚m.login.sso/redirect/loginm.login.token</p>
<h4 id="get-_matrixclientv3login">GET /_matrix/client/v3/login</h4>
<p>è·å–ä¸»æœåŠ¡å™¨æ”¯æŒçš„ç™»å½•ç±»å‹ä»¥å¯¹ç”¨æˆ·è¿›è¡Œèº«ä»½éªŒè¯ã€‚å®¢æˆ· åº”è¯¥é€‰æ‹©å…¶ä¸­ä¹‹ä¸€å¹¶åœ¨ç™»å½•æ—¶æä¾›å®ƒã€‚type</p>
<pre><code class="language-json">{
  &quot;flows&quot;: [
    {
      &quot;type&quot;: &quot;m.login.password&quot;
    }
  ]
}
</code></pre>
<h4 id="post-_matrixclientv3login">POST /_matrix/client/v3/login</h4>
<p>å¯¹ç”¨æˆ·è¿›è¡Œèº«ä»½éªŒè¯,å¹¶é¢å‘ä»–ä»¬å¯ä»¥çš„è®¿é—®ä»¤ç‰Œ ç”¨äºåœ¨åç»­è¯·æ±‚ä¸­æˆæƒè‡ªå·±ã€‚</p>
<p>å¦‚æœå®¢æˆ·ç«¯æœªæä¾› ,åˆ™æœåŠ¡å™¨å¿…é¡» è‡ªåŠ¨ç”Ÿæˆä¸€ä¸ªã€‚device_id</p>
<p>è¿”å›çš„è®¿é—®ä»¤ç‰Œå¿…é¡»ä¸å®¢æˆ·ç«¯æä¾›çš„æˆ–ç”±æœåŠ¡å™¨ç”Ÿæˆçš„ç›¸å…³è”ã€‚æœåŠ¡å™¨å¯èƒ½ ä½¿ä»¥å‰ä¸è¯¥è®¾å¤‡å…³è”çš„ä»»ä½•è®¿é—®ä»¤ç‰Œæ— æ•ˆã€‚è¯·å‚é˜…è®¿é—®ä»¤ç‰Œå’Œè®¾å¤‡ä¹‹é—´çš„å…³ç³»ã€‚device_id</p>
<pre><code class="language-json">{
  &quot;identifier&quot;: {
    &quot;type&quot;: &quot;m.id.user&quot;,
    &quot;user&quot;: &quot;cheeky_monkey&quot;
  },
  &quot;initial_device_display_name&quot;: &quot;Jungle Phone&quot;,
  &quot;password&quot;: &quot;ilovebananas&quot;,
  &quot;type&quot;: &quot;m.login.password&quot;
}
</code></pre>
<pre><code class="language-json">{
  &quot;access_token&quot;: &quot;abc123&quot;,
  &quot;device_id&quot;: &quot;GHTYAJCE&quot;,
  &quot;expires_in_ms&quot;: 60000,
  &quot;refresh_token&quot;: &quot;def456&quot;,
  &quot;user_id&quot;: &quot;@cheeky_monkey:matrix.org&quot;,
  &quot;well_known&quot;: {
    &quot;m.homeserver&quot;: {
      &quot;base_url&quot;: &quot;https://example.org&quot;
    },
    &quot;m.identity_server&quot;: {
      &quot;base_url&quot;: &quot;https://id.example.org&quot;
    }
  }
}
</code></pre>
<h4 id="post-_matrixclientv3refresh">POST /_matrix/client/v3/refresh</h4>
<p>v1.3 ä¸­æ–°å¢</p>
<p>åˆ·æ–°è®¿é—®ä»¤ç‰Œã€‚å®¢æˆ·ç«¯åº”ä½¿ç”¨è¿”å›çš„è®¿é—®ä»¤ç‰Œ è¿›è¡Œåç»­ API è°ƒç”¨æ—¶,å¹¶å­˜å‚¨è¿”å›çš„åˆ·æ–°ä»¤ç‰Œ ï¼ˆå¦‚æœç»™å®šï¼‰,ä»¥ä¾¿åœ¨å¿…è¦æ—¶åˆ·æ–°æ–°çš„è®¿é—®ä»¤ç‰Œã€‚</p>
<p>åˆ·æ–°è®¿é—®ä»¤ç‰Œå,æœåŠ¡å™¨å¯ä»¥é€‰æ‹© ä½¿æ—§è®¿é—®ä»¤ç‰Œç«‹å³å¤±æ•ˆ,ä¹Ÿå¯ä»¥é€‰æ‹©ä¸ä½¿æ—§è®¿é—®ä»¤ç‰Œå¤±æ•ˆ ä¾‹å¦‚,è®¿é—®ä»¤ç‰Œæ˜¯å¦å¾ˆå¿«å°±ä¼šè¿‡æœŸã€‚å®¢æˆ·åº”è¯¥ ä¸å¯¹æ—§è®¿é—®ä»¤ç‰Œä»ç„¶æœ‰æ•ˆåšå‡ºä»»ä½•å‡è®¾, å¹¶åº”æ”¹ç”¨æ–°æä¾›çš„è®¿é—®ä»¤ç‰Œã€‚</p>
<p>æ—§çš„åˆ·æ–°ä»¤ç‰Œåœ¨æ–°çš„è®¿é—®ä»¤ç‰Œæˆ–åˆ·æ–°ä»¤ç‰Œä¹‹å‰ä¸€ç›´æœ‰æ•ˆ ,æ­¤æ—¶å°†åŠé”€æ—§çš„åˆ·æ–°ä»¤ç‰Œã€‚</p>
<p>è¯·æ³¨æ„,æ­¤ç«¯ç‚¹ä¸éœ€è¦é€šè¿‡ è®¿é—®ä»¤ç‰Œã€‚èº«ä»½éªŒè¯é€šè¿‡åˆ·æ–°ä»¤ç‰Œæä¾›ã€‚</p>
<p>å·²ä¸ºæ­¤ç»ˆç»“ç‚¹ç¦ç”¨åº”ç”¨ç¨‹åºæœåŠ¡æ ‡è¯†æ–­è¨€ã€‚</p>
<pre><code class="language-json">
{
  &quot;refresh_token&quot;: &quot;some_token&quot;
}
</code></pre>
<pre><code class="language-json">{
  &quot;access_token&quot;: &quot;a_new_token&quot;,
  &quot;expires_in_ms&quot;: 60000,
  &quot;refresh_token&quot;: &quot;another_new_token&quot;
}
</code></pre>
<h4 id="post-_matrixclientv3logout">POST /_matrix/client/v3/logout</h4>
<p>ä½¿ç°æœ‰è®¿é—®ä»¤ç‰Œå¤±æ•ˆ,ä½¿å…¶ä¸èƒ½å†ç”¨äº æˆæƒã€‚ä¸è®¿é—®ä»¤ç‰Œå…³è”çš„è®¾å¤‡ä¹Ÿå°†è¢«åˆ é™¤ã€‚è®¾å¤‡çš„è®¾å¤‡å¯†é’¥å°†ä¸è®¾å¤‡ä¸€èµ·åˆ é™¤ã€‚</p>
<pre><code class="language-json">{}
</code></pre>
<h4 id="post-_matrixclientv3logoutall">POST /_matrix/client/v3/logout/all</h4>
<p>ä½¿ç”¨æˆ·çš„æ‰€æœ‰è®¿é—®ä»¤ç‰Œå¤±æ•ˆ,ä»¥ä¾¿å®ƒä»¬ä¸èƒ½å†ç”¨äº æˆæƒã€‚è¿™åŒ…æ‹¬å‘å‡ºæ­¤è¯·æ±‚çš„è®¿é—®ä»¤ç‰Œã€‚æ‰€æœ‰è®¾å¤‡ å¯¹äºç”¨æˆ·ä¹Ÿå°†è¢«åˆ é™¤ã€‚è®¾å¤‡çš„è®¾å¤‡å¯†é’¥ä¸º ä¸è®¾å¤‡ä¸€èµ·åˆ é™¤ã€‚</p>
<p>æ­¤ç»ˆç»“ç‚¹ä¸ä½¿ç”¨ç”¨æˆ·äº¤äº’å¼èº«ä»½éªŒè¯ API,å› ä¸º ç”¨æˆ·äº¤äº’å¼èº«ä»½éªŒè¯æ—¨åœ¨é˜²æ­¢ä»¥ä¸‹æ”»å‡»:æœ‰äººæŒæ¡äº†ä¸€ä¸ªè®¿é—®ä»¤ç‰Œ,ç„¶åæ¥ç®¡äº†è¯¥å¸æˆ·ã€‚è¿™ ç»ˆç»“ç‚¹ä½¿ç”¨æˆ·çš„æ‰€æœ‰è®¿é—®ä»¤ç‰Œå¤±æ•ˆ,åŒ…æ‹¬ è¯·æ±‚,å› æ­¤æ”»å‡»è€…æ— æ³•æ¥ç®¡å¸æˆ· è¿™è¾¹ã€‚</p>
<pre><code class="language-json">{}
</code></pre>
<h3 id="47">4.7 å¸æˆ·æ³¨å†Œå’Œç®¡ç†</h3>
<h4 id="post-_matrixclientv3accountdeactivate">POST /_matrix/client/v3/account/deactivate</h4>
<p>åœç”¨ç”¨æˆ·å¸æˆ·,åˆ é™¤ç”¨æˆ·çš„æ‰€æœ‰èƒ½åŠ› å†æ¬¡ç™»å½•ã€‚</p>
<p>æ­¤ API ç»ˆç»“ç‚¹ä½¿ç”¨ç”¨æˆ·äº¤äº’å¼èº«ä»½éªŒè¯ APIã€‚</p>
<p>å¦‚æœå®¢æˆ·ç«¯å…·æœ‰ æ´»åŠ¨ä¼šè¯ã€‚</p>
<p>ä¸»æœåŠ¡å™¨å¯èƒ½ä¼šæ›´æ”¹å¯ç”¨çš„æµ,å…·ä½“å–å†³äº æä¾›äº†æœ‰æ•ˆçš„è®¿é—®ä»¤ç‰Œã€‚</p>
<p>ä¸å…¶ä»–ç«¯ç‚¹ä¸åŒ,æ­¤ç«¯ç‚¹ä¸é‡‡ç”¨å‚æ•°,å› ä¸ºä¸»æœåŠ¡å™¨åº”å°†è¯·æ±‚ç­¾ååˆ° è€Œæ˜¯æ ‡è¯†æœåŠ¡å™¨ã€‚id_access_token</p>
<pre><code>req

{
  &quot;auth&quot;: {
    &quot;example_credential&quot;: &quot;verypoorsharedsecret&quot;,
    &quot;session&quot;: &quot;xxxxx&quot;,
    &quot;type&quot;: &quot;example.type.foo&quot;
  },
  &quot;id_server&quot;: &quot;example.org&quot;
}
</code></pre>
<pre><code>200

{
  &quot;id_server_unbind_result&quot;: &quot;success&quot;
}
</code></pre>
<pre><code>401

{
  &quot;completed&quot;: [
    &quot;example.type.foo&quot;
  ],
  &quot;flows&quot;: [
    {
      &quot;stages&quot;: [
        &quot;example.type.foo&quot;
      ]
    }
  ],
  &quot;params&quot;: {
    &quot;example.type.baz&quot;: {
      &quot;example_key&quot;: &quot;foobar&quot;
    }
  },
  &quot;session&quot;: &quot;xxxxxxyz&quot;
}
</code></pre>
<pre><code>429

{
  &quot;errcode&quot;: &quot;M_LIMIT_EXCEEDED&quot;,
  &quot;error&quot;: &quot;Too many requests&quot;,
  &quot;retry_after_ms&quot;: 2000
}
</code></pre>
<h4 id="post-_matrixclientv3accountpassword">POST /_matrix/client/v3/account/password</h4>
<p>æ›´æ”¹æ­¤ä¸»æœåŠ¡å™¨ä¸Šå¸æˆ·çš„å¯†ç ã€‚</p>
<p>æ­¤ API ç«¯ç‚¹ä½¿ç”¨ç”¨æˆ·äº¤äº’å¼èº«ä»½éªŒè¯ API æ¥ ç¡®ä¿æ›´æ”¹å¯†ç çš„ç”¨æˆ·å®é™…ä¸Šæ˜¯ å¸æˆ·ã€‚</p>
<p>å¦‚æœå®¢æˆ·ç«¯å…·æœ‰ æ´»åŠ¨ä¼šè¯ã€‚</p>
<p>ä¸»æœåŠ¡å™¨å¯èƒ½ä¼šæ›´æ”¹å¯ç”¨çš„æµ,å…·ä½“å–å†³äº æä¾›äº†æœ‰æ•ˆçš„è®¿é—®ä»¤ç‰Œã€‚ä¸»æœåŠ¡å™¨ä¸åº”æ’¤é”€ è¯·æ±‚ä¸­æä¾›çš„è®¿é—®ä»¤ç‰Œã€‚æ˜¯å¦ä¸ºå…¶ä»–è®¿é—®ä»¤ç‰Œ åŠé”€çš„ç”¨æˆ·å–å†³äºè¯·æ±‚å‚æ•°ã€‚</p>
<pre><code class="language-json">{
  &quot;auth&quot;: {
    &quot;example_credential&quot;: &quot;verypoorsharedsecret&quot;,
    &quot;session&quot;: &quot;xxxxx&quot;,
    &quot;type&quot;: &quot;example.type.foo&quot;
  },
  &quot;logout_devices&quot;: true,
  &quot;new_password&quot;: &quot;ihatebananas&quot;
}
</code></pre>
<pre><code class="language-json">{}
</code></pre>
<h4 id="post-_matrixclientv3accountpasswordemailrequesttoken">POST /_matrix/client/v3/account/password/email/requestToken</h4>
<p>ä¸»æœåŠ¡å™¨å¿…é¡»æ£€æŸ¥ç»™å®šçš„ç”µå­é‚®ä»¶åœ°å€æ˜¯å¦ä¸º ä¸æ­¤ä¸»æœåŠ¡å™¨ä¸Šçš„å¸æˆ·å…³è”ã€‚æ­¤æ¥å£åº”ä¸º ç”¨äºåœ¨å¯¹ç»ˆç»“ç‚¹è¿›è¡Œèº«ä»½éªŒè¯æ—¶è¯·æ±‚éªŒè¯ä»¤ç‰Œã€‚/account/password</p>
<p>æ­¤ API çš„å‚æ•°å’Œå“åº”ä¸ /register/email/requestToken ç«¯ç‚¹çš„å‚æ•°å’Œå“åº”ç›¸åŒ,åªæ˜¯å¦‚æœæ²¡æœ‰ä¸ å¯ä»¥æ‰¾åˆ°ç»™å®šçš„ç”µå­é‚®ä»¶åœ°å€ã€‚æœåŠ¡å™¨å¯èƒ½ä¼šå‘é€ å‘ç»™å®šåœ°å€å‘é€ç”µå­é‚®ä»¶,æç¤ºç”¨æˆ·åˆ›å»ºå¸æˆ·ã€‚
å¯èƒ½æ— æ³•é€€è´§ã€‚M_THREEPID_NOT_FOUNDM_THREEPID_IN_USE</p>
<p>ä¸»æœåŠ¡å™¨åº”éªŒè¯ç”µå­é‚®ä»¶æœ¬èº«,æ–¹æ³•æ˜¯å‘é€ éªŒè¯ç”µå­é‚®ä»¶æœ¬èº«æˆ–ä½¿ç”¨å®ƒå¯ä»¥æ§åˆ¶çš„æœåŠ¡ã€‚</p>
<pre><code class="language-json">{
  &quot;client_secret&quot;: &quot;monkeys_are_GREAT&quot;,
  &quot;email&quot;: &quot;alice@example.org&quot;,
  &quot;id_server&quot;: &quot;id.example.com&quot;,
  &quot;next_link&quot;: &quot;https://example.org/congratulations.html&quot;,
  &quot;send_attempt&quot;: 1
}
</code></pre>
<pre><code class="language-json">{
  &quot;sid&quot;: &quot;123abc&quot;,
  &quot;submit_url&quot;: &quot;https://example.org/path/to/submitToken&quot;
}
</code></pre>
<h4 id="post-_matrixclientv3accountpasswordmsisdnrequesttoken">POST /_matrix/client/v3/account/password/msisdn/requestToken</h4>
<p>ä¸»æœåŠ¡å™¨å¿…é¡»æ£€æŸ¥ç»™å®šçš„ç”µè¯å·ç æ˜¯å¦ä¸º ä¸æ­¤ä¸»æœåŠ¡å™¨ä¸Šçš„å¸æˆ·å…³è”ã€‚æ­¤æ¥å£åº”ä¸º ç”¨äºåœ¨å¯¹ç»ˆç»“ç‚¹è¿›è¡Œèº«ä»½éªŒè¯æ—¶è¯·æ±‚éªŒè¯ä»¤ç‰Œã€‚/account/password</p>
<p>æ­¤ API çš„å‚æ•°å’Œå“åº”ä¸ /register/msisdn/requestToken ç»ˆç»“ç‚¹çš„å‚æ•°å’Œå“åº”ç›¸åŒ,åªæ˜¯å¦‚æœæ²¡æœ‰ä¸ å¯ä»¥æ‰¾åˆ°ç»™å®šçš„ç”µè¯å·ç ã€‚æœåŠ¡å™¨å¯èƒ½ä¼šæ”¹ä¸ºå‘é€çŸ­ä¿¡ åˆ°æç¤ºç”¨æˆ·åˆ›å»ºå¸æˆ·çš„ç»™å®šç”µè¯å·ç ã€‚
å¯èƒ½æ— æ³•é€€è´§ã€‚M_THREEPID_NOT_FOUNDM_THREEPID_IN_USE</p>
<p>ä¸»æœåŠ¡å™¨åº”éªŒè¯ç”µè¯å·ç æœ¬èº«,æ–¹æ³•æ˜¯å‘é€ éªŒè¯æ¶ˆæ¯æœ¬èº«æˆ–é€šè¿‡ä½¿ç”¨å®ƒå¯ä»¥æ§åˆ¶çš„æœåŠ¡ã€‚</p>
<pre><code class="language-json">{
  &quot;client_secret&quot;: &quot;monkeys_are_GREAT&quot;,
  &quot;country&quot;: &quot;GB&quot;,
  &quot;id_server&quot;: &quot;id.example.com&quot;,
  &quot;next_link&quot;: &quot;https://example.org/congratulations.html&quot;,
  &quot;phone_number&quot;: &quot;07700900001&quot;,
  &quot;send_attempt&quot;: 1
}
</code></pre>
<pre><code class="language-json">{
  &quot;sid&quot;: &quot;123abc&quot;,
  &quot;submit_url&quot;: &quot;https://example.org/path/to/submitToken&quot;
}
</code></pre>
<h4 id="post-_matrixclientv3register">POST /_matrix/client/v3/register</h4>
<p>æ­¤ API çµ‚çµé»ä½¿ç”¨ä½¿ç”¨è€…äº’å‹•å¼èº«ä»½é©—è­‰ API,ä½† æ­£åœ¨è¨»å†Šä¾†è³“å¸³æˆ¶çš„æƒ…æ³ã€‚</p>
<p>åœ¨æ­¤ä¸»ä¼ºæœå™¨ä¸Šè¨»å†Šä¸€å€‹å¸³æˆ¶ã€‚</p>
<p>æœ‰å…©ç¨®é¡å‹çš„ä½¿ç”¨è€…å¸³æˆ¶:</p>
<ul>
<li>userå¸³æˆ¶ã€‚é€™äº›å¸³æˆ¶å¯ä»¥ä½¿ç”¨æœ¬è¦ç¯„ä¸­æè¿°çš„å®Œæ•´ APIã€‚</li>
<li>guestå¸³æˆ¶ã€‚é€™äº›å¸³æˆ¶å¯èƒ½å…·æœ‰æœ‰é™çš„è¨±å¯æ¬Š,ä¸¦ä¸”å¯èƒ½ä¸¦éå—æ‰€æœ‰ä¼ºæœå™¨æ”¯æ´</li>
</ul>
<p>å¦‚æœè¨»å†ŠæˆåŠŸ,æ­¤çµ‚çµé»å°‡é ’ç™¼è¨ªå•ä»¤ç‰Œ ç”¨æˆ¶ç«¯å¯ä»¥ä½¿ç”¨ åœ¨å¾ŒçºŒè«‹æ±‚ä¸­æˆæ¬Šè‡ªèº«ã€‚</p>
<p>å¦‚æœå®¢æˆ¶ç«¯æœªæä¾› ,å‰‡ä¼ºæœå™¨å¿…é ˆ è‡ªå‹•ç”Ÿæˆä¸€å€‹ã€‚device_id</p>
<p>ä¼ºæœå™¨æ‡‰æ ¹æ“šæä¾›çš„ä½¿ç”¨è€… ID è¨»å†Šä¸€å€‹å¸³æˆ¶ï¼ˆå¦‚æœæœ‰ï¼‰ã€‚è«‹æ³¨æ„,çŸ©é™£ä½¿ç”¨è€…IDçš„èªæ³• localparts å—åˆ°é™åˆ¶,å› æ­¤ä¼ºæœå™¨å¿…é ˆä»¥é‚è¼¯æ–¹å¼å°‡æä¾›çš„æ˜ å°„åˆ°
ä¸Š,æˆ–è€…æ‹’çµ•ä»»ä½•ä¸ç¬¦åˆèªæ³•çš„å…§å®¹ã€‚usernameusernameuser_idusernameM_INVALID_USERNAME</p>
<p>çŸ©é™£ç”¨æˆ¶ç«¯ä¸å¾—å‡å®šè¨»å†Šçš„æœ¬åœ°éƒ¨åˆ†èˆ‡æä¾›çš„ .user_idusername</p>
<p>è¿”å›çš„è¨ªå•ä»¤ç‰Œå¿…é ˆèˆ‡ç”¨æˆ¶ç«¯æä¾›çš„æˆ–ç”±ä¼ºæœå™¨ç”Ÿæˆçš„ç›¸é—œè¯ã€‚ä¼ºæœå™¨å¯èƒ½ ä½¿ä»¥å‰èˆ‡è©²è¨­å‚™é—œè¯çš„ä»»ä½•è¨ªå•ä»¤ç‰Œç„¡æ•ˆã€‚è«‹åƒé–±è¨ªå•ä»¤ç‰Œå’Œè¨­å‚™ä¹‹é–“çš„é—œä¿‚ã€‚device_id</p>
<p>è¨»å†Šä¾†è³“å¸³æˆ¶æ™‚,è«‹æ±‚æ­£æ–‡ä¸­çš„æ‰€æœ‰åƒæ•¸ å¿…é ˆå¿½ç•¥é™¤å¤– ç”±ä¼ºæœå™¨ã€‚ä¼ºæœå™¨å¿…é ˆç‚ºå¸³æˆ¶é¸æ“‡ä¸€å€‹ ç„¡è«–è¼¸å…¥å¦‚ä½•ã€‚initial_device_display_namedevice_id</p>
<p>è«‹æ±‚æ­£æ–‡ç¤ºä¾‹</p>
<pre><code class="language-json">{
  &quot;auth&quot;: {
    &quot;example_credential&quot;: &quot;verypoorsharedsecret&quot;,
    &quot;session&quot;: &quot;xxxxx&quot;,
    &quot;type&quot;: &quot;example.type.foo&quot;
  },
  &quot;device_id&quot;: &quot;GHTYAJCE&quot;,
  &quot;initial_device_display_name&quot;: &quot;Jungle Phone&quot;,
  &quot;password&quot;: &quot;ilovebananas&quot;,
  &quot;username&quot;: &quot;cheeky_monkey&quot;
}
</code></pre>
<p>200 å›æ‡‰</p>
<pre><code class="language-json">{
  &quot;access_token&quot;: &quot;abc123&quot;,
  &quot;device_id&quot;: &quot;GHTYAJCE&quot;,
  &quot;user_id&quot;: &quot;@cheeky_monkey:matrix.org&quot;
}
</code></pre>
<h4 id="get-_matrixclientv3registeravailable">GET /_matrix/client/v3/register/available</h4>
<p>æª¢æŸ¥ä½¿ç”¨è€…åæ˜¯å¦å¯ç”¨æ–¼ä¼ºæœå™¨ä¸”æœ‰æ•ˆã€‚</p>
<p>ä¼ºæœå™¨æ‡‰æª¢æŸ¥ä»¥ç¢ºä¿åœ¨è«‹æ±‚æ™‚ è«‹æ±‚çš„ä½¿ç”¨è€…åå¯ä¾›ä½¿ç”¨ã€‚é€™åŒ…æ‹¬é©—è­‰ æ‡‰ç”¨ç¨‹å¼æœå‹™å°šæœªè²æ˜ä½¿ç”¨è€…å,ä¸¦ä¸”è©²ä½¿ç”¨è€…å ç¬¦åˆä¼ºæœå™¨çš„æ‰€éœ€è¦æ±‚ï¼ˆä¾‹å¦‚,ä¼ºæœå™¨å¯ä»¥æŒ‡ç¤º å®ƒä¸å…è¨±å¸¶ä¸‹åŠƒç·šçš„ä½¿ç”¨è€…åï¼‰ã€‚</p>
<p>çŸ©é™£ç”¨æˆ¶ç«¯å¯èƒ½å¸Œæœ›åœ¨å˜—è©¦è¨»å†Šä¹‹å‰ä½¿ç”¨æ­¤ API, ä½†æ˜¯,å®¢æˆ¶ç«¯é‚„å¿…é ˆæ³¨æ„,é€šå¸¸ä¸æœƒä½¿ç”¨æ­¤ API ä¿ç•™ä½¿ç”¨è€…åã€‚é€™å¯èƒ½æ„å‘³è‘—ä½¿ç”¨è€…åè®Šå¾—ä¸å¯ç”¨ åœ¨æª¢æŸ¥å…¶å¯ç”¨æ€§å’Œå˜—è©¦è¨»å†Šå®ƒä¹‹é–“ã€‚</p>
<p>200 å›æ‡‰</p>
<pre><code class="language-json">{
  &quot;available&quot;: true
}
</code></pre>
<p>400 å›æ‡‰</p>
<pre><code class="language-json">{
  &quot;errcode&quot;: &quot;M_USER_IN_USE&quot;,
  &quot;error&quot;: &quot;Desired user ID is already taken.&quot;
}
</code></pre>
<h4 id="post-_matrixclientv3registeremailrequesttoken">POST /_matrix/client/v3/register/email/requestToken</h4>
<p>ä¸»ä¼ºæœå™¨å¿…é ˆæª¢æŸ¥çµ¦å®šçš„é›»å­éƒµä»¶ä½å€æ˜¯å¦å°šæœªèˆ‡æ­¤ä¸»ä¼ºæœå™¨ä¸Šçš„å¸³æˆ¶é—œè¯ã€‚ä¸»ä¼ºæœå™¨ æ‡‰é€šéç™¼é€é©—è­‰é›»å­éƒµä»¶ä¾†é©—è­‰é›»å­éƒµä»¶æœ¬èº« æœ¬èº«æˆ–é€šéä½¿ç”¨å®ƒå¯ä»¥æ§åˆ¶çš„æœå‹™ã€‚</p>
<p>è«‹æ±‚æ­£æ–‡ç¤ºä¾‹</p>
<pre><code class="language-json">{
  &quot;client_secret&quot;: &quot;monkeys_are_GREAT&quot;,
  &quot;email&quot;: &quot;alice@example.org&quot;,
  &quot;id_server&quot;: &quot;id.example.com&quot;,
  &quot;next_link&quot;: &quot;https://example.org/congratulations.html&quot;,
  &quot;send_attempt&quot;: 1
}
</code></pre>
<p>200 å›æ‡‰</p>
<pre><code class="language-json">{
  &quot;sid&quot;: &quot;123abc&quot;,
  &quot;submit_url&quot;: &quot;https://example.org/path/to/submitToken&quot;
}
</code></pre>
<h4 id="post-_matrixclientv3registermsisdnrequesttoken">POST /_matrix/client/v3/register/msisdn/requestToken</h4>
<p>ä¸»ä¼ºæœå™¨å¿…é ˆæª¢æŸ¥çµ¦å®šçš„é›»è©±è™Ÿç¢¼æ˜¯å¦å°šæœªèˆ‡æ­¤ä¸»ä¼ºæœå™¨ä¸Šçš„å¸³æˆ¶é—œè¯ã€‚ä¸»ä¼ºæœå™¨ æ‡‰é€šéç™¼é€é©—è­‰ä¾†é©—è­‰é›»è©±è™Ÿç¢¼æœ¬èº« æ¶ˆæ¯æœ¬èº«æˆ–é€šéä½¿ç”¨å®ƒå¯ä»¥æ§åˆ¶çš„æœå‹™ã€‚</p>
<p>è«‹æ±‚æ­£æ–‡ç¤ºä¾‹</p>
<pre><code class="language-json">{
  &quot;client_secret&quot;: &quot;monkeys_are_GREAT&quot;,
  &quot;country&quot;: &quot;GB&quot;,
  &quot;id_server&quot;: &quot;id.example.com&quot;,
  &quot;next_link&quot;: &quot;https://example.org/congratulations.html&quot;,
  &quot;phone_number&quot;: &quot;07700900001&quot;,
  &quot;send_attempt&quot;: 1
}
</code></pre>
<p>200 å›æ‡‰</p>
<pre><code class="language-json">{
  &quot;sid&quot;: &quot;123abc&quot;,
  &quot;submit_url&quot;: &quot;https://example.org/path/to/submitToken&quot;
}
</code></pre>
<h3 id="48">4.8 æ·»åŠ å¸³æˆ¶ç®¡ç†è¯ç¹«è³‡è¨Š</h3>
<h4 id="post-_matrixclientv3account3pidunbind">POST /_matrix/client/v3/account/3pid/unbind</h4>
<p>å¾æä¾›çš„èº«ä»½ä¼ºæœå™¨ä¸­åˆªé™¤ä½¿ç”¨è€…çš„ç¬¬ä¸‰æ–¹æ¨™è­˜ç¢¼ ç„¡éœ€å°‡å…¶å¾ä¸»ä¼ºæœå™¨ä¸­åˆªé™¤ã€‚</p>
<p>èˆ‡å…¶ä»–ç«¯é»ä¸åŒ,æ­¤ç«¯é»ä¸æ¡ç”¨åƒæ•¸,å› ç‚ºä¸»ä¼ºæœå™¨æ‡‰å°‡è«‹æ±‚ç°½ååˆ° è€Œæ˜¯æ¨™è­˜ä¼ºæœå™¨ã€‚id_access_token</p>
<p>è«‹æ±‚æ­£æ–‡ç¤ºä¾‹</p>
<pre><code class="language-json">{
  &quot;address&quot;: &quot;example@example.org&quot;,
  &quot;id_server&quot;: &quot;example.org&quot;,
  &quot;medium&quot;: &quot;email&quot;
}
</code></pre>
<p>200 å›æ‡‰</p>
<pre><code class="language-json">{
  &quot;id_server_unbind_result&quot;: &quot;success&quot;
}
</code></pre>
<h3 id="49">4.9 å¾€ä¾†å¸³æˆ¶è³‡è¨Š</h3>
<h4 id="get-_matrixclientv3accountwhoami">GET /_matrix/client/v3/account/whoami</h4>
<p>ç²å–æœ‰é—œçµ¦å®šè¨ªå•ä»¤ç‰Œçš„æ‰€æœ‰è€…çš„è³‡è¨Šã€‚</p>
<p>è«‹æ³¨æ„,èˆ‡å®¢æˆ¶ç«¯-ä¼ºæœå™¨ API çš„å…¶é¤˜éƒ¨åˆ†ä¸€æ¨£, æ‡‰ç”¨ç¨‹å¼æœå‹™å¯èƒ½æœƒå½è£æˆå…¶ä½¿ç”¨è€… å‘½åç©ºé–“,é€šéæä¾›æŸ¥è©¢åƒæ•¸ã€‚åœ¨æ­¤ åœ¨é€™ç¨®æƒ…æ³ä¸‹,ä¼ºæœå™¨æ‡‰é©—è­‰çµ¦å®šçš„æ˜¯å¦ç”±æ‡‰ç”¨æœå‹™è¨»å†Š,ä¸¦åœ¨å›æ‡‰ä¸­è¿”å› bodyã€‚user_iduser_id</p>
<p>200 å›æ‡‰</p>
<pre><code class="language-json">{
  &quot;device_id&quot;: &quot;ABC1234&quot;,
  &quot;user_id&quot;: &quot;@joe:example.org&quot;
}
</code></pre>
<h4 id="491">4.9.1 æœ‰é—œèº«ä»½ä¼ºæœå™¨çš„èªªæ˜</h4>
<p>Matrix ä¸­çš„è­˜åˆ¥ä¼ºæœå™¨å„²å­˜ç¶å®šï¼ˆé—œä¿‚ï¼‰ ä½¿ç”¨è€…çš„ç¬¬ä¸‰æ–¹æ¨™è­˜ç¢¼,é€šå¸¸æ˜¯é›»å­éƒµä»¶æˆ–é›»è©±è™Ÿç¢¼,ä»¥åŠ ä»–å€‘çš„ä½¿ç”¨è€…IDã€‚ç”¨æˆ¶é¸æ“‡èº«ä»½ä¼ºæœå™¨å,è©²èº«ä»½ ä¼ºæœå™¨æ‡‰ç”±æ‰€æœ‰ç”¨æˆ¶ç«¯ä½¿ç”¨ã€‚</p>
<p>ç”¨æˆ¶ç«¯å¯ä»¥é€šéå¸³æˆ¶æ•¸æ“šäº‹ä»¶æŸ¥çœ‹ç”¨æˆ¶é¸æ“‡äº†å“ªå€‹èº«ä»½ä¼ºæœå™¨,å¦‚ä¸‹æ‰€è¿°ã€‚å®¢æˆ¶ æ‡‰é¿å…å‘ä»»ä½•èº«ä»½ä¼ºæœå™¨ç™¼å‡ºè«‹æ±‚,ç›´åˆ° çš„å­˜åœ¨è¢«ç¢ºèªç‚ºï¼ˆä¸å­˜åœ¨ï¼‰ã€‚å¦‚æœ å­˜åœ¨,ç”¨æˆ¶ç«¯æ‡‰æª¢æŸ¥äº‹ä»¶å…§å®¹ä¸­æ˜¯å¦å­˜åœ¨å±¬æ€§ã€‚å¦‚æœå­˜åœ¨,å‰‡ ç”¨æˆ¶ç«¯æ‡‰ä½¿ç”¨è©²å±¬æ€§ä¸­çš„æ¨™è­˜ä¼ºæœå™¨ä½œç‚ºæ¨™è­˜
ç”¨æˆ¶çš„ä¼ºæœå™¨ã€‚å¦‚æœç¼ºå°‘,æˆ–è€…å¸³æˆ¶æ•¸æ“š äº‹ä»¶ä¸å­˜åœ¨,å®¢æˆ¶ç«¯æ‡‰ä½¿ç”¨ä»»ä½•é è¨­å€¼ é€šå¸¸é©ç”¨æ–¼èº«ä»½ä¼ºæœå™¨ï¼ˆå¦‚æœé©ç”¨ï¼‰ã€‚å®¢æˆ¶ä¸æ‡‰ ç•¶ä½¿ç”¨è€…ä½¿ç”¨é è¨­èº«ä»½ä¼ºæœå™¨æ›´æ–°å¸³æˆ¶æ•¸æ“šæ™‚
å…¶å¸³æˆ¶æ•¸æ“šä¸­ç¼ºå°‘èº«ä»½ä¼ºæœå™¨ã€‚m.identity_serverm.identity_serverbase_urlbase_urlbase_url</p>
<p>å®¢æˆ¶æ‡‰åµè½å¸³æˆ¶çš„æ›´æ”¹ æ•¸æ“šäº‹ä»¶,ä¸¦æ›´æ–°ä»–å€‘æ­£åœ¨è¯ç¹«çš„èº«ä»½ä¼ºæœå™¨ çµæœã€‚m.identity_server</p>
<p>å¦‚æœç”¨æˆ¶ç«¯æä¾›äº†ä¸€ç¨®è¨­ç½®è¦ä½¿ç”¨çš„èº«ä»½ä¼ºæœå™¨çš„æ–¹æ³•,å‰‡å¿…é ˆ ç›¸æ‡‰åœ°æ›´æ–°çš„å€¼ã€‚A çš„ MUST è¢«è¦–ç‚ºä½¿ç”¨è€…ä¸æƒ³ä½¿ç”¨ èº«ä»½ä¼ºæœå™¨,å› æ­¤ç¦ç”¨æ‰€æœ‰ç›¸é—œåŠŸèƒ½ã€‚m.identity_serverbase_urlnull</p>
<p>å®¢æˆ¶æ‡‰é¿å…å°‡å¸³æˆ¶æ•¸æ“šä½œç‚ºé·ç§»é€²è¡Œå¡«å…… é‡å°ç¼ºå°‘å¸³æˆ¶æ•¸æ“šçš„ä½¿ç”¨è€…çš„æ­¥é©Ÿ,é™¤éç”¨æˆ¶è¨­ç½® ç”¨æˆ¶ç«¯å…§çš„èº«ä»½ä¼ºæœå™¨ç‚ºå€¼ã€‚ä¾‹å¦‚,ä½¿ç”¨è€… æ²’æœ‰å¸³æˆ¶æ•¸æ“šäº‹ä»¶ä¸æ‡‰æœ€çµ‚ åœ¨å¸³æˆ¶æ•¸æ“šä¸­ä½¿ç”¨å®¢æˆ¶ç«¯çš„é è¨­èº«ä»½ä¼ºæœå™¨,é™¤é
ä½¿ç”¨è€…é¦–å…ˆè¨ªå•å…¶å¸³æˆ¶è¨­ç½®ä»¥è¨­ç½®èº«ä»½ä¼ºæœå™¨ã€‚m.identity_server</p>
<p>ä¾‹å­</p>
<pre><code class="language-json">{
  &quot;content&quot;: {
    &quot;base_url&quot;: &quot;https://example.org&quot;
  },
  &quot;type&quot;: &quot;m.identity_server&quot;
}
</code></pre>
<h2 id="5">5. èƒ½åŠ›å”å•†</h2>
<p>ä¸»ä¼ºæœå™¨å¯èƒ½ä¸æ”¯æ´æŸäº›æ“ä½œ,å®¢æˆ¶ç«¯å¿…é ˆèƒ½å¤  æŸ¥è©¢ä¸»ä¼ºæœå™¨å¯ä»¥æä¾›å’Œä¸èƒ½æä¾›çš„å…§å®¹ã€‚ä¾‹å¦‚,ä¸€å€‹ å®¶åº­ä¼ºæœå™¨å¯èƒ½ä¸æ”¯æ´ä½¿ç”¨è€…æŒ‰åŸæ¨£æ›´æ”¹å…¶å¯†ç¢¼ é…ç½®ç‚ºå°å¤–éƒ¨ç³»çµ±åŸ·è¡Œèº«ä»½é©—è­‰ã€‚</p>
<p>é€šéæ­¤ç³»çµ±å®£å‚³çš„åŠŸèƒ½æ—¨åœ¨ é€šå‘Šåœ¨ API ä¸­å¯é¸çš„åŠŸèƒ½,æˆ–è€…ä¾è³´æ–¼ ä½¿ç”¨è€…æˆ–ä¼ºæœå™¨ç‹€æ…‹çš„æŸç¨®æ–¹å¼ã€‚é€™å€‹ç³»çµ±ä¸æ‡‰è©² ç”¨æ–¼å®£å‚³ä¸ç©©å®šæˆ–å¯¦é©—æ€§åŠŸèƒ½ - é€™æ›´å¥½ ç”±ç«¯é»å®Œæˆã€‚/versions</p>
<p>åˆç†èƒ½åŠ›çš„ä¸€äº›ç¯„ä¾‹åŒ…æ‹¬:</p>
<ul>
<li>ä¼ºæœå™¨æ˜¯å¦æ”¯æ´ç”¨æˆ¶ç‹€æ…‹ã€‚</li>
<li>ä¼ºæœå™¨æ˜¯å¦æ”¯æ´å¯é¸åŠŸèƒ½,ä¾‹å¦‚ä½¿ç”¨è€…æˆ– æˆ¿é–“ç›®éŒ„ã€‚</li>
<li>å°ç”¨æˆ¶ç«¯æ–½åŠ çš„é€Ÿç‡é™åˆ¶æˆ–æª”é¡å‹é™åˆ¶ ä¼ºæœå™¨ã€‚</li>
</ul>
<p>ä¸æ‡‰æˆç‚ºåŠŸèƒ½çš„ä¸€äº›ç¯„ä¾‹åŒ…æ‹¬:</p>
<ul>
<li>ä¼ºæœå™¨æ˜¯å¦æ”¯æŒè¦ç¯„ä¸­çš„åŠŸèƒ½ã€‚unstable</li>
<li>åª’é«”å¤§å°é™åˆ¶ - é€™äº›é™åˆ¶ç”± /config API è™•ç†ã€‚</li>
<li>ç”¨æ–¼é€šä¿¡çš„å¯é¸ç·¨ç¢¼æˆ–æ›¿ä»£å‚³è¼¸ ä¼ºæœå™¨</li>
</ul>
<p>å‰ç¶´ç‚ºçš„åŠŸèƒ½ä¿ç•™ç”¨æ–¼åœ¨ çŸ©é™£è¦ç¯„,è€Œå…¶ä»–å€¼å¯èƒ½ç”±ä¼ºæœå™¨ä½¿ç”¨ Java åŒ…å‘½åç´„å®šã€‚çŸ©é™£æ”¯æ´çš„åŠŸèƒ½ è¦ç¯„å°‡åœ¨æœ¬ç¯€å¾Œé¢å®šç¾©ã€‚m.</p>
<h4 id="get-_matrixclientv3capabilities">GET /_matrix/client/v3/capabilities</h4>
<p>ç²å–æœ‰é—œä¼ºæœå™¨æ”¯æ´çš„åŠŸèƒ½é›†çš„è³‡è¨Š å’Œå…¶ä»–ç›¸é—œåŠŸèƒ½ã€‚</p>
<p>200 å›æ‡‰</p>
<pre><code class="language-json">{
  &quot;capabilities&quot;: {
    &quot;com.example.custom.ratelimit&quot;: {
      &quot;max_requests_per_hour&quot;: 600
    },
    &quot;m.change_password&quot;: {
      &quot;enabled&quot;: false
    },
    &quot;m.room_versions&quot;: {
      &quot;available&quot;: {
        &quot;1&quot;: &quot;stable&quot;,
        &quot;2&quot;: &quot;stable&quot;,
        &quot;3&quot;: &quot;unstable&quot;,
        &quot;test-version&quot;: &quot;unstable&quot;
      },
      &quot;default&quot;: &quot;1&quot;
    }
  }
}
</code></pre>
<h3 id="51-mchange_password">5.1 m.change_passwordèƒ½åŠ›</h3>
<p>æ­¤åŠŸèƒ½å…·æœ‰å–®å€‹æ¨™èªŒ,æŒ‡ç¤ºæ˜¯å¦æˆ– ä¸æ˜¯ä½¿ç”¨è€…å¯ä»¥ä½¿ç”¨ API ä¾†æ›´æ”¹å…¶ å¯†ç¢¼ã€‚å¦‚æœä¸å­˜åœ¨,ç”¨æˆ¶ç«¯æ‡‰å‡å®šå¯†ç¢¼æ›´æ”¹ å¯ä»¥é€šé API å¯¦ç¾ã€‚å¦‚æœå­˜åœ¨,å®¢æˆ¶æ‡‰å°Šé‡ åŠŸèƒ½çš„æ¨™èªŒ,ä¸¦åœ¨ç”¨æˆ¶ç„¡æ³•æ™‚å‘ä½¿ç”¨è€…æŒ‡ç¤º
ä»¥æ›´æ”¹å…¶å¯†ç¢¼ã€‚enabled/account/passwordenabled</p>
<p>åŠŸèƒ½ API å°æ­¤åŠŸèƒ½çš„å›æ‡‰ç¤ºä¾‹å¦‚ä¸‹:</p>
<pre><code>{
  &quot;capabilities&quot;: {
    &quot;m.change_password&quot;: {
      &quot;enabled&quot;: false
    }
  }
}

</code></pre>
<h3 id="52-mroom_versions">5.2 m.room_versionsèƒ½åŠ›</h3>
<p>æ­¤åŠŸèƒ½æè¿°é è¨­å’Œå¯ç”¨çš„æˆ¿é–“ç‰ˆæœ¬ a ä¼ºæœå™¨æ”¯æ´,ä»¥åŠç©©å®šæ€§ç´šåˆ¥ã€‚å®¢æˆ¶æ‡‰ä½¿ç”¨ æ­¤åŠŸèƒ½,ä»¥ç¢ºå®šæ˜¯å¦éœ€è¦é¼“å‹µä½¿ç”¨è€… å‡ç´šä»–å€‘çš„æˆ¿é–“ã€‚</p>
<p>åŠŸèƒ½ API å°æ­¤åŠŸèƒ½çš„å›æ‡‰ç¤ºä¾‹å¦‚ä¸‹:</p>
<pre><code class="language-json">{
  &quot;capabilities&quot;: {
    &quot;m.room_versions&quot;: {
      &quot;default&quot;: &quot;1&quot;,
      &quot;available&quot;: {
        &quot;1&quot;: &quot;stable&quot;,
        &quot;2&quot;: &quot;stable&quot;,
        &quot;3&quot;: &quot;unstable&quot;,
        &quot;custom-version&quot;: &quot;unstable&quot;
      }
    }
  }
}
</code></pre>
<p>æ­¤åŠŸèƒ½åæ˜ äº†æˆ¿é–“çš„ç›¸åŒé™åˆ¶ ç”¨æ–¼æè¿°å“ªäº›ç‰ˆæœ¬çš„ç‰ˆæœ¬ ç©©å®šå’Œä¸ç©©å®šã€‚ç”¨æˆ¶ç«¯æ‡‰å‡å®šç‰ˆæœ¬ç‚º ã€‚ä»»ä½•æœªæ˜ç¢ºæ¨™è¨˜ç‚ºç‰ˆæœ¬çš„ç‰ˆæœ¬éƒ½å°‡è¢«è¦–ç‚º ã€‚ä¾‹å¦‚,ä¸€å€‹ åˆ—ç‚ºçš„ç‰ˆæœ¬æ‡‰è¢«è¦–ç‚º
ã€‚defaultstablestableavailableunstablefuture-stableunstable</p>
<p>ç‰ˆæœ¬æ˜¯ä¼ºæœå™¨ç”¨æ–¼å‰µå»ºæ–°ç‰ˆæœ¬çš„ç‰ˆæœ¬ æˆ¿é–“ã€‚ç”¨æˆ¶ç«¯æ‡‰é¼“å‹µå…·æœ‰è¶³å¤ è¨±å¯æ¬Šçš„ä½¿ç”¨è€…åœ¨ æˆ¿é–“å°‡ä»–å€‘çš„æˆ¿é–“å‡ç´šåˆ°æˆ¿é–“æ™‚çš„ç‰ˆæœ¬ ä½¿ç”¨ç‰ˆæœ¬ã€‚defaultdefaultunstable</p>
<p>å¦‚æœæœªåˆ—å‡ºæ­¤åŠŸèƒ½,ç”¨æˆ¶ç«¯æ‡‰ç”¨ä½œ é»˜èªä¸”å”¯ä¸€ç©©å®šçš„æˆ¿é–“ç‰ˆæœ¬ã€‚"1"available</p>
<h3 id="53-mset_displayname">5.3 m.set_displaynameèƒ½åŠ›</h3>
<p>æ­¤åŠŸèƒ½å…·æœ‰å–®å€‹æ¨™èªŒ ,ç”¨æ–¼æŒ‡ç¤ºä½¿ç”¨è€…æ˜¯å¦ èƒ½å¤ é€šéé…ç½®æª”çµ‚çµé»æ›´æ”¹è‡ªå·±çš„é¡¯ç¤ºåç¨±ã€‚æ¡ˆä¾‹ ç¦ç”¨å¯èƒ½åŒ…æ‹¬å¾å¤–éƒ¨æ¨™è­˜/ç›®éŒ„æ˜ å°„çš„ä½¿ç”¨è€… æœå‹™,ä¾‹å¦‚LDAPã€‚enabled</p>
<p>è«‹æ³¨æ„,é€™èˆ‡åŠŸèƒ½å¾ˆå¥½åœ°åŒ¹é…ã€‚m.set_avatar_url</p>
<p>å¦‚æœæœªåˆ—å‡º,ç”¨æˆ¶ç«¯æ‡‰å‡å®šç”¨æˆ¶èƒ½å¤ æ›´æ”¹å…¶ é¡¯ç¤ºåç¨±ã€‚</p>
<p>åŠŸèƒ½ API å°æ­¤åŠŸèƒ½çš„å›æ‡‰ç¤ºä¾‹å¦‚ä¸‹:</p>
<pre><code class="language-json">{
  &quot;capabilities&quot;: {
    &quot;m.set_displayname&quot;: {
      &quot;enabled&quot;: false
    }
  }
}
</code></pre>
<h3 id="54-mset_avatar_url">5.4 m.set_avatar_urlèƒ½åŠ›</h3>
<p>æ­¤åŠŸèƒ½å…·æœ‰å–®å€‹æ¨™èªŒ ,ç”¨æ–¼æŒ‡ç¤ºä½¿ç”¨è€…æ˜¯å¦ èƒ½å¤ é€šéé…ç½®æª”ç«¯é»æ›´æ”¹è‡ªå·±çš„é ­åƒã€‚æ¡ˆä¾‹ ç¦ç”¨å¯èƒ½åŒ…æ‹¬å¾å¤–éƒ¨æ¨™è­˜/ç›®éŒ„æ˜ å°„çš„ä½¿ç”¨è€… æœå‹™,ä¾‹å¦‚LDAPã€‚enabled</p>
<p>è«‹æ³¨æ„,é€™èˆ‡åŠŸèƒ½å¾ˆå¥½åœ°åŒ¹é…ã€‚m.set_displayname</p>
<p>å¦‚æœæœªåˆ—å‡º,ç”¨æˆ¶ç«¯æ‡‰å‡å®šç”¨æˆ¶èƒ½å¤ æ›´æ”¹å…¶ åŒ–èº«ã€‚</p>
<p>åŠŸèƒ½ API å°æ­¤åŠŸèƒ½çš„å›æ‡‰ç¤ºä¾‹å¦‚ä¸‹:</p>
<pre><code class="language-json">{
  &quot;capabilities&quot;: {
    &quot;m.set_avatar_url&quot;: {
      &quot;enabled&quot;: false
    }
  }
}
</code></pre>
<h3 id="55-m3pid_changes">5.5 m.3pid_changesèƒ½åŠ›</h3>
<p>æ­¤åŠŸèƒ½å…·æœ‰å–®å€‹æ¨™èªŒ ,ç”¨æ–¼æŒ‡ç¤ºä½¿ç”¨è€…æ˜¯å¦ èƒ½å¤ æ·»åŠ ,åˆªé™¤æˆ–æ›´æ”¹å…¶å¸³æˆ¶ä¸Šçš„ 3PID é—œè¯ã€‚æ³¨æ„ é€™åƒ…å½±éŸ¿ä½¿ç”¨è€…ä½¿ç”¨ç®¡ç†å“¡è¯ç¹«è³‡è¨Š API çš„èƒ½åŠ›,è€Œä¸æœƒå½±éŸ¿èº«ä»½æœå‹™å…¬é–‹çš„çµ‚çµé»ã€‚ç¦ç”¨æ¡ˆä¾‹ å¯èƒ½åŒ…æ‹¬å¾å¤–éƒ¨æ¨™è­˜/ç›®éŒ„æœå‹™æ˜ å°„çš„ä½¿ç”¨è€…,
ä¾‹å¦‚LDAPã€‚enabled</p>
<p>å¦‚æœæœªåˆ—å‡º,ç”¨æˆ¶ç«¯æ‡‰å‡å®šç”¨æˆ¶èƒ½å¤ ä¿®æ”¹å…¶ 3PID å”æœƒã€‚</p>
<p>åŠŸèƒ½ API å°æ­¤åŠŸèƒ½çš„å›æ‡‰ç¤ºä¾‹å¦‚ä¸‹:</p>
<pre><code class="language-json">{
  &quot;capabilities&quot;: {
    &quot;m.3pid_changes&quot;: {
      &quot;enabled&quot;: false
    }
  }
}
</code></pre>
<h2 id="6">6 æ¿¾æ³¢</h2>
<p>éæ¿¾å™¨å¯ä»¥åœ¨ä¼ºæœå™¨ä¸Šå‰µå»º,ä¸¦å¯ä»¥ä½œç‚ºåƒæ•¸å‚³éçµ¦ è¿”å›äº‹ä»¶çš„ APIã€‚é€™äº›ç¯©é¸å™¨æ›´æ”¹å¾è¿”å›çš„æ•¸æ“š é‚£äº› APIã€‚ä¸¦éæ‰€æœ‰ API éƒ½æ¥å—ç¯©é¸å™¨ã€‚</p>
<h3 id="61">6.1 æ‡¶äººè£è¼‰å®¤æˆå“¡</h3>
<p>æœƒå“¡æ´»å‹•é€šå¸¸éœ€è¦å¤§é‡è³‡æºä¾›å®¢æˆ¶è·Ÿè¹¤ã€‚ ç‚ºäº†æ¸›å°‘ä½¿ç”¨çš„è³‡æºæ•¸é‡,ç”¨æˆ¶ç«¯å¯ä»¥å•Ÿç”¨ æˆ¿é–“æˆå“¡çš„'å»¶é²è¼‰å…¥'ã€‚ã€‚é€šéé€™æ¨£åš,ä¼ºæœå™¨å°‡å˜—è©¦ åƒ…ç™¼é€èˆ‡å®¢æˆ¶ç›¸é—œçš„æœƒå“¡æ´»å‹•ã€‚</p>
<p>é‡è¦çš„æ˜¯è¦äº†è§£å»¶é²è¼‰å…¥ä¸¦ä¸æ˜¯ç‚ºäº† å®Œç¾çš„å„ªåŒ–,ä¸¦ä¸”ä¼ºæœå™¨å¯èƒ½ä¸åˆ‡å¯¦éš› ç²¾ç¢ºè¨ˆç®—å“ªäº›æˆå“¡è³‡æ ¼äº‹ä»¶èˆ‡å®¢æˆ¶ç›¸é—œã€‚ å› æ­¤,ä¼ºæœå™¨ç™¼é€å†—é¤˜æˆå“¡è³‡æ ¼æ˜¯æœ‰æ•ˆçš„ äº‹ä»¶å‘å®¢æˆ¶ç«¯ç°¡åŒ–å¯¦ç¾,å„˜ç®¡é€™ç¨®å†—é¤˜ æ‡‰ç›¡å¯èƒ½æ¸›å°‘ä»¥ç¯€çœé »å¯¬ã€‚</p>
<p>åœ¨ç¯©æª¢ç¨‹å¼æ–¹é¢,å»¶é²è¼‰å…¥æ˜¯é€šéåœ¨ ï¼ˆæˆ– åƒ…å¤§å°å¯«ï¼‰ã€‚å•Ÿç”¨å¾Œ,å»¶é²è¼‰å…¥æ„ŸçŸ¥ç«¯é»ï¼ˆè«‹åƒé–± ä»¥ä¸‹ï¼‰å°‡åƒ…åŒ…æ‹¬ OF æ´»å‹•çš„æœƒå“¡æ´»å‹• åŒ…å«åœ¨å›æ‡‰ä¸­ã€‚ä¾‹å¦‚,å¦‚æœå®¢æˆ¶ç«¯ç™¼å‡ºå•Ÿç”¨äº†å»¶é²è¼‰å…¥çš„è«‹æ±‚,å‰‡ä¼ºæœå™¨å°‡åƒ…è¿”å› æ™‚é–“ç·šä¸­äº‹ä»¶çš„æˆå“¡èº«ä»½äº‹ä»¶,è€Œä¸æ˜¯å…¨éƒ¨
èŠå¤©å®¤çš„æˆå“¡ã€‚lazy_load_membersRoomEventFilterStateFilter/syncsender/syncsender</p>
<p>åœ¨è™•ç†ä¸€ç³»åˆ—äº‹ä»¶æ™‚ï¼ˆä¾‹å¦‚,é€šéè¿´åœˆæˆ– åˆ†é  ï¼‰,å°æ–¼äº‹ä»¶å¡Šä¾†èªªå¾ˆå¸¸è¦‹ åºåˆ—ä»¥å…±ç”¨ä¸€çµ„é¡ä¼¼çš„å¯„ä»¶è€…ã€‚è€Œä¸æ˜¯å›æ‡‰ å°‡é€™äº›ç™¼é€æ–¹çš„é‡è¤‡æˆå“¡èº«ä»½äº‹ä»¶ç™¼é€åˆ° ç”¨æˆ¶ç«¯,ä¼ºæœå™¨å¯èƒ½æœƒå‡è¨­å®¢æˆ¶ç«¯æœƒè¨˜ä½æˆå“¡è³‡æ ¼ å·²ç™¼é€çš„äº‹ä»¶,ä¸¦é¸æ“‡è·³éç™¼é€
æœƒå“¡è³‡æ ¼æœªæ›´æ”¹çš„æˆå“¡è³‡æ ¼æ´»å‹•ã€‚é€™äº› ç¨±ç‚º'å†—é¤˜æˆå“¡è³‡æ ¼äº‹ä»¶'ã€‚ã€‚å®¢æˆ¶å¯ä»¥è¦æ±‚ å†—é¤˜æˆå“¡èº«ä»½äº‹ä»¶å§‹çµ‚åŒ…å«åœ¨å›æ‡‰ä¸­,æ–¹æ³•æ˜¯åœ¨ç¯©é¸å™¨ä¸­è¨­ç½®ç‚º trueã€‚/sync/messagesinclude_redundant_members</p>
<p>ä½¿ç”¨å»¶é²è¼‰å…¥çš„é æœŸæ¨¡å¼ç›®å‰ç‚º:</p>
<ul>
<li>ç”¨æˆ¶ç«¯åœ¨å•Ÿç”¨å»¶é²è¼‰å…¥çš„æƒ…æ³ä¸‹åŸ·è¡Œåˆå§‹ /sync,ä¸¦ä¸” åƒ…æ¥æ”¶èˆ‡çš„ç™¼é€æ–¹ç›¸é—œçš„æˆå“¡èº«ä»½äº‹ä»¶ å®ƒæ¥æ”¶çš„äº‹ä»¶ã€‚</li>
<li>æ”¯æŒé¡¯ç¤ºåç¨±åˆ¶è¡¨å…ƒè£œå…¨æˆ–å…¶ä»–åŠŸèƒ½çš„ç”¨æˆ¶ç«¯ éœ€è¦å¿«é€Ÿè¨ªå•æˆ¿é–“å…§æ‰€æœ‰æˆå“¡çš„æ“ä½œ æ‡‰ç‚ºç•¶å‰é¸å®šçš„èŠå¤©å®¤èª¿ç”¨ /members,ä¸¦å°‡åƒæ•¸è¨­ç½®ç‚º /sync å›æ‡‰çš„ from ä»¤ç‰Œã€‚æˆå“¡æ¸…å–® å› ç‚ºæˆ¿é–“ç„¶å¾Œç”±åœ‹å®¶åœ¨éš¨å¾Œç¶­è­· å¢é‡/åŒæ­¥å›æ‡‰ã€‚?at</li>
<li>ä¸æ”¯æ´è£½è¡¨ç¬¦è£œå…¨çš„ç”¨æˆ¶ç«¯å¯èƒ½æœƒæ‹‰å…¥ ä»»æ„ä½¿ç”¨è€…çš„é…ç½®æª”ï¼ˆä¾‹å¦‚å·²è®€å›åŸ·,éµå…¥ é€šçŸ¥ï¼‰é€šéæŸ¥è©¢æˆ¿é–“ç‹€æ…‹æˆ– ./profile</li>
</ul>
<p>æ”¯æ´å»¶é²è¼‰å…¥æˆ¿é–“æˆå“¡çš„ç•¶å‰çµ‚çµé»åŒ…æ‹¬:</p>
<ul>
<li>/sync</li>
<li>/rooms/<room_id>/messages</li>
<li>/rooms/<room_id>/context/{eventId}</li>
</ul>
<h3 id="62">6.2 ä»‹é¢é€£æ¥é»</h3>
<h4 id="post-_matrixclientv3useruseridfilter">POST /_matrix/client/v3/user/{userId}/filter</h4>
<p>å°‡æ–°çš„ç¯©é¸å™¨å®šç¾©ä¸Šè¼‰åˆ°ä¸»ä¼ºæœå™¨ã€‚ è¿”å›ç¯©é¸å™¨ID,è©²IDå¯åœ¨å°‡ä¾†çš„è«‹æ±‚ä¸­ä½¿ç”¨ é™åˆ¶å°‡å“ªäº›äº‹ä»¶è¿”å›åˆ°ç”¨æˆ¶ç«¯ã€‚</p>
<p>è«‹æ±‚æ­£æ–‡ç¤ºä¾‹</p>
<pre><code class="language-json">{
  &quot;event_fields&quot;: [
    &quot;type&quot;,
    &quot;content&quot;,
    &quot;sender&quot;
  ],
  &quot;event_format&quot;: &quot;client&quot;,
  &quot;presence&quot;: {
    &quot;not_senders&quot;: [
      &quot;@alice:example.com&quot;
    ],
    &quot;types&quot;: [
      &quot;m.presence&quot;
    ]
  },
  &quot;room&quot;: {
    &quot;ephemeral&quot;: {
      &quot;not_rooms&quot;: [
        &quot;!726s6s6q:example.com&quot;
      ],
      &quot;not_senders&quot;: [
        &quot;@spam:example.com&quot;
      ],
      &quot;types&quot;: [
        &quot;m.receipt&quot;,
        &quot;m.typing&quot;
      ]
    },
    &quot;state&quot;: {
      &quot;not_rooms&quot;: [
        &quot;!726s6s6q:example.com&quot;
      ],
      &quot;types&quot;: [
        &quot;m.room.*&quot;
      ]
    },
    &quot;timeline&quot;: {
      &quot;limit&quot;: 10,
      &quot;not_rooms&quot;: [
        &quot;!726s6s6q:example.com&quot;
      ],
      &quot;not_senders&quot;: [
        &quot;@spam:example.com&quot;
      ],
      &quot;types&quot;: [
        &quot;m.room.message&quot;
      ]
    }
  }
}
</code></pre>
<p>200 å›æ‡‰</p>
<pre><code class="language-json">{
  &quot;filter_id&quot;: &quot;66696p746572&quot;
}
</code></pre>
<h4 id="get-_matrixclientv3useruseridfilterfilterid">GET /_matrix/client/v3/user/{userId}/filter/{filterId}</h4>
<p>200 å›æ‡‰</p>
<pre><code class="language-json">{
  &quot;event_fields&quot;: [
    &quot;type&quot;,
    &quot;content&quot;,
    &quot;sender&quot;
  ],
  &quot;event_format&quot;: &quot;client&quot;,
  &quot;presence&quot;: {
    &quot;not_senders&quot;: [
      &quot;@alice:example.com&quot;
    ],
    &quot;types&quot;: [
      &quot;m.presence&quot;
    ]
  },
  &quot;room&quot;: {
    &quot;ephemeral&quot;: {
      &quot;not_rooms&quot;: [
        &quot;!726s6s6q:example.com&quot;
      ],
      &quot;not_senders&quot;: [
        &quot;@spam:example.com&quot;
      ],
      &quot;types&quot;: [
        &quot;m.receipt&quot;,
        &quot;m.typing&quot;
      ]
    },
    &quot;state&quot;: {
      &quot;not_rooms&quot;: [
        &quot;!726s6s6q:example.com&quot;
      ],
      &quot;types&quot;: [
        &quot;m.room.*&quot;
      ]
    },
    &quot;timeline&quot;: {
      &quot;limit&quot;: 10,
      &quot;not_rooms&quot;: [
        &quot;!726s6s6q:example.com&quot;
      ],
      &quot;not_senders&quot;: [
        &quot;@spam:example.com&quot;
      ],
      &quot;types&quot;: [
        &quot;m.room.message&quot;
      ]
    }
  }
}
</code></pre>
<h2 id="7">7 äº‹ä»¶</h2>
<p>ç”¨æˆ¶ç«¯-ä¼ºæœå™¨ API å…¬é–‹çš„å°è©±æ­·å²è¨˜éŒ„æ¨¡å‹å¯ä»¥ è¢«è¦–ç‚ºäº‹ä»¶æ¸…å–®ã€‚ä¼ºæœå™¨'è¡ŒåŒ–'äº† å°‡äº‹ä»¶çš„æœ€çµ‚ä¸€è‡´æ€§äº‹ä»¶åœ–è½‰æ›ç‚º"äº‹ä»¶æµ" ä»»ä½•çµ¦å®šçš„æ™‚é–“é»:</p>
<pre><code>[E0]-&gt;[E1]-&gt;[E2]-&gt;[E3]-&gt;[E4]-&gt;[E5]
</code></pre>
<h3 id="71">7.1 æˆ¿é–“æ´»å‹•çš„é¡å‹</h3>
<p>æœƒè­°å®¤æ´»å‹•åˆ†ç‚ºå…©é¡:</p>
<ul>
<li>ç‹€æ…‹äº‹ä»¶:é€™äº›æ˜¯æ›´æ–°æˆ¿é–“ï¼ˆä¾‹å¦‚æˆ¿é–“ï¼‰å…ƒæ•¸æ“šç‹€æ…‹çš„äº‹ä»¶ ä¸»é¡Œ,æˆ¿é–“æˆå“¡è³‡æ ¼ç­‰ï¼‰ã€‚ç‹€æ…‹ç”±äº‹ä»¶å…ƒçµ„å’Œ .å…·æœ‰ç›¸åŒéµå…ƒçµ„çš„æˆ¿é–“ä¸­çš„ç‹€æ…‹å°‡æ˜¯ è¦†è“‹ã€‚typestate_key</li>
<li>æ¶ˆæ¯äº‹ä»¶:é€™äº›äº‹ä»¶æè¿°äº†æˆ¿é–“ä¸­çš„æš«æ™‚æ€§'ä¸€æ¬¡æ€§'æ´»å‹•:é€šå¸¸æ˜¯é€šä¿¡,ä¾‹å¦‚ç™¼é€å³æ™‚æ¶ˆæ¯æˆ–è¨­ç½® ç¶²è·¯é›»è©±å‘¼å«ã€‚</li>
</ul>
<p>æ­¤è¦ç¯„æ¦‚è¿°äº†å¹¾å€‹äº‹ä»¶,æ‰€æœ‰äº‹ä»¶éƒ½å…·æœ‰äº‹ä»¶é¡å‹ å‰ç¶´ã€‚ï¼ˆæœ‰é—œ m. äº‹ä»¶,è«‹åƒé–±æˆ¿é–“äº‹ä»¶ è¦ç¯„ã€‚ä½†æ˜¯,æ‡‰ç”¨ç¨‹å¼å¯èƒ½å¸Œæœ›æ·»åŠ è‡ªå·±çš„é¡å‹ äº‹ä»¶,é€™å¯ä»¥ä½¿ç”¨ ä»¥ä¸‹å„ç¯€ã€‚å¦‚æœæ·»åŠ äº†æ–°äº‹ä»¶,å‰‡äº‹ä»¶éµæ‡‰ éµå¾ª Java åŒ…å‘½åç´„å®š,ä¾‹å¦‚
.é€™å¯ç¢ºä¿äº‹ä»¶é¡å‹åˆé© ç‚ºæ¯å€‹æ‡‰ç”¨ç¨‹å¼å‘½å,ä¸¦é™ä½è¡çªé¢¨éšªã€‚m.typecom.example.myapp.event</p>
<h3 id="72">7.2 æœƒè­°å®¤äº‹ä»¶æ ¼å¼</h3>
<p>èŠå¤©å®¤äº‹ä»¶çš„'è¯åˆ'æ ¼å¼,ç”±ä¸»ä¼ºæœå™¨åœ¨å…§éƒ¨ä½¿ç”¨ å’Œé€šéä¼ºæœå™¨-ä¼ºæœå™¨APIçš„å®¶åº­ä¼ºæœå™¨ä¹‹é–“,å–æ±ºæ–¼"æˆ¿é–“" ç‰ˆæœ¬"åœ¨æˆ¿é–“ä½¿ç”¨ã€‚ä¾‹å¦‚,è«‹åƒé–±å®šç¾© æˆ¿é–“ç‰ˆæœ¬ 1 å’Œæˆ¿é–“ç‰ˆæœ¬ 3.</p>
<p>ä½†æ˜¯,çŸ©é™£ç”¨æˆ¶ç«¯é‡åˆ°æ­¤äº‹ä»¶æ˜¯ä¸å°‹å¸¸çš„ æ ¼å¼ã€‚ç›¸å,ä¸»ä¼ºæœå™¨è² è²¬å°‡äº‹ä»¶è½‰æ›ç‚º æ ¼å¼å¦‚ä¸‹æ‰€ç¤º,ä»¥ä¾¿ç”¨æˆ¶ç«¯å¯ä»¥è¼•é¬†è§£æå®ƒå€‘ã€‚</p>
<h4 id="clientevent">ClientEvent</h4>
<p>äº‹ä»¶å¾ä¸»ä¼ºæœå™¨è¿”å›åˆ°ç”¨æˆ¶ç«¯æ™‚ç”¨æ–¼äº‹ä»¶çš„æ ¼å¼ é€šéç”¨æˆ¶ç«¯-ä¼ºæœå™¨ API,æˆ–é€éæ‡‰ç”¨ç¨‹å¼æœå‹™ API ç™¼é€åˆ°æ‡‰ç”¨ç¨‹å¼æœå‹™ã€‚</p>
<p>ä¾‹å­</p>
<pre><code class="language-json">{
  &quot;content&quot;: {
    &quot;membership&quot;: &quot;join&quot;
  },
  &quot;event_id&quot;: &quot;$26RqwJMLw-yds1GAH_QxjHRC1Da9oasK0e5VLnck_45&quot;,
  &quot;origin_server_ts&quot;: 1632489532305,
  &quot;room_id&quot;: &quot;!jEsUZKDJdhlrceRyVU:example.org&quot;,
  &quot;sender&quot;: &quot;@example:example.org&quot;,
  &quot;state_key&quot;: &quot;@user:example.org&quot;,
  &quot;type&quot;: &quot;m.room.member&quot;,
  &quot;unsigned&quot;: {
    &quot;age&quot;: 1567437,
    &quot;redacted_because&quot;: {
      &quot;content&quot;: {
        &quot;reason&quot;: &quot;spam&quot;
      },
      &quot;event_id&quot;: &quot;$Nhl3rsgHMjk-DjMJANawr9HHAhLg4GcoTYrSiYYGqEE&quot;,
      &quot;origin_server_ts&quot;: 1632491098485,
      &quot;redacts&quot;: &quot;$26RqwJMLw-yds1GAH_QxjHRC1Da9oasK0e5VLnck_45&quot;,
      &quot;room_id&quot;: &quot;!jEsUZKDJdhlrceRyVU:example.org&quot;,
      &quot;sender&quot;: &quot;@moderator:example.org&quot;,
      &quot;type&quot;: &quot;m.room.redaction&quot;,
      &quot;unsigned&quot;: {
        &quot;age&quot;: 1257
      }
    }
  }
}
</code></pre>
<h3 id="73">7.3 å‰é›¢ç‹€æ…‹</h3>
<p>å‰é›¢ç‹€æ…‹æ˜¯æˆ¿é–“ç‹€æ…‹çš„ç°¡åŒ–è¦–åœ–,æ—¨åœ¨èª¬æ˜ æ½›åœ¨çš„ç´°æœ¨å·¥è­˜åˆ¥æˆ¿é–“ã€‚å®ƒç”±ä¸€çµ„æœ‰é™çš„ç‹€æ…‹äº‹ä»¶çµ„æˆ å®ƒå€‘æœ¬èº«ç¶“éç°¡åŒ–ä»¥æ¸›å°‘æ‰€éœ€çš„æ•¸æ“šé‡ã€‚</p>
<p>å‰é›¢çš„ç‹€æ…‹äº‹ä»¶åªèƒ½å­˜åœ¨, å’Œå±¬æ€§ã€‚sendertypestate_keycontent</p>
<p>å‰é›¢ç‹€æ…‹é€šå¸¸å‡ºç¾åœ¨é‚€è«‹,æ•²é–€å’Œå…¶ä»–ä½ç½®,å…¶ä¸­ ç”¨æˆ¶å¯ä»¥åœ¨å¯ç”¨æ¢ä»¶ï¼ˆä¾‹å¦‚å—é™æˆ¿é–“ï¼‰ä¸‹åŠ å…¥èŠå¤©å®¤ã€‚</p>
<p>ç”¨æˆ¶ç«¯æ‡‰åƒ…åœ¨æ²’æœ‰ é€²å…¥æˆ¿é–“çš„æ­£å¸¸ç‹€æ…‹ã€‚ä¸€æ—¦æˆ¿é–“çš„ç‹€æ…‹ç‚º å¯ç”¨,æ‡‰ä¸Ÿæ£„æ‰€æœ‰å‰é›¢ç‹€æ…‹ã€‚åœ¨ä»¥ä¸‹æƒ…æ³ä¸‹ ç”¨æˆ¶ç«¯å…·æœ‰æˆ¿é–“çš„å­˜æª”ç‹€æ…‹ï¼ˆä¾‹å¦‚è¢«è¸¢åï¼‰ ä¸¦ä¸”ç”¨æˆ¶ç«¯æ­£åœ¨æ¥æ”¶æˆ¿é–“çš„å‰é›¢ç‹€æ…‹,ä¾‹å¦‚ä¾†è‡ª é‚€è«‹æˆ–æ•²é–€,å‰‡å‰é›¢ç‹€æ…‹æ‡‰å„ªå…ˆ,ç›´åˆ° å¯ä»¥å¾è¯æ¥ä¸­ç²å–æ–°ç‹€æ…‹ã€‚</p>
<p>å‰é›¢ç‹€æ…‹æ‡‰åŒ…å«ä»¥ä¸‹éƒ¨åˆ†æˆ–å…¨éƒ¨ç‹€æ…‹äº‹ä»¶,é€™äº›äº‹ä»¶ æ‡‰ç›¡å¯èƒ½è¡¨ç¤ºç‚ºå‰é›¢çš„ç‹€æ…‹äº‹ä»¶:</p>
<ul>
<li>m.room.create</li>
<li>m.room.name</li>
<li>m.room.avatar</li>
<li>m.room.topic</li>
<li>m.room.join_rules</li>
<li>m.room.canonical_alias</li>
<li>m.room.encryption</li>
</ul>
<h3 id="74">7.4 å¤§å°é™åˆ¶</h3>
<p>æ ¼å¼åŒ–æ™‚,å®Œæ•´äº‹ä»¶ä¸å¾—å¤§æ–¼65536ä½å…ƒçµ„ ä½¿ç”¨è¯åˆäº‹ä»¶æ ¼å¼,åŒ…æ‹¬ä»»ä½• ç°½å,ä¸¦ç·¨ç¢¼ç‚ºè¦ç¯„ å‚‘æ£®ã€‚</p>
<p>æ¯å€‹é‡‘é‘°å¤§å°é‚„æœ‰å…¶ä»–é™åˆ¶:</p>
<ul>
<li>senderä¸å¾—è¶…é255ä½å…ƒçµ„ï¼ˆåŒ…æ‹¬åŸŸï¼‰ã€‚</li>
<li>room_idä¸å¾—è¶…é 255 å€‹å­—ç¯€ã€‚</li>
<li>state_keyä¸å¾—è¶…é 255 å€‹å­—ç¯€ã€‚</li>
<li>typeä¸å¾—è¶…é 255 å€‹å­—ç¯€ã€‚</li>
<li>event_idä¸å¾—è¶…é 255 å€‹å­—ç¯€ã€‚</li>
</ul>
<p>æŸäº›äº‹ä»¶é¡å‹å…·æœ‰æŒ‡å®šçš„å…¶ä»–å¤§å°é™åˆ¶ åœ¨äº‹ä»¶çš„æè¿°ä¸­ã€‚é™„åŠ éµæ²’æœ‰é™åˆ¶å…¶ä»– è€Œä¸æ˜¯äº‹ä»¶çš„ç¸½ 64 KiB é™åˆ¶æ‰€æš—ç¤ºçš„ã€‚</p>
<h3 id="75">7.5 æœƒè­°å®¤æ´»å‹•</h3>
<p>æ­¤è¦ç¯„æ¦‚è¿°äº†å¹¾ç¨®æ¨™æº–äº‹ä»¶é¡å‹,æ‰€æœ‰é€™äº›äº‹ä»¶é¡å‹éƒ½ å‰ç¶´ç‚ºm.</p>
<h4 id="mroomcanonical_alias">m.room.canonical_alias</h4>
<p>æ­¤äº‹ä»¶ç”¨æ–¼é€šçŸ¥èŠå¤©å®¤æ‡‰ä½¿ç”¨å“ªå€‹åˆ¥å è¢«èªç‚ºæ˜¯è¦ç¯„çš„,ä»¥åŠå…¶ä»–å“ªäº›åˆ¥åæŒ‡å‘æˆ¿é–“ã€‚ é€™å¯ä»¥ç”¨æ–¼é¡¯ç¤ºç›®çš„æˆ–ä½œç‚ºå°åˆ¥åç”¨æˆ¶çš„å»ºè­° ç”¨æ–¼å®£å‚³å’Œè¨ªå•æˆ¿é–“ã€‚</p>
<p>ä¾‹å­</p>
<pre><code class="language-json">{
  &quot;content&quot;: {
    &quot;alias&quot;: &quot;#somewhere:localhost&quot;,
    &quot;alt_aliases&quot;: [
      &quot;#somewhere:example.org&quot;,
      &quot;#myroom:example.com&quot;
    ]
  },
  &quot;event_id&quot;: &quot;$143273582443PhrSn:example.org&quot;,
  &quot;origin_server_ts&quot;: 1432735824653,
  &quot;room_id&quot;: &quot;!jEsUZKDJdhlrceRyVU:example.org&quot;,
  &quot;sender&quot;: &quot;@example:example.org&quot;,
  &quot;state_key&quot;: &quot;&quot;,
  &quot;type&quot;: &quot;m.room.canonical_alias&quot;,
  &quot;unsigned&quot;: {
    &quot;age&quot;: 1234
  }
}
</code></pre>
<h4 id="mroomcreate">m.room.create</h4>
<p>é€™æ˜¯æœƒè­°å®¤ä¸­çš„ç¬¬ä¸€å€‹äº‹ä»¶,ç„¡æ³•æ›´æ”¹ã€‚å®ƒå……ç•¶æ‰€æœ‰å…¶ä»–äº‹ä»¶çš„æ ¹ã€‚</p>
<pre><code class="language-json">{
  &quot;content&quot;: {
    &quot;creator&quot;: &quot;@example:example.org&quot;,
    &quot;m.federate&quot;: true,
    &quot;predecessor&quot;: {
      &quot;event_id&quot;: &quot;$something:example.org&quot;,
      &quot;room_id&quot;: &quot;!oldroom:example.org&quot;
    },
    &quot;room_version&quot;: &quot;1&quot;
  },
  &quot;event_id&quot;: &quot;$143273582443PhrSn:example.org&quot;,
  &quot;origin_server_ts&quot;: 1432735824653,
  &quot;room_id&quot;: &quot;!jEsUZKDJdhlrceRyVU:example.org&quot;,
  &quot;sender&quot;: &quot;@example:example.org&quot;,
  &quot;state_key&quot;: &quot;&quot;,
  &quot;type&quot;: &quot;m.room.create&quot;,
  &quot;unsigned&quot;: {
    &quot;age&quot;: 1234
  }
}
</code></pre>
<h4 id="mroomjoin_rules">m.room.join_rules</h4>
<p>æˆ¿é–“å¯ä»¥å…·æœ‰ä»¥ä¸‹åç¨±ä¹‹ä¸€:</p>
<ul>
<li>public- ä»»ä½•äººéƒ½å¯ä»¥åŠ å…¥æˆ¿é–“,ç„¡éœ€äº‹å…ˆåŸ·è¡Œä»»ä½•æ“ä½œã€‚</li>
<li>invite- ç”¨æˆ¶å¿…é ˆé¦–å…ˆæ”¶åˆ°æœƒè­°å®¤ä¸­å·²æœ‰äººå“¡çš„é‚€è«‹ ç‚ºäº†åŠ å…¥ã€‚</li>
<li>knock- ç”¨æˆ¶å¯ä»¥è«‹æ±‚é‚€è«‹åŠ å…¥æˆ¿é–“ã€‚ä»–å€‘å¯ä»¥è¢«å…è¨±ï¼ˆé‚€è«‹ï¼‰ æˆ–æ‹’çµ•ï¼ˆè¸¢/ç¦æ­¢ï¼‰è¨ªå•ã€‚å¦å‰‡,éœ€è¦é‚€è«‹ä½¿ç”¨è€…åŠ å…¥ã€‚åª å¯åœ¨æ”¯æŒæ•²é–€çš„æˆ¿é–“ä½¿ç”¨ã€‚</li>
<li>restricted- ä»»ä½•èƒ½å¤ æ»¿è¶³è‡³å°‘ä¸€å€‹å…è¨±æ¢ä»¶çš„äººéƒ½æ˜¯ ç„¡éœ€äº‹å…ˆæ“ä½œå³å¯åŠ å…¥æˆ¿é–“ã€‚å¦å‰‡,éœ€è¦é‚€è«‹ã€‚ åƒ…é©ç”¨æ–¼æ”¯æ´åŠ å…¥è¦å‰‡çš„æˆ¿é–“ã€‚</li>
<li>knock_restricted- ç”¨æˆ¶å¯ä»¥ä½¿ç”¨æä¾›çš„ç›¸åŒåŠŸèƒ½è«‹æ±‚é‚€è«‹ é€šéåŠ å…¥è¦å‰‡,æˆ–è€…å¯ä»¥åœ¨æ»¿è¶³å…è¨±æ¢ä»¶çš„æƒ…æ³ä¸‹å˜—è©¦åŠ å…¥ æ ¹æ“šè¯æ¥è¦å‰‡ã€‚åƒ…é©ç”¨æ–¼æ”¯æ´åŠ å…¥è¦å‰‡çš„æˆ¿é–“ã€‚knockrestricted</li>
<li>private- ä¿ç•™è€Œä¸å¯¦æ–½ã€‚æ²’æœ‰é‡è¦æ„ç¾©ã€‚</li>
</ul>
<pre><code class="language-json">{
  &quot;content&quot;: {
    &quot;join_rule&quot;: &quot;public&quot;
  },
  &quot;event_id&quot;: &quot;$143273582443PhrSn:example.org&quot;,
  &quot;origin_server_ts&quot;: 1432735824653,
  &quot;room_id&quot;: &quot;!jEsUZKDJdhlrceRyVU:example.org&quot;,
  &quot;sender&quot;: &quot;@example:example.org&quot;,
  &quot;state_key&quot;: &quot;&quot;,
  &quot;type&quot;: &quot;m.room.join_rules&quot;,
  &quot;unsigned&quot;: {
    &quot;age&quot;: 1234
  }
}
</code></pre>
<pre><code class="language-json">{
  &quot;content&quot;: {
    &quot;allow&quot;: [
      {
        &quot;room_id&quot;: &quot;!other:example.org&quot;,
        &quot;type&quot;: &quot;m.room_membership&quot;
      },
      {
        &quot;room_id&quot;: &quot;!elsewhere:example.org&quot;,
        &quot;type&quot;: &quot;m.room_membership&quot;
      }
    ],
    &quot;join_rule&quot;: &quot;restricted&quot;
  },
  &quot;event_id&quot;: &quot;$143273582443PhrSn:example.org&quot;,
  &quot;origin_server_ts&quot;: 1432735824653,
  &quot;room_id&quot;: &quot;!jEsUZKDJdhlrceRyVU:example.org&quot;,
  &quot;sender&quot;: &quot;@example:example.org&quot;,
  &quot;state_key&quot;: &quot;&quot;,
  &quot;type&quot;: &quot;m.room.join_rules&quot;,
  &quot;unsigned&quot;: {
    &quot;age&quot;: 1234
  }
}
</code></pre>
<h4 id="mroommember">m.room.member</h4>
<p>èª¿æ•´èŠå¤©å®¤ä¸­ç”¨æˆ¶çš„æˆå“¡èº«ä»½ç‹€æ…‹ã€‚æœ€å¥½åœ¨åŸ·è¡Œæˆå“¡è³‡æ ¼æ“ä½œæ™‚ä½¿ç”¨æˆå“¡è³‡æ ¼ APIï¼ˆ ç­‰ï¼‰,è€Œä¸æ˜¯ç›´æ¥èª¿æ•´ç‹€æ…‹,å› ç‚ºå­˜åœ¨ä¸€çµ„å—é™åˆ¶çš„æœ‰æ•ˆè½‰æ›ã€‚ä¾‹å¦‚,ä½¿ç”¨è€… A ç„¡æ³•å¼·åˆ¶ä½¿ç”¨è€… B
åŠ å…¥èŠå¤©å®¤,ä¸¦ä¸”å˜—è©¦ç›´æ¥å¼·åˆ¶æ›´æ”¹æ­¤ç‹€æ…‹å°‡å¤±æ•—ã€‚/rooms/<room id>/invite</p>
<p>æŒ‡å®šäº†ä»¥ä¸‹æˆå“¡è³‡æ ¼ç‹€æ…‹:</p>
<ul>
<li>invite- ä½¿ç”¨è€…å·²è¢«é‚€è«‹åŠ å…¥èŠå¤©å®¤,ä½†å°šæœªåŠ å…¥è©²èŠå¤©å®¤ã€‚åœ¨åŠ å…¥ä¹‹å‰,ä»–å€‘ä¸å¾—åƒåŠ æœƒè­°å®¤ã€‚</li>
<li>join- ä½¿ç”¨è€…å·²åŠ å…¥èŠå¤©å®¤ï¼ˆå¯èƒ½åœ¨æ¥å—é‚€è«‹åï¼‰,ä¸¦å¯èƒ½åƒèˆ‡å…¶ä¸­ã€‚</li>
<li>leave- ç”¨æˆ¶æ›¾ç¶“åŠ å…¥æˆ¿é–“,ä½†å¾Œä¾†é›¢é–‹äº†ï¼ˆå¯èƒ½æ˜¯å‡ºæ–¼é¸æ“‡,ä¹Ÿå¯èƒ½æ˜¯è¢«è¸¢ï¼‰ã€‚</li>
<li>ban- ä½¿ç”¨è€…å·²è¢«ç¦æ­¢é€²å…¥èŠå¤©å®¤,ä¸¦ä¸”ä¸å†è¢«å…è¨±åŠ å…¥èŠå¤©å®¤,ç›´åˆ°ä»–å€‘è¢«å–æ¶ˆç¦æ­¢é€²å…¥èŠå¤©å®¤ï¼ˆé€šéå°‡å…¶æˆå“¡èº«ä»½ç‹€æ…‹è¨­ç½®ç‚ºé å€¼ï¼‰ã€‚ban</li>
<li>knock- ä½¿ç”¨è€…å·²æ•²æˆ¿é–“,è«‹æ±‚å…è¨±åƒèˆ‡ã€‚åœ¨åŠ å…¥ä¹‹å‰,ä»–å€‘ä¸å¾—åƒåŠ æœƒè­°å®¤ã€‚</li>
</ul>
<p>å¦‚æœæ­¤é‚€è«‹æ˜¯äº‹ä»¶ä¸¦ä¸”æ˜¯äº‹ä»¶çš„å¾ŒçºŒäº‹ä»¶,å‰‡è¨­ç½®è©²å±¬æ€§,å¦å‰‡ä¸å­˜åœ¨ã€‚third_party_inviteinvitem.room.third_party_invite</p>
<p>æ­¤äº‹ä»¶é‚„å¯èƒ½åŒ…å«äº‹ä»¶æ•¸æ“šä¸­çš„éµã€‚ å¦‚æœå­˜åœ¨,å‰‡åŒ…å«ä¸€çµ„å‰é›¢ç‹€æ…‹äº‹ä»¶,ä»¥èª¬æ˜æ¥æ”¶å™¨è­˜åˆ¥æˆ¿é–“ã€‚invite_room_stateunsigned</p>
<p>å¥—ç”¨æˆå“¡è³‡æ ¼çš„ä½¿ç”¨è€…ç”± .åœ¨æŸäº›æƒ…æ³ä¸‹, å’Œå¯èƒ½ä¸åŒ¹é… - é€™å¯èƒ½è¢«è§£é‡‹ç‚ºå½±éŸ¿ ç”¨æˆ¶çš„æˆå“¡èº«ä»½ç‹€æ…‹ã€‚state_keysenderstate_keysenderstate_key</p>
<p>çµ¦å®šä½¿ç”¨è€…çš„ TO å¯èƒ½æœƒéš¨æ™‚é–“è€Œè®ŠåŒ–ã€‚ä¸‹è¡¨åˆ—å‡ºäº†å„ç¨®æ›´æ”¹ éš¨æ™‚é–“æ¨ç§»ä»¥åŠå®¢æˆ¶ç«¯å’Œä¼ºæœå™¨å¿…é ˆå¦‚ä½•è§£é‡‹é€™äº›æ›´æ”¹ã€‚å¯ä»¥æª¢ç´¢ä»¥å‰çš„æœƒå“¡è³‡æ ¼ å¾äº‹ä»¶ä¸Šçš„ç‰©ä»¶ã€‚å¦‚æœä¸å­˜åœ¨,å‰‡å¿…é ˆå‡å®šä½¿ç”¨è€…ä»¥å‰çš„æˆå“¡èº«ä»½
å¦‚ã€‚membershipprev_contentleave</p>
<pre><code class="language-json">{
  &quot;content&quot;: {
    &quot;avatar_url&quot;: &quot;mxc://example.org/SEsfnsuifSDFSSEF&quot;,
    &quot;displayname&quot;: &quot;Alice Margatroid&quot;,
    &quot;membership&quot;: &quot;join&quot;,
    &quot;reason&quot;: &quot;Looking for support&quot;
  },
  &quot;event_id&quot;: &quot;$143273582443PhrSn:example.org&quot;,
  &quot;origin_server_ts&quot;: 1432735824653,
  &quot;room_id&quot;: &quot;!jEsUZKDJdhlrceRyVU:example.org&quot;,
  &quot;sender&quot;: &quot;@example:example.org&quot;,
  &quot;state_key&quot;: &quot;@alice:example.org&quot;,
  &quot;type&quot;: &quot;m.room.member&quot;,
  &quot;unsigned&quot;: {
    &quot;age&quot;: 1234
  }
}
</code></pre>
<pre><code class="language-json">{
  &quot;content&quot;: {
    &quot;avatar_url&quot;: &quot;mxc://example.org/SEsfnsuifSDFSSEF&quot;,
    &quot;displayname&quot;: &quot;Alice Margatroid&quot;,
    &quot;membership&quot;: &quot;invite&quot;,
    &quot;reason&quot;: &quot;Looking for support&quot;
  },
  &quot;event_id&quot;: &quot;$143273582443PhrSn:example.org&quot;,
  &quot;origin_server_ts&quot;: 1432735824653,
  &quot;room_id&quot;: &quot;!jEsUZKDJdhlrceRyVU:example.org&quot;,
  &quot;sender&quot;: &quot;@example:example.org&quot;,
  &quot;state_key&quot;: &quot;@alice:example.org&quot;,
  &quot;type&quot;: &quot;m.room.member&quot;,
  &quot;unsigned&quot;: {
    &quot;age&quot;: 1234,
    &quot;invite_room_state&quot;: [
      {
        &quot;content&quot;: {
          &quot;name&quot;: &quot;Example Room&quot;
        },
        &quot;sender&quot;: &quot;@bob:example.org&quot;,
        &quot;state_key&quot;: &quot;&quot;,
        &quot;type&quot;: &quot;m.room.name&quot;
      },
      {
        &quot;content&quot;: {
          &quot;join_rule&quot;: &quot;invite&quot;
        },
        &quot;sender&quot;: &quot;@bob:example.org&quot;,
        &quot;state_key&quot;: &quot;&quot;,
        &quot;type&quot;: &quot;m.room.join_rules&quot;
      }
    ]
  }
}
</code></pre>
<pre><code class="language-json">{
  &quot;content&quot;: {
    &quot;avatar_url&quot;: &quot;mxc://example.org/SEsfnsuifSDFSSEF&quot;,
    &quot;displayname&quot;: &quot;Alice Margatroid&quot;,
    &quot;join_authorised_via_users_server&quot;: &quot;@bob:other.example.org&quot;,
    &quot;membership&quot;: &quot;join&quot;
  },
  &quot;event_id&quot;: &quot;$143273582443PhrSn:example.org&quot;,
  &quot;origin_server_ts&quot;: 1432735824653,
  &quot;room_id&quot;: &quot;!jEsUZKDJdhlrceRyVU:example.org&quot;,
  &quot;sender&quot;: &quot;@example:example.org&quot;,
  &quot;state_key&quot;: &quot;@alice:example.org&quot;,
  &quot;type&quot;: &quot;m.room.member&quot;,
  &quot;unsigned&quot;: {
    &quot;age&quot;: 1234
  }
}
</code></pre>
<pre><code class="language-json">{
  &quot;content&quot;: {
    &quot;avatar_url&quot;: &quot;mxc://example.org/SEsfnsuifSDFSSEF&quot;,
    &quot;displayname&quot;: &quot;Alice Margatroid&quot;,
    &quot;membership&quot;: &quot;knock&quot;,
    &quot;reason&quot;: &quot;Looking for support&quot;
  },
  &quot;event_id&quot;: &quot;$143273582443PhrSn:example.org&quot;,
  &quot;origin_server_ts&quot;: 1432735824653,
  &quot;room_id&quot;: &quot;!jEsUZKDJdhlrceRyVU:example.org&quot;,
  &quot;sender&quot;: &quot;@example:example.org&quot;,
  &quot;state_key&quot;: &quot;@alice:example.org&quot;,
  &quot;type&quot;: &quot;m.room.member&quot;,
  &quot;unsigned&quot;: {
    &quot;age&quot;: 1234,
    &quot;knock_room_state&quot;: [
      {
        &quot;content&quot;: {
          &quot;name&quot;: &quot;Example Room&quot;
        },
        &quot;sender&quot;: &quot;@bob:example.org&quot;,
        &quot;state_key&quot;: &quot;&quot;,
        &quot;type&quot;: &quot;m.room.name&quot;
      },
      {
        &quot;content&quot;: {
          &quot;join_rule&quot;: &quot;knock&quot;
        },
        &quot;sender&quot;: &quot;@bob:example.org&quot;,
        &quot;state_key&quot;: &quot;&quot;,
        &quot;type&quot;: &quot;m.room.join_rules&quot;
      }
    ]
  }
}
</code></pre>
<pre><code class="language-json">{
  &quot;content&quot;: {
    &quot;avatar_url&quot;: &quot;mxc://example.org/SEsfnsuifSDFSSEF&quot;,
    &quot;displayname&quot;: &quot;Alice Margatroid&quot;,
    &quot;membership&quot;: &quot;invite&quot;,
    &quot;third_party_invite&quot;: {
      &quot;display_name&quot;: &quot;alice&quot;,
      &quot;signed&quot;: {
        &quot;mxid&quot;: &quot;@alice:example.org&quot;,
        &quot;signatures&quot;: {
          &quot;magic.forest&quot;: {
            &quot;ed25519:3&quot;: &quot;fQpGIW1Snz+pwLZu6sTy2aHy/DYWWTspTJRPyNp0PKkymfIsNffysMl6ObMMFdIJhk6g6pwlIqZ54rxo8SLmAg&quot;
          }
        },
        &quot;token&quot;: &quot;abc123&quot;
      }
    }
  },
  &quot;event_id&quot;: &quot;$143273582443PhrSn:example.org&quot;,
  &quot;origin_server_ts&quot;: 1432735824653,
  &quot;room_id&quot;: &quot;!jEsUZKDJdhlrceRyVU:example.org&quot;,
  &quot;sender&quot;: &quot;@example:example.org&quot;,
  &quot;state_key&quot;: &quot;@alice:example.org&quot;,
  &quot;type&quot;: &quot;m.room.member&quot;,
  &quot;unsigned&quot;: {
    &quot;age&quot;: 1234
  }
}
</code></pre>
<h4 id="mroompower_levels">m.room.power_levels</h4>
<p>æ­¤äº‹ä»¶æŒ‡å®šç”¨æˆ¶å¿…é ˆå…·æœ‰çš„æœ€ä½ç´šåˆ¥æ‰èƒ½åŸ·è¡Œ æŸäº›å‹•ä½œã€‚å®ƒé‚„æŒ‡å®šæª”å®¤ä¸­æ¯å€‹ç”¨æˆ¶çš„ç´šåˆ¥ã€‚</p>
<p>å¦‚æœ a åœ¨æ¸…å–®ä¸­,å‰‡å…·æœ‰ ç›¸é—œçš„åŠŸç‡ç´šåˆ¥ã€‚å¦å‰‡,å®ƒå€‘å…·æœ‰é»˜èªç´šåˆ¥ã€‚å¦‚æœæœªæä¾›,å‰‡å‡å®šç‚º 0. å¦‚æœèŠå¤©å®¤ä¸åŒ…å«ä»»ä½•äº‹ä»¶,å‰‡èŠå¤©å®¤çš„å»ºç«‹è€…å…·æœ‰ åŠŸç‡ç´šåˆ¥ç‚º 100,æ‰€æœ‰å…¶ä»–ä½¿ç”¨è€…çš„åŠŸç‡ç´šåˆ¥ç‚º
0ã€‚user_idusersuser_idusers_defaultusers_defaultm.room.power_levels</p>
<p>ç™¼é€ç‰¹å®šäº‹ä»¶æ‰€éœ€çš„ç´šåˆ¥ç”±å’Œæ§åˆ¶ã€‚å¦‚æœåœ¨ ä¸­æŒ‡å®šäº†äº‹ä»¶é¡å‹,å‰‡ç”¨æˆ¶å¿…é ˆè‡³å°‘å…·æœ‰æŒ‡å®šçš„ç´šåˆ¥,ä»¥ä¾¿ ç™¼é€è©²äº‹ä»¶ã€‚å¦‚æœæœªæä¾›äº‹ä»¶é¡å‹,å‰‡é è¨­ç‚º for æ¶ˆæ¯äº‹ä»¶å’Œ state
äº‹ä»¶ã€‚eventsstate_defaultevents_defaulteventsevents_defaultstate_default</p>
<p>å¦‚æœäº‹ä»¶ä¸­æ²’æœ‰state_default,æˆ–è€… m.room.power_levelsæ²’æœ‰äº‹ä»¶,æ˜¯ m.room.power_levels 50ã€‚ å¦‚æœäº‹ä»¶ä¸­æ²’æœ‰state_default, æˆ–è€…æ²’æœ‰äº‹ä»¶events_default,å‰‡ç‚º
0ã€‚</p>
<p>é‚€è«‹ä½¿ç”¨è€…åŠ å…¥èŠå¤©å®¤æ‰€éœ€çš„åŠŸç‡ç´šåˆ¥,å°‡ä½¿ç”¨è€…è¸¢å‡º èŠå¤©å®¤,ç¦æ­¢ä½¿ç”¨è€…é€²å…¥èŠå¤©å®¤æˆ–ç·¨è¼¯å…¶ä»–ç”¨æˆ¶ç™¼é€çš„äº‹ä»¶æ˜¯ åˆ†åˆ¥ç”±, , å’Œå®šç¾©ã€‚é—œå¡ ,å¦‚æœæœªåœ¨äº‹ä»¶ä¸­æŒ‡å®š,æˆ–è€…æª”å®¤ä¸åŒ…å«ä»»ä½•äº‹ä»¶,å‰‡é è¨­ç‚º 50ã€‚ åœ¨ä»»ä¸€æƒ…æ³ä¸‹å‡é è¨­ç‚º 0ã€‚invite
kick ban redact kick ban redact m.room.power_levels m.room.power_levels invite</p>
<p>è«¾ç¶­å…‹æ–¯</p>
<p>åŠŸç‡é›»å¹³å€¼çš„å…è¨±ç¯„åœç‚º , æŒ‰ç…§è¦ç¯„ JSON è¦ç¯„çš„è¦æ±‚ã€‚[-(2<strong>53)+1, (2</strong>53)-1]</p>
<pre><code class="language-json">{
  &quot;content&quot;: {
    &quot;ban&quot;: 50,
    &quot;events&quot;: {
      &quot;m.room.name&quot;: 100,
      &quot;m.room.power_levels&quot;: 100
    },
    &quot;events_default&quot;: 0,
    &quot;invite&quot;: 50,
    &quot;kick&quot;: 50,
    &quot;notifications&quot;: {
      &quot;room&quot;: 20
    },
    &quot;redact&quot;: 50,
    &quot;state_default&quot;: 50,
    &quot;users&quot;: {
      &quot;@example:localhost&quot;: 100
    },
    &quot;users_default&quot;: 0
  },
  &quot;event_id&quot;: &quot;$143273582443PhrSn:example.org&quot;,
  &quot;origin_server_ts&quot;: 1432735824653,
  &quot;room_id&quot;: &quot;!jEsUZKDJdhlrceRyVU:example.org&quot;,
  &quot;sender&quot;: &quot;@example:example.org&quot;,
  &quot;state_key&quot;: &quot;&quot;,
  &quot;type&quot;: &quot;m.room.power_levels&quot;,
  &quot;unsigned&quot;: {
    &quot;age&quot;: 1234
  }
}
</code></pre>
<h4 id="751">7.5.1 æ­·å²äº‹ä»¶</h4>
<p>ä½†æ˜¯,å‘½åç©ºé–“ä¸­çš„æŸäº›äº‹ä»¶å¯èƒ½æœƒå‡ºç¾åœ¨èŠå¤©å®¤ä¸­ å®ƒå€‘åœ¨æ­¤ç‰ˆæœ¬çš„è¦ç¯„ä¸­æ²’æœ‰é‡è¦æ„ç¾©ã€‚ å®ƒå€‘æ˜¯:m.</p>
<ul>
<li>m.room.aliases</li>
</ul>
<p>è©²è¦ç¯„çš„å…ˆå‰ç‰ˆæœ¬æä¾›äº†æœ‰é—œé€™äº›çš„æ›´å¤šè³‡è¨Š äº‹ä»¶ã€‚</p>
<h3 id="76">7.6 åŒæ­¥</h3>
<p>è‹¥è¦è®€å–äº‹ä»¶,é æœŸçš„æ“ä½œæµæ˜¯ç”¨æˆ¶ç«¯é¦–å…ˆ èª¿ç”¨ä¸å¸¶åƒæ•¸çš„ /sync APIã€‚é€™å°‡è¿”å› æ¯å€‹èŠå¤©å®¤çš„æœ€æ–°æ¶ˆæ¯äº‹ä»¶,ä»¥åŠ è¿”å›æ™‚é–“ç·šé–‹é ­çš„æˆ¿é–“ã€‚å›æ‡‰é‚„åŒ…æ‹¬ä¸€å€‹å­—æ®µ,è©²å­—æ®µæ‡‰åœ¨ä¸‹æ¬¡èª¿ç”¨ æ™‚ç”¨ä½œåƒæ•¸çš„å€¼ã€‚æœ€å¾Œ,å›æ‡‰åŒ…æ‹¬:
å°æ–¼æ¯å€‹æˆ¿é–“,ä¸€å€‹å­—æ®µ,è©²å­—æ®µå¯ä»¥ä½œç‚ºåƒæ•¸å‚³éçµ¦ /rooms/<room_id>/messages API ä»¥æå‰æª¢ç´¢ æ¶ˆæ¯ã€‚sincenext_batchsince/syncprev_batchstart</p>
<p>ä¾‹å¦‚,ä¸€å€‹è«‹æ±‚å¯èƒ½æœƒè¿”å›ä¸€å€‹ç”±å››å€‹äº‹ä»¶çµ„æˆçš„ç¯„åœ,ä¸¦åœ¨çµ¦å®šçš„æˆ¿é–“å…§,çœç•¥å…©å€‹å…ˆå‰çš„äº‹ä»¶å’Œ ã€‚é€™å¯ä»¥å¯è¦–åŒ–å¦‚ä¸‹:/syncE2E3E4E5E0E1</p>
<pre><code>    [E0]-&gt;[E1]-&gt;[E2]-&gt;[E3]-&gt;[E4]-&gt;[E5]
               ^                      ^
               |                      |
         prev_batch: '1-2-3'        next_batch: 'a-b-c'
</code></pre>
<p>é€šå¸¸,å®¢æˆ¶ç«¯å¯è¦‹çš„æ‰€æœ‰æ–°äº‹ä»¶éƒ½å°‡å‡ºç¾åœ¨ å° API çš„å›æ‡‰ã€‚ä½†æ˜¯,å¦‚æœå¤§é‡äº‹ä»¶ åœ¨èª¿ç”¨ ä¹‹é–“åˆ°é”,è¿”å›'æœ‰é™'æ™‚é–“ç·š, åƒ…åŒ…å«æœ€æ–°çš„æ¶ˆæ¯äº‹ä»¶ã€‚ç‹€æ…‹"delta"ä¹Ÿæ˜¯ è¿”å›,ç¸½çµçœç•¥éƒ¨åˆ†çš„ä»»ä½•ç‹€æ…‹æ›´æ”¹
æ™‚é–“è»¸ã€‚å› æ­¤,å®¢æˆ¶æœ€çµ‚å¯èƒ½æœƒåœ¨å…¶çŸ¥è­˜ä¸Šå‡ºç¾"å·®è·" çš„æ¶ˆæ¯æ™‚é–“ç·šã€‚ç”¨æˆ¶ç«¯å¯ä»¥ä½¿ç”¨ /rooms/<room_id>/messages API å¡«å……é€™äº›ç©ºç™½ã€‚/sync/sync</p>
<p>ç¹¼çºŒæˆ‘å€‘çš„ç¤ºä¾‹,å‡è¨­æˆ‘å€‘ç™¼å‡ºç¬¬ä¸‰å€‹è«‹æ±‚,è¦æ±‚ è‡ªä¸Šæ¬¡åŒæ­¥ä»¥ä¾†çš„äº‹ä»¶,é€šéå°‡ä»¤ç‰Œä½œç‚º åƒæ•¸ã€‚ä¼ºæœå™¨çŸ¥é“å››å€‹æ–°äº‹ä»¶,, å’Œ ,ä½†èªç‚ºé€™å¤ªå¤šäº†,ç„¡æ³•ä¸€æ¬¡å ±å‘Šã€‚ç›¸å ä¼ºæœå™¨ç™¼é€åŒ…å«çš„å›æ‡‰,ä¸¦ä¸”
çœç•¥ã€‚é€™å½¢æˆäº†ä¸€å€‹ç¼ºå£,æˆ‘å€‘å¯ä»¥åœ¨å¯è¦–åŒ–ä¸­çœ‹åˆ°:/syncnext_batchx-y-zsinceE7E8E9E10limitedE8E9E10E7</p>
<pre><code>                                            | gap |
                                            | &lt;-&gt; |
    [E0]-&gt;[E1]-&gt;[E2]-&gt;[E3]-&gt;[E4]-&gt;[E5]-&gt;[E6]-&gt;[E7]-&gt;[E8]-&gt;[E9]-&gt;[E10]
                                            ^     ^                  ^
                                            |     |                  |
                                 since: 'x-y-z'   |                  |
                                       prev_batch: 'd-e-f'       next_batch: 'u-v-w'
</code></pre>
<p>æœ‰é™çš„å›æ‡‰åŒ…æ‹¬ä¸€å€‹ç‹€æ…‹å¢é‡,å®ƒæè¿°äº†ç‹€æ…‹ çš„æˆ¿é–“åœ¨é–“éš™ä¸Šè®ŠåŒ–ã€‚æ­¤å¢é‡èªªæ˜å¦‚ä½•æ§‹å»ºç‹€æ…‹ åœ¨å¾ç”¨æˆ¶ç«¯çŸ¥é“çš„ç‹€æ…‹è¿”å›æ™‚é–“ç·šï¼ˆå³åœ¨ï¼‰ä¹‹å‰ ï¼ˆå³åœ¨ ï¼‰ã€‚ç‚ºäº†ç¸®å°å·®è·,å®¢æˆ¶ç«¯æ‡‰è©²ä½¿ç”¨æŸ¥è©¢åƒæ•¸å’Œ å‘ /rooms/<room_id>/messages
ç™¼å‡ºè«‹æ±‚ã€‚E7E6from=x-y-zto=d-e-f</p>
<h4 id="get-_matrixclientv3sync">GET /_matrix/client/v3/sync</h4>
<p>å°‡å®¢æˆ¶ç«¯çš„ç‹€æ…‹èˆ‡ä¼ºæœå™¨ä¸Šçš„æœ€æ–°ç‹€æ…‹åŒæ­¥ã€‚ ç”¨æˆ¶ç«¯åœ¨é¦–æ¬¡ç™»éŒ„æ™‚ä½¿ç”¨æ­¤ API ä»¥ç²å–åˆå§‹å¿«ç…§ çš„ç‹€æ…‹,ç„¶å¾Œç¹¼çºŒèª¿ç”¨æ­¤ API ç²å– å¢é‡å¢é‡åˆ°ç‹€æ…‹,ä¸¦æ¥æ”¶æ–°æ¶ˆæ¯ã€‚</p>
<p>æ³¨æ„:æ­¤ç«¯é»æ”¯æ´å»¶é²è¼‰å…¥ã€‚æœ‰é—œè©³ç´°è³‡è¨Š,è«‹åƒé–±ç¯©é¸ã€‚å»¶é²è¼‰å…¥æˆå“¡åƒ…åœ¨æ­¤ç«¯é»ä¸Šå—æ”¯æ´ã€‚å•Ÿç”¨å»¶é²è¼‰å…¥å¾Œ,ä¼ºæœå™¨å¿…é ˆåŒ…æ‹¬ ç•¶ä½¿ç”¨è€…åŠ å…¥èŠå¤©å®¤æ™‚åŒæ­¥è‡ªå·±çš„æˆå“¡è³‡æ ¼äº‹ä»¶,æˆ–è€…ç•¶ä½¿ç”¨è€… è«‹æ±‚æˆ¿é–“çš„å®Œæ•´ç‹€æ…‹,ä»¥å¹«åŠ©ç™¼ç¾ç”¨æˆ¶çš„é ­åƒå’Œ
é¡¯ç¤ºåç¨±ã€‚StateFilter</p>
<p>æ­¤å¤–,èˆ‡å…¶ä»–æœƒå“¡ä¸€æ¨£,ä½¿ç”¨è€…è‡ªå·±çš„æœƒå“¡æ´»å‹•ä¹Ÿç¬¦åˆæ¢ä»¶ è¢«ä¼ºæœå™¨è¦–ç‚ºå†—é¤˜ã€‚ç•¶åŒæ­¥ç‚º æ™‚ , ä¼ºæœå™¨å¿…é ˆè¿”å›é–“éš™ä¸­äº‹ä»¶çš„æˆå“¡èº«ä»½äº‹ä»¶ ï¼ˆåœ¨è¿”å›çš„æ™‚é–“ç·šä¹‹é–“å’Œé–‹å§‹ä¹‹é–“ï¼‰,ç„¡è«– è‡³æ–¼å®ƒå€‘æ˜¯å¦æ˜¯å¤šé¤˜çš„ã€‚é€™å¯ç¢ºä¿é€£æ¥/é›¢é–‹
ä¸¦ä¸”åœ¨é–“éš™æœŸé–“ç™¼ç”Ÿçš„è¼ªå»“è®ŠåŒ–ä¸æœƒä¸Ÿå¤±ã€‚limitedsince</p>
<p>è«‹æ³¨æ„,çš„é è¨­è¡Œç‚ºæ˜¯åŒ…æ‹¬æ‰€æœ‰æˆå“¡è³‡æ ¼ äº‹ä»¶ä»¥åŠå…¶ä»–ç‹€æ…‹,ç•¶æœªå•Ÿç”¨å»¶é²è¼‰å…¥æ™‚ã€‚state</p>
<p>200å›æ‡‰</p>
<pre><code class="language-json">{
  &quot;account_data&quot;: {
    &quot;events&quot;: [
      {
        &quot;content&quot;: {
          &quot;custom_config_key&quot;: &quot;custom_config_value&quot;
        },
        &quot;type&quot;: &quot;org.example.custom.config&quot;
      }
    ]
  },
  &quot;next_batch&quot;: &quot;s72595_4483_1934&quot;,
  &quot;presence&quot;: {
    &quot;events&quot;: [
      {
        &quot;content&quot;: {
          &quot;avatar_url&quot;: &quot;mxc://localhost/wefuiwegh8742w&quot;,
          &quot;currently_active&quot;: false,
          &quot;last_active_ago&quot;: 2478593,
          &quot;presence&quot;: &quot;online&quot;,
          &quot;status_msg&quot;: &quot;Making cupcakes&quot;
        },
        &quot;sender&quot;: &quot;@example:localhost&quot;,
        &quot;type&quot;: &quot;m.presence&quot;
      }
    ]
  },
  &quot;rooms&quot;: {
    &quot;invite&quot;: {
      &quot;!696r7674:example.com&quot;: {
        &quot;invite_state&quot;: {
          &quot;events&quot;: [
            {
              &quot;content&quot;: {
                &quot;name&quot;: &quot;My Room Name&quot;
              },
              &quot;sender&quot;: &quot;@alice:example.com&quot;,
              &quot;state_key&quot;: &quot;&quot;,
              &quot;type&quot;: &quot;m.room.name&quot;
            },
            {
              &quot;content&quot;: {
                &quot;membership&quot;: &quot;invite&quot;
              },
              &quot;sender&quot;: &quot;@alice:example.com&quot;,
              &quot;state_key&quot;: &quot;@bob:example.com&quot;,
              &quot;type&quot;: &quot;m.room.member&quot;
            }
          ]
        }
      }
    },
    &quot;join&quot;: {
      &quot;!726s6s6q:example.com&quot;: {
        &quot;account_data&quot;: {
          &quot;events&quot;: [
            {
              &quot;content&quot;: {
                &quot;tags&quot;: {
                  &quot;u.work&quot;: {
                    &quot;order&quot;: 0.9
                  }
                }
              },
              &quot;type&quot;: &quot;m.tag&quot;
            },
            {
              &quot;content&quot;: {
                &quot;custom_config_key&quot;: &quot;custom_config_value&quot;
              },
              &quot;type&quot;: &quot;org.example.custom.room.config&quot;
            }
          ]
        },
        &quot;ephemeral&quot;: {
          &quot;events&quot;: [
            {
              &quot;content&quot;: {
                &quot;user_ids&quot;: [
                  &quot;@alice:matrix.org&quot;,
                  &quot;@bob:example.com&quot;
                ]
              },
              &quot;type&quot;: &quot;m.typing&quot;
            },
            {
              &quot;content&quot;: {
                &quot;$1435641916114394fHBLK:matrix.org&quot;: {
                  &quot;m.read&quot;: {
                    &quot;@rikj:jki.re&quot;: {
                      &quot;ts&quot;: 1436451550453
                    }
                  },
                  &quot;m.read.private&quot;: {
                    &quot;@self:example.org&quot;: {
                      &quot;ts&quot;: 1661384801651
                    }
                  }
                }
              },
              &quot;type&quot;: &quot;m.receipt&quot;
            }
          ]
        },
        &quot;state&quot;: {
          &quot;events&quot;: [
            {
              &quot;content&quot;: {
                &quot;avatar_url&quot;: &quot;mxc://example.org/SEsfnsuifSDFSSEF&quot;,
                &quot;displayname&quot;: &quot;Alice Margatroid&quot;,
                &quot;membership&quot;: &quot;join&quot;,
                &quot;reason&quot;: &quot;Looking for support&quot;
              },
              &quot;event_id&quot;: &quot;$143273582443PhrSn:example.org&quot;,
              &quot;origin_server_ts&quot;: 1432735824653,
              &quot;room_id&quot;: &quot;!jEsUZKDJdhlrceRyVU:example.org&quot;,
              &quot;sender&quot;: &quot;@example:example.org&quot;,
              &quot;state_key&quot;: &quot;@alice:example.org&quot;,
              &quot;type&quot;: &quot;m.room.member&quot;,
              &quot;unsigned&quot;: {
                &quot;age&quot;: 1234
              }
            }
          ]
        },
        &quot;summary&quot;: {
          &quot;m.heroes&quot;: [
            &quot;@alice:example.com&quot;,
            &quot;@bob:example.com&quot;
          ],
          &quot;m.invited_member_count&quot;: 0,
          &quot;m.joined_member_count&quot;: 2
        },
        &quot;timeline&quot;: {
          &quot;events&quot;: [
            {
              &quot;content&quot;: {
                &quot;avatar_url&quot;: &quot;mxc://example.org/SEsfnsuifSDFSSEF&quot;,
                &quot;displayname&quot;: &quot;Alice Margatroid&quot;,
                &quot;membership&quot;: &quot;join&quot;,
                &quot;reason&quot;: &quot;Looking for support&quot;
              },
              &quot;event_id&quot;: &quot;$143273582443PhrSn:example.org&quot;,
              &quot;origin_server_ts&quot;: 1432735824653,
              &quot;room_id&quot;: &quot;!jEsUZKDJdhlrceRyVU:example.org&quot;,
              &quot;sender&quot;: &quot;@example:example.org&quot;,
              &quot;state_key&quot;: &quot;@alice:example.org&quot;,
              &quot;type&quot;: &quot;m.room.member&quot;,
              &quot;unsigned&quot;: {
                &quot;age&quot;: 1234
              }
            },
            {
              &quot;content&quot;: {
                &quot;body&quot;: &quot;This is an example text message&quot;,
                &quot;format&quot;: &quot;org.matrix.custom.html&quot;,
                &quot;formatted_body&quot;: &quot;&lt;b&gt;This is an example text message&lt;/b&gt;&quot;,
                &quot;msgtype&quot;: &quot;m.text&quot;
              },
              &quot;event_id&quot;: &quot;$143273582443PhrSn:example.org&quot;,
              &quot;origin_server_ts&quot;: 1432735824653,
              &quot;room_id&quot;: &quot;!jEsUZKDJdhlrceRyVU:example.org&quot;,
              &quot;sender&quot;: &quot;@example:example.org&quot;,
              &quot;type&quot;: &quot;m.room.message&quot;,
              &quot;unsigned&quot;: {
                &quot;age&quot;: 1234
              }
            }
          ],
          &quot;limited&quot;: true,
          &quot;prev_batch&quot;: &quot;t34-23535_0_0&quot;
        },
        &quot;unread_notifications&quot;: {
          &quot;highlight_count&quot;: 1,
          &quot;notification_count&quot;: 5
        },
        &quot;unread_thread_notifications&quot;: {
          &quot;$threadroot&quot;: {
            &quot;highlight_count&quot;: 3,
            &quot;notification_count&quot;: 6
          }
        }
      }
    },
    &quot;knock&quot;: {
      &quot;!223asd456:example.com&quot;: {
        &quot;knock_state&quot;: {
          &quot;events&quot;: [
            {
              &quot;content&quot;: {
                &quot;name&quot;: &quot;My Room Name&quot;
              },
              &quot;sender&quot;: &quot;@alice:example.com&quot;,
              &quot;state_key&quot;: &quot;&quot;,
              &quot;type&quot;: &quot;m.room.name&quot;
            },
            {
              &quot;content&quot;: {
                &quot;membership&quot;: &quot;knock&quot;
              },
              &quot;sender&quot;: &quot;@bob:example.com&quot;,
              &quot;state_key&quot;: &quot;@bob:example.com&quot;,
              &quot;type&quot;: &quot;m.room.member&quot;
            }
          ]
        }
      }
    },
    &quot;leave&quot;: {}
  }
}
</code></pre>
<h3 id="77">7.7 ç²å–èŠå¤©å®¤çš„äº‹ä»¶</h3>
<p>ç‚ºèŠå¤©å®¤çš„äº‹ä»¶æä¾›äº†å¤šå€‹ API:</p>
<h4 id="get-_matrixclientv3roomsroomideventeventid">GET /_matrix/client/v3/rooms/{roomId}/event/{eventId}</h4>
<p>ç²å–åŸºæ–¼çš„å–®å€‹äº‹ä»¶ã€‚æ‚¨å¿…é ˆå…·æœ‰ä»¥ä¸‹æ¬Šé™:æª¢ç´¢æ­¤äº‹ä»¶,ä¾‹å¦‚,é€šéæˆç‚ºæ­¤äº‹ä»¶æˆ¿é–“ä¸­çš„æˆå“¡ã€‚roomId/eventId</p>
<pre><code class="language-json">{
  &quot;content&quot;: {
    &quot;body&quot;: &quot;This is an example text message&quot;,
    &quot;format&quot;: &quot;org.matrix.custom.html&quot;,
    &quot;formatted_body&quot;: &quot;&lt;b&gt;This is an example text message&lt;/b&gt;&quot;,
    &quot;msgtype&quot;: &quot;m.text&quot;
  },
  &quot;event_id&quot;: &quot;$143273582443PhrSn:example.org&quot;,
  &quot;origin_server_ts&quot;: 1432735824653,
  &quot;room_id&quot;: &quot;!636q39766251:matrix.org&quot;,
  &quot;sender&quot;: &quot;@example:example.org&quot;,
  &quot;type&quot;: &quot;m.room.message&quot;,
  &quot;unsigned&quot;: {
    &quot;age&quot;: 1234
  }
}
</code></pre>
<h4 id="get-_matrixclientv3roomsroomidjoined_members">GET /_matrix/client/v3/rooms/{roomId}/joined_members</h4>
<p>æ­¤ API å°‡ MXID çš„æ˜ å°„è¿”å›åˆ°èŠå¤©å®¤æˆå“¡çš„æˆå“¡ä¿¡æ¯ç‰©ä»¶ã€‚ç•¶å‰ç”¨æˆ¶å¿…é ˆåœ¨èŠå¤©å®¤ä¸­æ‰èƒ½å·¥ä½œ,é™¤éå®ƒæ˜¯æ‡‰ç”¨ç¨‹å¼æœå‹™,åœ¨é€™ç¨®æƒ…æ³ä¸‹,ä»»ä½• AS çš„ä½¿ç”¨è€…éƒ½å¿…é ˆåœ¨èŠå¤©å®¤ä¸­ã€‚æ­¤ API
ä¸»è¦ç”¨æ–¼æ‡‰ç”¨ç¨‹å¼æœå‹™,å›æ‡‰é€Ÿåº¦æ‡‰å¿«æ–¼åœ¨ä¼ºæœå™¨ä¸Šæ›´é«˜æ•ˆåœ°å¯¦ç¾ã€‚/members</p>
<pre><code class="language-json">{
  &quot;joined&quot;: {
    &quot;@bar:example.com&quot;: {
      &quot;avatar_url&quot;: &quot;mxc://riot.ovh/printErCATzZijQsSDWorRaK&quot;,
      &quot;display_name&quot;: &quot;Bar&quot;
    }
  }
}
</code></pre>
<h4 id="get-_matrixclientv3roomsroomidmembers">GET /_matrix/client/v3/rooms/{roomId}/members</h4>
<p>ç²å–æ­¤æœƒè­°å®¤çš„æˆå“¡æ¸…å–®ã€‚</p>
<pre><code class="language-json">{
  &quot;chunk&quot;: [
    {
      &quot;content&quot;: {
        &quot;avatar_url&quot;: &quot;mxc://example.org/SEsfnsuifSDFSSEF&quot;,
        &quot;displayname&quot;: &quot;Alice Margatroid&quot;,
        &quot;membership&quot;: &quot;join&quot;,
        &quot;reason&quot;: &quot;Looking for support&quot;
      },
      &quot;event_id&quot;: &quot;$143273582443PhrSn:example.org&quot;,
      &quot;origin_server_ts&quot;: 1432735824653,
      &quot;room_id&quot;: &quot;!636q39766251:example.com&quot;,
      &quot;sender&quot;: &quot;@example:example.org&quot;,
      &quot;state_key&quot;: &quot;@alice:example.org&quot;,
      &quot;type&quot;: &quot;m.room.member&quot;,
      &quot;unsigned&quot;: {
        &quot;age&quot;: 1234
      }
    }
  ]
}
</code></pre>
<h4 id="get-_matrixclientv3roomsroomidstate">GET /_matrix/client/v3/rooms/{roomId}/state</h4>
<p>ç²å–èŠå¤©å®¤ç•¶å‰ç‹€æ…‹çš„ç‹€æ…‹äº‹ä»¶ã€‚</p>
<pre><code class="language-json">[
  {
    &quot;content&quot;: {
      &quot;join_rule&quot;: &quot;public&quot;
    },
    &quot;event_id&quot;: &quot;$143273582443PhrSn:example.org&quot;,
    &quot;origin_server_ts&quot;: 1432735824653,
    &quot;room_id&quot;: &quot;!636q39766251:example.com&quot;,
    &quot;sender&quot;: &quot;@example:example.org&quot;,
    &quot;state_key&quot;: &quot;&quot;,
    &quot;type&quot;: &quot;m.room.join_rules&quot;,
    &quot;unsigned&quot;: {
      &quot;age&quot;: 1234
    }
  },
  {
    &quot;content&quot;: {
      &quot;avatar_url&quot;: &quot;mxc://example.org/SEsfnsuifSDFSSEF&quot;,
      &quot;displayname&quot;: &quot;Alice Margatroid&quot;,
      &quot;membership&quot;: &quot;join&quot;,
      &quot;reason&quot;: &quot;Looking for support&quot;
    },
    &quot;event_id&quot;: &quot;$143273582443PhrSn:example.org&quot;,
    &quot;origin_server_ts&quot;: 1432735824653,
    &quot;room_id&quot;: &quot;!636q39766251:example.com&quot;,
    &quot;sender&quot;: &quot;@example:example.org&quot;,
    &quot;state_key&quot;: &quot;@alice:example.org&quot;,
    &quot;type&quot;: &quot;m.room.member&quot;,
    &quot;unsigned&quot;: {
      &quot;age&quot;: 1234
    }
  },
  {
    &quot;content&quot;: {
      &quot;creator&quot;: &quot;@example:example.org&quot;,
      &quot;m.federate&quot;: true,
      &quot;predecessor&quot;: {
        &quot;event_id&quot;: &quot;$something:example.org&quot;,
        &quot;room_id&quot;: &quot;!oldroom:example.org&quot;
      },
      &quot;room_version&quot;: &quot;1&quot;
    },
    &quot;event_id&quot;: &quot;$143273582443PhrSn:example.org&quot;,
    &quot;origin_server_ts&quot;: 1432735824653,
    &quot;room_id&quot;: &quot;!636q39766251:example.com&quot;,
    &quot;sender&quot;: &quot;@example:example.org&quot;,
    &quot;state_key&quot;: &quot;&quot;,
    &quot;type&quot;: &quot;m.room.create&quot;,
    &quot;unsigned&quot;: {
      &quot;age&quot;: 1234
    }
  },
  {
    &quot;content&quot;: {
      &quot;ban&quot;: 50,
      &quot;events&quot;: {
        &quot;m.room.name&quot;: 100,
        &quot;m.room.power_levels&quot;: 100
      },
      &quot;events_default&quot;: 0,
      &quot;invite&quot;: 50,
      &quot;kick&quot;: 50,
      &quot;notifications&quot;: {
        &quot;room&quot;: 20
      },
      &quot;redact&quot;: 50,
      &quot;state_default&quot;: 50,
      &quot;users&quot;: {
        &quot;@example:localhost&quot;: 100
      },
      &quot;users_default&quot;: 0
    },
    &quot;event_id&quot;: &quot;$143273582443PhrSn:example.org&quot;,
    &quot;origin_server_ts&quot;: 1432735824653,
    &quot;room_id&quot;: &quot;!636q39766251:example.com&quot;,
    &quot;sender&quot;: &quot;@example:example.org&quot;,
    &quot;state_key&quot;: &quot;&quot;,
    &quot;type&quot;: &quot;m.room.power_levels&quot;,
    &quot;unsigned&quot;: {
      &quot;age&quot;: 1234
    }
  }
]
</code></pre>
<h4 id="get-_matrixclientv3roomsroomidstateeventtypestatekey">GET /_matrix/client/v3/rooms/{roomId}/state/{eventType}/{stateKey}</h4>
<p>æŸ¥æ‰¾æª”å®¤ä¸­ç‹€æ…‹äº‹ä»¶çš„å…§å®¹ã€‚å¦‚æœä½¿ç”¨è€…æ˜¯ åŠ å…¥åˆ°æˆ¿é–“,ç„¶å¾Œç‹€æ…‹å¾ç•¶å‰ç²å– æˆ¿é–“çš„ç‹€æ…‹ã€‚å¦‚æœç”¨æˆ¶å·²é›¢é–‹æˆ¿é–“,å‰‡ç‹€æ…‹ç‚º å–è‡ªä»–å€‘é›¢é–‹æ™‚çš„æˆ¿é–“ç‹€æ…‹ã€‚</p>
<p>200 å›æ‡‰</p>
<pre><code class="language-json">{
  &quot;name&quot;: &quot;Example room name&quot;
}
</code></pre>
<h4 id="get-_matrixclientv3roomsroomidmessages">GET /_matrix/client/v3/rooms/{roomId}/messages</h4>
<p>æ­¤ API è¿”å›èŠå¤©å®¤çš„æ¶ˆæ¯å’Œç‹€æ…‹äº‹ä»¶æ¸…å–®ã€‚å®ƒä½¿ç”¨ åˆ†é æŸ¥è©¢åƒæ•¸,ç”¨æ–¼å°æˆ¿é–“ä¸­çš„æ­·å²è¨˜éŒ„é€²è¡Œåˆ†é ã€‚</p>
<p>æ³¨:æ­¤ç«¯é»æ”¯æ´å»¶é²è¼‰å…¥æª”æ¡ˆå®¤æˆå“¡äº‹ä»¶ã€‚æœ‰é—œè©³ç´°è³‡è¨Š,è«‹åƒé–±æ‡¶æƒ°è¼‰å…¥å®¤æˆå“¡ã€‚</p>
<pre><code class="language-json">{
  &quot;chunk&quot;: [
    {
      &quot;content&quot;: {
        &quot;body&quot;: &quot;This is an example text message&quot;,
        &quot;format&quot;: &quot;org.matrix.custom.html&quot;,
        &quot;formatted_body&quot;: &quot;&lt;b&gt;This is an example text message&lt;/b&gt;&quot;,
        &quot;msgtype&quot;: &quot;m.text&quot;
      },
      &quot;event_id&quot;: &quot;$143273582443PhrSn:example.org&quot;,
      &quot;origin_server_ts&quot;: 1432735824653,
      &quot;room_id&quot;: &quot;!636q39766251:example.com&quot;,
      &quot;sender&quot;: &quot;@example:example.org&quot;,
      &quot;type&quot;: &quot;m.room.message&quot;,
      &quot;unsigned&quot;: {
        &quot;age&quot;: 1234
      }
    },
    {
      &quot;content&quot;: {
        &quot;name&quot;: &quot;The room name&quot;
      },
      &quot;event_id&quot;: &quot;$143273582443PhrSn:example.org&quot;,
      &quot;origin_server_ts&quot;: 1432735824653,
      &quot;room_id&quot;: &quot;!636q39766251:example.com&quot;,
      &quot;sender&quot;: &quot;@example:example.org&quot;,
      &quot;state_key&quot;: &quot;&quot;,
      &quot;type&quot;: &quot;m.room.name&quot;,
      &quot;unsigned&quot;: {
        &quot;age&quot;: 1234
      }
    },
    {
      &quot;content&quot;: {
        &quot;body&quot;: &quot;Gangnam Style&quot;,
        &quot;info&quot;: {
          &quot;duration&quot;: 2140786,
          &quot;h&quot;: 320,
          &quot;mimetype&quot;: &quot;video/mp4&quot;,
          &quot;size&quot;: 1563685,
          &quot;thumbnail_info&quot;: {
            &quot;h&quot;: 300,
            &quot;mimetype&quot;: &quot;image/jpeg&quot;,
            &quot;size&quot;: 46144,
            &quot;w&quot;: 300
          },
          &quot;thumbnail_url&quot;: &quot;mxc://example.org/FHyPlCeYUSFFxlgbQYZmoEoe&quot;,
          &quot;w&quot;: 480
        },
        &quot;msgtype&quot;: &quot;m.video&quot;,
        &quot;url&quot;: &quot;mxc://example.org/a526eYUSFFxlgbQYZmo442&quot;
      },
      &quot;event_id&quot;: &quot;$143273582443PhrSn:example.org&quot;,
      &quot;origin_server_ts&quot;: 1432735824653,
      &quot;room_id&quot;: &quot;!636q39766251:example.com&quot;,
      &quot;sender&quot;: &quot;@example:example.org&quot;,
      &quot;type&quot;: &quot;m.room.message&quot;,
      &quot;unsigned&quot;: {
        &quot;age&quot;: 1234
      }
    }
  ],
  &quot;end&quot;: &quot;t47409-4357353_219380_26003_2265&quot;,
  &quot;start&quot;: &quot;t47429-4392820_219380_26003_2265&quot;
}
</code></pre>
<h4 id="get-_matrixclientv1roomsroomidtimestamp_to_event">GET /_matrix/client/v1/rooms/{roomId}/timestamp_to_event</h4>
<p>v1.6 ä¸­æ–°å¢</p>
<p>ç²å–æœ€æ¥è¿‘çµ¦å®šæ™‚é–“æˆ³çš„äº‹ä»¶çš„ID,åœ¨ åƒæ•¸æŒ‡å®šçš„æ–¹å‘ã€‚dir</p>
<p>å¦‚æœä¼ºæœå™¨æ²’æœ‰æ‰€æœ‰æˆ¿é–“æ­·å²è¨˜éŒ„,ä¸¦ä¸”æ²’æœ‰ é©ç•¶æ¥è¿‘è«‹æ±‚æ™‚é–“æˆ³çš„äº‹ä»¶,å®ƒå¯ä»¥ä½¿ç”¨ ç›¸æ‡‰çš„è¯åˆçµ‚çµé»,ç”¨æ–¼å‘å…¶ä»–ä¼ºæœå™¨è«‹æ±‚åˆé©çš„äº‹ä»¶ã€‚</p>
<p>èª¿ç”¨æ­¤çµ‚çµé»å,ç”¨æˆ¶ç«¯å¯ä»¥èª¿ç”¨ /rooms/{roomId}/context/{eventId} ä¾†ç²å–åˆ†é ä»¤ç‰Œ,ä»¥æª¢ç´¢è¿”å›äº‹ä»¶å‘¨åœçš„äº‹ä»¶ã€‚</p>
<p>æ­¤çµ‚çµé»è¿”å›çš„äº‹ä»¶å¯èƒ½æ˜¯ç”¨æˆ¶ç«¯è¿”å›çš„äº‹ä»¶ ç„¡æ³•å‘ˆç¾,å› æ­¤å¯èƒ½éœ€è¦åˆ†é æ‰èƒ½æ‰¾åˆ°äº‹ä»¶ å®ƒå¯ä»¥é¡¯ç¤º,æœ€çµ‚å¯èƒ½æœƒè¶…å‡ºç”¨æˆ¶ç«¯çš„ åˆé©çš„ç¯„åœã€‚å®¢æˆ¶å¯ä»¥æ¡ç”¨ä¸åŒçš„ç­–ç•¥ä¾†å±•ç¤º å°ç”¨æˆ¶ä¾†èªªåˆç†çš„æ±è¥¿ã€‚ä¾‹å¦‚,ç”¨æˆ¶ç«¯å¯ä»¥å˜—è©¦ æœä¸€å€‹æ–¹å‘åˆ†é ä¸€æœƒå…’,åŒæ™‚çœ‹è‘—
å®ƒæ­£åœ¨åˆ†é çš„äº‹ä»¶çš„æ™‚é–“æˆ³,ä»¥åŠå®ƒæ˜¯å¦ è¶…éèˆ‡ç›®æ¨™æ™‚é–“æˆ³çš„ä¸€å®šå·®ç•°,å¯ä»¥å˜—è©¦ ä»¥ç›¸åçš„æ–¹å‘åˆ†é ã€‚å®¢æˆ¶ä¹Ÿå¯ä»¥ç°¡å–®åœ° åœ¨ä¸€å€‹æ–¹å‘ä¸Šåˆ†é ,ä¸¦é€šçŸ¥ä½¿ç”¨è€…æœ€è¿‘çš„äº‹ä»¶ åœ¨è©²æ–¹å‘ä¸Šç™¼ç¾è¶…å‡ºäº†é æœŸç¯„åœã€‚</p>
<pre><code class="language-json">{
  &quot;event_id&quot;: &quot;$143273582443PhrSn:example.org&quot;,
  &quot;origin_server_ts&quot;: 1432735824653
}
</code></pre>
<h3 id="78">7.8 å°‡äº‹ä»¶ç™¼é€åˆ°èŠå¤©å®¤</h3>
<p>å¦‚æœæŸäº›äº‹ä»¶èˆ‡å¦ä¸€å€‹äº‹ä»¶ç›¸é—œ,å‰‡ä¼ºæœå™¨å¯èƒ½éœ€è¦å°å…¶é€²è¡Œå¾Œè™•ç†ã€‚è©²æ´»å‹•çš„ é—œä¿‚é¡å‹ ï¼ˆï¼‰ ç¢ºå®šå¯èƒ½é©ç”¨çš„ä»»ä½•é™åˆ¶, ä¾‹å¦‚,ä½¿ç”¨è€…åªèƒ½ç™¼é€ä¸€å€‹çµ¦å®šé¡å‹çš„äº‹ä»¶ åˆ°å¦ä¸€å€‹ã€‚rel_type</p>
<h4 id="put-_matrixclientv3roomsroomidstateeventtypestatekey">PUT /_matrix/client/v3/rooms/{roomId}/state/{eventType}/{stateKey}</h4>
<p>å¯ä»¥ä½¿ç”¨æ­¤çµ‚çµé»ç™¼é€ç‹€æ…‹äº‹ä»¶ã€‚é€™äº›äº‹ä»¶å°‡æ˜¯ è¦†è“‹ if å’Œæ‰€æœ‰ ç«æŸ´ã€‚<room id><event type><state key></p>
<p>å°æ­¤ç«¯é»çš„è«‹æ±‚ä¸èƒ½åƒå…¶ä»–è·¯å¾‘ä¸€æ¨£ä½¿ç”¨äº‹å‹™ ID,å› ç‚ºå®ƒå€‘ç„¡æ³•èˆ‡ .æ­¤å¤–,åœ¨ç‹€æ…‹è·¯å¾‘ä¸Šä¸å—æ”¯æ´ã€‚PUTstate_keyPOST</p>
<p>è«‹æ±‚çš„æ­£æ–‡æ‡‰è©²æ˜¯äº‹ä»¶çš„å…§å®¹ç‰©ä»¶;é€™ æ­¤ç‰©ä»¶ä¸­çš„æ¬„ä½å°‡æ ¹æ“šäº‹ä»¶é¡å‹è€Œæœ‰æ‰€ä¸åŒã€‚æœ‰é—œæ´»å‹•è¦ç¯„,è«‹åƒé–±æœƒè­°å®¤æ´»å‹•ã€‚m.</p>
<p>å¦‚æœè¦ç™¼é€çš„äº‹ä»¶é¡å‹æ˜¯ä¼ºæœå™¨ æ‡‰ç¢ºä¿äº‹ä»¶ä¸­åˆ—å‡ºçš„ä»»ä½•æ–°åˆ¥åéƒ½æœ‰æ•ˆ æ ¹æ“šä»–å€‘çš„èªæ³•/å¥æ³•,ä¸¦ä¸”ä»–å€‘æŒ‡å‘æˆ¿é–“IDå…¶ä¸­ å°‡ç™¼é€ç‹€æ…‹äº‹ä»¶ã€‚ä¼ºæœå™¨ä¸é©—è­‰åˆ¥å æ­£åœ¨åˆªé™¤æˆ–å·²å­˜åœ¨æ–¼ç‹€æ…‹äº‹ä»¶ä¸­ã€‚m.room.canonical_alias</p>
<p>è«‹æ±‚æ­£æ–‡ç¤ºä¾‹</p>
<pre><code class="language-json">{
  &quot;avatar_url&quot;: &quot;mxc://localhost/SEsfnsuifSDFSSEF&quot;,
  &quot;displayname&quot;: &quot;Alice Margatroid&quot;,
  &quot;membership&quot;: &quot;join&quot;
}
</code></pre>
<p>200å›æ‡‰</p>
<pre><code class="language-json">{
  &quot;event_id&quot;: &quot;$YUwRidLecu:example.com&quot;
}
</code></pre>
<h4 id="put-_matrixclientv3roomsroomidsendeventtypetxnid">PUT /_matrix/client/v3/rooms/{roomId}/send/{eventType}/{txnId}</h4>
<p>æ­¤çµ‚çµé»ç”¨æ–¼å°‡æ¶ˆæ¯äº‹ä»¶ç™¼é€åˆ°èŠå¤©å®¤ã€‚æ¶ˆæ¯äº‹ä»¶ å…è¨±è¨ªå•æ­·å²äº‹ä»¶å’Œåˆ†é ,ä½¿å…¶é©åˆ ç”¨æ–¼æˆ¿é–“å…§çš„'ä¸€æ¬¡æ€§'æ´»å‹•ã€‚</p>
<p>è«‹æ±‚çš„æ­£æ–‡æ‡‰è©²æ˜¯äº‹ä»¶çš„å…§å®¹ç‰©ä»¶;é€™ æ­¤ç‰©ä»¶ä¸­çš„æ¬„ä½å°‡æ ¹æ“šäº‹ä»¶é¡å‹è€Œæœ‰æ‰€ä¸åŒã€‚æœ‰é—œ m. äº‹ä»¶è¦ç¯„,è«‹åƒé–±æœƒè­°å®¤äº‹ä»¶ã€‚</p>
<p>è«‹æ±‚æ­£æ–‡ç¤ºä¾‹</p>
<pre><code class="language-json">{
  &quot;body&quot;: &quot;hello&quot;,
  &quot;msgtype&quot;: &quot;m.text&quot;
}
</code></pre>
<p>200 å›æ‡‰</p>
<pre><code class="language-json">{
  &quot;event_id&quot;: &quot;$YUwRidLecu:example.com&quot;
}
</code></pre>
<h3 id="79">7.9 å¯†æ–‡</h3>
<p>ç”±æ–¼äº‹ä»¶æ˜¯å¯æ“´å±•çš„,å› æ­¤æƒ¡æ„ä½¿ç”¨è€…å’Œ/æˆ– ä¼ºæœå™¨,ç”¨æ–¼æ·»åŠ è«¸å¦‚æ”»æ“Šæ€§æˆ–éæ³•çš„å¯†é‘°ã€‚å› ç‚º æœ‰äº›äº‹ä»¶ä¸èƒ½ç°¡å–®åœ°åˆªé™¤,ä¾‹å¦‚æœƒå“¡æ´»å‹•,æˆ‘å€‘å–è€Œä»£ä¹‹çš„æ˜¯ "ç·¨è¼¯"äº‹ä»¶ã€‚é€™æ¶‰åŠå¾äº‹ä»¶ä¸­åˆªé™¤æ‰€æœ‰éµ å”å®šä¸éœ€è¦ã€‚æ­¤å¾Œ,æ­¤ç²¾ç°¡äº‹ä»¶
æ¯ç•¶å®¢æˆ¶ç«¯æˆ–é ç«¯ä¼ºæœå™¨è«‹æ±‚å®ƒæ™‚è¿”å›ã€‚ç·¨è¼¯ä¸€å€‹ äº‹ä»¶ç„¡æ³•æ’¤éŠ·,å…è¨±ä¼ºæœå™¨æ“æœ‰è€…åˆªé™¤æœ‰å•é¡Œçš„ è³‡æ–™åº«ä¸­çš„å…§å®¹ã€‚ä¼ºæœå™¨æ‡‰åœ¨å‘ç”¨æˆ¶ç«¯æä¾›ç¶“éç·¨è¼¯çš„äº‹ä»¶æ™‚åœ¨ as
ä¸‹åŒ…å«äº‹ä»¶çš„å‰¯æœ¬ã€‚m.room.redactionunsignedredacted_because</p>
<p>åœ¨æˆ¿é–“ä¸­å®šç¾©è¦æ‡‰ç”¨æ–¼äº‹ä»¶çš„ç¢ºåˆ‡æ¼”ç®—æ³• ç‰ˆæœ¬è¦ç¯„,ä»¥åŠä¸»ä¼ºæœå™¨æ‡‰éµå¾ªçš„æ¨™æº– åœ¨æ±ºå®šæ˜¯å¦æ¥å—ä¾†è‡ªé ç«¯çš„ç·¨æ ¡äº‹ä»¶æ™‚ä½¿ç”¨ ä¸»ä¼ºæœå™¨ã€‚</p>
<p>ç•¶ç”¨æˆ¶ç«¯æ”¶åˆ°äº‹ä»¶æ™‚,å®ƒæ‡‰è©²æ›´æ”¹ å—å½±éŸ¿çš„äº‹ä»¶èˆ‡ä¼ºæœå™¨ç›¸åŒã€‚m.room.redaction</p>
<h4 id="791">7.9.1 äº‹ä»¶</h4>
<h5 id="mroomredaction">m.room.redaction</h5>
<p>æ­¤äº‹ä»¶ç”±ä¼ºæœå™¨å‰µå»º,ç”¨æ–¼æè¿°å·²ç·¨è¼¯çš„äº‹ä»¶,ç”±èª°ç·¨è¼¯ä»¥åŠï¼ˆå¯é¸ï¼‰åŸå› ã€‚å·²ç·¨è¼¯çš„äº‹ä»¶åœ¨äº‹ä»¶ç´šåˆ¥éµä¸­æŒ‡å®šã€‚ç·¨è¼¯äº‹ä»¶æ„å‘³è‘—å”å®šä¸éœ€è¦çš„æ‰€æœ‰å¯†é‘°éƒ½æœƒè¢«å‰é›¢,å¾è€Œå…è¨±éš±è—æ¶ˆæ¯æˆ–å…è¨±ç®¡ç†å“¡åˆªé™¤å†’çŠ¯æ€§æˆ–éæ³•å…§å®¹ã€‚redacts</p>
<pre><code class="language-json">{
  &quot;content&quot;: {
    &quot;reason&quot;: &quot;Spamming&quot;
  },
  &quot;event_id&quot;: &quot;$143273582443PhrSn:example.org&quot;,
  &quot;origin_server_ts&quot;: 1432735824653,
  &quot;redacts&quot;: &quot;$fukweghifu23:localhost&quot;,
  &quot;room_id&quot;: &quot;!jEsUZKDJdhlrceRyVU:example.org&quot;,
  &quot;sender&quot;: &quot;@example:example.org&quot;,
  &quot;type&quot;: &quot;m.room.redaction&quot;,
  &quot;unsigned&quot;: {
    &quot;age&quot;: 1234
  }
}
</code></pre>
<h4 id="792">7.9.2 å®¢æˆ¶ç«¯è¡Œç‚º</h4>
<h5 id="put-_matrixclientv3roomsroomidredacteventidtxnid">PUT /_matrix/client/v3/rooms/{roomId}/redact/{eventId}/{txnId}</h5>
<p>å¾å° èŠå¤©å®¤çš„ä¼ºæœå™¨ç«¯è¡¨ç¤ºå½¢å¼çš„å®Œæ•´æ€§ã€‚</p>
<p>é€™æ˜¯ç„¡æ³•æ’¤éŠ·çš„ã€‚</p>
<p>ä»»ä½•åŠŸç‡ç´šåˆ¥å¤§æ–¼æˆ–ç­‰æ–¼äº‹ä»¶åŠŸç‡ç´šåˆ¥çš„ä½¿ç”¨è€…éƒ½å¯ä»¥åœ¨èŠå¤©å®¤ä¸­ç™¼é€å¯†æ–‡äº‹ä»¶ã€‚å¦‚æœç”¨æˆ¶çš„é›»æº é›»å¹³å¤§æ–¼ä¹Ÿå¤§æ–¼æˆ–ç­‰æ–¼åŠŸç‡é›»å¹³ ,ç”¨æˆ¶å¯ä»¥ç·¨è¼¯å…¶ä»–ç”¨æˆ¶ç™¼é€çš„äº‹ä»¶ã€‚m.room.redactionredact</p>
<p>ä¼ºæœå™¨ç®¡ç†å“¡å¯ä»¥ç·¨è¼¯ä½¿ç”¨è€…åœ¨å…¶ä¼ºæœå™¨ä¸Šç™¼é€çš„äº‹ä»¶ã€‚</p>
<p>è«‹æ±‚æ­£æ–‡ç¤ºä¾‹</p>
<pre><code>{
  &quot;reason&quot;: &quot;Indecent material&quot;
}
</code></pre>
<p>200 å›æ‡‰</p>
<pre><code class="language-json">{
  &quot;event_id&quot;: &quot;$YUwQidLecu:example.com&quot;
}
</code></pre>
<h3 id="710">7.10 åœ¨äº‹ä»¶ä¹‹é–“å½¢æˆé—œä¿‚</h3>
<p>åœ¨æŸäº›æƒ…æ³ä¸‹,æœ€å¥½åœ¨é‚è¼¯ä¸Šå°‡ä¸€å€‹äº‹ä»¶çš„å…§å®¹èˆ‡ å¦ä¸€å€‹äº‹ä»¶çš„å…§å®¹ â€” ä¾‹å¦‚,åœ¨å›å¾©æ¶ˆæ¯æ™‚,ç·¨è¼¯ äº‹ä»¶,æˆ–è€…åªæ˜¯å¸Œæœ›ç‚ºäº‹ä»¶çš„ç›®çš„æ·»åŠ ä¸Šä¸‹æ–‡ã€‚</p>
<p>äº‹ä»¶åœ¨çˆ¶/å­çµæ§‹ä¸­ç›¸äº’é—œè¯,å…¶ä¸­ä»»ä½•äº‹ä»¶éƒ½å¯ä»¥ é€šéç°¡å–®åœ°è®“ä¸€å€‹å­©å­äº‹ä»¶é»æˆç‚ºçˆ¶æ¯ã€‚çˆ¶äº‹ä»¶ä¸ å®šç¾©ä»–å€‘çš„å­©å­,è€Œä¸æ˜¯ä¾é å­©å­ä¾†æè¿°ä»–å€‘çš„çˆ¶æ¯ã€‚</p>
<p>å­äº‹ä»¶èˆ‡å…¶çˆ¶äº‹ä»¶ä¹‹é–“çš„é—œä¿‚åœ¨å­äº‹ä»¶ä¸­æè¿° äº‹ä»¶ç‚ºï¼ˆå®šç¾©å¦‚ä¸‹ï¼‰ã€‚å­äº‹ä»¶å¯ä»¥æŒ‡å‘ ä»»ä½•å…¶ä»–äº‹ä»¶,åŒ…æ‹¬å¦ä¸€å€‹å­äº‹ä»¶,ä»¥å»ºç«‹å¦‚æ­¤é•·æ™‚é–“çš„é—œä¿‚ ç”±æ–¼å…©å€‹æ´»å‹•éƒ½åœ¨åŒä¸€å€‹æˆ¿é–“å…§,ä½†æ˜¯å¯èƒ½æœƒæ–½åŠ é¡å¤–çš„é™åˆ¶ æŒ‰é—œä¿‚çš„é¡å‹
ï¼ˆï¼‰ã€‚contentm.relates_torel_type</p>
<p>è‹¥è¦å…è¨±ä¼ºæœå™¨èšåˆå’ŒæŸ¥æ‰¾çˆ¶äº‹ä»¶çš„å­äº‹ä»¶,äº‹ä»¶çš„éµå¿…é ˆåŒ…å«åœ¨äº‹ä»¶çš„æ˜æ–‡éƒ¨åˆ†ä¸­ã€‚å®ƒä¸å¯èƒ½ ä»¥ç¨ä½”æ–¹å¼è¨˜éŒ„åœ¨åŠ å¯†çš„æœ‰æ•ˆè² è¼‰ä¸­,å› ç‚ºä¼ºæœå™¨ç„¡æ³•è§£å¯†äº‹ä»¶ ç”¨æ–¼è™•ç†ã€‚m.relates_to</p>
<p>èˆ‡æ¶æ§‹ä¸åŒ¹é…æˆ–é•åé—œä¿‚è¦å‰‡çš„é—œä¿‚, åªæ˜¯è¢«å¿½ç•¥äº†ã€‚ä¸€å€‹ä¾‹å­å¯èƒ½æ˜¯çˆ¶é …å’Œå­é …è™•æ–¼ä¸åŒçš„ä½ç½® æˆ¿é–“,æˆ–ä»¥ä¸‹æ¶æ§‹æ‰€éœ€çš„ç¼ºå°‘å±¬æ€§çš„é—œä¿‚ã€‚å®¢æˆ¶ è™•ç†æ­¤é¡ç„¡æ•ˆé—œä¿‚æ‡‰ç¨ç«‹æ–¼æ¯å€‹äº‹ä»¶é¡¯ç¤ºäº‹ä»¶ å…¶ä»–,å¯é¸å–çš„é¡¯ç¤ºéŒ¯èª¤è¨Šæ¯ã€‚</p>
<h4 id="mrelates_to">m.relates_to</h4>
<pre><code class="language-json">{
  &quot;m.relates_to&quot;: {
    &quot;event_id&quot;: &quot;$an_event&quot;,
    &quot;rel_type&quot;: &quot;org.example.relationship&quot;
  }
}
</code></pre>
<h4 id="7101">7.10.1 é—œä¿‚é¡å‹</h4>
<p>é€™å€‹è¦ç¯„æè¿°ä»¥ä¸‹é—œä¿‚é¡å‹:</p>
<ul>
<li>Event replacements.</li>
<li>Event annotations.</li>
<li>Threads.</li>
<li>References</li>
</ul>
<h4 id="7102">7.10.2 å­äº‹ä»¶çš„èšåˆ</h4>
<p>æŸäº›å­äº‹ä»¶å¯ä»¥ç”±ä¼ºæœå™¨'èšåˆ',å…·é«”å–æ±ºæ–¼å®ƒå€‘çš„ .é€™å¯ä»¥å…è¨±å°‡ä¸€çµ„å­äº‹ä»¶åŒ¯ç¸½åˆ°ç”¨æˆ¶ç«¯,è€Œç„¡éœ€ éœ€è¦å­äº‹ä»¶æœ¬èº«çš„ç”¨æˆ¶ç«¯ã€‚rel_type</p>
<p>é€™æ–¹é¢çš„ä¸€å€‹ä¾‹å­å¯èƒ½æ˜¯ a éœ€è¦ä¸€å€‹é¡å¤–çš„æ¬„ä½,ç•¶ é©ç•¶æŒ‡å®š,å°‡æ„å‘³è‘—ç”¨æˆ¶ç«¯æ”¶åˆ°è©²æ•¸å­—çš„ç¸½æ•¸ å­äº‹ä»¶ä½¿ç”¨çš„æ¬¡æ•¸ã€‚rel_typekeykey</p>
<p>å¯¦éš›çš„èšåˆæ ¼å¼å–æ±ºæ–¼ .rel_type</p>
<p>ç•¶é€šéä¸‹é¢åˆ—å‡ºçš„ API å°‡äº‹ä»¶æä¾›çµ¦ç”¨æˆ¶ç«¯æ™‚,å¦‚æœäº‹ä»¶å…·æœ‰å­ç´š,å‰‡åœ¨'å¦‚æœäº‹ä»¶å…·æœ‰å­é …'ä¸‹å°‡åŒ…å«ä¸€å€‹å±¬æ€§ å¯ä»¥èšåˆä½µæŒ‡å‘å®ƒçš„äº‹ä»¶ã€‚è©²ç‰©æ¥­æ˜¯ ç”±å’Œå€¼ç‚ºéµçš„ç‰©ä»¶æ˜¯ç‰¹å®šæ–¼é¡å‹çš„èšåˆ æ ¼å¼.æ­¤å±¬æ€§ç¨±ç‚º'æ†ç¶'ã€‚ èšåˆ"
ã€‚m.relationsunsignedm.relationsrel_typerel_typem.relations</p>
<p>ä¾‹å¦‚ï¼ˆä¸åŒ…æ‹¬ä¸é‡è¦çš„æ¬„ä½ï¼‰:</p>
<pre><code class="language-json">{
  &quot;event_id&quot;: &quot;$my_event&quot;,
  &quot;unsigned&quot;: {
    &quot;m.relations&quot;: {
      &quot;org.example.possible_annotations&quot;: [
        {
          &quot;key&quot;: &quot;ğŸ‘&quot;,
          &quot;origin_server_ts&quot;: 1562763768320,
          &quot;count&quot;: 3
        },
        {
          &quot;key&quot;: &quot;ğŸ‘&quot;,
          &quot;origin_server_ts&quot;: 1562763768320,
          &quot;count&quot;: 1
        }
      ],
      &quot;org.example.possible_thread&quot;: {
        &quot;current_server_participated&quot;: true,
        &quot;count&quot;: 7,
        &quot;latest_event&quot;: {
          &quot;event_id&quot;: &quot;$another_event&quot;,
          &quot;content&quot;: {
            &quot;body&quot;: &quot;Hello world&quot;
          }
        }
      }
    }
  }
}
</code></pre>
<h4 id="7103">7.10.3 é—œä¿‚ä»‹é¢</h4>
<p>è‹¥è¦å¾ä¼ºæœå™¨æª¢ç´¢çˆ¶é …çš„å­äº‹ä»¶,ç”¨æˆ¶ç«¯å¯ä»¥èª¿ç”¨ ä»¥ä¸‹ç«¯é»ã€‚</p>
<p>å¦‚æœå®¢æˆ¶ç«¯ä¸Ÿå¤±äº†èšåˆä¸Šçš„ä¸Šä¸‹æ–‡,å‰‡æ­¤çµ‚çµé»ç‰¹åˆ¥æœ‰ç”¨ çˆ¶äº‹ä»¶,éœ€è¦é‡æ–°ç”Ÿæˆ/é©—è­‰å®ƒã€‚</p>
<h5 id="get-_matrixclientv1roomsroomidrelationseventid">GET /_matrix/client/v1/rooms/{roomId}/relations/{eventId}</h5>
<p>æª¢ç´¢çµ¦å®šçˆ¶äº‹ä»¶çš„æ‰€æœ‰å­äº‹ä»¶ã€‚</p>
<p>è«‹æ³¨æ„,åˆ†é æ™‚,ä»¤ç‰Œæ‡‰"åœ¨"ä»¤ç‰Œä¹‹å¾Œ æ‹“æ’²æ’åºè¡“èª,å› ç‚ºåªèƒ½'å‘å¾Œ'åˆ†é  é€šéäº‹ä»¶,å¾ é–‹å§‹ã€‚fromtofrom</p>
<p>ä¾‹å¦‚,å¾çµæœçš„ç¬¬ 2 é å‚³éä»¤ç‰Œ,ä»¥åŠä¸€å€‹ä»¤ç‰Œ å¾ç¬¬ 1 é é–‹å§‹,å°‡è¿”å›ç©ºé›†ã€‚èª¿ç”¨æ–¹å¯ä»¥ä½¿ç”¨ä¾†è‡ª ä½†æ˜¯,ç¬¬ 1 é å’Œç¬¬ 2 é ä¸­çš„æ¨™è¨˜å°‡åœ¨åŒä¸€ç¯„åœå…§é€²è¡Œåˆ†é ã€‚fromtofromto</p>
<pre><code class="language-json">{
  &quot;chunk&quot;: [
    {
      &quot;content&quot;: {
        &quot;m.relates_to&quot;: {
          &quot;event_id&quot;: &quot;$asfDuShaf7Gafaw&quot;,
          &quot;rel_type&quot;: &quot;org.example.my_relation&quot;
        }
      },
      &quot;event_id&quot;: &quot;$143273582443PhrSn:example.org&quot;,
      &quot;origin_server_ts&quot;: 1432735824653,
      &quot;room_id&quot;: &quot;!636q39766251:matrix.org&quot;,
      &quot;sender&quot;: &quot;@example:example.org&quot;,
      &quot;type&quot;: &quot;m.room.message&quot;,
      &quot;unsigned&quot;: {
        &quot;age&quot;: 1234
      }
    }
  ],
  &quot;next_batch&quot;: &quot;page2_token&quot;,
  &quot;prev_batch&quot;: &quot;page1_token&quot;
}
</code></pre>
<h5 id="get-_matrixclientv1roomsroomidrelationseventidreltype">GET /_matrix/client/v1/rooms/{roomId}/relations/{eventId}/{relType}</h5>
<p>æª¢ç´¢çµ¦å®šçˆ¶äº‹ä»¶èˆ‡çˆ¶äº‹ä»¶ç›¸é—œçš„æ‰€æœ‰å­äº‹ä»¶ ä½¿ç”¨çµ¦å®šçš„ .relType</p>
<p>è«‹æ³¨æ„,åˆ†é æ™‚,ä»¤ç‰Œæ‡‰"åœ¨"ä»¤ç‰Œä¹‹å¾Œ æ‹“æ’²æ’åºè¡“èª,å› ç‚ºåªèƒ½'å‘å¾Œ'åˆ†é  é€šéäº‹ä»¶,å¾ é–‹å§‹ã€‚fromtofrom</p>
<p>ä¾‹å¦‚,å¾çµæœçš„ç¬¬ 2 é å‚³éä»¤ç‰Œ,ä»¥åŠä¸€å€‹ä»¤ç‰Œ å¾ç¬¬ 1 é é–‹å§‹,å°‡è¿”å›ç©ºé›†ã€‚èª¿ç”¨æ–¹å¯ä»¥ä½¿ç”¨ä¾†è‡ª ä½†æ˜¯,ç¬¬ 1 é å’Œç¬¬ 2 é ä¸­çš„æ¨™è¨˜å°‡åœ¨åŒä¸€ç¯„åœå…§é€²è¡Œåˆ†é ã€‚fromtofromto</p>
<pre><code class="language-json">{
  &quot;chunk&quot;: [
    {
      &quot;content&quot;: {
        &quot;m.relates_to&quot;: {
          &quot;event_id&quot;: &quot;$asfDuShaf7Gafaw&quot;,
          &quot;rel_type&quot;: &quot;org.example.my_relation&quot;
        }
      },
      &quot;event_id&quot;: &quot;$143273582443PhrSn:example.org&quot;,
      &quot;origin_server_ts&quot;: 1432735824653,
      &quot;room_id&quot;: &quot;!636q39766251:matrix.org&quot;,
      &quot;sender&quot;: &quot;@example:example.org&quot;,
      &quot;type&quot;: &quot;m.room.message&quot;,
      &quot;unsigned&quot;: {
        &quot;age&quot;: 1234
      }
    }
  ],
  &quot;next_batch&quot;: &quot;page2_token&quot;,
  &quot;prev_batch&quot;: &quot;page1_token&quot;
}
</code></pre>
<h5 id="get-_matrixclientv1roomsroomidrelationseventidreltypeeventtype">GET /_matrix/client/v1/rooms/{roomId}/relations/{eventId}/{relType}/{eventType}</h5>
<p>æª¢ç´¢çµ¦å®šçˆ¶äº‹ä»¶èˆ‡çˆ¶äº‹ä»¶ç›¸é—œçš„æ‰€æœ‰å­äº‹ä»¶ ä½¿ç”¨çµ¦å®šçš„ä¸¦æ“æœ‰çµ¦å®šçš„.relTypeeventType</p>
<p>è«‹æ³¨æ„,åˆ†é æ™‚,ä»¤ç‰Œæ‡‰"åœ¨"ä»¤ç‰Œä¹‹å¾Œ æ‹“æ’²æ’åºè¡“èª,å› ç‚ºåªèƒ½'å‘å¾Œ'åˆ†é  é€šéäº‹ä»¶,å¾ é–‹å§‹ã€‚fromtofrom</p>
<p>ä¾‹å¦‚,å¾çµæœçš„ç¬¬ 2 é å‚³éä»¤ç‰Œ,ä»¥åŠä¸€å€‹ä»¤ç‰Œ å¾ç¬¬ 1 é é–‹å§‹,å°‡è¿”å›ç©ºé›†ã€‚èª¿ç”¨æ–¹å¯ä»¥ä½¿ç”¨ä¾†è‡ª ä½†æ˜¯,ç¬¬ 1 é å’Œç¬¬ 2 é ä¸­çš„æ¨™è¨˜å°‡åœ¨åŒä¸€ç¯„åœå…§é€²è¡Œåˆ†é ã€‚fromtofromto</p>
<pre><code class="language-json">{
  &quot;chunk&quot;: [
    {
      &quot;content&quot;: {
        &quot;m.relates_to&quot;: {
          &quot;event_id&quot;: &quot;$asfDuShaf7Gafaw&quot;,
          &quot;rel_type&quot;: &quot;org.example.my_relation&quot;
        }
      },
      &quot;event_id&quot;: &quot;$143273582443PhrSn:example.org&quot;,
      &quot;origin_server_ts&quot;: 1432735824653,
      &quot;room_id&quot;: &quot;!636q39766251:matrix.org&quot;,
      &quot;sender&quot;: &quot;@example:example.org&quot;,
      &quot;type&quot;: &quot;m.room.message&quot;,
      &quot;unsigned&quot;: {
        &quot;age&quot;: 1234
      }
    }
  ],
  &quot;next_batch&quot;: &quot;page2_token&quot;,
  &quot;prev_batch&quot;: &quot;page1_token&quot;
}
</code></pre>
<h2 id="8">8 æˆ¿é–“</h2>
<h3 id="81">8.1 é¡å‹</h3>
<p>ï¼ˆå¯é¸ï¼‰æˆ¿é–“å¯ä»¥å…·æœ‰è¡¨ç¤ºå…¶é æœŸåŠŸèƒ½çš„é¡å‹ã€‚ä¸€å€‹æˆ¿é–“ æ²’æœ‰é¡å‹ä¸¦ä¸ä¸€å®šæ„å‘³è‘—å®ƒå…·æœ‰ç‰¹å®šçš„é è¨­å‡½æ•¸, å„˜ç®¡é€šå¸¸é€™äº›æˆ¿é–“å°‡ç”¨æ–¼å°è©±ç›®çš„ã€‚</p>
<p>ç•¶å®¢æˆ¶å¯èƒ½éœ€è¦å€åˆ† å…©å€‹ä¸åŒçš„æˆ¿é–“,ä¾‹å¦‚å°è©±ä¿æŒå’Œæ•¸æ“šä¿æŒã€‚å¦‚æœæˆ¿é–“ æœ‰ä¸€å€‹é¡å‹,å®ƒåœ¨ m.room.create äº‹ä»¶çš„éµä¸­æŒ‡å®šã€‚è¦æŒ‡å®šæˆ¿é–“çš„é¡å‹,è«‹å°‡å…¶ä½œç‚º on çš„ä¸€éƒ¨åˆ†æä¾› å‰µå»ºæª”æ¡ˆå®¤è«‹æ±‚ã€‚typecreation_content</p>
<p>åœ¨æ­¤è¦ç¯„ä¸­,æŒ‡å®šäº†ä»¥ä¸‹æˆ¿å‹:</p>
<ul>
<li>m.space</li>
</ul>
<p>é€šéä½¿ç”¨å‘½åç©ºé–“æ¨™è­˜ç¢¼,å…è¨±æœªæŒ‡å®šçš„æˆ¿é–“é¡å‹ã€‚</p>
<h3 id="82">8.2 å‰µé€ </h3>
<p>ç•¶æˆ¿é–“ å·²å‰µå»º,ç”¨ä½œæ­¤èŠå¤©å®¤çš„äº‹ä»¶åœ–çš„æ ¹ã€‚é€™ äº‹ä»¶é‚„æœ‰ä¸€å€‹é‡‘é‘°,å…¶ä¸­åŒ…å«èŠå¤©å®¤çš„ä½¿ç”¨è€… ID é€ ç‰©ä¸»ã€‚å®ƒé‚„å°‡ç”Ÿæˆå…¶ä»–å¹¾å€‹äº‹ä»¶ä»¥ç®¡ç† æ­¤æˆ¿é–“çš„è¨±å¯æ¬Šã€‚é€™åŒ…æ‹¬:m.room.createcreator</p>
<ul>
<li>m.room.power_levels:è¨­ç½®ä½¿ç”¨è€…çš„åŠŸç‡ç´šåˆ¥å’Œæ‰€éœ€åŠŸç‡ æˆ¿é–“å…§å„ç¨®æ“ä½œçš„ç´šåˆ¥,ä¾‹å¦‚ç™¼é€äº‹ä»¶ã€‚</li>
<li>m.room.join_rules:æˆ¿é–“æ˜¯å¦"åƒ…é™é‚€è«‹"ã€‚</li>
</ul>
<p>æœ‰é—œé€™äº›æ´»å‹•çš„æ›´å¤šè³‡è¨Š,è«‹åƒé–±æœƒè­°å®¤æ´»å‹•ã€‚è‡ª å‰µå»ºæˆ¿é–“æ™‚,å®¢æˆ¶ç«¯å¿…é ˆä½¿ç”¨ä»¥ä¸‹ APIã€‚</p>
<h4 id="post-_matrixclientv3createroom">POST /_matrix/client/v3/createRoom</h4>
<p>å‰µå»ºå…·æœ‰å„ç¨®é…ç½®é¸é …çš„æ–°æˆ¿é–“ã€‚</p>
<p>ä¼ºæœå™¨å¿…é ˆåœ¨å‰µå»ºæ™‚æ‡‰ç”¨æ­£å¸¸ç‹€æ…‹è§£æè¦å‰‡ æ–°æˆ¿é–“,åŒ…æ‹¬æª¢æŸ¥æ¯å€‹äº‹ä»¶çš„åŠŸç‡ç´šåˆ¥ã€‚å®ƒå¿…é ˆ ä¾ä»¥ä¸‹é †åºæ‡‰ç”¨è«‹æ±‚éš±å«çš„äº‹ä»¶:</p>
<ol>
<li>
<p>äº‹ä»¶æœ¬èº«ã€‚å¿…é ˆæ˜¯ æˆ¿é–“ã€‚m.room.create</p>
</li>
<li>
<p>å»ºç«‹è€…åŠ å…¥èŠå¤©å®¤çš„äº‹ä»¶ã€‚é€™æ˜¯ éœ€è¦,ä»¥ä¾¿å¯ä»¥ç™¼é€å…¶é¤˜äº‹ä»¶ã€‚m.room.member</p>
</li>
<li>
<p>é»˜èªäº‹ä»¶,ç‚ºæˆ¿é–“å»ºç«‹è€…æä¾› ï¼ˆè€Œä¸æ˜¯å…¶ä»–æˆå“¡ï¼‰ç™¼é€ç‹€æ…‹äº‹ä»¶çš„è¨±å¯æ¬Šã€‚é‡å¯« æŒ‰åƒæ•¸ã€‚m.room.power_levelspower_level_content_override</p>
</li>
<li>
<p>å¦‚æœçµ¦å®š,å‰‡ç‚ºäº‹ä»¶ã€‚m.room.canonical_aliasroom_alias_name</p>
</li>
<li>
<p>ç”±è¨­ç½®çš„äº‹ä»¶ã€‚ç›®å‰,é€™äº›æ˜¯ , å’Œç‹€æ…‹äº‹ä»¶ã€‚presetm.room.join_rulesm.room.history_visibilitym.room.guest_access</p>
</li>
<li>
<p>ä¸­åˆ—å‡ºçš„äº‹ä»¶,æŒ‰å…¶é †åºæ’åˆ— ä¸Šå¸‚ã€‚initial_state</p>
</li>
<li>
<p>å’Œ ï¼ˆ å’Œç‹€æ…‹äº‹ä»¶ï¼‰æ‰€éš±å«çš„äº‹ä»¶ã€‚nametopicm.room.namem.room.topic</p>
</li>
<li>
<p>é‚€è«‹å’Œ ï¼ˆ with and ï¼‰ æ‰€éš±å«çš„äº‹ä»¶ã€‚inviteinvite_3pidm.room.membermembership: invitem.room.third_party_invite</p>
</li>
</ol>
<p>ä¼ºæœå™¨å°‡åœ¨æˆ¿é–“å…§å‰µå»ºä¸€å€‹äº‹ä»¶,å…¶ä¸­åŒ…å« è«‹æ±‚ä½¿ç”¨è€…ä½œç‚ºå»ºç«‹è€…,ä»¥åŠä¸­æä¾›çš„å…¶ä»–å¯†é‘°ã€‚m.room.createcreation_content</p>
<p>è«‹æ±‚æ­£æ–‡ç¤ºä¾‹</p>
<pre><code class="language-json">{
  &quot;creation_content&quot;: {
    &quot;m.federate&quot;: false
  },
  &quot;name&quot;: &quot;The Grand Duke Pub&quot;,
  &quot;preset&quot;: &quot;public_chat&quot;,
  &quot;room_alias_name&quot;: &quot;thepub&quot;,
  &quot;topic&quot;: &quot;All about happy hour&quot;
}
</code></pre>
<p>200 å›æ‡‰</p>
<pre><code class="language-json">{
  &quot;room_id&quot;: &quot;!sefiuhWgwghwWgh:example.com&quot;
}
</code></pre>
<p>8.3 æˆ¿é–“åˆ¥å
ä¼ºæœå™¨å¯ä»¥è¨—ç®¡å…·æœ‰äººé¡å‹å¥½åç¨±çš„æˆ¿é–“çš„åˆ¥åã€‚åˆ¥å æ¡å–å½¢å¼.#friendlyname:server.name</p>
<p>ç”±æ–¼æˆ¿é–“åˆ¥åçš„ç¯„åœé™å®šç‚ºç‰¹å®šçš„ä¸»ä¼ºæœå™¨åŠŸèƒ½è®Šæ•¸åç¨±,å› æ­¤å®ƒæ˜¯ ä¸»ä¼ºæœå™¨å¯èƒ½æœƒæ‹’çµ•åœ¨ ä¸Šç¶­è­·åˆ¥åçš„å˜—è©¦ å…¶ä»–åŠŸèƒ½è®Šæ•¸åç¨±ã€‚æ­¤è¦ç¯„ä¸æä¾› ä¸»ä¼ºæœå™¨,ç”¨æ–¼å‘å…¶ä»–ä¼ºæœå™¨ç™¼é€æ›´æ–°è«‹æ±‚ã€‚ç„¶è€Œ ä¸»ä¼ºæœå™¨å¿…é ˆè™•ç†è§£æå…¶ä»–åˆ¥åçš„è«‹æ±‚
ä¼ºæœå™¨;å¦‚æœ‰å¿…è¦,ä»–å€‘æ‡‰ä½¿ç”¨è¯åˆèº«ä»½é©—è­‰ API åŸ·è¡Œæ­¤æ“ä½œã€‚GET</p>
<p>ä½†æ˜¯,æª”å®¤ä¸æœƒå„²å­˜æª”å®¤ä¸­å­˜åœ¨çš„æ‰€æœ‰åˆ¥åçš„æ¸…å–® å…·æœ‰ç›¸é—œè¨±å¯æ¬Šçš„èŠå¤©å®¤æˆå“¡å¯ä»¥ç™¼ä½ˆé¦–é¸ é€šéç‹€æ…‹äº‹ä»¶çš„åˆ¥åã€‚ä¸­çš„åˆ¥å ç‹€æ…‹äº‹ä»¶æ‡‰æŒ‡å‘åœ¨å…¶ä¸­ç™¼ä½ˆå®ƒå€‘çš„æˆ¿é–“ID, ä½†æ˜¯,éš¨è‘—æ™‚é–“çš„æ¨ç§»,æˆ¿é–“åˆ¥åå¯èƒ½æœƒæ¼‚ç§»åˆ°å…¶ä»–æˆ¿é–“ IDã€‚
ç”¨æˆ¶ç«¯ä¸æ‡‰å°‡åˆ¥åè¦–ç‚ºæº–ç¢ºã€‚ä»–å€‘æ‡‰è©²è¢«æª¢æŸ¥ åœ¨ä½¿ç”¨å®ƒå€‘æˆ–èˆ‡å…¶ä»–ç”¨æˆ¶å…±ç”¨ä¹‹å‰ã€‚å¦‚æœæˆ¿é–“çœ‹èµ·ä¾† å…·æœ‰çš„æˆ¿é–“åˆ¥å,é€™æ‡‰è©²è¢«æª¢æŸ¥åˆ° ç¢ºä¿æˆ¿é–“çš„IDèˆ‡å¾ è«‹æ±‚ã€‚m.room.canonical_alias#alias:
example.comroom_id</p>
<h4 id="get-_matrixclientv3directoryroomroomalias">GET /_matrix/client/v3/directory/room/{roomAlias}</h4>
<p>è«‹æ±‚ä¼ºæœå™¨å°‡æœƒè­°å®¤åˆ¥åè§£æç‚ºæœƒè­°å®¤IDã€‚</p>
<p>ä¼ºæœå™¨å°‡ä½¿ç”¨è¯åˆ API è§£æåˆ¥å,å¦‚æœ åˆ¥åçš„åŸŸéƒ¨åˆ†èˆ‡ä¼ºæœå™¨è‡ªå·±çš„ä¸å°æ‡‰ åŸŸã€‚</p>
<p>200 å›æ‡‰</p>
<pre><code class="language-json">{
  &quot;room_id&quot;: &quot;!abnjk1jdasj98:capuchins.com&quot;,
  &quot;servers&quot;: [
    &quot;capuchins.com&quot;,
    &quot;matrix.org&quot;,
    &quot;another.com&quot;
  ]
}
</code></pre>
<h4 id="put-_matrixclientv3directoryroomroomalias">PUT /_matrix/client/v3/directory/room/{roomAlias}</h4>
<p>è«‹æ±‚æ­£æ–‡ç¤ºä¾‹</p>
<pre><code class="language-json">{
  &quot;room_id&quot;: &quot;!abnjk1jdasj98:capuchins.com&quot;
}
</code></pre>
<p>200 å›æ‡‰</p>
<pre><code class="language-json">{}
</code></pre>
<h4 id="delete-_matrixclientv3directoryroomroomalias">DELETE /_matrix/client/v3/directory/room/{roomAlias}</h4>
<p>åˆªé™¤æˆ¿é–“åˆ¥ååˆ°æˆ¿é–“IDçš„æ˜ å°„ã€‚</p>
<p>ä¼ºæœå™¨å¯ä»¥é¸æ“‡åœ¨æ­¤è™•å¯¦æ–½é¡å¤–çš„è¨ªå•æ§åˆ¶æª¢æŸ¥,ä¾‹å¦‚ èŠå¤©å®¤åˆ¥ååªèƒ½ç”±å…¶å»ºç«‹è€…æˆ–ä¼ºæœå™¨ç®¡ç†å“¡åˆªé™¤ã€‚</p>
<p>æ³¨æ„:ä¼ºæœå™¨å¯ä»¥é¸æ“‡åœ¨åˆªé™¤åˆ¥åæ™‚æ›´æ–°èŠå¤©å®¤ä¸­çš„ç‹€æ…‹äº‹ä»¶ã€‚é¸æ“‡æ›´æ–° å»ºè­°ä½¿ç”¨è¦ç¯„åˆ¥åäº‹ä»¶,é™¤äº†å…¶å…¶ä»–ç›¸é—œè¨±å¯æ¬Šå¤– æª¢æŸ¥,åˆªé™¤åˆ¥åä¸¦è¿”å›æˆåŠŸå›æ‡‰,å³ä½¿ç”¨æˆ¶æ²’æœ‰
æœ‰æ¬Šæ›´æ–°äº‹ä»¶ã€‚alt_aliasesm.room.canonical_aliasm.room.canonical_alias</p>
<p>200 å›æ‡‰</p>
<pre><code class="language-json">{}
</code></pre>
<h4 id="get-_matrixclientv3roomsroomidaliases">GET /_matrix/client/v3/rooms/{roomId}/aliases</h4>
<p>ç²å–ç”±æœ¬åœ°ä¼ºæœå™¨ç¶­è­·çš„åˆ¥åæ¸…å–® çµ¦äº†ç©ºé–“ã€‚</p>
<p>æ­¤çµ‚çµé»å¯ç”±æœƒè­°å®¤ï¼ˆå¤–éƒ¨ï¼‰ä¸­çš„ç”¨æˆ¶èª¿ç”¨ ä½¿ç”¨è€…æœƒæ”¶åˆ°éŒ¯èª¤å›æ‡‰ï¼‰ã€‚å¦‚æœæˆ¿é–“æ˜ å°„åˆ° ,å‰‡ä»»æ„ ç”¨æˆ¶å¯ä»¥èª¿ç”¨æ­¤çµ‚çµé»ã€‚M_FORBIDDENm.room.history_visibilityworld_readable</p>
<p>ä¼ºæœå™¨å¯ä»¥é¸æ“‡åœ¨æ­¤è™•å¯¦æ–½é¡å¤–çš„è¨ªå•æ§åˆ¶æª¢æŸ¥, ä¾‹å¦‚,å…è¨±ä¼ºæœå™¨ç®¡ç†å“¡æŸ¥çœ‹åˆ¥å,è€Œä¸ç®¡ æœƒå“¡ã€‚</p>
<p>æ³¨æ„:å»ºè­°ç”¨æˆ¶ç«¯ä¸è¦çªå‡ºé¡¯ç¤ºæ­¤åˆ¥åæ¸…å–® å› ç‚ºå®ƒå€‘ä¸æ˜¯ç­–åŠƒçš„,ä¸åƒç‹€æ…‹äº‹ä»¶ä¸­åˆ—å‡ºçš„é‚£äº›ã€‚m.room.canonical_alias</p>
<p>200 å›æ‡‰</p>
<pre><code class="language-json">{
  &quot;aliases&quot;: [
    &quot;#somewhere:example.com&quot;,
    &quot;#another:example.com&quot;,
    &quot;#hat_trick:example.com&quot;
  ]
}
</code></pre>
<h3 id="84">8.4 è¨±å¯æ¬Š</h3>
<p>æˆ¿é–“çš„è¨±å¯æ¬Šæ˜¯é€šéåŠŸç‡ç´šåˆ¥çš„æ¦‚å¿µå®Œæˆçš„ - å¾…è¾¦äº‹é … ç”¨æˆ¶åœ¨æˆ¿é–“å…§çš„ä»»ä½•æ“ä½œéƒ½å¿…é ˆå…·æœ‰åˆé©çš„åŠŸç‡ç´šåˆ¥ã€‚æ¬ŠåŠ› é—œå¡ä½œç‚ºç‹€æ…‹äº‹ä»¶å­˜å„²åœ¨çµ¦å®šæˆ¿é–“ä¸­ã€‚åŠŸç‡æ°´æº– æ“ä½œæ‰€éœ€çš„å’Œä½¿ç”¨è€…çš„åŠŸç‡ç´šåˆ¥åœ¨ ä¸­å®šç¾©,å…¶ä¸­é è¨­ä½¿ç”¨è€…å’Œç‰¹å®šä½¿ç”¨è€…çš„åŠŸç‡
å¯ä»¥è¨­ç½®ç´šåˆ¥ã€‚é»˜èªæƒ…æ³ä¸‹,æ‰€æœ‰ä½¿ç”¨è€…çš„åŠŸç‡ç´šåˆ¥ç‚º 0,å…¶ä»– æ¯”é›»æºç´šåˆ¥é è¨­ç‚º 100 çš„èŠå¤©å®¤å»ºç«‹è€…ã€‚ç”¨æˆ¶å¯ä»¥æˆäºˆ å…¶ä»–ä½¿ç”¨è€…å°‡åŠŸç‡ç´šåˆ¥æé«˜åˆ°è‡ªå·±çš„åŠŸç‡ç´šåˆ¥ã€‚ç‚º ä¾‹å¦‚,åŠŸç‡ç´šåˆ¥ç‚º50çš„ä½¿ç”¨è€… A å¯ä»¥æé«˜åŠŸç‡ç´šåˆ¥ ä½¿ç”¨è€… B çš„æœ€é«˜ç­‰ç´šç‚º
50ã€‚è·Ÿè¹¤ä½¿ç”¨è€…çš„åŠŸç‡æ°´æº– æ¯å€‹æˆ¿é–“,å³ä½¿ä½¿ç”¨è€…ä¸åœ¨æˆ¿é–“ä¸­ã€‚åŒ…å«çš„é‡‘é‘° åœ¨ç¢ºå®šæŸäº›æ‰€éœ€çš„æ°´æº–
è¸¢,ç¦æ­¢å’Œç™¼é€åœ‹å®¶äº‹ä»¶ç­‰æ“ä½œã€‚æœ‰é—œè©³ç´°è³‡è¨Š,è«‹åƒé–±m.room.power_levelsã€‚m.room.power_levelsm.room.power_levels</p>
<p>ç”¨æˆ¶ç«¯å¯èƒ½å¸Œæœ›ç‚ºç‰¹å®šåŠŸç‡ç´šåˆ¥åˆ†é…åç¨±ã€‚ä¸€å»ºè­° æ˜ å°„å¦‚ä¸‹:- 0 ä½¿ç”¨è€… - 50 ç‰ˆä¸» - 100 ç®¡ç†å“¡</p>
<h3 id="85">8.5 æª”å®¤æˆå“¡è³‡æ ¼</h3>
<p>ä½¿ç”¨è€…éœ€è¦æ˜¯èŠå¤©å®¤çš„æˆå“¡æ‰èƒ½ç™¼é€å’Œæ¥æ”¶äº‹ä»¶ åœ¨é‚£å€‹æˆ¿é–“é‡Œã€‚ä½¿ç”¨è€…å¯èƒ½è™•æ–¼å¤šç¨®ç‹€æ…‹,åœ¨ èˆ‡æˆ¿é–“çš„é—œä¿‚:</p>
<ul>
<li>ä¸ç›¸é—œï¼ˆä½¿ç”¨è€…ç„¡æ³•åœ¨èŠå¤©å®¤ä¸­å‚³é€æˆ–æ¥æ”¶äº‹ä»¶ï¼‰</li>
<li>æ•²é–€ï¼ˆä½¿ç”¨è€…å·²è«‹æ±‚åƒèˆ‡æˆ¿é–“,ä½† å°šä¸è¢«å…è¨± ï¼‰</li>
<li>å·²é‚€è«‹ï¼ˆä½¿ç”¨è€…å·²è¢«é‚€è«‹åƒèˆ‡èŠå¤©å®¤,ä½† å°šæœªåƒèˆ‡ï¼‰</li>
<li>å·²åŠ å…¥ï¼ˆä½¿ç”¨è€…å¯ä»¥åœ¨èŠå¤©å®¤ä¸­å‚³é€èˆ‡æ¥æ”¶äº‹ä»¶ï¼‰</li>
<li>ç¦æ­¢ï¼ˆä¸å…è¨±ä½¿ç”¨è€…åŠ å…¥èŠå¤©å®¤ï¼‰</li>
</ul>
<p>æœ‰ä¸€äº›å€¼å¾—æ³¨æ„çš„ä¾‹å¤–æƒ…æ³å…è¨±æœªåŠ å…¥çš„æˆå“¡ åœ¨èŠå¤©å®¤ä¸­å‚³é€äº‹ä»¶çš„æˆ¿é–“:</p>
<ul>
<li>
<p>å¸Œæœ›æ‹’çµ•é‚€è«‹çš„ä½¿ç”¨è€…å°‡ä½¿ç”¨ ç™¼é€å¸¶æœ‰çš„äº‹ä»¶ã€‚ä»–å€‘ä¸€å®šæ˜¯å…ˆè¢«é‚€è«‹çš„ã€‚m.room.membercontent.membershipleave</p>
</li>
<li>
<p>å¦‚æœæˆ¿é–“å…è¨±,ç”¨æˆ¶å¯ä»¥ç™¼é€å¸¶æœ‰ of çš„äº‹ä»¶ä¾†æ•²æˆ¿é–“ã€‚é€™æ˜¯ä½¿ç”¨è€…ç™¼å‡ºçš„é‚€è«‹è«‹æ±‚ã€‚m.room.membercontent.membershipknock</p>
</li>
<li>
<p>è¦æ”¶å›ä¹‹å‰çš„æ•²é–€è²,ç”¨æˆ¶å°‡ç™¼é€é¡ä¼¼æ–¼ æ‹’çµ•é‚€è«‹ã€‚leave</p>
</li>
</ul>
<p>æœ‰äº›èŠå¤©å®¤è¦æ±‚ä½¿ç”¨è€…åœ¨åŠ å…¥ä¹‹å‰å…ˆå—é‚€åŠ å…¥; å…¶ä»–äººå…è¨±ä»»ä½•äººåŠ å…¥ã€‚çµ¦å®šçš„èŠå¤©å®¤æ˜¯å¦ç‚º"åƒ…é™å—é‚€è€…" æˆ¿é–“ç”±æˆ¿é–“é…ç½®éµç¢ºå®šã€‚å®ƒå¯ä»¥ å…·æœ‰ä»¥ä¸‹å€¼ä¹‹ä¸€:m.room.join_rules</p>
<p>publicé€™å€‹æˆ¿é–“å¯ä¾›ä»»ä½•äººå…è²»åŠ å…¥,ç„¡éœ€é‚€è«‹ã€‚</p>
<p>inviteåªæœ‰åœ¨æ‚¨è¢«é‚€è«‹çš„æƒ…æ³ä¸‹æ‰èƒ½åŠ å…¥æ­¤æˆ¿é–“ã€‚</p>
<p>knockæ­¤æˆ¿é–“åªæœ‰åœ¨æ‚¨è¢«é‚€è«‹çš„æƒ…æ³ä¸‹æ‰èƒ½åŠ å…¥,ä¸¦å…è¨±ä»»ä½•äºº è«‹æ±‚é‚€è«‹åŠ å…¥æœƒè­°å®¤ã€‚è«‹æ³¨æ„,æ­¤è¯æ¥è¦å‰‡åƒ…å¯ç”¨ åœ¨æ”¯æ´æ•²é–€çš„æˆ¿é–“ç‰ˆæœ¬ä¸­ã€‚</p>
<p>[v1.2 ä¸­æ–°å¢]</p>
<p>restrictedå¦‚æœæ‚¨è¢«é‚€è«‹æˆ–æ‚¨æ˜¯å¦ä¸€å€‹æˆ¿é–“çš„æˆå“¡,å‰‡å¯ä»¥åŠ å…¥æ­¤æˆ¿é–“ åŠ å…¥è¦å‰‡ä¸­åˆ—å‡ºçš„æˆ¿é–“ã€‚å¦‚æœä¼ºæœå™¨ç„¡æ³•é©—è­‰ä»»ä½•æˆå“¡èº«ä»½ åˆ—å‡ºçš„æˆ¿é–“,é‚£éº¼æ‚¨åªèƒ½é€šéé‚€è«‹åŠ å…¥ã€‚è«‹æ³¨æ„,æ­¤è¦å‰‡ åªæ‡‰åœ¨æ”¯æ´å®ƒçš„æˆ¿é–“ç‰ˆæœ¬ä¸­å·¥ä½œã€‚</p>
<p>[v1.3 ä¸­æ–°å¢]</p>
<p>knock_restrictedé€™å€‹æˆ¿é–“å¯ä»¥åƒä»¥å‰ä¸€æ¨£é€£æ¥ã€‚å¦‚æœä½  ä½¿ç”¨æ•²é–€èˆ‡æˆ¿é–“äº¤äº’,è¦å‰‡ç”Ÿæ•ˆ,è€Œ å˜—è©¦åœ¨æ²’æœ‰é‚€è«‹çš„æƒ…æ³ä¸‹åŠ å…¥èŠå¤©å®¤å°‡æ‡‰ç”¨åŠ å…¥è¦å‰‡ã€‚
è«‹æ³¨æ„,æ­¤è¦å‰‡åƒ…é©ç”¨æ–¼æ”¯æ´å®ƒçš„æˆ¿é–“ç‰ˆæœ¬ã€‚restrictedknockknockrestricted</p>
<p>æˆå“¡è³‡æ ¼å…è¨±çš„ç‹€æ…‹è½‰æ›ç‚º:
<a href="/img/membership.png"><img alt="membership.png" src="/img/membership.png" title="membership.png" /></a></p>
<h4 id="get-_matrixclientv3joined_rooms">GET /_matrix/client/v3/joined_rooms</h4>
<p>æ­¤ API å‚³å›ä½¿ç”¨è€…ç›®å‰èŠå¤©å®¤çš„æ¸…å–®ã€‚</p>
<pre><code class="language-json">{
  &quot;joined_rooms&quot;: [
    &quot;!foo:example.com&quot;
  ]
}
</code></pre>
<h4 id="851">8.5.1 é€£æ¥æˆ¿é–“</h4>
<h5 id="post-_matrixclientv3roomsroomidinvite">POST /_matrix/client/v3/rooms/{roomId}/invite</h5>
<p>è«‹æ³¨æ„,æ­¤ API æœ‰å…©ç¨®å½¢å¼,åˆ†åˆ¥è¨˜éŒ„ã€‚ æ­¤ç‰ˆæœ¬çš„ API è¦æ±‚é‚€è«‹è€…çŸ¥é“çŸ©é™£ è¢«é‚€è«‹è€…çš„æ¨™è­˜ç¢¼ã€‚å¦ä¸€å€‹è¨˜éŒ„åœ¨ç¬¬ä¸‰æ–¹é‚€è«‹éƒ¨åˆ†ä¸­ã€‚</p>
<p>æ­¤ API é‚€è«‹ç”¨æˆ¶åƒèˆ‡ç‰¹å®šèŠå¤©å®¤ã€‚ åœ¨ä»–å€‘å¯¦éš›åŠ å…¥ æˆ¿é–“ã€‚</p>
<p>åªæœ‰ç•¶å‰ä½æ–¼ç‰¹å®šèŠå¤©å®¤ä¸­çš„ä½¿ç”¨è€…æ‰èƒ½é‚€è«‹å…¶ä»–ä½¿ç”¨è€… åŠ å…¥é‚£å€‹æˆ¿é–“ã€‚</p>
<p>å¦‚æœä½¿ç”¨è€…è¢«é‚€è«‹åˆ°èŠå¤©å®¤,ä¸»ä¼ºæœå™¨æœƒå°‡äº‹ä»¶è¿½åŠ åˆ°èŠå¤©å®¤ã€‚m.room.member</p>
<p>è«‹æ±‚æ­£æ–‡ç¤ºä¾‹</p>
<pre><code class="language-json">{
  &quot;reason&quot;: &quot;Welcome to the team!&quot;,
  &quot;user_id&quot;: &quot;@cheeky_monkey:matrix.org&quot;
}
</code></pre>
<p>200 å›æ‡‰</p>
<pre><code>{}
</code></pre>
<h5 id="post-_matrixclientv3joinroomidoralias">POST /_matrix/client/v3/join/{roomIdOrAlias}</h5>
<p>è«‹æ³¨æ„,æ­¤ API æ¡ç”¨æˆ¿é–“ ID æˆ–åˆ¥å,é€™èˆ‡ ./rooms/{roomId}/join</p>
<p>æ­¤ API å•Ÿå‹•åƒèˆ‡ç‰¹å®šèŠå¤©å®¤çš„ä½¿ç”¨è€…ï¼ˆå¦‚æœè©²ä½¿ç”¨è€…ï¼‰ è¢«å…è¨±åƒåŠ è©²æˆ¿é–“ã€‚åœ¨æ­¤èª¿ç”¨ä¹‹å¾Œ,ç”¨æˆ¶ç«¯æ˜¯ å…è¨±æŸ¥çœ‹æˆ¿é–“ä¸­çš„æ‰€æœ‰ç•¶å‰ç‹€æ…‹äº‹ä»¶,ä»¥åŠæ‰€æœ‰å¾ŒçºŒäº‹ä»¶ èˆ‡èŠå¤©å®¤é—œè¯çš„äº‹ä»¶,ç›´åˆ°ä½¿ç”¨è€…é›¢é–‹èŠå¤©å®¤ã€‚</p>
<p>ä½¿ç”¨è€…åŠ å…¥æª”å®¤å,è©²èŠå¤©å®¤å°‡ä½œç‚ºæ¢ç›®é¡¯ç¤ºåœ¨ /initialSync å’Œ /sync API çš„å›æ‡‰ã€‚</p>
<p>è«‹æ±‚æ­£æ–‡ç¤ºä¾‹</p>
<pre><code>{
  &quot;reason&quot;: &quot;Looking for support&quot;,
  &quot;third_party_signed&quot;: {
    &quot;mxid&quot;: &quot;@bob:example.org&quot;,
    &quot;sender&quot;: &quot;@alice:example.org&quot;,
    &quot;signatures&quot;: {
      &quot;example.org&quot;: {
        &quot;ed25519:0&quot;: &quot;some9signature&quot;
      }
    },
    &quot;token&quot;: &quot;random8nonce&quot;
  }
}
</code></pre>
<p>200 å›æ‡‰</p>
<pre><code class="language-json">{
  &quot;room_id&quot;: &quot;!d41d8cd:matrix.org&quot;
}
</code></pre>
<h5 id="post-_matrixclientv3roomsroomidjoin">POST /_matrix/client/v3/rooms/{roomId}/join</h5>
<p>è«‹æ³¨æ„,æ­¤ API éœ€è¦æœƒè­°å®¤ ID,è€Œä¸æ˜¯åˆ¥åã€‚ å¦‚æœæ‚¨æœ‰æª”å®¤åˆ¥å,å‰‡å­˜åœ¨ã€‚/join/{roomIdOrAlias}</p>
<p>æ­¤ API å•Ÿå‹•åƒèˆ‡ç‰¹å®šèŠå¤©å®¤çš„ä½¿ç”¨è€…ï¼ˆå¦‚æœè©²ä½¿ç”¨è€…ï¼‰ è¢«å…è¨±åƒåŠ è©²æˆ¿é–“ã€‚åœ¨æ­¤èª¿ç”¨ä¹‹å¾Œ,ç”¨æˆ¶ç«¯æ˜¯ å…è¨±æŸ¥çœ‹æˆ¿é–“ä¸­çš„æ‰€æœ‰ç•¶å‰ç‹€æ…‹äº‹ä»¶,ä»¥åŠæ‰€æœ‰å¾ŒçºŒäº‹ä»¶ èˆ‡èŠå¤©å®¤é—œè¯çš„äº‹ä»¶,ç›´åˆ°ä½¿ç”¨è€…é›¢é–‹èŠå¤©å®¤ã€‚</p>
<p>ä½¿ç”¨è€…åŠ å…¥æª”å®¤å,è©²èŠå¤©å®¤å°‡ä½œç‚ºæ¢ç›®é¡¯ç¤ºåœ¨ /initialSync å’Œ /sync API çš„å›æ‡‰ã€‚</p>
<p>è«‹æ±‚æ­£æ–‡ç¤ºä¾‹</p>
<pre><code class="language-json">{
  &quot;reason&quot;: &quot;Looking for support&quot;,
  &quot;third_party_signed&quot;: {
    &quot;mxid&quot;: &quot;@bob:example.org&quot;,
    &quot;sender&quot;: &quot;@alice:example.org&quot;,
    &quot;signatures&quot;: {
      &quot;example.org&quot;: {
        &quot;ed25519:0&quot;: &quot;some9signature&quot;
      }
    },
    &quot;token&quot;: &quot;random8nonce&quot;
  }
}
</code></pre>
<p>200 å›æ‡‰</p>
<pre><code class="language-json">{
  &quot;room_id&quot;: &quot;!d41d8cd:matrix.org&quot;
}
</code></pre>
<h4 id="852">8.5.2 é›¢é–‹æˆ¿é–“</h4>
<p>ç”¨æˆ¶å¯ä»¥é›¢é–‹èŠå¤©å®¤ä»¥åœæ­¢æ¥æ”¶è©²èŠå¤©å®¤çš„äº‹ä»¶ã€‚ä¸€å€‹ä½¿ç”¨è€… å¿…é ˆåœ¨ä»–å€‘è¢«é‚€è«‹æˆ–åŠ å…¥æˆ¿é–“ä¹‹å‰ æœ‰è³‡æ ¼é›¢é–‹æˆ¿é–“ã€‚é›¢é–‹ä½¿ç”¨è€…æ‰€åœ¨çš„æˆ¿é–“ é‚€è«‹æ‹’çµ•é‚€è«‹,ä¸¦ä¸”å¯ä»¥æ”¶å›æ•²é–€è²ã€‚ç”¨æˆ¶é›¢é–‹å ä¸€å€‹æˆ¿é–“,å®ƒå°‡ä¸å†å‡ºç¾åœ¨å° /sync API çš„å›æ‡‰ä¸­,é™¤éå®ƒæ˜¯
é€šéå…·æœ‰æ¬„ä½é›†çš„éæ¿¾å™¨é¡¯å¼è«‹æ±‚ è‡ªã€‚include_leavetrue</p>
<p>ç„¡è«–ä»–å€‘æ˜¯å¦çœŸçš„åŠ å…¥äº†æˆ¿é–“,å¦‚æœæˆ¿é–“æ˜¯ä¸€å€‹ "åƒ…é™é‚€è«‹"èŠå¤©å®¤ ä½¿ç”¨è€…éœ€è¦é‡æ–°é‚€è«‹æ‰èƒ½ é‡æ–°åŠ å…¥æˆ¿é–“ã€‚</p>
<p>ä½¿ç”¨è€…é‚„å¯ä»¥å¿˜è¨˜ä»–å€‘é›¢é–‹çš„æˆ¿é–“ã€‚å®¢æˆ¿æœ‰ è¢«éºå¿˜æ°¸é ä¸æœƒå‡ºç¾å° /sync API çš„å›æ‡‰, ç›´åˆ°ä½¿ç”¨è€…é‡æ–°åŠ å…¥,é‡æ–°é‚€è«‹æˆ–æ•²é–€ã€‚</p>
<p>ä½¿ç”¨è€…å¯èƒ½å¸Œæœ›å¼·åˆ¶å…¶ä»–ä½¿ç”¨è€…é›¢é–‹æˆ¿é–“ã€‚é€™æ˜¯å¯ä»¥åšåˆ°çš„ é€šé'è¸¢'å…¶ä»–ä½¿ç”¨è€…ã€‚ç‚ºæ­¤,åŸ·è¡Œè¸¢çƒçš„ç”¨æˆ¶å¿…é ˆ å…·æœ‰æ‰€éœ€çš„åŠŸç‡æ°´æº–ã€‚ä¸€æ—¦ä½¿ç”¨è€…è¢«è¸¢å‡º,å‰‡ è¡Œç‚ºèˆ‡è‡ªé¡˜é›¢é–‹æ˜¯ä¸€æ¨£çš„ã€‚åœ¨ ç‰¹åˆ¥æ˜¯,å¦‚æœæˆ¿é–“ä¸æ˜¯,ç”¨æˆ¶å¯ä»¥è‡ªç”±é‡æ–°åŠ å…¥ "åƒ…é™é‚€è«‹"ã€‚</p>
<h5 id="post-_matrixclientv3roomsroomidforget">POST /_matrix/client/v3/rooms/{roomId}/forget</h5>
<p>æ­¤ API é˜»æ­¢ä½¿ç”¨è€…è¨˜ä½ç‰¹å®šæˆ¿é–“ã€‚</p>
<p>ä¸€èˆ¬ä¾†èªª,æ­·å²æ˜¯é§­å®¢å¸åœ‹çš„ä¸€ç­‰å…¬æ°‘ã€‚åœ¨æ­¤ API ä¹‹å¾Œ è¢«èª¿ç”¨,ä½†æ˜¯,ä½¿ç”¨è€…å°‡ç„¡æ³•å†æª¢ç´¢æ­·å²è¨˜éŒ„ å°æ–¼é€™å€‹æˆ¿é–“ã€‚å¦‚æœä¸»ä¼ºæœå™¨ä¸Šçš„æ‰€æœ‰ç”¨æˆ¶éƒ½å¿˜è¨˜äº†ä¸€å€‹æˆ¿é–“,å‰‡è©²æˆ¿é–“æ˜¯ ç¬¦åˆå¾è©²ä¸»ä¼ºæœå™¨åˆªé™¤çš„æ¢ä»¶ã€‚</p>
<p>å¦‚æœä½¿ç”¨è€…ç•¶å‰å·²åŠ å…¥èŠå¤©å®¤,å‰‡ä»–å€‘å¿…é ˆé›¢é–‹èŠå¤©å®¤ åœ¨èª¿ç”¨æ­¤ API ä¹‹å‰ã€‚</p>
<p>200 å›æ‡‰</p>
<pre><code class="language-json">{}
</code></pre>
<h5 id="post-_matrixclientv3roomsroomidleave">POST /_matrix/client/v3/rooms/{roomId}/leave</h5>
<p>æ­¤ API é˜»æ­¢ç”¨æˆ¶åƒèˆ‡ç‰¹å®šèŠå¤©å®¤ã€‚</p>
<p>å¦‚æœç”¨æˆ¶å·²ç¶“åœ¨æˆ¿é–“ä¸­,ä»–å€‘å°‡ç„¡æ³•å†çœ‹åˆ° æˆ¿é–“é‡Œæœ‰æ–°äº‹ä»¶ã€‚å¦‚æœèŠå¤©å®¤éœ€è¦é‚€è«‹æ‰èƒ½åŠ å…¥,å‰‡ éœ€è¦é‡æ–°é‚€è«‹æ‰èƒ½é‡æ–°åŠ å…¥ã€‚</p>
<p>å¦‚æœä½¿ç”¨è€…è¢«é‚€è«‹åŠ å…¥èŠå¤©å®¤,ä½†å°šæœªåŠ å…¥,å‰‡æ­¤å‘¼å« ç”¨æ–¼æ‹’çµ•é‚€è«‹ã€‚</p>
<p>ä½¿ç”¨è€…ä»è¢«å…è¨±å¾æˆ¿é–“ä¸­æª¢ç´¢æ­·å²è¨˜éŒ„ ä»–å€‘ä»¥å‰è¢«å…è¨±çœ‹åˆ°ã€‚</p>
<p>è«‹æ±‚æ­£æ–‡ç¤ºä¾‹</p>
<pre><code class="language-json">{
  &quot;reason&quot;: &quot;Saying farewell - thanks for the support!&quot;
}
</code></pre>
<p>200 å›æ‡‰</p>
<pre><code class="language-json">{}
</code></pre>
<h5 id="post-_matrixclientv3roomsroomidkick">POST /_matrix/client/v3/rooms/{roomId}/kick</h5>
<p>å°‡ä½¿ç”¨è€…è¸¢å‡ºæˆ¿é–“ã€‚</p>
<p>èª¿ç”¨æ–¹å¿…é ˆå…·æœ‰æ‰€éœ€çš„åŠŸç‡ç´šåˆ¥æ‰èƒ½åŸ·è¡Œæ­¤æ“ä½œã€‚</p>
<p>è¸¢å‡ºä½¿ç”¨è€…æœƒå°‡ç›®æ¨™æˆå“¡çš„æˆå“¡è³‡æ ¼ç‹€æ…‹èª¿æ•´ç‚º è‡ªé¸ã€‚èˆ‡å…¶ä»–æˆå“¡è³‡æ ¼æ›´æ”¹ä¸€æ¨£,ç”¨æˆ¶å¯ä»¥ç›´æ¥èª¿æ•´ é€šéå‘ç™¼å‡ºè«‹æ±‚ä¾†é¡¯ç¤ºç›®æ¨™æˆå“¡çš„ç‹€æ…‹ã€‚leavereason/rooms/<room id>
/state/m.room.member/<user id></p>
<p>è«‹æ±‚æ­£æ–‡ç¤ºä¾‹</p>
<pre><code class="language-json">{
  &quot;reason&quot;: &quot;Telling unfunny jokes&quot;,
  &quot;user_id&quot;: &quot;@cheeky_monkey:matrix.org&quot;
}
</code></pre>
<p>200 å›æ‡‰</p>
<pre><code class="language-json">{}
</code></pre>
<h3 id="86">8.6 åˆ—å‡ºæˆ¿é–“</h3>
<h4 id="get-_matrixclientv3directorylistroomroomid">GET /_matrix/client/v3/directory/list/room/{roomId}</h4>
<p>ç²å–çµ¦å®šæª”å®¤åœ¨ä¼ºæœå™¨çš„å…¬å…±æœƒè­°å®¤ç›®éŒ„ä¸­çš„å¯è¦‹æ€§ã€‚</p>
<p>200 å›æ‡‰</p>
<pre><code class="language-json">{
  &quot;visibility&quot;: &quot;public&quot;
}
</code></pre>
<h4 id="put-_matrixclientv3directorylistroomroomid">PUT /_matrix/client/v3/directory/list/room/{roomId}</h4>
<p>è¨­ç½®çµ¦å®šèŠå¤©å®¤åœ¨ä¼ºæœå™¨å…¬å…±èŠå¤©å®¤ä¸­çš„å¯è¦‹æ€§ ç›®éŒ„ã€‚</p>
<p>ä¼ºæœå™¨å¯ä»¥é¸æ“‡å¯¦æ–½é¡å¤–çš„è¨ªå•æ§åˆ¶æª¢æŸ¥ ä¾‹å¦‚,åœ¨é€™è£¡,æˆ¿é–“çš„å¯è¦‹æ€§åªèƒ½é€šéä»¥ä¸‹æ–¹å¼æ›´æ”¹ èŠå¤©å®¤å»ºç«‹è€…æˆ–ä¼ºæœå™¨ç®¡ç†å“¡ã€‚</p>
<p>è«‹æ±‚æ­£æ–‡ç¤ºä¾‹</p>
<pre><code class="language-json">{
  &quot;visibility&quot;: &quot;public&quot;
}
</code></pre>
<p>200 å›æ‡‰</p>
<pre><code class="language-json">{}
</code></pre>
<h4 id="get-_matrixclientv3publicrooms">GET /_matrix/client/v3/publicRooms</h4>
<p>åˆ—å‡ºä¼ºæœå™¨ä¸Šçš„å…¬å…±æœƒè­°å®¤ã€‚</p>
<p>æ­¤ API è¿”å›åˆ†é å›æ‡‰ã€‚æˆ¿é–“æŒ‰ç·¨è™Ÿæ’åº åŠ å…¥çš„æˆå“¡,æœ€å¤§çš„æˆ¿é–“æ’åœ¨ç¬¬ä¸€ä½ã€‚</p>
<p>200 å›æ‡‰</p>
<pre><code class="language-json">{
  &quot;chunk&quot;: [
    {
      &quot;avatar_url&quot;: &quot;mxc://bleecker.street/CHEDDARandBRIE&quot;,
      &quot;guest_can_join&quot;: false,
      &quot;join_rule&quot;: &quot;public&quot;,
      &quot;name&quot;: &quot;CHEESE&quot;,
      &quot;num_joined_members&quot;: 37,
      &quot;room_id&quot;: &quot;!ol19s:bleecker.street&quot;,
      &quot;room_type&quot;: &quot;m.space&quot;,
      &quot;topic&quot;: &quot;Tasty tasty cheese&quot;,
      &quot;world_readable&quot;: true
    }
  ],
  &quot;next_batch&quot;: &quot;p190q&quot;,
  &quot;prev_batch&quot;: &quot;p1902&quot;,
  &quot;total_room_count_estimate&quot;: 115
}
</code></pre>
<h2 id="9">9 ç”¨æˆ¶æ•¸æ“š</h2>
<h3 id="91">9.1 ç”¨æˆ¶ç›®éŒ„</h3>
<h4 id="post-_matrixclientv3user_directorysearch">POST /_matrix/client/v3/user_directory/search</h4>
<p>å°ä½¿ç”¨è€…åŸ·è¡Œæœç´¢ã€‚ä¸»ä¼ºæœå™¨å¯èƒ½ ç¢ºå®šæœç´¢å“ªäº›ç”¨æˆ¶å­é›†,ä½†ä¸»ä¼ºæœå™¨ å¿…é ˆè‡³å°‘è€ƒæ…®è«‹æ±‚ä½¿ç”¨è€…å…±äº«çš„ä½¿ç”¨è€… èˆ‡å±…ä½åœ¨å…¬å…±æˆ¿é–“ï¼ˆå®¶åº­ä¼ºæœå™¨å·²çŸ¥ï¼‰çš„äººçš„æˆ¿é–“ã€‚ æœç´¢å¿…é ˆè€ƒæ…®æœ¬åœ°ä½¿ç”¨è€…åˆ°ä¸»ä¼ºæœå™¨,ä¸¦ä¸”æ‡‰è©² åœ¨æœç´¢éç¨‹ä¸­æŸ¥è©¢é ç«¯ä½¿ç”¨è€…ã€‚</p>
<p>æœç´¢å°ä½¿ç”¨è€… ID å’Œé¡¯ç¤ºä¸å€åˆ†å¤§å°å¯« åç¨±æœ€å¥½ä½¿ç”¨åŸºæ–¼è«‹æ±‚ä¸­æä¾›çš„æ¨™é ­ï¼ˆå¦‚æœå­˜åœ¨ï¼‰ç¢ºå®šçš„æ’åºè¦å‰‡ã€‚Accept-Language</p>
<p>è«‹æ±‚æ­£æ–‡ç¤ºä¾‹</p>
<pre><code class="language-json">{
  &quot;limit&quot;: 10,
  &quot;search_term&quot;: &quot;foo&quot;
}
</code></pre>
<p>200 å›æ‡‰</p>
<pre><code class="language-json">{
  &quot;limited&quot;: false,
  &quot;results&quot;: [
    {
      &quot;avatar_url&quot;: &quot;mxc://bar.com/foo&quot;,
      &quot;display_name&quot;: &quot;Foo&quot;,
      &quot;user_id&quot;: &quot;@foo:bar.com&quot;
    }
  ]
}
</code></pre>
<h3 id="92">9.2 é…ç½® æª”</h3>
<h4 id="get-_matrixclientv3profileuserid">GET /_matrix/client/v3/profile/{userId}</h4>
<p>ç²å–æ­¤ä½¿ç”¨è€…çš„çµ„åˆé…ç½®æª”è³‡è¨Šã€‚å¯ä»¥ä½¿ç”¨æ­¤ä»‹é¢ ç²å–ä½¿ç”¨è€…è‡ªå·±çš„å€‹äººè³‡æ–™è³‡è¨Šæˆ–å…¶ä»–ä½¿ç”¨è€…;ä¹Ÿ æœ¬åœ°æˆ–é ç«¯å®¶åº­ä¼ºæœå™¨ä¸Šã€‚æ­¤ API å¯èƒ½æœƒè¿”å›ä¸æ˜¯ åªé™æ–¼æˆ– ã€‚displaynameavatar_url</p>
<p>200 å›æ‡‰</p>
<pre><code class="language-json">{
  &quot;avatar_url&quot;: &quot;mxc://matrix.org/SDGdghriugerRg&quot;,
  &quot;displayname&quot;: &quot;Alice Margatroid&quot;
}
</code></pre>
<h4 id="get-_matrixclientv3profileuseridavatar_url">GET /_matrix/client/v3/profile/{userId}/avatar_url</h4>
<p>ç²å–ç”¨æˆ¶çš„é ­åƒç¶²å€ã€‚æ­¤ API å¯ç”¨æ–¼ç²å–ä½¿ç”¨è€…çš„ æ“æœ‰é ­åƒç¶²å€æˆ–æŸ¥è©¢å…¶ä»–ä½¿ç”¨è€…çš„ç¶²å€;æœ¬åœ°æˆ– åœ¨é ç«¯å®¶åº­ä¼ºæœå™¨ä¸Šã€‚</p>
<p>200 å›æ‡‰</p>
<pre><code class="language-json">{
  &quot;avatar_url&quot;: &quot;mxc://matrix.org/SDGdghriugerRg&quot;
}
</code></pre>
<h4 id="put-_matrixclientv3profileuseridavatar_url">PUT /_matrix/client/v3/profile/{userId}/avatar_url</h4>
<p>æ­¤ API è¨­å®šçµ¦å®šä½¿ç”¨è€…çš„é ­åƒ URLã€‚æ‚¨å¿…é ˆå…·æœ‰ä»¥ä¸‹æ¬Šé™:è¨­å®šæ­¤ä½¿ç”¨è€…çš„é ­åƒ URL,ä¾‹å¦‚,æ‚¨éœ€è¦æ“æœ‰ä»–å€‘çš„ .access_token</p>
<p>è«‹æ±‚æ­£æ–‡ç¤ºä¾‹</p>
<pre><code class="language-json">{
  &quot;avatar_url&quot;: &quot;mxc://matrix.org/wefh34uihSDRGhw34&quot;
}
</code></pre>
<p>200 å›æ‡‰</p>
<pre><code class="language-json">{}
</code></pre>
<h4 id="get-_matrixclientv3profileuseriddisplayname">GET /_matrix/client/v3/profile/{userId}/displayname</h4>
<p>ç²å–ä½¿ç”¨è€…çš„é¡¯ç¤ºåç¨±ã€‚æ­¤ API å¯ç”¨æ–¼ç²å–ä½¿ç”¨è€…çš„ è‡ªå·±çš„é¡¯ç¤ºåç¨±æˆ–æŸ¥è©¢å…¶ä»–ç”¨æˆ¶çš„åç¨±;æœ¬åœ°æˆ– åœ¨é ç«¯å®¶åº­ä¼ºæœå™¨ä¸Šã€‚</p>
<pre><code class="language-json">{
  &quot;displayname&quot;: &quot;Alice Margatroid&quot;
}
</code></pre>
<h4 id="put-_matrixclientv3profileuseriddisplayname">PUT /_matrix/client/v3/profile/{userId}/displayname</h4>
<p>æ­¤ API è¨­å®šçµ¦å®šä½¿ç”¨è€…çš„é¡¯ç¤ºåç¨±ã€‚æ‚¨å¿…é ˆå…·æœ‰ä»¥ä¸‹æ¬Šé™:è¨­å®šæ­¤ä½¿ç”¨è€…çš„é¡¯ç¤ºåç¨±,ä¾‹å¦‚,æ‚¨éœ€è¦å…·æœ‰ä»–å€‘çš„ .access_token</p>
<p>è«‹æ±‚æ­£æ–‡ç¤ºä¾‹</p>
<pre><code class="language-json">{
  &quot;displayname&quot;: &quot;Alice Margatroid&quot;
}
</code></pre>
<p>200 å›æ‡‰</p>
<pre><code class="language-json">{}
</code></pre>
<h4 id="921">9.2.1 å€‹äººè³‡æ–™è³‡è¨Šè®Šæ›´äº‹ä»¶</h4>
<p>å› ç‚ºé…ç½®æ–‡ä»¶é¡¯ç¤ºåç¨±å’Œé ­åƒè³‡è¨Šå¾ˆå¯èƒ½æ˜¯ åœ¨å®¢æˆ¶ç«¯é¡¯ç¤ºçš„è¨±å¤šä½ç½®ä½¿ç”¨,å°é€™äº›æ¬„ä½çš„æ›´æ”¹æœƒå°è‡´ ç™¼ç”Ÿè‡ªå‹•å‚³æ’­äº‹ä»¶,é€šçŸ¥å¯èƒ½æ„Ÿèˆˆè¶£çš„äºº æ–°åƒ¹å€¼è§€çš„å„æ–¹ã€‚æ­¤æ›´æ”¹ä½¿ç”¨å…©å€‹å–®ç¨çš„ æ©Ÿåˆ¶:</p>
<ul>
<li>ä¸€å€‹äº‹ä»¶ï¼ˆå…·æœ‰æˆå“¡è³‡æ ¼ï¼‰è¢«ç™¼é€åˆ°æ¯å€‹ ä½¿ç”¨è€…æ‰€å±¬çš„èŠå¤©å®¤,ä»¥æ›´æ–° å’Œ ã€‚m.room.memberjoindisplaynameavatar_url</li>
<li>ç™¼é€ç‹€æ…‹æ›´æ–°,å†æ¬¡åŒ…å« å’Œéµçš„æ–°å€¼,æ­¤å¤– åˆ°åŒ…å«ç•¶å‰ç‹€æ…‹çš„å¿…éœ€éµ çš„ä½¿ç”¨è€…ã€‚m.presencedisplaynameavatar_urlpresence
  ç•¶ä½¿ç”¨è€…ä½¿ç”¨æ™‚,é€™å…©è€…éƒ½æ‡‰ç”±ä¸»ä¼ºæœå™¨è‡ªå‹•å®Œæˆ æˆåŠŸæ›´æ”¹å…¶é¡¯ç¤ºåç¨±æˆ–é ­åƒ URL æ¬„ä½ã€‚</li>
</ul>
<p>æ­¤å¤–,ç•¶ä¸»ä¼ºæœå™¨ç‚ºè‡ªå·±ç™¼å‡ºæˆ¿é–“æˆå“¡èº«ä»½äº‹ä»¶æ™‚ ç”¨æˆ¶,ä»–å€‘æ‡‰è©²åœ¨ é€™äº›äº‹ä»¶ä½¿å®¢æˆ¶å·²ç¶“æŒæ¡äº†é€™äº›è©³ç´°è³‡è¨Š,ä¸¦ä¸” ä¸å¿…åŸ·è¡Œé¡å¤–çš„å¾€è¿”ä¾†æŸ¥è©¢å®ƒã€‚</p>
<h2 id="10">10 å®‰å…¨</h2>
<h3 id="101">10.1 é€Ÿç‡é™åˆ¶</h3>
<p>å®¶åº­ä¼ºæœå™¨æ‡‰å¯¦æ–½é€Ÿç‡é™åˆ¶ä»¥é™ä½é¢¨éšª é‡è¼‰ã€‚å¦‚æœè«‹æ±‚å› é€Ÿç‡é™åˆ¶è€Œè¢«æ‹’çµ•,å‰‡æ‡‰ å‚³å›ä»¥ä¸‹å½¢å¼çš„æ¨™æº–éŒ¯èª¤å›æ‡‰:</p>
<pre><code>{
  &quot;errcode&quot;: &quot;M_LIMIT_EXCEEDED&quot;,
  &quot;error&quot;: &quot;string&quot;,
  &quot;retry_after_ms&quot;: integer (optional)
}
</code></pre>
<p>æ‡‰åŒ…å«é‡‘é‘°ä»¥å‘Šè¨´å®¢æˆ¶ç«¯å¤šé•·æ™‚é–“ ä»–å€‘å¿…é ˆåœ¨å¹¾æ¯«ç§’å…§ç­‰å¾…,ç„¶å¾Œæ‰èƒ½é‡è©¦ã€‚retry_after_ms</p>
<h2 id="11_1">11 æ¨¡çµ„</h2>
<p>æ¨¡çµ„æ˜¯ç”¨æˆ¶ç«¯-ä¼ºæœå™¨ API çš„ä¸€éƒ¨åˆ†,ä¸¦éé€šç”¨ æ‰€æœ‰çµ‚çµé»ã€‚æ¨¡çµ„åœ¨æ­¤è¦ç¯„ä¸­åš´æ ¼å®šç¾© ä¸¦ä¸”ä¸æ‡‰è¢«èª¤èªç‚ºæ˜¯å¯¦é©—æ€§æ“´å±•æˆ–å¯é¸æ“´å±• ç‰¹å¾µã€‚ç›¸å®¹çš„ä¼ºæœå™¨å¯¦ç¾å¿…é ˆæ”¯æ´æ‰€æœ‰æ¨¡çµ„å’Œ æ”¯æ´è¦ç¯„ï¼ˆé™¤éå¯¦ç¾åƒ…é‡å°ç”¨æˆ¶ç«¯
æŸäº›é…ç½®æª”,åœ¨é€™ç¨®æƒ…æ³ä¸‹,åªæœ‰é‚£äº›é…ç½®æª”æ‰€éœ€çš„æ¨¡çµ„ å¿…é ˆå¯¦ç¾åŠŸèƒ½é…ç½®æª”ï¼‰ã€‚åˆè¦çš„å®¢æˆ¶ç«¯å¯¦ç¾ å¿…é ˆæ”¯æ´æ‰€æœ‰å¿…éœ€çš„æ¨¡çµ„å’Œæ”¯æŒè¦ç¯„ å®ƒæ‰€é‡å°çš„åŠŸèƒ½é…ç½®æª”ã€‚</p>
<h3 id="111_1">11.1 åŠŸèƒ½é…ç½®æª”</h3>
<p>çŸ©é™£æ”¯æ´è¨±å¤šä¸åŒé¡å‹çš„ç”¨æˆ¶ç«¯:ä¾†è‡ªåµŒå…¥å¼ç‰©è¯ç¶² è¨­å‚™åˆ°æ¡Œé¢ç”¨æˆ¶ç«¯ã€‚ä¸¦éæ‰€æœ‰ç”¨æˆ¶ç«¯éƒ½å¯ä»¥æä¾›ç›¸åŒçš„åŠŸèƒ½ è¨­ç½®ç‚ºå…¶ä»–ç”¨æˆ¶ç«¯,ä¾‹å¦‚ç”±æ–¼ç¼ºå°‘ç‰©ç†ç¡¬é«”,ä¾‹å¦‚ æœ‰ä¸€å€‹è¢å¹•ã€‚ç”¨æˆ¶ç«¯å¯ä»¥å±¬æ–¼å¤šå€‹é…ç½®æª”ä¹‹ä¸€,æ¯å€‹é…ç½®æª” é…ç½®æª”åŒ…å«å®¢æˆ¶ç«¯å¿…é ˆæ”¯æ´çš„ä¸€çµ„åŠŸèƒ½ã€‚é€™
éƒ¨åˆ†è©³ç´°ä»‹ç´¹äº†ä¸€çµ„'åŠŸèƒ½é…ç½®æª”'ã€‚å®¢æˆ¶æ‡‰ å®Œæ•´åœ°å¯¦ç¾é…ç½®æª”,ä»¥ä¾¿å°‡å…¶åˆ†é¡ç‚º è©²é…ç½®æª”ã€‚</p>
<h3 id="112_1">11.2 å³æ™‚é€šè¨Š</h3>
<p>æ­¤æ¨¡çµ„å¢åŠ äº†å°å‘æˆ¿é–“ç™¼é€äººé¡å¯è®€æ¶ˆæ¯çš„æ”¯æ´ã€‚ å®ƒé‚„å¢åŠ äº†å°å°‡äººé¡å¯è®€è³‡è¨Šèˆ‡ æˆ¿é–“æœ¬èº«,ä¾‹å¦‚æˆ¿é–“åç¨±å’Œä¸»é¡Œã€‚</p>
<h4 id="1121">11.2.1 äº‹ä»¶</h4>
<h5 id="mroommessage">m.room.message</h5>
<p>åœ¨èŠå¤©å®¤ä¸­ç™¼é€æ¶ˆæ¯æ™‚ä½¿ç”¨æ­¤äº‹ä»¶ã€‚æ¶ˆæ¯ä¸é™æ–¼æ–‡æœ¬ã€‚éµæ¦‚è¿°äº†æ¶ˆæ¯çš„é¡å‹,ä¾‹å¦‚æ–‡æœ¬,éŸ³è¨Š,åœ–åƒ,è¦–é »ç­‰ã€‚å¯†é‘°æ˜¯æ–‡æœ¬,å¿…é ˆèˆ‡å„ç¨®ä¸€èµ·ä½¿ç”¨,ä½œç‚ºå®¢æˆ¶ç«¯ç„¡æ³•å‘ˆç¾æ¶ˆæ¯æ™‚çš„å›é€€æ©Ÿåˆ¶ã€‚é€™å…è¨±å®¢æˆ¶ç«¯é¡¯ç¤ºæŸäº›å…§å®¹,å³ä½¿å®ƒåªæ˜¯ç´”æ–‡å­—ã€‚msgtypebodymsgtype</p>
<pre><code class="language-json">{
  &quot;content&quot;: {
    &quot;body&quot;: &quot;This is an example text message&quot;,
    &quot;format&quot;: &quot;org.matrix.custom.html&quot;,
    &quot;formatted_body&quot;: &quot;&lt;b&gt;This is an example text message&lt;/b&gt;&quot;,
    &quot;msgtype&quot;: &quot;m.text&quot;
  },
  &quot;event_id&quot;: &quot;$143273582443PhrSn:example.org&quot;,
  &quot;origin_server_ts&quot;: 1432735824653,
  &quot;room_id&quot;: &quot;!jEsUZKDJdhlrceRyVU:example.org&quot;,
  &quot;sender&quot;: &quot;@example:example.org&quot;,
  &quot;type&quot;: &quot;m.room.message&quot;,
  &quot;unsigned&quot;: {
    &quot;age&quot;: 1234
  }
}
</code></pre>
<h4 id="1122">11.2.2 å®¢æˆ¶ç«¯è¡Œç‚º</h4>
<p>ç”¨æˆ¶ç«¯æ‡‰é©—è­‰å‚³å…¥äº‹ä»¶çš„çµæ§‹,ä»¥ç¢ºä¿
é æœŸçš„éµå­˜åœ¨,ä¸¦ä¸”å®ƒå€‘å±¬æ–¼æ­£ç¢ºçš„é¡å‹ã€‚å®¢æˆ¶å¯ä»¥
æ”¾æ£„æ ¼å¼éŒ¯èª¤çš„äº‹ä»¶æˆ–å‘ç”¨æˆ¶é¡¯ç¤ºä½”ä½å…ƒæ¶ˆæ¯ã€‚
å¿…é ˆå¾ç”¨æˆ¶ç«¯ä¸­åˆªé™¤å·²ç·¨è¼¯çš„'m.room.message'äº‹ä»¶ã€‚é€™
å¯ä»¥ç”¨ä½”ä½å…ƒæ–‡æœ¬æ›¿æ›ï¼ˆä¾‹å¦‚"[å·²ç·¨è¼¯]"ï¼‰æˆ–
å¯ä»¥å¾éƒµä»¶æª¢è¦–ä¸­å®Œå…¨åˆªé™¤å·²ç·¨è¼¯çš„éƒµä»¶ã€‚</p>
<p>åŒ…å«é™„ä»¶çš„äº‹ä»¶ï¼ˆä¾‹å¦‚"m.image","m.file"ï¼‰æ‡‰è©²æ˜¯
ä½¿ç”¨ [å…§å®¹å­˜å„²åº«æ¨¡çµ„]ï¼ˆ#contentå­˜å‚¨åº“ï¼‰ä¸Šå‚³
å¦‚æœå¯ç”¨ã€‚ç„¶å¾Œ,å¯ä»¥åœ¨"url"ä¸­ä½¿ç”¨ç”Ÿæˆçš„"mxc://"URI
ã€‚.keyã€‚</p>
<p>ç”¨æˆ¶ç«¯å¯ä»¥åŒ…å«ç”¨æˆ¶ç«¯ç”Ÿæˆçš„é™„ä»¶ç¸®åœ–
åœ¨"info.thumbnail_url"éµä¸‹ã€‚ç¸®åœ–ä¹Ÿæ‡‰è©²æ˜¯
"mxc://"çƒé‡Œã€‚é¡¯ç¤ºå¸¶æœ‰é™„ä»¶çš„äº‹ä»¶çš„ç”¨æˆ¶ç«¯å¯ä»¥ä½¿ç”¨
ç”¨æˆ¶ç«¯ç”Ÿæˆçš„ç¸®åœ–æˆ–è¦æ±‚å…¶ä¸»ä¼ºæœå™¨ç”Ÿæˆ
åŸå§‹é™„ä»¶ä¸­çš„ç¸®åœ–,ä½¿ç”¨ [å…§å®¹å­˜å„²åº«
æ¨¡çµ„]ï¼ˆ#contentå­˜å‚¨åº“ï¼‰ã€‚</p>
<h5 id="_1">ç™¼é€æ¶ˆæ¯æ™‚çš„å»ºè­°</h5>
<p>å¦‚æœç™¼é€å¤±æ•—,ç”¨æˆ¶ç«¯æ‡‰ä½¿ç”¨
ä¸€å®šæ™‚é–“ T çš„æŒ‡æ•¸é€€é¿æ¼”ç®—æ³•ã€‚æ˜¯çš„
å»ºè­° T ä¸è¶…é 5 åˆ†é˜ã€‚åœ¨æ­¤ä¹‹å¾Œ,
ç”¨æˆ¶ç«¯æ‡‰åœæ­¢é‡è©¦ä¸¦å°‡æ¶ˆæ¯æ¨™è¨˜ç‚º'æœªç™¼é€'ã€‚ä½¿ç”¨è€…
æ‡‰è©²èƒ½å¤ æ‰‹å‹•é‡æ–°ç™¼é€æœªç™¼é€çš„æ¶ˆæ¯ã€‚</p>
<p>ç”¨æˆ¶å¯ä»¥ä¸€æ¬¡éµå…¥å¤šæ¢æ¶ˆæ¯ä¸¦å¿«é€Ÿç™¼é€æ‰€æœ‰æ¶ˆæ¯
ç¹¼æ‰¿ã€‚ç”¨æˆ¶ç«¯æ‡‰ä¿ç•™ç™¼é€å®ƒå€‘çš„é †åº
ä½¿ç”¨è€…ã€‚é€™æ„å‘³è‘—å®¢æˆ¶ç«¯æ‡‰ç­‰å¾…å°
ç™¼é€ä¸‹ä¸€å€‹è«‹æ±‚ä¹‹å‰çš„ä¸Šä¸€å€‹è«‹æ±‚ã€‚é€™å¯èƒ½å°è‡´
ç·šé ­é˜»å¡ã€‚ç‚ºäº†æ¸›å°‘ç·šé ­çš„å½±éŸ¿
é˜»å¡,ç”¨æˆ¶ç«¯æ‡‰ä½¿ç”¨æ¯å€‹æˆ¿é–“çš„ä½‡åˆ—,è€Œä¸æ˜¯å…¨åŸŸä½‡åˆ—
ä½‡åˆ—,å› ç‚ºè¨‚è³¼åƒ…åœ¨å–®å€‹æˆ¿é–“å…§ç›¸é—œ,è€Œä¸æ˜¯
æˆ¿é–“ä¹‹é–“ã€‚</p>
<h5 id="_2">æœ¬åœ°å›è²</h5>
<p>ç•¶ä½¿ç”¨è€…ä½¿ç”¨æ™‚,æ¶ˆæ¯æ‡‰ç«‹å³é¡¯ç¤ºåœ¨æ¶ˆæ¯æª¢è¦–ä¸­
æŒ‰ä¸‹'ç™¼é€'æŒ‰éˆ•ã€‚å³ä½¿æ¶ˆæ¯æ˜¯
ä»åœ¨ç™¼é€ã€‚é€™ç¨±ç‚º'æœ¬åœ°å›è²'ã€‚å®¢æˆ¶æ‡‰è©²
å¯¦ç¾æ¶ˆæ¯çš„'æœ¬åœ°å›é¡¯'ã€‚ç”¨æˆ¶ç«¯å¯ä»¥åœ¨
ä¸åŒçš„æ ¼å¼,ä»¥æŒ‡ç¤ºä¼ºæœå™¨å°šæœªè™•ç†
æ¶ˆæ¯ã€‚ä¼ºæœå™¨å›æ‡‰æ™‚æ‡‰åˆªé™¤æ­¤æ ¼å¼ã€‚</p>
<p>ç”¨æˆ¶ç«¯éœ€è¦èƒ½å¤ å°‡ä»–å€‘ç™¼é€çš„æ¶ˆæ¯èˆ‡
ä»–å€‘å¾äº‹ä»¶æµæ”¶åˆ°çš„æ¶ˆæ¯ç›¸åŒã€‚å›è²
ä¾†è‡ªäº‹ä»¶æµçš„åŒä¸€æ¶ˆæ¯ç¨±ç‚º'é ç«¯å›è²'ã€‚ã€‚é›™
å›è²éœ€è¦æ¨™è­˜ç‚ºåŒä¸€æ¶ˆæ¯,ä»¥é˜²æ­¢
é¡¯ç¤ºé‡è¤‡æ¶ˆæ¯ã€‚ç†æƒ³æƒ…æ³ä¸‹,é€™ç¨®é…å°æœƒç™¼ç”Ÿ
å°ä½¿ç”¨è€…é€æ˜:UI åœ¨è½‰æ›æ™‚ä¸æœƒé–ƒçˆ
å¾æœ¬åœ°åˆ°é ç«¯ã€‚å¯ä»¥é€šéç”¨æˆ¶ç«¯ä½¿é–ƒçˆæ¸›å°‘
ä½¿ç”¨ä»–å€‘ç”¨æ–¼ç™¼é€ç‰¹å®šäº‹ä»¶çš„äº‹å‹™IDã€‚é€™
ä½¿ç”¨çš„äº¤æ˜“ ID å°‡åŒ…å«åœ¨äº‹ä»¶çš„'æœªç°½å'æ•¸æ“šä¸­,ä½œç‚º
ç•¶å®ƒé€šéäº‹ä»¶æµåˆ°é”æ™‚transaction_idã€‚</p>
<p>ç„¡æ³•ä½¿ç”¨äº¤æ˜“ ID çš„ç”¨æˆ¶ç«¯å¯èƒ½æœƒ
ç•¶é ç«¯å›è²åˆ°é”äº‹ä»¶æµæ™‚é«”é©—é–ƒçˆ
<em>åœ¨</em>ç™¼é€æ¶ˆæ¯çš„è«‹æ±‚å®Œæˆä¹‹å‰ã€‚åœ¨é€™ç¨®æƒ…æ³ä¸‹,
äº‹ä»¶åœ¨å®¢æˆ¶ç«¯ç²å–äº‹ä»¶ ID ä¹‹å‰åˆ°é”,ä½¿å…¶
ç„¡æ³•å°‡å…¶è­˜åˆ¥ç‚ºé ç«¯å›è²ã€‚é€™æœƒå°è‡´ç”¨æˆ¶ç«¯
åœ¨ä¸€æ®µæ™‚é–“å…§é¡¯ç¤ºå…©æ¬¡æ¶ˆæ¯ï¼ˆå–æ±ºæ–¼ä¼ºæœå™¨ï¼‰
å›æ‡‰èƒ½åŠ›ï¼‰åœ¨åŸå§‹è«‹æ±‚ç™¼é€æ¶ˆæ¯ä¹‹å‰
å®Œæˆã€‚å®Œæˆå¾Œ,å®¢æˆ¶ç«¯å¯ä»¥æ¡å–è£œæ•‘æªæ–½ä¾†
é€šéæŸ¥æ‰¾é‡è¤‡çš„äº‹ä»¶IDä¾†åˆªé™¤é‡è¤‡çš„äº‹ä»¶ã€‚</p>
<h5 id="_3">è¨ˆç®—ä½¿ç”¨è€…çš„é¡¯ç¤ºåç¨±</h5>
<p>ç”¨æˆ¶ç«¯å¯èƒ½å¸Œæœ›é¡¯ç¤ºæˆ¿é–“çš„äººé¡å¯è®€é¡¯ç¤ºåç¨±
æˆå“¡èº«ä»½,æˆ–ç•¶ä»–å€‘ç™¼é€æ¶ˆæ¯æ™‚ã€‚
ä½†æ˜¯,ä¸åŒçš„æˆå“¡å¯èƒ½å…·æœ‰è¡çªçš„é¡¯ç¤ºåç¨±ã€‚é¡¯ç¤º
åœ¨å‘ç”¨æˆ¶é¡¯ç¤ºåç¨±ä¹‹å‰,å¿…é ˆæ¶ˆé™¤åç¨±çš„æ­§ç¾©,ä»¥ä¾¿
é˜²æ­¢æ¬ºé¨™å…¶ä»–ä½¿ç”¨è€…ã€‚</p>
<p>ç‚ºäº†ç¢ºä¿è·¨ç”¨æˆ¶ç«¯ä¸€è‡´åœ°åŸ·è¡Œæ­¤æ“ä½œ,ç”¨æˆ¶ç«¯æ‡‰ä½¿ç”¨
ä»¥ä¸‹æ¼”ç®—æ³•ç”¨æ–¼è¨ˆç®—
çµ¦å®šä½¿ç”¨è€…:</p>
<ol>
<li>æª¢æŸ¥ç›¸é—œä½¿ç”¨è€… ID çš„"m.room.member"ç‹€æ…‹äº‹ä»¶ã€‚</li>
<li>å¦‚æœ"m.room.member"ç‹€æ…‹äº‹ä»¶æ²’æœ‰"é¡¯ç¤ºåç¨±"å­—æ®µ,æˆ–è€…å¦‚æœ
   è©²æ¬„ä½å…·æœ‰'null' å€¼,è«‹ä½¿ç”¨åŸå§‹ä½¿ç”¨è€… ID ä½œç‚ºé¡¯ç¤º
   åå­—ã€‚å¦å‰‡:</li>
<li>å¦‚æœ"m.room.member"äº‹ä»¶å…·æœ‰å”¯ä¸€çš„"é¡¯ç¤ºåç¨±"
   åœ¨å…·æœ‰'æˆå“¡è³‡æ ¼:åŠ å…¥'æˆ–
   "æˆå“¡è³‡æ ¼:é‚€è«‹",ä½¿ç”¨çµ¦å®šçš„"é¡¯ç¤ºåç¨±"ä½œç‚º
   ç”¨æˆ¶å¯è¦‹çš„é¡¯ç¤ºåç¨±ã€‚å¦å‰‡:</li>
<li>"m.room.member"äº‹ä»¶å…·æœ‰éå”¯ä¸€çš„"é¡¯ç¤ºåç¨±"ã€‚é€™
   æ‡‰ä½¿ç”¨ä½¿ç”¨è€…IDæ¶ˆé™¤æ­§ç¾©,ä¾‹å¦‚"é¡¯ç¤ºåç¨±
   (@id:homeserver.orgï¼‰"ã€‚</li>
</ol>
<p>é–‹ç™¼äººå“¡åœ¨å¯¦ç¾ä¸Šè¿°å…§å®¹æ™‚æ‡‰æ³¨æ„ä»¥ä¸‹äº‹é …
æ¼”ç®—æ³•:</p>
<ul>
<li>ä¸€å€‹æˆå“¡çš„ç”¨æˆ¶å¯è¦‹é¡¯ç¤ºåç¨±å¯èƒ½å—åˆ°ä»¥ä¸‹å› ç´ çš„å½±éŸ¿
  å¦ä¸€å€‹æˆå“¡çš„ç‹€æ…‹æ›´æ”¹ã€‚ä¾‹å¦‚,å¦‚æœ
  "@user1:matrix.org"å‡ºç¾åœ¨ä¸€å€‹æˆ¿é–“é‡Œ,å¸¶æœ‰"é¡¯ç¤ºåç¨±:æ„›éº—çµ²",
  ç„¶å¾Œç•¶"@user2:ç¤ºä¾‹.com"åŠ å…¥æˆ¿é–“æ™‚,ä¹Ÿèˆ‡
  "é¡¯ç¤ºåç¨±:æ„›éº—çµ²",<em>å…©å€‹</em>ç”¨æˆ¶å¿…é ˆæ¶ˆé™¤æ­§ç¾©
  é¡¯ç¤ºåç¨±ã€‚åŒæ¨£,ç•¶å…¶ä¸­ä¸€å€‹ä½¿ç”¨è€…éš¨å¾Œæ›´æ”¹å…¶
  é¡¯ç¤ºåç¨±,ä¸å†æœ‰è¡çª,<em>å…©å€‹</em>ç”¨æˆ¶å¯ä»¥
  çµ¦å®šä»–å€‘é¸æ“‡çš„é¡¯ç¤ºåç¨±ã€‚å®¢æˆ¶æ‡‰å°æ­¤ä¿æŒè­¦æƒ•
  å¯èƒ½æ€§ä¸¦ç¢ºä¿æ‰€æœ‰å—å½±éŸ¿çš„ä½¿ç”¨è€…éƒ½æ­£ç¢º
  é‡æ–°å‘½åã€‚</li>
<li>èŠå¤©å®¤çš„é¡¯ç¤ºåç¨±ä¹Ÿå¯èƒ½å—åˆ°
  æˆå“¡åå–®ã€‚é€™æ˜¯ç”±æ–¼æˆ¿é–“åç¨±æœ‰æ™‚æ˜¯åŸºæ–¼
  åœ¨ä½¿ç”¨è€…é¡¯ç¤ºåç¨±ä¸Šï¼ˆè«‹åƒé–± [è¨ˆç®— çš„é¡¯ç¤ºåç¨±
  æˆ¿é–“]ï¼ˆ#calculatingæˆ¿é—´çš„æ˜¾ç¤ºåç§°ï¼‰ï¼‰ã€‚</li>
<li>å¦‚æœæœç´¢æ•´å€‹æˆå“¡èº«ä»½æ¸…å–®ä»¥é¡¯ç¤ºè¡çª
  åç¨±,é€™å°è‡´ç”¨æ–¼æ§‹å»ºæ¸…å–®çš„ Oï¼ˆN^2ï¼‰ å¯¦ç¾
  çš„æˆ¿é–“æˆå“¡ã€‚å°æ–¼å¤§å‹æˆ¿é–“ä¾†èªª,é€™å°‡éå¸¸ä½æ•ˆ
  æˆå“¡äººæ•¸ã€‚å»ºè­°å®¢æˆ¶ç«¯å¯¦ç¾
  ç¶­è­·å¾'é¡¯ç¤ºåç¨±'åˆ°æˆ¿é–“æ¸…å–®çš„å“ˆå¸Œè¡¨æ˜ å°„
  ä½¿ç”¨è©²åç¨±çš„æˆå“¡ã€‚ç„¶å¾Œå¯ä»¥ä½¿ç”¨é€™æ¨£çš„è¡¨ä¾†æœ‰æ•ˆåœ°
  è¨ˆç®—æ˜¯å¦éœ€è¦æ¶ˆé™¤æ­§ç¾©ã€‚</li>
</ul>
<h5 id="_4">ä½¿ç”¨æ¶ˆæ¯é¡¯ç¤ºæˆå“¡èº«ä»½è³‡è¨Š</h5>
<p>å®¢æˆ¶å¯èƒ½å¸Œæœ›é¡¯ç¤ºæˆ¿é–“çš„é¡¯ç¤ºåç¨±å’Œé ­åƒURL
ç™¼é€æ¶ˆæ¯çš„æˆå“¡ã€‚é€™å¯ä»¥é€šéæª¢æŸ¥
è©²ä½¿ç”¨è€… ID çš„"m.room.member"ç‹€æ…‹äº‹ä»¶ï¼ˆè«‹åƒé–± [è¨ˆç®—
ç”¨æˆ¶çš„é¡¯ç¤ºåç¨±]ï¼ˆ#calculatingç”¨æˆ·çš„æ˜¾ç¤ºåç§°ï¼‰ï¼‰ã€‚</p>
<p>ç•¶ä½¿ç”¨è€…å°éƒµä»¶æ­·å²è¨˜éŒ„é€²è¡Œåˆ†é æ™‚,ç”¨æˆ¶ç«¯å¯èƒ½å¸Œæœ›é¡¯ç¤º
èŠå¤©å®¤æˆå“¡çš„é¡¯ç¤ºåç¨±å’Œé ­åƒURLã€‚é€™æ˜¯
å¯èƒ½æ˜¯å› ç‚ºè¼ƒèˆŠçš„'m.room.member'äº‹ä»¶åœ¨ä»¥ä¸‹æƒ…æ³ä¸‹è¿”å›
åˆ†é ã€‚é€™å¯ä»¥é€šéä¿ç•™å…©çµ„
æˆ¿é–“ç‹€æ…‹:èˆŠå’Œç•¶å‰ã€‚éš¨è‘—æ–°äº‹ä»¶çš„åˆ°ä¾†å’Œ/æˆ–ä½¿ç”¨è€…
æ™‚å…‰å€’æµ,é€™å…©çµ„ç‹€æ…‹å½¼æ­¤åˆ†é“æšé‘£ã€‚
æ–°äº‹ä»¶æ›´æ–°ç•¶å‰ç‹€æ…‹,åˆ†é äº‹ä»¶æ›´æ–°èˆŠç‹€æ…‹
å·ã€‚æŒ‰é †åºè™•ç†åˆ†é äº‹ä»¶æ™‚,èˆŠç‹€æ…‹
è¡¨ç¤ºç™¼é€äº‹ä»¶æ™‚èŠå¤©å®¤çš„ç‹€æ…‹*ã€‚é€™
ç„¶å¾Œå¯ç”¨æ–¼è¨­ç½®æ­·å²é¡¯ç¤ºåç¨±å’Œé ­åƒURLã€‚</p>
<h5 id="_5">è¨ˆç®—èŠå¤©å®¤çš„é¡¯ç¤ºåç¨±</h5>
<p>å®¢æˆ¶å¯èƒ½å¸Œæœ›ç‚ºæˆ¿é–“é¡¯ç¤ºäººé¡å¯è®€çš„åç¨±ã€‚æœ‰ä¸€å€‹
é¸æ“‡æœ‰ç”¨åç¨±çš„å¯èƒ½æ€§æ•¸é‡ã€‚ç¢ºä¿æˆ¿é–“
åœ¨ç”¨æˆ¶ç«¯ä¸­ä¸€è‡´å‘½å,ç”¨æˆ¶ç«¯æ‡‰ä½¿ç”¨ä»¥ä¸‹åç¨±
é¸æ“‡åç¨±çš„æ¼”æ¼”ç®—æ³•:</p>
<ol>
<li>å¦‚æœèŠå¤©å®¤å…·æœ‰éç©ºçš„ [m.room.name]ï¼ˆ#mroomnameï¼‰ ç‹€æ…‹äº‹ä»¶
   "åç¨±"æ¬„ä½,è«‹ä½¿ç”¨è©²æ¬„ä½æŒ‡å®šçš„åç¨±ã€‚</li>
<li>å¦‚æœèŠå¤©å®¤å…·æœ‰ [m.room.canonical_alias]ï¼ˆ#mroomcanonical_aliasï¼‰ ç‹€æ…‹äº‹ä»¶,ä¸¦ä¸”
   æœ‰æ•ˆçš„"åˆ¥å"æ¬„ä½,ä½¿ç”¨è©²å­—æ®µçµ¦å‡ºçš„åˆ¥åä½œç‚ºåç¨±ã€‚
   è«‹æ³¨æ„,å®¢æˆ¶ç«¯åœ¨è¨ˆç®—æ™‚æ‡‰é¿å…ä½¿ç”¨"alt_aliases"
   æˆ¿é–“åç¨±ã€‚
   3.å¦‚æœä»¥ä¸Šæ¢ä»¶éƒ½ä¸æ»¿è¶³,å‰‡æ‡‰çµ„æˆä¸€å€‹åç¨±
   åŸºæ–¼æˆ¿é–“çš„æˆå“¡ã€‚å®¢æˆ¶æ‡‰è€ƒæ…®
   [m.room.member]ï¼ˆ#mroommemberï¼‰ ç™»éŒ„ä½¿ç”¨è€…ä»¥å¤–çš„ä½¿ç”¨è€…çš„äº‹ä»¶,å¦‚
   å®šç¾©å¦‚ä¸‹ã€‚<ol>
<li>å¦‚æœæˆ¿é–“çš„'m.hero'æ•¸é‡å¤§æ–¼æˆ–ç­‰æ–¼
   "m.joined_member_count + m.invited_member_count - 1",ç„¶å¾Œä½¿ç”¨
   è‹±é›„è¨ˆç®—é¡¯ç¤ºåç¨±çš„æˆå“¡è³‡æ ¼äº‹ä»¶
   å°æ–¼ä½¿ç”¨è€…ï¼ˆ[æ¶ˆé™¤æ­§ç¾©,å¦‚æœ
   å¿…éœ€]ï¼ˆ#calculatingç”¨æˆ·çš„æ˜¾ç¤ºåç§°ï¼‰ï¼‰å’Œ
   å°‡å®ƒå€‘é€£æ¥èµ·ä¾†ã€‚ä¾‹å¦‚,å®¢æˆ¶å¯ä»¥é¸æ“‡é¡¯ç¤º
   "Alice, Bob, and Charlie ï¼ˆ@charlie:example.orgï¼‰"ä½œç‚ºæˆ¿é–“
   åå­—ã€‚ç”¨æˆ¶ç«¯å¯ä»¥é¸æ“‡é™åˆ¶å…¶ç”¨æˆ¶æ•¸
   ç”¨æ–¼ç”Ÿæˆæˆ¿é–“åç¨±ã€‚</li>
<li>å¦‚æœè‹±é›„å°‘æ–¼
   "m.joined_member_count + m.invited_member_count - 1",ä»¥åŠ
   "m.joined_member_count + m.invited_member_count"å¤§æ–¼
   1,ç”¨æˆ¶ç«¯æ‡‰ä½¿ç”¨è‹±é›„ä¾†è¨ˆç®—é¡¯ç¤ºåç¨±
   å°æ–¼ä½¿ç”¨è€…ï¼ˆ[æ¶ˆé™¤æ­§ç¾©,å¦‚æœ
   å¿…éœ€]ï¼ˆ#calculatingç”¨æˆ·çš„æ˜¾ç¤ºåç§°ï¼‰ï¼‰å’Œ
   å°‡å®ƒå€‘èˆ‡å‰©é¤˜ä½¿ç”¨è€…çš„è¨ˆæ•¸é€£æ¥èµ·ä¾†ã€‚ç‚º
   ä¾‹å¦‚,"æ„›éº—çµ²,é®‘å‹ƒå’Œå…¶ä»– 1234 äºº"ã€‚</li>
<li>å¦‚æœ"m.joined_member_count + m.invited_member_count"å°æ–¼
   æˆ–ç­‰æ–¼ 1ï¼ˆè¡¨ç¤ºæˆå“¡æ˜¯å–®ç¨çš„ï¼‰,ç”¨æˆ¶ç«¯
   æ‡‰ä½¿ç”¨ä¸Šè¿°è¦å‰‡ä¾†æŒ‡ç¤ºæˆ¿é–“æ˜¯ç©ºçš„ã€‚
   ä¾‹å¦‚,'ç©ºæˆ¿é–“ï¼ˆæ˜¯æ„›éº—çµ²ï¼‰','ç©ºæˆ¿é–“ï¼ˆæ˜¯æ„›éº—çµ²ï¼‰
   å’Œå…¶ä»– 1234 äººï¼‰",å¦‚æœæ²’æœ‰è‹±é›„,å‰‡ç‚º"ç©ºæˆ¿é–“"ã€‚</li>
</ol>
</li>
</ol>
<p>å®¢æˆ¶æ‡‰å°‡æˆ¿é–“åç¨±åœ‹éš›åŒ–ç‚ºç”¨æˆ¶çš„èªè¨€
ç•¶ä½¿ç”¨"m.heroes"è¨ˆç®—åç¨±æ™‚ã€‚ç”¨æˆ¶ç«¯æ‡‰ä½¿ç”¨
åœ¨å¯èƒ½çš„æƒ…æ³ä¸‹,è‡³å°‘ 5 å€‹è‹±é›„ä¾†è¨ˆç®—æˆ¿é–“åç¨±,ä½†å¯ä»¥ä½¿ç”¨
æˆ–å¤šæˆ–å°‘æ˜¯ç‚ºäº†æ›´å¥½åœ°é©æ‡‰ä»–å€‘çš„ç”¨æˆ¶é«”é©—ã€‚</p>
<h5 id="_6">åŠ‡é€æ¶ˆæ¯</h5>
<p>é€šéä½¿ç”¨åŠ‡é€,å¯ä»¥ç›´è§€åœ°å‘ç”¨æˆ¶éš±è—æ¶ˆæ¯çš„æŸäº›éƒ¨åˆ†ã€‚
é€™ä¸æœƒå½±éŸ¿ä¼ºæœå™¨å°äº‹ä»¶å…§å®¹çš„è¡¨ç¤º - å®ƒ
åªæ˜¯å‘ä½¿ç”¨è€…æä¾›è¦–è¦ºæç¤º,æ¶ˆæ¯å¯èƒ½æœƒæ­ç¤ºé‡è¦å…§å®¹
æœ‰é—œæŸäº‹çš„ä¿¡æ¯,ç ´å£ä»»ä½•ç›¸é—œçš„é©šå–œã€‚</p>
<p>è¦ç™¼é€åŠ‡é€,å®¢æˆ¶å¿…é ˆä½¿ç”¨"formatted_body",å› æ­¤
"org.matrix.custom.html"æ ¼å¼,å¦‚ä¸Šæ‰€è¿°ã€‚é€™ä½¿å¾—åŠ‡é€åœ¨
ä»»ä½•å¯ä»¥é©ç•¶æ”¯æ´æ­¤æ ¼å¼çš„"msgtype"ã€‚</p>
<p>åŠ‡é€æœ¬èº«åŒ…å«'span'æ¨™ç±¤,åŸå› ï¼ˆå¯é¸ï¼‰
è™•æ–¼'æ•¸æ“š-MX-åŠ‡é€'å±¬æ€§ä¸­ã€‚ç„¡æ•…åŠ‡é€å¿…é ˆè‡³å°‘
æŒ‡å®šå±¬æ€§,ä½†è©²å€¼å¯èƒ½ç‚ºç©º/æœªå®šç¾©ã€‚</p>
<p>åŠ‡é€çš„ä¸€å€‹ä¾‹å­æ˜¯:</p>
<pre><code class="language-json">{
  &quot;msgtype&quot;: &quot;m.text&quot;,
  &quot;format&quot;: &quot;org.matrix.custom.html&quot;,
  &quot;body&quot;: &quot;é›»å½±ä¸­çš„æ„›éº—çµ²[åŠ‡é€]ï¼ˆmxc://example.org/abc123ï¼‰ã€‚
  &quot;formatted_body&quot;: &quot;æ„›éº—çµ²&lt;è·¨æ•¸æ“š-mx-åŠ‡é€&gt;å¾æ­¤éä¸Šäº†å¹¸ç¦çš„ç”Ÿæ´»&lt;/è·¨åº¦&gt;åœ¨é›»å½±ä¸­ã€‚
}
</code></pre>
<p>å¦‚æœè¦æä¾›åŸå› ,å®ƒå°‡å¦‚ä¸‹æ‰€ç¤º:</p>
<pre><code class="language-json">{
  &quot;msgtype&quot;: &quot;m.text&quot;,
  &quot;format&quot;: &quot;org.matrix.custom.html&quot;,
  &quot;body&quot;: &quot;æ„›éº—çµ²[æ„›éº—çµ²çš„å¥åº·åŠ‡é€]ï¼ˆmxc://example.org/abc123ï¼‰åœ¨é›»å½±ä¸­ã€‚
  &quot;formatted_body&quot;: &quot;æ„›éº—çµ²&lt;è·¨åº¦æ•¸æ“š-mx-spoiler='æ„›éº—çµ²çš„å¥åº·'&gt;å¾æ­¤éä¸Šäº†å¹¸ç¦çš„ç”Ÿæ´»&lt;/è·¨åº¦&gt;ã€‚
}
</code></pre>
<p>ç™¼é€åŠ‡é€æ™‚,ç”¨æˆ¶ç«¯æ‡‰åœ¨"æ­£æ–‡"ä¸­æä¾›å›é€€,å¦‚ä¸Šæ‰€ç¤º
ï¼ˆåŒ…æ‹¬åŸå› ï¼‰ã€‚å›é€€ä¸æ‡‰åŒ…å«åŒ…å«åŠ‡é€çš„æ–‡æœ¬,å› ç‚º
"body"å¯èƒ½æœƒé¡¯ç¤ºåœ¨ç´”æ–‡æœ¬ç”¨æˆ¶ç«¯æˆ–é€šçŸ¥ä¸­ã€‚ç‚ºé˜²æ­¢åŠ‡é€å‡ºç¾åœ¨
åœ¨é€™ç¨®æƒ…æ³ä¸‹,å¼·çƒˆå»ºè­°å®¢æˆ¶å…ˆä¸Šå‚³åŒ…å«åŠ‡é€çš„æ–‡æœ¬
åˆ°åª’é«”å­˜å„²åº«,ç„¶å¾Œåœ¨ markdown æ¨£å¼çš„é€£çµä¸­å¼•ç”¨"mxc://"URI,å¦‚ä¸Šæ‰€ç¤ºã€‚</p>
<p>å®¢æˆ¶æ‡‰è©²é€šéæŸç¨®æŠ«éœ²ä»¥ä¸åŒçš„æ–¹å¼å‘ˆç¾åŠ‡é€ã€‚ä¾‹å¦‚,
ç”¨æˆ¶ç«¯å¯ä»¥æ¨¡ç³Šå¯¦éš›æ–‡æœ¬ä¸¦è¦æ±‚ç”¨æˆ¶æŒ‰å…©ä¸‹å®ƒä»¥é¡¯ç¤ºå®ƒã€‚</p>
<h4 id="_7">ä¼ºæœå™¨è¡Œç‚º</h4>
<p>ä¸»ä¼ºæœå™¨æ‡‰æ‹’çµ•æ²’æœ‰
"msgtype"éµ,æˆ–è€…æ²’æœ‰æ–‡æœ¬"body"éµ,å¸¶æœ‰ HTTP
ç‹€æ…‹ä»£ç¢¼ç‚º 400ã€‚</p>
<h4 id="_8">å®‰å…¨æ³¨æ„äº‹é …</h4>
<p>ä½¿ç”¨æ­¤æ¨¡çµ„ç™¼é€çš„æ¶ˆæ¯æœªåŠ å¯†,å„˜ç®¡æ˜¯ç«¯åˆ°ç«¯çš„
åŠ å¯†æ­£åœ¨é–‹ç™¼ä¸­ï¼ˆè«‹åƒé–± [E2E æ¨¡çµ„]ï¼ˆ#end ç«¯åˆ°ç«¯åŠ å¯†ï¼‰ï¼‰ã€‚</p>
<p>ç”¨æˆ¶ç«¯æ‡‰æ¸…ç†<strong>æ‰€æœ‰é¡¯ç¤ºçš„å¯†é‘°</strong>ä»¥æŸ¥æ‰¾ä¸å®‰å…¨çš„HTML
é˜²æ­¢è·¨ç¶²ç«™è…³ç¨¿ ï¼ˆXSSï¼‰ æ”»æ“Šã€‚é€™åŒ…æ‹¬æˆ¿é–“åç¨±å’Œ
ä¸»é¡Œã€‚</p>
<h3 id="113">11.3 è±å¯Œçš„å›å¾©</h3>
<p>è±å¯Œçš„å›å¾©æ˜¯ä¸€å€‹
ç‰¹æ®Šé¡å‹çš„[é—œä¿‚]ï¼ˆ#forming-äº‹ä»¶ä¹‹é–“çš„é—œä¿‚-äº‹ä»¶ä¹‹é–“ï¼‰
æœ‰æ•ˆåœ°å¼•ç”¨å¼•ç”¨çš„äº‹ä»¶,ä»¥ä¾¿ç”¨æˆ¶ç«¯å‘ˆç¾/è™•ç†å¦‚ä½•
å®ƒå¸Œæœ›ã€‚å®ƒå€‘é€šå¸¸èˆ‡ ['m.room.message']ï¼ˆ#mroommessageï¼‰ äº‹ä»¶ä¸€èµ·ä½¿ç”¨ã€‚</p>
<p>åœ¨è¦ç¯„çš„ v1.3 ä¹‹å‰,è±å¯Œçš„å›å¾©åƒ…é™æ–¼"m.room.message"äº‹ä»¶
å®ƒå¯ä»¥è¡¨ç¤º HTML æ ¼å¼çš„æ­£æ–‡ã€‚å¾ v1.3 é–‹å§‹,ç¾åœ¨å·²æ“´å±•
åˆ° <em>all</em> äº‹ä»¶é¡å‹,é€šéæ”¾æ£„ HTML æ ¼å¼çš„æ­£æ–‡çš„è¦æ±‚
è¢«åŒ…æ‹¬åœ¨å…§ã€‚</p>
<p>æ­¤å¤–,è±å¯Œçš„å›å¾©å¯ä»¥å¼•ç”¨è‡ª v1.3 èµ·çš„ä»»ä½•å…¶ä»–äº‹ä»¶é¡å‹ã€‚
ä»¥å‰,è±å¯Œçš„å›å¾©åªèƒ½å¼•ç”¨å¦ä¸€å€‹"m.room.message"äº‹ä»¶ã€‚</p>
<p>å¦‚æœå¯èƒ½,äº‹ä»¶æ‡‰åŒ…æ‹¬ [å›é€€è¡¨ç¤ºå½¢å¼]ï¼ˆ#fallbacks-for-rich-repliesï¼‰
å…è¨±ä¸å‘ˆç¾å¯Œå›å¾©çš„ç”¨æˆ¶ç«¯ä»ç„¶çœ‹åˆ°ä»¥ä¸‹å…§å®¹
ä¼¼ä¹æ˜¯å¼•ç”¨çš„ç­”è¦†ã€‚</p>
<p>å„˜ç®¡è±å¯Œçš„å›å¾©èˆ‡å¦ä¸€å€‹äº‹ä»¶å½¢æˆé—œä¿‚,ä½†å®ƒå€‘ä¸æœƒ
ä½¿ç”¨"rel_type"å‰µå»ºæ­¤é—œä¿‚ã€‚è€Œæ˜¯åç‚º"m.in_reply_to"çš„å­é …
ç”¨æ–¼æè¿°å›å¾©çš„é—œä¿‚,ä¿ç•™
"m.relates_to"ä¾†æè¿°äº‹ä»¶çš„ä¸»è¦é—œä¿‚ã€‚é€™æ„å‘³è‘—
å¦‚æœä¸€å€‹äº‹ä»¶åªæ˜¯å›å¾©å¦ä¸€å€‹äº‹ä»¶,æ²’æœ‰é€²ä¸€æ­¥çš„é—œä¿‚,
"m.relates_to"çš„"rel_type"å’Œ"event_id"å±¬æ€§è®Šç‚º<em>å¯é¸</em>ã€‚</p>
<p>ä¸€å€‹ç¯„ä¾‹å›å¾©æ˜¯:</p>
<pre><code class="language-json5">{
  &quot;å…§å®¹&quot;: {
    &quot;m.relates_to&quot;: {
      &quot;m.in_reply_to&quot;: {
        &quot;event_id&quot;: &quot;$another_äº‹ä»¶&quot;
      }
    },
    &quot;body&quot;: &quot;é€™è½èµ·ä¾†æ˜¯å€‹å¥½ä¸»æ„ï¼
  },
  äº‹ä»¶æ‰€éœ€çš„å…¶ä»–æ¬„ä½
}
</code></pre>
<p>è«‹æ³¨æ„,"m.in_reply_to"ç‰©ä»¶çš„"event_id"å…·æœ‰ç›¸åŒçš„è¦æ±‚
å¥½åƒå®ƒç›´æ¥åœ¨"m.relates_to"ä¸‹ã€‚</p>
<h4 id="_9">è±å¯Œå›å¾©çš„å›é€€</h4>
<p>æŸäº›ç”¨æˆ¶ç«¯å¯èƒ½ä¸æ”¯æŒè±å¯Œçš„å›å¾©,å› æ­¤éœ€è¦
å›é€€ä»¥æ”¹ç”¨ã€‚ä¸æ”¯æ´å¯Œå›å¾©çš„ç”¨æˆ¶ç«¯æ‡‰
å°‡äº‹ä»¶å‘ˆç¾ç‚ºè±å¯Œçš„å›å¾©ä¸¦ä¸ç‰¹åˆ¥ã€‚</p>
<p>æ”¯æ´å¯Œå›å¾©çš„ç”¨æˆ¶ç«¯æ‡‰æä¾›å›é€€æ ¼å¼
å›å¾©,ä¸¦ä¸”å¿…é ˆåœ¨å‘ˆç¾å›å¾©ä¹‹å‰å‰é›¢å›é€€ã€‚é€™
æ¯å€‹"msgtype"çš„ç‰¹å®šå›é€€æ–‡æœ¬éƒ½ä¸åŒ,ä½†æ˜¯
"æ­£æ–‡"çš„ä¸€èˆ¬æ ¼å¼ç‚º:</p>
<pre><code class="language-text">&gt; &lt;@alice:example.org&gt;é€™æ˜¯åŸå§‹æ­£æ–‡
&gt; é€™æ˜¯å›å¾©çš„åœ°æ–¹

</code></pre>
<p>"formatted_body"ï¼ˆå¦‚æœå­˜åœ¨ï¼‰ä¸¦ä½¿ç”¨é—œè¯çš„"æ ¼å¼"
"org.matrix.custom.html"æ‡‰ä½¿ç”¨ä»¥ä¸‹ç¯„æœ¬:</p>
<pre><code class="language-html">
&lt;MX-å›å¾©&gt;
    &lt;å¡Šå¼•ç”¨&gt;
        &lt;a href=&quot;https://matrix.to/#/!somewhere:example.org/$event:example.org&quot;&gt;å›å¾©&lt;/a&gt;
        &lt;a href=&quot;https://matrix.to/#/@alice:example.org&quot;&gt;@alice:example.org&lt;/a&gt;
        &lt;BR/&gt;
        &lt;!--é€™æ˜¯ç›¸é—œäº‹ä»¶çš„ HTML æ‰€åœ¨çš„ä½ç½®ã€‚--&gt;
    &lt;/å¡Šå¼•ç”¨&gt;
&lt;/MX-å›å¾©&gt;
é€™å°±æ˜¯ç­”è¦†çš„åœ°æ–¹ã€‚
</code></pre>
<p>å¦‚æœç›¸é—œäº‹ä»¶æ²’æœ‰"formatted_body",å‰‡äº‹ä»¶çš„
åœ¨å°ä»»ä½• HTML ç‰¹æ®Šå­—å…ƒé€²è¡Œç·¨ç¢¼å¾Œ,æ‡‰è€ƒæ…®"body"ã€‚
è«‹æ³¨æ„,å…©å€‹éŒ¨é»ä¸­çš„"href"éƒ½ä½¿ç”¨ [matrix.to
URI]ï¼ˆ/appendices#matrixto-navigationï¼‰.</p>
<h5 id="_10">å‰é›¢å›é€€</h5>
<p>æ”¯æ´å¯Œå›å¾©çš„å®¢æˆ¶ç«¯å¿…é ˆå¾
äº‹ä»¶,ç„¶å¾Œå‘ˆç¾äº‹ä»¶ã€‚é€™æ˜¯å› ç‚º
ä¸èƒ½ä¿¡ä»»å›é€€æ˜¯
äº‹ä»¶ã€‚åˆªé™¤å›é€€å¾Œ,å»ºè­°ç”¨æˆ¶ç«¯è¡¨ç¤º
"m.in_reply_to"å¼•ç”¨çš„äº‹ä»¶é¡ä¼¼æ–¼å›é€€çš„äº‹ä»¶
è¡¨ç¤º,å„˜ç®¡å®¢æˆ¶ç¢ºå¯¦ç‚ºå…¶ä½¿ç”¨è€…æä¾›äº†å‰µä½œè‡ªç”±
ä»‹é¢ã€‚å®¢æˆ¶æ‡‰è©²æ›´å–œæ­¡ã€Œformatted_bodyã€è€Œä¸æ˜¯ã€Œbodyã€,
å°±åƒå…¶ä»–"m.room.message"äº‹ä»¶ä¸€æ¨£ã€‚</p>
<p>è¦å‰é›¢"æ­£æ–‡"ä¸Šçš„å›é€€,ç”¨æˆ¶ç«¯æ‡‰éæ­·æ¯å€‹
å­—ä¸²çš„è¡Œ,åˆªé™¤ä»¥å›é€€é–‹é ­çš„ä»»ä½•è¡Œ
å‰ç¶´ï¼ˆ"&gt; ",åŒ…æ‹¬ç©ºæ ¼,ä¸å¸¶å¼•è™Ÿï¼‰ä¸¦åœ¨ä»¥ä¸‹æƒ…æ³ä¸‹åœæ­¢
é‡åˆ°ä¸å¸¶å‰ç¶´çš„è¡Œã€‚æ­¤å‰ç¶´ç¨±ç‚º
å›é€€å‰ç¶´åºåˆ—"ã€‚</p>
<p>è‹¥è¦å‰é›¢"formatted_body"ä¸Šçš„å›é€€,ç”¨æˆ¶ç«¯æ‡‰åˆªé™¤
æ•´å€‹"MX-å›å¾©"æ¨™è¨˜ã€‚</p>
<h5 id="mtextmnotice">"m.text"ã€"m.notice"å’Œç„¡æ³•è­˜åˆ¥çš„æ¶ˆæ¯é¡å‹çš„å›é€€</h5>
<p>ä½¿ç”¨å‰ç¶´åºåˆ—,ç›¸é—œäº‹ä»¶"æ­£æ–‡"çš„ç¬¬ä¸€è¡Œ
æ‡‰ä»¥ä½¿ç”¨è€…çš„ ID ç‚ºå‰ç¶´,å¾Œè·Ÿæ¯è¡Œ
ä»¥å›é€€å‰ç¶´åºåˆ—ç‚ºå‰ç¶´ã€‚ä¾‹å¦‚:</p>
<pre><code class="language-text">&gt; &lt;@alice:example.org&gt;é€™æ˜¯ç¬¬ä¸€è¡Œ
&gt; é€™æ˜¯ç¬¬äºŒè¡Œ
&gt; é€™æ˜¯å›å¾©

</code></pre>
<p>"formatted_body"ä½¿ç”¨æœ¬ç¯€å‰é¢å®šç¾©çš„ç¯„æœ¬ã€‚</p>
<h5 id="memote">"m.emote"çš„å›é€€</h5>
<p>èˆ‡"m.text"çš„å›é€€é¡ä¼¼,æ¯è¡Œéƒ½ä»¥
å›é€€å‰ç¶´åºåˆ—ã€‚ä½†æ˜¯,æ‡‰åœ¨ä¹‹å‰æ’å…¥æ˜Ÿè™Ÿ
ä½¿ç”¨è€…çš„ID,å¦‚ä¸‹æ‰€ç¤º:</p>
<pre><code class="language-text">&gt; * &lt;@alice:example.org&gt; æ„Ÿè¦ºä»Šå¤©å°‡æ˜¯ç¾å¥½çš„ä¸€å¤©
    é€™æ˜¯å›å¾©
</code></pre>
<p>"formatted_body"å°æ–¼ç¯„æœ¬æœ‰ä¸€å€‹ç´°å¾®çš„å€åˆ¥,å…¶ä¸­
æ˜Ÿè™Ÿä¹Ÿæ’å…¥åˆ°ä½¿ç”¨è€…çš„ ID ä¹‹å‰:</p>
<pre><code class="language-html">
&lt;MX-å›å¾©&gt;
    &lt;å¡Šå¼•ç”¨&gt;
        &lt;a href=&quot;https://matrix.to/#/!somewhere:example.org/$event:example.org&quot;&gt;å›å¾©&lt;/a&gt;

        * &lt;a href=&quot;https://matrix.to/#/@alice:example.org&quot;&gt;@alice:example.org&lt;/a&gt;
        &lt;BR/&gt;

        &lt;!--é€™æ˜¯ç›¸é—œäº‹ä»¶çš„ HTML æ‰€åœ¨çš„ä½ç½®ã€‚--&gt;
    &lt;/å¡Šå¼•ç”¨&gt;
&lt;/MX-å›å¾©&gt;
é€™å°±æ˜¯ç­”è¦†çš„åœ°æ–¹ã€‚

</code></pre>
<h5 id="mimagemvideomaudiomfile">"m.image"ã€"m.video"ã€"m.audio"å’Œ"m.file"çš„å›é€€</h5>
<p>ç›¸é—œäº‹ä»¶çš„"æ­£æ–‡"å°‡æ˜¯ä¸€å€‹æª”å,å¯èƒ½ä¸æ˜¯å¾ˆ
æè¿°ã€‚ç›¸é—œäº‹ä»¶ä¸æ‡‰å…·æœ‰"æ ¼å¼"
æˆ–"å…§å®¹"ä¸­çš„"formatted_body"â€”â€”å¦‚æœæ´»å‹•ç¢ºå¯¦æœ‰"æ ¼å¼"
å’Œ/æˆ–"formatted_body",å‰‡æ‡‰å¿½ç•¥é€™äº›æ¬„ä½ã€‚å› ç‚º
æª”åæœ¬èº«å¯èƒ½ä¸æ˜¯æè¿°æ€§çš„,ç›¸é—œäº‹ä»¶çš„"æ­£æ–‡"æ‡‰è©²
è¢«è¦–ç‚ºã€Œå·²ç™¼é€æª”ã€ã€‚' ä½¿è¼¸å‡ºçœ‹èµ·ä¾†ç›¸ä¼¼
åˆ°ä»¥ä¸‹å…§å®¹:</p>
<pre><code class="language-text">&gt; &lt;@alice:example.org&gt;ç™¼é€äº†ä¸€å€‹æª”ã€‚
é€™æ˜¯å›å¾©
</code></pre>
<pre><code class="language-html">
&lt;MX-å›å¾©&gt;
    &lt;å¡Šå¼•ç”¨&gt;
        &lt;a href=&quot;https://matrix.to/#/!somewhere:example.org/$event:example.org&quot;&gt;å›å¾©&lt;/a&gt;
        &lt;a href=&quot;https://matrix.to/#/@alice:example.org&quot;&gt;@alice:example.org&lt;/a&gt;
        &lt;BR/&gt;
        ç™¼é€äº†ä¸€å€‹æª”ã€‚
    &lt;/å¡Šå¼•ç”¨&gt;
&lt;/MX-å›å¾©&gt;
é€™å°±æ˜¯ç­”è¦†çš„åœ°æ–¹ã€‚

</code></pre>
<p>å°æ–¼"m.image",æ–‡æœ¬æ‡‰ç‚º"ç™¼é€åœ–åƒ"ã€‚<code>.å°æ–¼ã€Œm.videoã€,
æ–‡æœ¬æ‡‰ç‚ºã€Œç™¼é€è¦–é »ã€ã€‚</code>.å°æ–¼"m.audio",æ–‡æœ¬æ‡‰ç‚º
ã€Œç™¼é€éŸ³è¨Šæª”ã€ã€‚ã€‚</p>
<h3 id="114-ip">11.4 IP èªéŸ³</h3>
<p>æœ¬æ¨¡çµ„æ¦‚è¿°äº†æˆ¿é–“ä¸­çš„å…©å€‹ä½¿ç”¨è€…å¦‚ä½•è¨­ç½®IPèªéŸ³
ï¼ˆVoIPï¼‰äº’ç›¸å‘¼å«ã€‚èªéŸ³å’Œè¦–é »é€šè©±å»ºç«‹åœ¨
WebRTC 1.0æ¨™æº–ã€‚å‘¼å«ä¿¡ä»¤æ˜¯é€šéç™¼é€ [æ¶ˆæ¯] ä¾†å¯¦ç¾çš„
äº‹ä»¶]ï¼ˆ#eventsï¼‰åˆ°æˆ¿é–“ã€‚åœ¨æ­¤ç‰ˆæœ¬çš„è¦ç¯„ä¸­,åªæœ‰å…©æ–¹
æ”¯æ´é€šä¿¡ï¼ˆä¾‹å¦‚,å…©å€‹å°ç­‰é«”ä¹‹é–“æˆ–å°ç­‰é«”ä¹‹é–“
å’Œå¤šé»æœƒè­°è£ç½®ï¼‰ã€‚é€™æ„å‘³è‘—ç”¨æˆ¶ç«¯åªèƒ½
å°‡å‘¼å«äº‹ä»¶ç™¼é€åˆ°åªæœ‰å…©å€‹åƒèˆ‡è€…çš„èŠå¤©å®¤ã€‚</p>
<h4 id="1141">11.4.1 äº‹ä»¶</h4>
<h5 id="mcallanswer">m.call.answer</h5>
<p>æ­¤äº‹ä»¶ç”±è¢«å«æ–¹åœ¨å¸Œæœ›æ‡‰ç­”å‘¼å«æ™‚ç™¼é€</p>
<pre><code class="language-text">{
  &quot;content&quot;: {
    &quot;answer&quot;: {
      &quot;sdp&quot;: &quot;v=0\r\no=- 6584580628695956864 2 IN IP4 127.0.0.1[...]&quot;,
      &quot;type&quot;: &quot;answer&quot;
    },
    &quot;call_id&quot;: &quot;12345&quot;,
    &quot;version&quot;: 0
  },
  &quot;event_id&quot;: &quot;$143273582443PhrSn:example.org&quot;,
  &quot;origin_server_ts&quot;: 1432735824653,
  &quot;room_id&quot;: &quot;!jEsUZKDJdhlrceRyVU:example.org&quot;,
  &quot;sender&quot;: &quot;@example:example.org&quot;,
  &quot;type&quot;: &quot;m.call.answer&quot;,
  &quot;unsigned&quot;: {
    &quot;age&quot;: 1234
  }
}
</code></pre>
<h4 id="_11">å®¢æˆ¶ç«¯è¡Œç‚º</h4>
<p>ä½¿ç”¨äº¤æ›çš„æ¶ˆæ¯äº‹ä»¶è¨­ç½®å‘¼å«,å¦‚ä¸‹æ‰€ç¤º:</p>
<pre><code>ä¾†é›»è€…è¢«å«æ–¹
[æ’¥æ‰“é›»è©±]
m.call.invite -----------&gt;
m.call.candidate --------&gt;
[..å€™é¸äºº..]--------&gt;
[æ¥è½é›»è©±]
&lt;--------------- m.call.answer
[é€šè©±æ­£åœ¨é€²è¡Œä¸­]
&lt;--------------- m.call.hangup
</code></pre>
<p>æˆ–æ‹’çµ•çš„å‘¼å«:</p>
<pre><code>ä¾†é›»è€…è¢«å«æ–¹
m.call.invite ------------&gt;
m.call.candidate ---------&gt;
[..å€™é¸äºº..]---------&gt;
[æ‹’çµ•ä¾†é›»]
&lt;-------------- m.call.hangup
</code></pre>
<p>èª¿ç”¨æ˜¯æ ¹æ“šWebRTCè¦ç¯„å”å•†çš„ã€‚</p>
<h5 id="_12">çœ©å…‰</h5>
<p>"çœ©å…‰"æ˜¯å…©å€‹ä½¿ç”¨è€…åœ¨ä»¥ä¸‹ä½ç½®ç›¸äº’å‘¼å«æ™‚å‡ºç¾çš„å•é¡Œ
å¤§è‡´åœ¨åŒä¸€æ™‚é–“ã€‚é€™æœƒå°è‡´å‘¼å«ç„¡æ³•è¨­ç½®ç‚º
å·²ç¶“æœ‰ä¾†é›»/å»é›»ã€‚çœ©å…‰è§£æåº¦æ¼”ç®—æ³•
å¯ç”¨æ–¼ç¢ºå®šè¦æ›æ–·çš„å‘¼å«å’Œæ‡‰ç­”çš„å‘¼å«ã€‚
å¦‚æœå…©å€‹ç”¨æˆ¶ç«¯å¯¦ç¾ç›¸åŒçš„æ¼”ç®—æ³•,å‰‡å®ƒå€‘éƒ½å°‡é¸æ“‡
åŒä¸€å‘¼å«å’Œå‘¼å«å°‡æˆåŠŸé€£æ¥ã€‚</p>
<p>ç•¶å‘¼å«è¢«"ä¸‹é”"åˆ°æˆ¿é–“è€Œä¸æ˜¯ä½¿ç”¨è€…æ™‚,çœ©å…‰è§£æåº¦
ä¸‹é¢æ¦‚è¿°çš„æ¼”ç®—æ³•åƒ…è€ƒæ…®ç”¨æ–¼å°
åŒä¸€å€‹æˆ¿é–“ã€‚æ¼”ç®—æ³•å¦‚ä¸‹:</p>
<p>-å¦‚æœæ”¶åˆ°æˆ¿é–“çš„"m.call.invite",è€Œå®¢æˆ¶
<strong>æº–å‚™å‘åŒä¸€æˆ¿é–“ç™¼é€"m.call.invite":
-ç”¨æˆ¶ç«¯æ‡‰å–æ¶ˆå…¶å‚³å‡ºå‘¼å«,æ”¹ç‚º
ä»£è¡¨ç”¨æˆ¶è‡ªå‹•æ¥å—å‚³å…¥å‘¼å«ã€‚
-å¦‚æœæ”¶åˆ°æˆ¿é–“çš„"m.call.invite"</strong>åœ¨ç”¨æˆ¶ç«¯æœ‰
å·²ç™¼é€<em><em> "m.call.invite"åˆ°åŒä¸€æˆ¿é–“,æ­£åœ¨ç­‰å¾…
å›æ‡‰:
-å®¢æˆ¶æ‡‰åŸ·è¡Œ
å…©å€‹å‘¼å«çš„å‘¼å«ID,ä¸¦ä½¿ç”¨å…©å€‹å‘¼å«ä¸­çš„</em>è¼ƒå°</em>,
æµç”¢è¶Šå¤§ã€‚å¦‚æœä¾†é›»è¼ƒå°,å‰‡
ç”¨æˆ¶ç«¯æ‡‰ä»£è¡¨ä½¿ç”¨è€…æ¥å—æ­¤èª¿ç”¨ã€‚</p>
<p>å‘¼å«è¨­ç½®æ‡‰è©²å°ç”¨æˆ¶é¡¯ç¤ºç„¡ç¸«,å°±å¥½åƒä»–å€‘åªæ˜¯ç°¡å–®åœ°
æ‰“äº†å€‹é›»è©±,å°æ–¹æ¥è½äº†ã€‚é€™æ„å‘³è‘—ä»»ä½•åª’é«”
æ‡‰è½‰ç§»å·²è¨­ç½®ç‚ºç”¨æ–¼å‘¼å«çš„æµ,ä¸¦ä¸”
ç”¨æ–¼æ›¿æ›å®ƒçš„èª¿ç”¨ã€‚</p>
<h4 id="1143">11.4.3 ä¼ºæœå™¨è¡Œç‚º</h4>
<p>ä¸»ä¼ºæœå™¨å¯ä»¥æä¾›ç”¨æˆ¶ç«¯å¯ä»¥ä½¿ç”¨çš„ TURN ä¼ºæœå™¨
è¯ç¹«é ç«¯æ–¹ã€‚å°‡ä½¿ç”¨ä»¥ä¸‹ HTTP API ç«¯é»
ç”¨æˆ¶ç«¯ä»¥ç²å–æœ‰é—œ TURN ä¼ºæœå™¨çš„è³‡è¨Šã€‚</p>
<h4 id="1144">11.4.4 å®‰å…¨æ³¨æ„äº‹é …</h4>
<p>åªèƒ½å‘å…·æœ‰å¦ä¸€å€‹ç”¨æˆ¶çš„æˆ¿é–“ç™¼å‡ºå‘¼å«ã€‚å¦‚æœ
å®ƒå€‘è¢«æ”¾ç½®åœ¨ç¾¤èŠå®¤ä¸­,å¯èƒ½æ˜¯å…¶ä»–ä½¿ç”¨è€…
å°‡æ””æˆªä¸¦æ¥è½é›»è©±ã€‚</p>
<h3 id="115">11.5 éµå…¥é€šçŸ¥</h3>
<p>ä½¿ç”¨è€…å¯èƒ½å¸Œæœ›åœ¨å…¶ä»–ç”¨æˆ¶åœ¨æˆ¿é–“å…§éµå…¥å…§å®¹æ™‚æ”¶åˆ°é€šçŸ¥ã€‚
é€™å¯ä»¥é€šééµå…¥é€šçŸ¥ä¾†å¯¦ç¾ã€‚é€™äº›æ˜¯çŸ­æš«çš„
äº‹ä»¶,å› æ­¤å®ƒå€‘ä¸æ§‹æˆ
[äº‹ä»¶åœ–]ï¼ˆ/#eventå›¾ï¼‰ã€‚éµå…¥é€šçŸ¥çš„ç¯„åœé™å®š
åˆ°ä¸€å€‹æˆ¿é–“ã€‚</p>
<h4 id="_13">äº‹ä»¶</h4>
<h5 id="mtyping">m.typing</h5>
<p>é€šçŸ¥ç”¨æˆ¶ç«¯ç›®å‰æ­£åœ¨éµå…¥çš„ç”¨æˆ¶æ¸…å–®ã€‚</p>
<pre><code class="language-text">{
  &quot;content&quot;: {
    &quot;user_ids&quot;: [
      &quot;@alice:matrix.org&quot;,
      &quot;@bob:example.com&quot;
    ]
  },
  &quot;type&quot;: &quot;m.typing&quot;
}
</code></pre>
<h4 id="_14">å®¢æˆ¶ç«¯è¡Œç‚º</h4>
<p>ç•¶ç”¨æˆ¶ç«¯æ”¶åˆ°ã€Œm.typingã€äº‹ä»¶æ™‚,å®ƒå¿…é ˆä½¿ç”¨ä½¿ç”¨è€… ID æ¸…å–®
<strong>æ›¿æ›</strong>ç•¶å‰æ­£åœ¨éµå…¥çš„æ¯å€‹ç”¨æˆ¶çš„çŸ¥è­˜ã€‚é€™
åŸå› æ˜¯ä¼ºæœå™¨<em>ä¸è¨˜å¾—</em>ä¸æ˜¯çš„ä½¿ç”¨è€…
ç›®å‰è¼¸å…¥,å› ç‚ºè©²æ¸…å–®å¾ˆå¿«å°±æœƒè®Šå¤§ã€‚å®¢æˆ¶æ‡‰æ¨™è¨˜
å› ç‚ºä¸éµå…¥ä¸åœ¨è©²æ¸…å–®ä¸­çš„ä»»ä½•ä½¿ç”¨è€…IDã€‚</p>
<p>å»ºè­°ç”¨æˆ¶ç«¯å­˜å„²ä¸€å€‹ã€Œå¸ƒçˆ¾å€¼ã€ æŒ‡ç¤ºæ˜¯å¦
ä½¿ç”¨è€…æ˜¯å¦æ­£åœ¨éµå…¥ã€‚é›–ç„¶æ­¤å€¼ç‚º"true",ä½†è¨ˆæ™‚å™¨æ‡‰è§¸ç™¼
å®šæœŸæ¯ N ç§’ç™¼é€ä¸€æ¬¡éµå…¥çš„ HTTP è«‹æ±‚ã€‚çš„åƒ¹å€¼
Nå»ºè­°ä¸è¶…é20-30ç§’ã€‚æ­¤è«‹æ±‚æ‡‰
ç”±ç”¨æˆ¶ç«¯é‡æ–°ç™¼é€ä»¥ç¹¼çºŒé€šçŸ¥ä¼ºæœå™¨ä½¿ç”¨è€…æ˜¯
é‚„åœ¨æ‰“å­—ã€‚ç”±æ–¼å¾ŒçºŒè«‹æ±‚å°‡æ›¿æ›èˆŠè«‹æ±‚,å› æ­¤
é æœŸè¶…æ™‚ç”¨å®Œå‰ 5 ç§’çš„å®‰å…¨è£•åº¦ç‚º
æ¨è–¦ã€‚ç•¶ä½¿ç”¨è€…åœæ­¢éµå…¥æ™‚,ç‹€æ…‹æ›´æ”¹
"å¸ƒçˆ¾"åˆ°"å‡"æ‡‰è©²è§¸ç™¼å¦ä¸€å€‹HTTPè«‹æ±‚ä¾†é€šçŸ¥
ä½¿ç”¨è€…å·²åœæ­¢éµå…¥çš„ä¼ºæœå™¨ã€‚</p>
<h5 id="put-_matrixclientv3roomsroomidtypinguserid">PUT /_matrix/client/v3/rooms/{roomId}/typing/{userId}</h5>
<p>é€™å‘Šè¨´ä¼ºæœå™¨ä½¿ç”¨è€…æ­£åœ¨éµå…¥ä¸‹ä¸€å€‹ N æ¯«ç§’,å…¶ä¸­ N æ˜¯éµä¸­æŒ‡å®šçš„å€¼ã€‚ æˆ–è€…,å¦‚æœæ˜¯ ,å®ƒå‘Šè¨´ä¼ºæœå™¨ ä½¿ç”¨è€…å·²åœæ­¢éµå…¥ã€‚timeouttypingfalse</p>
<p>è«‹æ±‚æ­£æ–‡ç¤ºä¾‹</p>
<pre><code class="language-text">{
  &quot;timeout&quot;: 30000,
  &quot;typing&quot;: true
}
</code></pre>
<h4 id="_15">å®‰å…¨æ³¨æ„äº‹é …</h4>
<p>å®¢æˆ¶å¯èƒ½ä¸å¸Œæœ›é€šçŸ¥æˆ¿é–“é‡Œçš„æ¯å€‹äººä»–å€‘æ­£åœ¨æ‰“å­—
è€Œæ˜¯åƒ…æœƒè­°å®¤ä¸­çš„ç‰¹å®šä½¿ç”¨è€…ã€‚</p>
<h3 id="116">11.6 æ”¶æ“š</h3>
<p>{{&lt; changed-in v="1.4" &gt;}}æ·»åŠ äº†ç§äººå·²è®€å›åŸ·ã€‚</p>
<p>æ­¤æ¨¡çµ„å¢åŠ äº†å°æ”¶æ“šçš„æ”¯æ´ã€‚é€™äº›æ”¶æ“šæ˜¯
äº‹ä»¶ç¢ºèªã€‚æ­¤æ¨¡çµ„å®šç¾©ã€Œm.readã€æ”¶æ“š
ç”¨æ–¼æŒ‡ç¤ºä½¿ç”¨è€…å·²è®€å–çµ¦å®šäº‹ä»¶,ä»¥åŠ"m.read.private"
åœ¨æ²’æœ‰ä»»ä½•å…¶ä»–ä½¿ç”¨è€…çŸ¥é“çš„æƒ…æ³ä¸‹é”åˆ°ç›¸åŒçš„ç›®çš„ã€‚ä¸»è¦
"m.read.private"æ—¨åœ¨æ¸…é™¤[é€šçŸ¥]ï¼ˆ#receiving-é€šçŸ¥ï¼‰
æ²’æœ‰å‘ä»–äººå®£å‚³è®€åˆ°ç‹€æ…‹ã€‚</p>
<p>ç‚ºæ¯å€‹äº‹ä»¶ç™¼é€æ”¶æ“šå¯èƒ½æœƒå°è‡´ç™¼é€å¤§é‡
åˆ°ä¸»ä¼ºæœå™¨çš„æµé‡ã€‚ç‚ºäº†é˜²æ­¢é€™æˆç‚ºä¸€å€‹å•é¡Œ,
æ”¶æ“šæ˜¯ä½¿ç”¨"æœ€å¤š"æ¨™è¨˜å¯¦ç¾çš„ã€‚æ­¤æ¨™è¨˜æŒ‡ç¤º
ç¢ºèªé©ç”¨æ–¼"ä¹‹å‰ä¸¦åŒ…æ‹¬"çš„æ‰€æœ‰äº‹ä»¶
æŒ‡å®šçš„äº‹ä»¶ã€‚ä¾‹å¦‚,å°‡äº‹ä»¶æ¨™è¨˜ç‚ºã€Œå·²è®€ã€ å°‡æŒ‡ç¤º
ç”¨æˆ¶å·²è®€å–æ‰€æœ‰äº‹ä»¶<em>ç›´åˆ°</em>å¼•ç”¨çš„äº‹ä»¶ã€‚è«‹åƒé–±çš„
[æ¥æ”¶é€šçŸ¥]ï¼ˆ#receiving-é€šçŸ¥ï¼‰éƒ¨åˆ†ç­è§£æ›´å¤šè³‡è¨Š
æœ‰é—œå·²è®€å›åŸ·å¦‚ä½•å½±éŸ¿é€šçŸ¥è¨ˆæ•¸çš„è³‡è¨Šã€‚</p>
<p>{{&lt; add-in v="1.4" &gt;}}å·²è®€å›åŸ·ä¸»è¦æœ‰ä¸‰ç¨®å½¢å¼:
<em>ç„¡ç·šç¨‹:è¡¨ç¤ºè®€å–åˆ°æ¥æ”¶,è€Œä¸è€ƒæ…®ç·šç¨‹ã€‚é€™å°±æ˜¯
é ç·šç¨‹åŒ–å·²è®€å›åŸ·æœ‰æ•ˆã€‚
</em>ç·šç¨‹,ä¸»æ™‚é–“ç·š:è¡¨ç¤ºä¸åœ¨
ç‰¹å®šç·šç¨‹ã€‚ç”±ç·šç¨‹ID MAinè­˜åˆ¥ã€‚
*ç·šç¨‹,åœ¨ç·šç¨‹ä¸­:è¡¨ç¤ºç‰¹å®šç·šç¨‹ä¸­çš„è®€åˆ°æ¥æ”¶
ç·šã€‚ç”±ç·šç¨‹æ ¹çš„äº‹ä»¶IDæ¨™è­˜ã€‚</p>
<p>ç·šç¨‹å¼è®€å›åŸ·å°‡åœ¨ä¸‹é¢é€²ä¸€æ­¥è©³ç´°è¨è«–ï¼ˆ#threaded-å·²è®€å›åŸ·ï¼‰ã€‚</p>
<h4 id="_16">äº‹ä»¶</h4>
<p>{{&lt; changed-in v="1.4" &gt;}}æ¯å€‹"user_id"ã€"receipt_type"å’Œåˆ†é¡
ï¼ˆç„¡ç·šç¨‹æˆ–"thread_id"ï¼‰å…ƒçµ„å¿…é ˆåƒ…èˆ‡å–®å€‹å…ƒçµ„é—œè¯
"event_id"ã€‚</p>
<h4 id="mreceipt">m.receipt</h4>
<p>é€šçŸ¥å®¢æˆ¶æ–°æ”¶æ“šã€‚</p>
<pre><code class="language-text">{
  &quot;content&quot;: {
    &quot;$1435641916114394fHBLK:matrix.org&quot;: {
      &quot;m.read&quot;: {
        &quot;@rikj:jki.re&quot;: {
          &quot;ts&quot;: 1436451550453
        }
      },
      &quot;m.read.private&quot;: {
        &quot;@self:example.org&quot;: {
          &quot;ts&quot;: 1661384801651
        }
      }
    }
  },
  &quot;type&quot;: &quot;m.receipt&quot;
}
</code></pre>
<h4 id="_17">å®¢æˆ¶ç«¯è¡Œç‚º</h4>
<p>{{&lt; changed-in v="1.4" &gt;}}å·²æ›´æ”¹ä»¥æ”¯æ´ç·šç¨‹å¼å·²è®€å›åŸ·ã€‚</p>
<p>åœ¨"/sync"ä¸­,æ”¶æ“šåˆ—åœ¨"è‡¨æ™‚"äº‹ä»¶é™£åˆ—ä¸‹
å°æ–¼çµ¦å®šçš„æˆ¿é–“ã€‚äº‹ä»¶æµä¸­çš„æ–°æ”¶æ“šæ˜¯
æ›´æ–°ç¾æœ‰æ˜ å°„çš„å¢é‡ã€‚ç”¨æˆ¶ç«¯æ‡‰æ›¿æ›èˆŠçš„
åŸºæ–¼"user_id"ã€"receipt_type"å’Œ
"thread_id"ï¼ˆå¦‚æœå­˜åœ¨ï¼‰ã€‚
ä¾‹å¦‚:</p>
<pre><code class="language-text">Client receives m.receipt:
  user = @alice:example.com
  receipt_type = m.read
  event_id = $aaa:example.com
  thread_id = undefined

Client receives another m.receipt:
  user = @alice:example.com
  receipt_type = m.read
  event_id = $bbb:example.com
  thread_id = main

The client does not replace any acknowledgements, yet.

Client receives yet another m.receipt:
  user = @alice:example.com
  receipt_type = m.read
  event_id = $ccc:example.com
  thread_id = undefined

The client replaces the older acknowledgement for $aaa:example.com
with this new one for $ccc:example.com, but does not replace the
acknowledgement for $bbb:example.com because it belongs to a thread.

Client receives yet another m.receipt:
  user = @alice:example.com
  receipt_type = m.read
  event_id = $ddd:example.com
  thread_id = main

Now the client replaces the older $bbb:example.com acknowledgement with
this new $ddd:example.com acknowledgement. The client does NOT replace the
older acknowledgement for $ccc:example.com as it is unthreaded.
</code></pre>
<p>ç•¶ç¢ºå®š
æœ‰å•é¡Œçš„äº‹ä»¶å·²å‘ç”¨æˆ¶é¡¯ç¤º<em><em>ã€‚åªéœ€æ¥æ”¶
äº‹ä»¶ä¸èƒ½æä¾›è¶³å¤ çš„ç¢ºå®šæ€§,è¡¨æ˜ç”¨æˆ¶å·²ç¶“çœ‹åˆ°äº†
äº‹ä»¶ã€‚ç”¨æˆ¶æ‡‰è©²éœ€è¦</em>æ¡å–ä¸€äº›æ“ä½œ</em>,ä¾‹å¦‚æŸ¥çœ‹
äº‹ä»¶ç™¼é€åˆ°çš„æˆ¿é–“æˆ–æŒ‰é †åºé—œé–‰é€šçŸ¥
ä½¿äº‹ä»¶è¨ˆç‚ºã€Œå·²è®€ã€ã€‚ç”¨æˆ¶ç«¯ä¸æ‡‰ç™¼é€å·²è®€å›åŸ·
å°æ–¼è‡ªå·±çš„ç”¨æˆ¶ç™¼é€çš„äº‹ä»¶ã€‚</p>
<p>èˆ‡ç™¼é€å›åŸ·çš„è¦å‰‡é¡ä¼¼,æ‡‰é¡¯ç¤ºç·šç¨‹å›åŸ·
åœ¨ç·šç¨‹çš„ä¸Šä¸‹æ–‡ä¸­ã€‚å¦‚æœç·šç¨‹å‘ˆç¾åœ¨æŠ«éœ²å¾Œé¢,
ç”¨æˆ¶ç«¯å°šæœªé¡¯ç¤ºäº‹ä»¶ï¼ˆæˆ–ä»»ä½•é©ç”¨çš„å·²è®€å›åŸ·ï¼‰
çµ¦ä½¿ç”¨è€…ã€‚ä½†æ˜¯,ä¸€æ—¦ä»–å€‘æ“´å±•äº†ç·šç¨‹,ç·šç¨‹å·²è®€å›åŸ·
å°‡ç™¼é€ä¸¦é¡¯ç¤ºä¾†è‡ªå…¶ä»–ä½¿ç”¨è€…çš„æ¯å€‹ç·šç¨‹çš„æ”¶æ“šã€‚</p>
<p>ç”¨æˆ¶ç«¯å¯ä»¥é€šéèˆ‡
éµå¾ª HTTP APIã€‚</p>
<h5 id="post-_matrixclientv3roomsroomidreceiptreceipttypeeventid">POST /_matrix/client/v3/rooms/{roomId}/receipt/{receiptType}/{eventId}</h5>
<p>æ­¤ API å°‡çµ¦å®šæ”¶æ“šé¡å‹çš„æ¨™è¨˜æ›´æ–°ç‚ºäº‹ä»¶ ID æŒ‡å®šã€‚</p>
<p>è«‹æ±‚æ­£æ–‡ç¤ºä¾‹</p>
<pre><code class="language-text">{
  &quot;thread_id&quot;: &quot;main&quot;
}
</code></pre>
<h5 id="_18">ç§äººå·²è®€å›åŸ·</h5>
<p>{{% add-in v="1.4" %}}</p>
<p>ä¸€äº›ä½¿ç”¨è€…å¸Œæœ›å°‡æˆ¿é–“æ¨™è¨˜ç‚ºå·²è®€,æ¸…é™¤å…¶[é€šçŸ¥è¨ˆæ•¸]ï¼ˆ#receivingé€šçŸ¥ï¼‰,
ä½†ä¸è¦æ´©éœ²ä»–å€‘å·²ç¶“é–±è®€äº†ç‰¹å®šæ¶ˆæ¯çš„äº‹å¯¦ã€‚è‡ª
ç‚ºæ­¤,ç”¨æˆ¶ç«¯å¯ä»¥ç™¼é€ã€Œm.read.privateã€æ”¶æ“šè€Œä¸æ˜¯ã€Œm.readã€ã€‚
è¦åšåˆ°é€™ä¸€é»:æ¸…é™¤é€šçŸ¥,ä¸è¦å°‡æ”¶æ“šå»£æ’­åˆ°
å…¶ä»–ä½¿ç”¨è€…ã€‚</p>
<p>ä¼ºæœå™¨ä¸å¾—å°‡ã€Œm.read.privateã€æ”¶æ“šç™¼é€çµ¦é™¤
ä¸€å€‹æœ€åˆç™¼é€å®ƒã€‚</p>
<p>åœ¨"m.read"å’Œ"m.read.private"ä¹‹é–“,æ”¶æ“šæ›´"é ˜å…ˆ"æˆ–
åœ¨ç¢ºå®šæœ€é«˜è®€æ•¸æ¨™è¨˜æ™‚ä½¿ç”¨"æœ€è¿‘"ã€‚è«‹åƒé–±çš„
[é€šçŸ¥]ï¼ˆ#receiving-é€šçŸ¥ï¼‰éƒ¨åˆ†,ä»¥ç²å–æ›´å¤šè³‡è¨Š
é€™å°é€šçŸ¥è¨ˆæ•¸æœ‰ä½•å½±éŸ¿ã€‚</p>
<p>å¦‚æœå®¢æˆ¶ç«¯ç™¼é€"m.read"æ”¶æ“š,è©²æ”¶æ“šä½æ–¼"m.read.private"çš„"å¾Œé¢"
æ”¶åˆ°,å…¶ä»–ä½¿ç”¨è€…å°‡çœ‹åˆ°æ›´æ”¹ç™¼ç”Ÿ,ä½†ç™¼é€ä½¿ç”¨è€…å°‡
ä¸æœƒå°‡å…¶é€šçŸ¥è¨ˆæ•¸å€’å›è©²æ™‚é–“é»ã€‚è€Œ
ä¸å¸¸è¦‹,"m.read"ï¼ˆå…¬å…±ï¼‰æ¥æ”¶æ»¯å¾Œè¢«èªç‚ºæ˜¯æœ‰æ•ˆçš„
ä¾‹å¦‚,"m.read.private"æ”¶æ“šå¾Œé¢çš„å¹¾æ¢æ¶ˆæ¯ã€‚</p>
<h5 id="_19">ç·šç¨‹å¼è®€å›åŸ·</h5>
<p>{{% add-in v="1.4" %}}</p>
<p>å¦‚æœç”¨æˆ¶ç«¯ä¸ä½¿ç”¨ [threading]ï¼ˆ#threadingï¼‰,é‚£éº¼å®ƒå€‘åªæœƒ
ç™¼é€ã€Œç„¡ç·šç¨‹ã€å·²è®€å›åŸ·,ç„¡è«–ç·šç¨‹å¦‚ä½•,éƒ½æœƒå½±éŸ¿æ•´å€‹æˆ¿é–“ã€‚</p>
<p>ç·šç¨‹å¼å·²è®€å›åŸ·åªæ˜¯å¸¶æœ‰"thread_id"çš„å›åŸ·,ç›®æ¨™
ç·šç¨‹æ ¹çš„äº‹ä»¶ ID æˆ–ä¸»æ™‚é–“ç·šçš„"main"ã€‚</p>
<p>ç·šç¨‹å¼•å…¥äº†åœ¨åŒä¸€æœƒè©±ä¸­é€²è¡Œå¤šå€‹å°è©±çš„æ¦‚å¿µ
æˆ¿é–“,å› æ­¤å€¼å¾—è‡ªå·±çš„å·²è®€å›åŸ·å’Œé€šçŸ¥è¨ˆæ•¸ã€‚äº‹ä»¶æ˜¯
å¦‚æœæ»¿è¶³ä»¥ä¸‹ä»»ä½•æ¢ä»¶,å‰‡è¢«è¦–ç‚ºã€Œåœ¨ç·šç¨‹ä¸­ã€:
<em>å®ƒçš„"rel_type"ç‚º"m.thread"ã€‚
</em>å®ƒå…·æœ‰"rel_type"ç‚º"m.thread"çš„å­äº‹ä»¶ï¼ˆåœ¨é€™ç¨®æƒ…æ³ä¸‹,å®ƒå°‡æ˜¯
ç·šç¨‹æ ¹ï¼‰ã€‚
*åœ¨äº‹ä»¶é—œä¿‚ä¹‹å¾Œ,å®ƒæœ‰ä¸€å€‹çˆ¶äº‹ä»¶,è©²çˆ¶äº‹ä»¶ç¬¦åˆ
ä»¥ä¸Šä¹‹ä¸€ã€‚ä½†æ˜¯,å¯¦ç¾ä¸æ‡‰è©²ç„¡é™éæ­¸:a
å»ºè­°æœ€å¤šä½¿ç”¨ 3 å€‹èºé»ä»¥æ¶µè“‹é–“æ¥é—œä¿‚ã€‚</p>
<p>ä¸åœ¨ç·šç¨‹ä¸­ä½†ä»åœ¨æˆ¿é–“ä¸­çš„äº‹ä»¶è¢«è¦–ç‚º
"ä¸»æ™‚é–“ç·š",æˆ–IDç‚º"main"çš„ç‰¹æ®Šç·šç¨‹ã€‚</p>
<p>ä¸‹é¢æ˜¯ä¸€å€‹èŠå¤©å®¤çš„ç¤ºä¾‹ DAG,è™›ç·šè¡¨ç¤ºäº‹ä»¶
é—œä¿‚å’Œé¡¯ç¤ºæ‹“æ’²æ’åºçš„å¯¦ç·šã€‚</p>
<p><a href="/img/threaded-dag.png"><img alt="threaded-dag.png" src="/img/threaded-dag.png" title="threaded-dag.png" /></a></p>
<p>æ­¤ DAG å¯ä»¥è¡¨ç¤ºç‚º 3 å€‹ç·šç¨‹æ™‚é–“ç·š,å…¶ä¸­"A"å’Œ"B"æ˜¯ç·šç¨‹
æ ¹:</p>
<p><a href="/img/threaded-dag-threads.png"><img alt="threaded-dag-threads.png" src="/img/threaded-dag-threads.png" title="threaded-dag-threads.png" /></a></p>
<p>æœ‰äº†é€™å€‹,æˆ‘å€‘å¯ä»¥è­‰æ˜:
<em>"I"ä¸Šçš„ç·šç¨‹å·²è®€å›åŸ·æœƒå°‡"A"ã€"B"å’Œ"I"æ¨™è¨˜ç‚ºå·²è®€ã€‚
</em>"E"ä¸Šçš„ç·šç¨‹å·²è®€å›åŸ·æœƒå°‡"C"å’Œ"E"æ¨™è¨˜ç‚ºå·²è®€ã€‚
*"D"ä¸Šçš„éç·šç¨‹å·²è®€å›åŸ·æœƒå°‡"A"ã€"B"ã€"C"å’Œ"D"æ¨™è¨˜ç‚ºå·²è®€ã€‚</p>
<p>è«‹æ³¨æ„,ä½¿ç”¨ç·šç¨‹å·²è®€å›åŸ·å°‡"A"æ¨™è¨˜ç‚ºå·²è®€ä¸¦ä¸æ„å‘³è‘—
"C"ã€"E"ã€"G"æˆ–"H"è¢«æ¨™è¨˜ç‚ºå·²è®€:ç·šç¨‹ A çš„æ™‚é–“ç·šéœ€è¦
å®ƒè‡ªå·±çš„ç·šç¨‹è®€å–å›åŸ·ä½æ–¼ã€ŒHã€è™•ä»¥å¯¦ç¾æ­¤ç›®çš„ã€‚</p>
<p>ä¸Šè¿° 3 å€‹ç¯„ä¾‹çš„å·²è®€å›åŸ·ç‚º:</p>
<pre><code class="language-json">{
  &quot;$I&quot;: {
    &quot;m.read&quot;: {
      &quot;@user:example.org&quot;: {
        &quot;ts&quot;: 1661384801651,
        &quot;thread_id&quot;: &quot;main&quot; // because `I` is not in a thread, but is a threaded receipt
      }
    }
  },
  &quot;$E&quot;: {
    &quot;m.read&quot;: {
      &quot;@user:example.org&quot;: {
        &quot;ts&quot;: 1661384801651,
        &quot;thread_id&quot;: &quot;$A&quot; // because `E` is in Thread `A`
      }
    }
  },
  &quot;$D&quot;: {
    &quot;m.read&quot;: {
      &quot;@user:example.org&quot;: {
        &quot;ts&quot;: 1661384801651
        // no `thread_id` because the receipt is *unthreaded*
      }
    }
  }
}
</code></pre>
<p>ç™¼é€å·²è®€å›åŸ·çš„æ¢ä»¶èˆ‡ç·šç¨‹å’Œéç·šç¨‹è®€å–é¡ä¼¼
æ”¶ç›Šã€‚ä¾‹å¦‚,ç”¨æˆ¶ç«¯å¯èƒ½æœƒç‚ºç·šç¨‹ç™¼é€å°ˆç”¨å·²è®€å›åŸ·
ç”¨æˆ¶å±•é–‹è©²ç·šç¨‹æ™‚çš„äº‹ä»¶ã€‚</p>
<h4 id="_20">ä¼ºæœå™¨è¡Œç‚º</h4>
<p>ç‚ºäº†æé«˜æ•ˆç‡,æ”¶æ“šæ‡‰åˆ†æ‰¹åˆ°æ¯å€‹æˆ¿é–“çš„ä¸€å€‹äº‹ä»¶ä¸­
åœ¨å°‡å®ƒå€‘äº¤ä»˜çµ¦å®¢æˆ¶ä¹‹å‰ã€‚</p>
<p>æŸäº›æ”¶æ“šä½œç‚ºé¡å‹ç‚ºã€Œm.receiptã€çš„EDUé€šéè¯åˆç™¼é€ã€‚é€™
EDU æ ¼å¼ç‚º:</p>
<pre><code>{
    &lt;room_id&gt;: {
        &lt;receipt_type&gt;: {
            &lt;user_id&gt;: { &lt;content (ts &amp; thread_id, currently)&gt; }
        },
        ...
    },
    ...
}
</code></pre>
<p>é€™äº›å§‹çµ‚ä½œç‚ºå¢é‡ç™¼é€åˆ°ä»¥å‰ç™¼é€çš„å›åŸ·ã€‚ç¾åœ¨
åªæ‡‰ä½¿ç”¨å–®å€‹"<receipt_type>":"m.read"ã€‚'m.read.private'
ä¸å¾—å‡ºç¾åœ¨æ­¤è¯åˆ"m.receipt"æ•™è‚²ä¸­ã€‚</p>
<h4 id="_21">å®‰å…¨æ³¨æ„äº‹é …</h4>
<p>ç”±æ–¼æ”¶æ“šæ˜¯åœ¨äº‹ä»¶åœ–çš„ä¸Šä¸‹æ–‡ä¹‹å¤–ç™¼é€çš„,å› æ­¤å­˜åœ¨
æœªå°ã€Œm.receiptã€äº‹ä»¶çš„å…§å®¹åŸ·è¡Œå®Œæ•´æ€§æª¢æŸ¥ã€‚</p>





                
              </article>
            </div>
          
          
        </div>
        
      </main>
      
        <footer class="md-footer">
  
  <div class="md-footer-meta md-typeset">
    <div class="md-footer-meta__inner md-grid">
      <div class="md-copyright">
  
  
    Made with
    <a href="https://squidfunk.github.io/mkdocs-material/" target="_blank" rel="noopener">
      Material for MkDocs
    </a>
  
</div>
      
    </div>
  </div>
</footer>
      
    </div>
    <div class="md-dialog" data-md-component="dialog">
      <div class="md-dialog__inner md-typeset"></div>
    </div>
    
    
    <script id="__config" type="application/json">{"base": "../..", "features": ["navigation.tabs"], "search": "../../assets/javascripts/workers/search.f886a092.min.js", "translations": {"clipboard.copied": "Copied to clipboard", "clipboard.copy": "Copy to clipboard", "search.result.more.one": "1 more on this page", "search.result.more.other": "# more on this page", "search.result.none": "No matching documents", "search.result.one": "1 matching document", "search.result.other": "# matching documents", "search.result.placeholder": "Type to start searching", "search.result.term.missing": "Missing", "select.version": "Select version"}}</script>
    
    
      <script src="../../assets/javascripts/bundle.94c44541.min.js"></script>
      
    
  </body>
</html>